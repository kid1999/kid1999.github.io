<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>åŒæŒ‡é’ˆæ¨¡æ¿</title>
      <link href="/2020/09/07/%E5%8F%8C%E6%8C%87%E9%92%88%E6%A8%A1%E6%9D%BF/"/>
      <url>/2020/09/07/%E5%8F%8C%E6%8C%87%E9%92%88%E6%A8%A1%E6%9D%BF/</url>
      
        <content type="html"><![CDATA[<h4 id="åŒæŒ‡é’ˆæŠ€å·§å¯ä»¥åˆ†ä¸ºä¸¤ç±»"><a href="#åŒæŒ‡é’ˆæŠ€å·§å¯ä»¥åˆ†ä¸ºä¸¤ç±»" class="headerlink" title="åŒæŒ‡é’ˆæŠ€å·§å¯ä»¥åˆ†ä¸ºä¸¤ç±»"></a>åŒæŒ‡é’ˆæŠ€å·§å¯ä»¥åˆ†ä¸ºä¸¤ç±»</h4><ul><li><strong>ã€Œå¿«æ…¢æŒ‡é’ˆã€</strong> è§£å†³ä¸»è¦è§£å†³é“¾è¡¨ä¸­çš„é—®é¢˜ï¼Œæ¯”å¦‚å…¸å‹çš„åˆ¤å®šé“¾è¡¨ä¸­æ˜¯å¦åŒ…å«ç¯</li><li>*<em>ã€Œå·¦å³æŒ‡é’ˆã€ *</em>åè€…ä¸»è¦è§£å†³æ•°ç»„ï¼ˆæˆ–è€…å­—ç¬¦ä¸²ï¼‰ä¸­çš„é—®é¢˜ï¼Œæ¯”å¦‚äºŒåˆ†æŸ¥æ‰¾ã€æ»‘åŠ¨çª—å£</li></ul><h2 id="ä¸€ã€å¿«æ…¢æŒ‡é’ˆçš„å¸¸è§ç®—æ³•"><a href="#ä¸€ã€å¿«æ…¢æŒ‡é’ˆçš„å¸¸è§ç®—æ³•" class="headerlink" title="ä¸€ã€å¿«æ…¢æŒ‡é’ˆçš„å¸¸è§ç®—æ³•"></a><strong>ä¸€ã€å¿«æ…¢æŒ‡é’ˆçš„å¸¸è§ç®—æ³•</strong></h2><p>å¿«æ…¢æŒ‡é’ˆä¸€èˆ¬éƒ½åˆå§‹åŒ–æŒ‡å‘é“¾è¡¨çš„å¤´ç»“ç‚¹ headï¼Œå‰è¿›æ—¶å¿«æŒ‡é’ˆ fast åœ¨å‰ï¼Œæ…¢æŒ‡é’ˆ slow åœ¨åï¼Œå·§å¦™è§£å†³ä¸€äº›é“¾è¡¨ä¸­çš„é—®é¢˜ã€‚</p><h3 id="1ã€åˆ¤å®šé“¾è¡¨ä¸­æ˜¯å¦å«æœ‰ç¯"><a href="#1ã€åˆ¤å®šé“¾è¡¨ä¸­æ˜¯å¦å«æœ‰ç¯" class="headerlink" title="1ã€åˆ¤å®šé“¾è¡¨ä¸­æ˜¯å¦å«æœ‰ç¯"></a><strong>1ã€åˆ¤å®šé“¾è¡¨ä¸­æ˜¯å¦å«æœ‰ç¯</strong></h3><p>è¿™åº”è¯¥å±äºé“¾è¡¨æœ€åŸºæœ¬çš„æ“ä½œäº†ï¼Œå¦‚æœè¯»è€…å·²ç»çŸ¥é“è¿™ä¸ªæŠ€å·§ï¼Œå¯ä»¥è·³è¿‡ã€‚</p><p>å•é“¾è¡¨çš„ç‰¹ç‚¹æ˜¯æ¯ä¸ªèŠ‚ç‚¹åªçŸ¥é“ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ‰€ä»¥ä¸€ä¸ªæŒ‡é’ˆçš„è¯æ— æ³•åˆ¤æ–­é“¾è¡¨ä¸­æ˜¯å¦å«æœ‰ç¯çš„ã€‚</p><p>å¦‚æœé“¾è¡¨ä¸­ä¸åŒ…å«ç¯ï¼Œé‚£ä¹ˆè¿™ä¸ªæŒ‡é’ˆæœ€ç»ˆä¼šé‡åˆ°ç©ºæŒ‡é’ˆ null è¡¨ç¤ºé“¾è¡¨åˆ°å¤´äº†ï¼Œè¿™è¿˜å¥½è¯´ï¼Œå¯ä»¥åˆ¤æ–­è¯¥é“¾è¡¨ä¸å«ç¯ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">boolean hasCycle(ListNode head) &#123;</span><br><span class="line">    while (head != null)</span><br><span class="line">        head = head.next;</span><br><span class="line">    return false;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯å¦‚æœé“¾è¡¨ä¸­å«æœ‰ç¯ï¼Œé‚£ä¹ˆè¿™ä¸ªæŒ‡é’ˆå°±ä¼šé™·å…¥æ­»å¾ªç¯ï¼Œå› ä¸ºç¯å½¢æ•°ç»„ä¸­æ²¡æœ‰ null æŒ‡é’ˆä½œä¸ºå°¾éƒ¨èŠ‚ç‚¹ã€‚</p><p>ç»å…¸è§£æ³•å°±æ˜¯ç”¨ä¸¤ä¸ªæŒ‡é’ˆï¼Œä¸€ä¸ªæ¯æ¬¡å‰è¿›ä¸¤æ­¥ï¼Œä¸€ä¸ªæ¯æ¬¡å‰è¿›ä¸€æ­¥ã€‚å¦‚æœä¸å«æœ‰ç¯ï¼Œè·‘å¾—å¿«çš„é‚£ä¸ªæŒ‡é’ˆæœ€ç»ˆä¼šé‡åˆ° nullï¼Œè¯´æ˜é“¾è¡¨ä¸å«ç¯ï¼›å¦‚æœå«æœ‰ç¯ï¼Œå¿«æŒ‡é’ˆæœ€ç»ˆä¼šè¶…æ…¢æŒ‡é’ˆä¸€åœˆï¼Œå’Œæ…¢æŒ‡é’ˆç›¸é‡ï¼Œè¯´æ˜é“¾è¡¨å«æœ‰ç¯ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">boolean hasCycle(ListNode head) &#123;</span><br><span class="line">    ListNode fast, slow;</span><br><span class="line">    fast = slow = head;</span><br><span class="line">    while(fast != null &amp;&amp; fast.next != null) &#123;</span><br><span class="line">        fast = fast.next.next;</span><br><span class="line">        slow = slow.next;</span><br><span class="line">        </span><br><span class="line">        if (fast == slow)</span><br><span class="line">            return true;</span><br><span class="line">    &#125;</span><br><span class="line">    return false;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2ã€å·²çŸ¥é“¾è¡¨ä¸­å«æœ‰ç¯ï¼Œè¿”å›è¿™ä¸ªç¯çš„èµ·å§‹ä½ç½®"><a href="#2ã€å·²çŸ¥é“¾è¡¨ä¸­å«æœ‰ç¯ï¼Œè¿”å›è¿™ä¸ªç¯çš„èµ·å§‹ä½ç½®" class="headerlink" title="2ã€å·²çŸ¥é“¾è¡¨ä¸­å«æœ‰ç¯ï¼Œè¿”å›è¿™ä¸ªç¯çš„èµ·å§‹ä½ç½®"></a><strong>2ã€å·²çŸ¥é“¾è¡¨ä¸­å«æœ‰ç¯ï¼Œè¿”å›è¿™ä¸ªç¯çš„èµ·å§‹ä½ç½®</strong></h3><p><img alt="img" data-src="https://pic1.zhimg.com/80/v2-97406fdff42b59b8f91ebb69522bed20_720w.jpg" class="lazyload"></p><p>è¿™ä¸ªé—®é¢˜å…¶å®ä¸å›°éš¾ï¼Œæœ‰ç‚¹ç±»ä¼¼è„‘ç­‹æ€¥è½¬å¼¯ï¼Œå…ˆç›´æ¥çœ‹ä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">ListNode detectCycle(ListNode head) &#123;</span><br><span class="line">    ListNode fast, slow;</span><br><span class="line">    fast = slow = head;</span><br><span class="line">    while (fast != null &amp;&amp; fast.next != null) &#123;</span><br><span class="line">        fast = fast.next.next;</span><br><span class="line">        slow = slow.next;</span><br><span class="line">        if (fast == slow)</span><br><span class="line">            break;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    slow = head;</span><br><span class="line">    while (slow != fast) &#123;</span><br><span class="line">        fast = fast.next;</span><br><span class="line">        slow = slow.next;</span><br><span class="line">    &#125;</span><br><span class="line">    return slow;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œå½“å¿«æ…¢æŒ‡é’ˆç›¸é‡æ—¶ï¼Œè®©å…¶ä¸­ä»»ä¸€ä¸ªæŒ‡é’ˆé‡æ–°æŒ‡å‘å¤´èŠ‚ç‚¹ï¼Œç„¶åè®©å®ƒä¿©ä»¥ç›¸åŒé€Ÿåº¦å‰è¿›ï¼Œå†æ¬¡ç›¸é‡æ—¶æ‰€åœ¨çš„èŠ‚ç‚¹ä½ç½®å°±æ˜¯ç¯å¼€å§‹çš„ä½ç½®ã€‚è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><p>ç¬¬ä¸€æ¬¡ç›¸é‡æ—¶ï¼Œå‡è®¾æ…¢æŒ‡é’ˆ slow èµ°äº† k æ­¥ï¼Œé‚£ä¹ˆå¿«æŒ‡é’ˆ fast ä¸€å®šèµ°äº† 2k æ­¥ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯” slow å¤šèµ°äº† k æ­¥ï¼ˆä¹Ÿå°±æ˜¯ç¯çš„é•¿åº¦ï¼‰ã€‚</p><p><img alt="img" data-src="https://pic3.zhimg.com/80/v2-e20cf1fac533671eff6b9a18df652668_720w.jpg" class="lazyload"></p><p>è®¾ç›¸é‡ç‚¹è·ç¯çš„èµ·ç‚¹çš„è·ç¦»ä¸º mï¼Œé‚£ä¹ˆç¯çš„èµ·ç‚¹è·å¤´ç»“ç‚¹ head çš„è·ç¦»ä¸º k - mï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœä» head å‰è¿› k - m æ­¥å°±èƒ½åˆ°è¾¾ç¯èµ·ç‚¹ã€‚</p><p>å·§çš„æ˜¯ï¼Œå¦‚æœä»ç›¸é‡ç‚¹ç»§ç»­å‰è¿› k - m æ­¥ï¼Œä¹Ÿæ°å¥½åˆ°è¾¾ç¯èµ·ç‚¹ã€‚</p><p><img alt="img" data-src="https://pic2.zhimg.com/80/v2-94f939ddf9d896c585ac6f61080d6a89_720w.jpg" class="lazyload"></p><p>æ‰€ä»¥ï¼Œåªè¦æˆ‘ä»¬æŠŠå¿«æ…¢æŒ‡é’ˆä¸­çš„ä»»ä¸€ä¸ªé‡æ–°æŒ‡å‘ headï¼Œç„¶åä¸¤ä¸ªæŒ‡é’ˆåŒé€Ÿå‰è¿›ï¼Œk - m æ­¥åå°±ä¼šç›¸é‡ï¼Œç›¸é‡ä¹‹å¤„å°±æ˜¯ç¯çš„èµ·ç‚¹äº†ã€‚</p><h3 id="3ã€å¯»æ‰¾é“¾è¡¨çš„ä¸­ç‚¹"><a href="#3ã€å¯»æ‰¾é“¾è¡¨çš„ä¸­ç‚¹" class="headerlink" title="3ã€å¯»æ‰¾é“¾è¡¨çš„ä¸­ç‚¹"></a><strong>3ã€å¯»æ‰¾é“¾è¡¨çš„ä¸­ç‚¹</strong></h3><p>ç±»ä¼¼ä¸Šé¢çš„æ€è·¯ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è®©å¿«æŒ‡é’ˆä¸€æ¬¡å‰è¿›ä¸¤æ­¥ï¼Œæ…¢æŒ‡é’ˆä¸€æ¬¡å‰è¿›ä¸€æ­¥ï¼Œå½“å¿«æŒ‡é’ˆåˆ°è¾¾é“¾è¡¨å°½å¤´æ—¶ï¼Œæ…¢æŒ‡é’ˆå°±å¤„äºé“¾è¡¨çš„ä¸­é—´ä½ç½®ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ListNode slow, fast;</span><br><span class="line">slow = fast = head;</span><br><span class="line">while (fast != null &amp;&amp; fast.next != null) &#123;</span><br><span class="line">    fast = fast.next.next;</span><br><span class="line">    slow = slow.next;</span><br><span class="line">&#125;</span><br><span class="line">// slow å°±åœ¨ä¸­é—´ä½ç½®</span><br><span class="line">return slow;</span><br></pre></td></tr></table></figure><p>å½“é“¾è¡¨çš„é•¿åº¦æ˜¯å¥‡æ•°æ—¶ï¼Œslow æ°å·§åœåœ¨ä¸­ç‚¹ä½ç½®ï¼›å¦‚æœé•¿åº¦æ˜¯å¶æ•°ï¼Œslow æœ€ç»ˆçš„ä½ç½®æ˜¯ä¸­é—´åå³ï¼š</p><p><img alt="img" data-src="https://picb.zhimg.com/80/v2-0f6ae47e73eaf517d579d925a2421092_720w.jpg" class="lazyload"></p><p>å¯»æ‰¾é“¾è¡¨ä¸­ç‚¹çš„ä¸€ä¸ªé‡è¦ä½œç”¨æ˜¯å¯¹é“¾è¡¨è¿›è¡Œå½’å¹¶æ’åºã€‚</p><p>å›æƒ³æ•°ç»„çš„å½’å¹¶æ’åºï¼šæ±‚ä¸­ç‚¹ç´¢å¼•é€’å½’åœ°æŠŠæ•°ç»„äºŒåˆ†ï¼Œæœ€ååˆå¹¶ä¸¤ä¸ªæœ‰åºæ•°ç»„ã€‚å¯¹äºé“¾è¡¨ï¼Œåˆå¹¶ä¸¤ä¸ªæœ‰åºé“¾è¡¨æ˜¯å¾ˆç®€å•çš„ï¼Œéš¾ç‚¹å°±åœ¨äºäºŒåˆ†ã€‚</p><p>ä½†æ˜¯ç°åœ¨ä½ å­¦ä¼šäº†æ‰¾åˆ°é“¾è¡¨çš„ä¸­ç‚¹ï¼Œå°±èƒ½å®ç°é“¾è¡¨çš„äºŒåˆ†äº†ã€‚å…³äºå½’å¹¶æ’åºçš„å…·ä½“å†…å®¹æœ¬æ–‡å°±ä¸å…·ä½“å±•å¼€äº†ã€‚</p><h3 id="4ã€å¯»æ‰¾é“¾è¡¨çš„å€’æ•°ç¬¬-k-ä¸ªå…ƒç´ "><a href="#4ã€å¯»æ‰¾é“¾è¡¨çš„å€’æ•°ç¬¬-k-ä¸ªå…ƒç´ " class="headerlink" title="4ã€å¯»æ‰¾é“¾è¡¨çš„å€’æ•°ç¬¬ k ä¸ªå…ƒç´ "></a><strong>4ã€å¯»æ‰¾é“¾è¡¨çš„å€’æ•°ç¬¬ k ä¸ªå…ƒç´ </strong></h3><p>æˆ‘ä»¬çš„æ€è·¯è¿˜æ˜¯ä½¿ç”¨å¿«æ…¢æŒ‡é’ˆï¼Œè®©å¿«æŒ‡é’ˆå…ˆèµ° k æ­¥ï¼Œç„¶åå¿«æ…¢æŒ‡é’ˆå¼€å§‹åŒé€Ÿå‰è¿›ã€‚è¿™æ ·å½“å¿«æŒ‡é’ˆèµ°åˆ°é“¾è¡¨æœ«å°¾ null æ—¶ï¼Œæ…¢æŒ‡é’ˆæ‰€åœ¨çš„ä½ç½®å°±æ˜¯å€’æ•°ç¬¬ k ä¸ªé“¾è¡¨èŠ‚ç‚¹ï¼ˆä¸ºäº†ç®€åŒ–ï¼Œå‡è®¾ k ä¸ä¼šè¶…è¿‡é“¾è¡¨é•¿åº¦ï¼‰ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ListNode slow, fast;</span><br><span class="line">slow = fast = head;</span><br><span class="line">while (k-- &gt; 0) </span><br><span class="line">    fast = fast.next;</span><br><span class="line"></span><br><span class="line">while (fast != null) &#123;</span><br><span class="line">    slow = slow.next;</span><br><span class="line">    fast = fast.next;</span><br><span class="line">&#125;</span><br><span class="line">return slow;</span><br></pre></td></tr></table></figure><h2 id="äºŒã€å·¦å³æŒ‡é’ˆçš„å¸¸ç”¨ç®—æ³•"><a href="#äºŒã€å·¦å³æŒ‡é’ˆçš„å¸¸ç”¨ç®—æ³•" class="headerlink" title="äºŒã€å·¦å³æŒ‡é’ˆçš„å¸¸ç”¨ç®—æ³•"></a><strong>äºŒã€å·¦å³æŒ‡é’ˆçš„å¸¸ç”¨ç®—æ³•</strong></h2><p>å·¦å³æŒ‡é’ˆåœ¨æ•°ç»„ä¸­å®é™…æ˜¯æŒ‡ä¸¤ä¸ªç´¢å¼•å€¼ï¼Œä¸€èˆ¬åˆå§‹åŒ–ä¸º left = 0, right = nums.length - 1 ã€‚</p><h3 id="1ã€äºŒåˆ†æŸ¥æ‰¾"><a href="#1ã€äºŒåˆ†æŸ¥æ‰¾" class="headerlink" title="1ã€äºŒåˆ†æŸ¥æ‰¾"></a><strong>1ã€äºŒåˆ†æŸ¥æ‰¾</strong></h3><p>å‰æ–‡ <a href="https://link.zhihu.com/?target=https%3A//www.cnblogs.com/kyoner/p/11080078.html">äºŒåˆ†æŸ¥æ‰¾ç®—æ³•è¯¦è§£</a> æœ‰è¯¦ç»†è®²è§£ï¼Œè¿™é‡Œåªå†™æœ€ç®€å•çš„äºŒåˆ†ç®—æ³•ï¼Œæ—¨åœ¨çªå‡ºå®ƒçš„åŒæŒ‡é’ˆç‰¹æ€§ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">int binarySearch(int[] nums, int target) &#123;</span><br><span class="line">    int left = 0;</span><br><span class="line">    int right = nums.length - 1;</span><br><span class="line">    while(left &lt;= right) &#123;</span><br><span class="line">        int mid = (right + left) / 2;</span><br><span class="line">        if (nums[mid] == target)</span><br><span class="line">            return mid;</span><br><span class="line">        else if (nums[mid] &lt; target)</span><br><span class="line">            left = mid + 1;</span><br><span class="line">        else if (nums[mid] &gt; target)</span><br><span class="line">            right = mid - 1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2ã€ä¸¤æ•°ä¹‹å’Œ"><a href="#2ã€ä¸¤æ•°ä¹‹å’Œ" class="headerlink" title="2ã€ä¸¤æ•°ä¹‹å’Œ"></a><strong>2ã€ä¸¤æ•°ä¹‹å’Œ</strong></h3><p>ç›´æ¥çœ‹ä¸€é“ LeetCode é¢˜ç›®å§ï¼š</p><p><img alt="img" data-src="https://pic4.zhimg.com/80/v2-7a9d45ef94187fea3c88ace260e79011_720w.jpg" class="lazyload"></p><p>åªè¦æ•°ç»„æœ‰åºï¼Œå°±åº”è¯¥æƒ³åˆ°åŒæŒ‡é’ˆæŠ€å·§ã€‚è¿™é“é¢˜çš„è§£æ³•æœ‰ç‚¹ç±»ä¼¼äºŒåˆ†æŸ¥æ‰¾ï¼Œé€šè¿‡è°ƒèŠ‚ left å’Œ right å¯ä»¥è°ƒæ•´ sum çš„å¤§å°ï¼š</p><h3 id="3ã€åè½¬æ•°ç»„"><a href="#3ã€åè½¬æ•°ç»„" class="headerlink" title="3ã€åè½¬æ•°ç»„"></a><strong>3ã€åè½¬æ•°ç»„</strong></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">void reverse(int[] nums) &#123;</span><br><span class="line">    int left = 0;</span><br><span class="line">    int right = nums.length - 1;</span><br><span class="line">    while (left &lt; right) &#123;</span><br><span class="line">        // swap(nums[left], nums[right])</span><br><span class="line">        int temp = nums[left];</span><br><span class="line">        nums[left] = nums[right];</span><br><span class="line">        nums[right] = temp;</span><br><span class="line">        left++;</span><br><span class="line">        right--;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4ã€æ»‘åŠ¨çª—å£ç®—æ³•"><a href="#4ã€æ»‘åŠ¨çª—å£ç®—æ³•" class="headerlink" title="4ã€æ»‘åŠ¨çª—å£ç®—æ³•"></a><strong>4ã€æ»‘åŠ¨çª—å£ç®—æ³•</strong></h3><p>å¦‚æœæŒæ¡äº†æ­¤ç®—æ³•ï¼Œå¯ä»¥è§£å†³ä¸€å¤§ç±»å­å­—ç¬¦ä¸²åŒ¹é…çš„é—®é¢˜ï¼Œè¯¦æƒ…å‚è€ƒæ»‘åŠ¨çª—å£ä¸€æ–‡ã€‚</p><p>å‚è€ƒï¼š</p><p><a href="https://zhuanlan.zhihu.com/p/138273078" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/138273078</a></p>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åŒæŒ‡é’ˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è£…é¥°å™¨æ¨¡å¼</title>
      <link href="/2020/09/07/%E8%A3%85%E9%A5%B0%E5%99%A8%E6%A8%A1%E5%BC%8F/"/>
      <url>/2020/09/07/%E8%A3%85%E9%A5%B0%E5%99%A8%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<p>é€‚ç”¨èŒƒå›´ï¼š</p><blockquote><p>æˆ‘å·²ç»æœ‰äº†ä¸€ä¸ªç±»ï¼Œä½†æ˜¯è¿™ä¸ªç±»è¿˜ä¸å¤Ÿè®©æˆ‘æ»¡æ„ï¼Œæˆ‘å°±æ‹¿è£…é¥°å™¨ç»™ä»–è£…é¥°ä¸€ä¸‹ã€‚</p></blockquote><h3 id="ä»£ç æ¼”ç¤ºï¼š"><a href="#ä»£ç æ¼”ç¤ºï¼š" class="headerlink" title="ä»£ç æ¼”ç¤ºï¼š"></a>ä»£ç æ¼”ç¤ºï¼š</h3><ul><li>å‡å¦‚æˆ‘å»å–å’–å•¡ï¼Œä½†æ˜¯å’–å•¡æ˜¯è‹¦çš„ï¼Œæˆ‘éœ€è¦åŠ ç³–è£…é¥°ä¸€ä¸‹</li><li>è‹¦å’–å•¡ ä¸ åŠ ç³–å’–å•¡ éƒ½æ˜¯åŸºäº å’–å•¡æ¥å£</li><li>å³å°†åˆšå¼€å§‹çš„è‹¦å’–å•¡ç»è¿‡åŠ ç³–å’–å•¡çš„è£…é¥°è¿”å›äº†ä¸€æ¯æ–°çš„å’–å•¡</li></ul><ol><li>å’–å•¡æ¥å£</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public interface Coffee &#123;</span><br><span class="line">    /**</span><br><span class="line">     * æ‰“å°å½“å‰å’–å•¡çš„åŸææ–™ï¼Œå³å’–å•¡é‡Œæœ‰ä»€ä¹ˆ</span><br><span class="line">     */</span><br><span class="line">    void printMaterial();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>è‹¦å’–å•¡å®ç°ç±»</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public class BitterCoffee implements Coffee &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void printMaterial() &#123;</span><br><span class="line">        System.out.println(&quot;å’–å•¡&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>é»˜è®¤ç‚¹é¤é€»è¾‘</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public class Main &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        Coffee coffee = new BitterCoffee();</span><br><span class="line">        coffee.printMaterial();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="4"><li>åŠ ç³–è£…é¥°å™¨</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * ç³–è£…é¥°å™¨ï¼Œç”¨æ¥ç»™å’–å•¡åŠ ç³–</span><br><span class="line"> */</span><br><span class="line">public class SugarDecorator implements Coffee &#123;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * æŒæœ‰çš„å’–å•¡å¯¹è±¡</span><br><span class="line">     */</span><br><span class="line">    private final Coffee coffee;</span><br><span class="line"></span><br><span class="line">    public SugarDecorator(Coffee coffee) &#123;</span><br><span class="line">        this.coffee = coffee;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    @Override</span><br><span class="line">    public void printMaterial() &#123;</span><br><span class="line">        System.out.println(&quot;ç³–&quot;);</span><br><span class="line">        this.coffee.printMaterial();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>5.åŠ ç³–æˆåŠŸ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public class Main &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        Coffee coffee = new BitterCoffee();</span><br><span class="line">        coffee = new SugarDecorator(coffee);</span><br><span class="line">        coffee.printMaterial();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">``` </span><br><span class="line">#### ä¸ä»£ç†æ¨¡å¼çš„å·®åˆ«ï¼š</span><br><span class="line"></span><br><span class="line">* ä¸¤è€…å®ç°çš„éƒ½æ˜¯å¯¹åŸå¯¹è±¡çš„åŒ…è£…ï¼ŒæŒæœ‰åŸå¯¹è±¡çš„å®ä¾‹ï¼Œå·®åˆ«åœ¨äºå¯¹å¤–çš„è¡¨ç°ã€‚</span><br><span class="line"></span><br><span class="line">* è£…é¥°å™¨æ¨¡å¼ï¼šç‚¹äº†å’–å•¡ï¼Œå‘ç°å¤ªè‹¦äº†ï¼Œä¸æ˜¯è‡ªå·±æƒ³è¦çš„ï¼Œç„¶åç”¨è£…é¥°å™¨åŠ äº†ç‚¹ç³–ã€‚</span><br></pre></td></tr></table></figure><p>Coffee coffee = new BitterCoffee();<br>coffee = new SugarDecorator(coffee);</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">* ä»£ç†æ¨¡å¼ï¼šç›´æ¥å°±ç‚¹çš„åŠ ç³–å’–å•¡ã€‚</span><br></pre></td></tr></table></figure><p>Coffee coffee = new CoffeeWithSugar();<br>```</p>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è£…é¥°å™¨æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å·¥å‚æ¨¡å¼</title>
      <link href="/2020/09/07/%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/"/>
      <url>/2020/09/07/%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h3 id="ç®€å•å·¥å‚æ¨¡å¼"><a href="#ç®€å•å·¥å‚æ¨¡å¼" class="headerlink" title="ç®€å•å·¥å‚æ¨¡å¼"></a>ç®€å•å·¥å‚æ¨¡å¼</h3><p><strong>å®šä¹‰</strong>ï¼šç”±ä¸€ä¸ªå·¥å‚å¯¹è±¡å†³å®šåˆ›å»ºå‡ºå“ªä¸€ç§ç±»å‹å®ä¾‹ã€‚å®¢æˆ·ç«¯åªéœ€ä¼ å…¥å·¥å‚ç±»çš„å‚æ•°ï¼Œæ— å¿ƒå…³å¿ƒåˆ›å»ºè¿‡ç¨‹ã€‚</p><p><strong>ä¼˜ç‚¹</strong>ï¼šå…·ä½“äº§å“ä»å®¢æˆ·ç«¯ä»£ç ä¸­æŠ½ç¦»å‡ºæ¥ï¼Œè§£è€¦ã€‚</p><p><strong>ç¼ºç‚¹</strong>ï¼šå·¥å‚ç±»èŒè´£è¿‡é‡ï¼Œå¢åŠ æ–°çš„ç±»å‹æ—¶ï¼Œå¾—ä¿®æ”¹å·¥ç¨‹ç±»å¾—ä»£ç ï¼Œè¿èƒŒå¼€é—­åŸåˆ™ã€‚</p><p>ä¸¾ä¾‹ï¼šæ–°å»ºFruitæ°´æœæŠ½è±¡ç±»ï¼ŒåŒ…å«eatæŠ½è±¡æ–¹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public abstract class Fruit &#123;</span><br><span class="line">    public abstract void eat();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶å®ç°ç±»Appleï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public class Apple extends Fruit&#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void eat() &#123;</span><br><span class="line">        System.out.println(&quot;åƒğŸ&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–°å»ºåˆ›å»ºFruitçš„å·¥å‚ç±»ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public class FruitFactory &#123;</span><br><span class="line">    public Fruit produce(String name) &#123;</span><br><span class="line">        if (&quot;apple&quot;.equals(name)) &#123;</span><br><span class="line">            return new Apple();</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            return null;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–°å»ºä¸ªå®¢æˆ·ç«¯æµ‹è¯•ä¸€ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public class Application &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        FruitFactory factory = new FruitFactory();</span><br><span class="line">        Fruit fruit = factory.produce(&quot;apple&quot;);</span><br><span class="line">        fruit.eat();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œmainæ–¹æ³•ï¼Œè¾“å‡ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åƒğŸ</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œå®¢æˆ·ç«¯Applicationå¹¶æœªä¾èµ–å…·ä½“çš„æ°´æœç±»å‹ï¼Œåªå…³å¿ƒ<code>FruitFactory</code>çš„å…¥å‚ï¼Œè¿™å°±æ˜¯å®¢æˆ·ç«¯å’Œå…·ä½“äº§å“è§£è€¦çš„ä½“ç°ï¼ŒUMLå›¾å¦‚ä¸‹ï¼š</p><p><img alt="QQæˆªå›¾20191216103019.png" data-src="https://mrbird.cc/img/QQ%E6%88%AA%E5%9B%BE20191216103019.png" class="lazyload"></p><h3 id="å·¥å‚æ–¹æ³•æ¨¡å¼"><a href="#å·¥å‚æ–¹æ³•æ¨¡å¼" class="headerlink" title="å·¥å‚æ–¹æ³•æ¨¡å¼"></a>å·¥å‚æ–¹æ³•æ¨¡å¼</h3><p>ä¸ºäº†è§£å†³ç®€å•å·¥å‚æ¨¡å¼çš„ç¼ºç‚¹ï¼Œè¯ç”Ÿäº†å·¥å‚æ–¹æ³•æ¨¡å¼ï¼ˆFactory method patternï¼‰ã€‚</p><p><strong>å®šä¹‰</strong>ï¼šå®šä¹‰åˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œè®©å®ç°è¿™ä¸ªæ¥å£çš„ç±»æ¥å†³å®šå®ä¾‹åŒ–å“ªä¸ªç±»ï¼Œå·¥å‚æ–¹æ³•è®©ç±»çš„å®ä¾‹åŒ–æ¨è¿Ÿåˆ°äº†å­ç±»è¿›è¡Œã€‚</p><p><strong>ä¼˜ç‚¹</strong>ï¼š</p><ol><li>å…·ä½“äº§å“ä»å®¢æˆ·ç«¯ä»£ç ä¸­æŠ½ç¦»å‡ºæ¥ï¼Œè§£è€¦ã€‚</li><li>åŠ å…¥æ–°çš„ç±»å‹æ—¶ï¼Œåªéœ€æ·»åŠ æ–°çš„å·¥å‚æ–¹æ³•ï¼ˆæ— éœ€ä¿®æ”¹æ—§çš„å·¥å‚æ–¹æ³•ä»£ç ï¼‰ï¼Œç¬¦åˆå¼€é—­åŸåˆ™ã€‚</li></ol><p><strong>ç¼ºç‚¹</strong>ï¼šç±»çš„ä¸ªæ•°å®¹æ˜“è¿‡å¤šï¼Œå¢åŠ å¤æ‚åº¦ã€‚</p><p>ä¸¾ä¾‹ï¼šæ–°å»ºFruitæŠ½è±¡ç±»ï¼ŒåŒ…å«eatæŠ½è±¡æ–¹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public abstract class Fruit &#123;</span><br><span class="line">    public abstract void eat();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–°å»º<code>FruitFactory</code>æŠ½è±¡å·¥å‚ï¼Œå®šä¹‰<code>produceFruit</code>æŠ½è±¡æ–¹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public abstract class FruitFactory &#123;</span><br><span class="line">    public abstract Fruit produceFruit();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–°å»ºFruitçš„å®ç°ç±»ï¼ŒAppleï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public class Apple extends Fruit &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void eat() &#123;</span><br><span class="line">        System.out.println(&quot;åƒğŸ&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–°å»º<code>FruitFactory</code>çš„å®ç°ç±»<code>AppleFruitFactory</code>ï¼Œç”¨äºç”Ÿäº§å…·ä½“ç±»å‹çš„æ°´æœ â€”â€” è‹¹æœï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public class AppleFruitFactory extends FruitFactory&#123;</span><br><span class="line">    @Override</span><br><span class="line">    public Fruit produceFruit() &#123;</span><br><span class="line">        return new Apple();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–°å»ºå®¢æˆ·ç«¯Applicationæµ‹è¯•ä¸€æ³¢ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public class Application &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        FruitFactory factory = new AppleFruitFactory();</span><br><span class="line">        Fruit fruit = factory.produceFruit();</span><br><span class="line">        fruit.eat();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œmainæ–¹æ³•ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åƒğŸ</span><br></pre></td></tr></table></figure><p>ç°åœ¨è¦æ–°å¢Bananaç±»å‹çš„æ°´æœï¼Œåªéœ€è¦æ–°å¢Bananaç±»å‹çš„å·¥å‚ç±»å³å¯ï¼Œæ— éœ€ä¿®æ”¹ç°æœ‰çš„<code>AppleFruitFactory</code>ä»£ç ï¼Œç¬¦åˆå¼€é—­åŸåˆ™ã€‚ä½†æ˜¯è¿™ç§æ¨¡å¼çš„ç¼ºç‚¹ä¹Ÿæ˜¾è€Œæ˜“è§ï¼Œå°±æ˜¯ç±»çš„ä¸ªæ•°å®¹æ˜“è¿‡å¤šï¼Œå¢åŠ å¤æ‚åº¦ã€‚</p><p>ä¸Šé¢ä¾‹å­UMLå›¾å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img alt="QQæˆªå›¾20191216105317.png" data-src="https://mrbird.cc/img/QQ%E6%88%AA%E5%9B%BE20191216105317.png" class="lazyload"></p><h3 id="æŠ½è±¡å·¥å‚æ¨¡å¼"><a href="#æŠ½è±¡å·¥å‚æ¨¡å¼" class="headerlink" title="æŠ½è±¡å·¥å‚æ¨¡å¼"></a>æŠ½è±¡å·¥å‚æ¨¡å¼</h3><p>æŠ½è±¡å·¥å‚æ¨¡å¼ï¼ˆAbstract factory patternï¼‰æä¾›äº†<strong>ä¸€ç³»åˆ—</strong>ç›¸å…³æˆ–è€…ç›¸äº’ä¾èµ–çš„å¯¹è±¡çš„æ¥å£ï¼Œå…³é”®å­—æ˜¯â€œä¸€ç³»åˆ—â€ã€‚</p><p><strong>ä¼˜ç‚¹</strong>ï¼š</p><ol><li>å…·ä½“äº§å“ä»å®¢æˆ·ç«¯ä»£ç ä¸­æŠ½ç¦»å‡ºæ¥ï¼Œè§£è€¦ã€‚</li><li>å°†ä¸€ä¸ªç³»åˆ—çš„äº§å“æ—ç»Ÿä¸€åˆ°ä¸€èµ·åˆ›å»ºã€‚</li></ol><p><strong>ç¼ºç‚¹</strong>ï¼šæ‹“å±•æ–°çš„åŠŸèƒ½å›°éš¾ï¼Œéœ€è¦ä¿®æ”¹æŠ½è±¡å·¥å‚çš„æ¥å£ï¼›</p><p>ç»¼ä¸Šæ‰€è¿°ï¼ŒæŠ½è±¡å·¥å‚æ¨¡å¼é€‚åˆé‚£äº›åŠŸèƒ½ç›¸å¯¹å›ºå®šçš„äº§å“æ—çš„åˆ›å»ºã€‚</p><p>ä¸¾ä¾‹ï¼šæ–°å»ºæ°´æœæŠ½è±¡ç±»Fruitï¼ŒåŒ…å«buyæŠ½è±¡æ–¹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public abstract class Fruit &#123;</span><br><span class="line">    public abstract void buy();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–°å»ºä»·æ ¼æŠ½è±¡ç±»Priceï¼ŒåŒ…å«payæŠ½è±¡æ–¹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public abstract class Price &#123;</span><br><span class="line">    public abstract void pay();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–°å»ºæ°´æœåˆ›å»ºå·¥å‚æ¥å£<code>FruitFactory</code>ï¼ŒåŒ…å«è·å–æ°´æœå’Œä»·æ ¼æŠ½è±¡æ–¹æ³•ï¼ˆäº§å“æ—çš„ä½“ç°æ˜¯ï¼Œä¸€ç»„äº§å“åŒ…å«æ°´æœå’Œå¯¹åº”çš„ä»·æ ¼ï¼‰ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public interface FruitFactory &#123;</span><br><span class="line">    Fruit getFruit();</span><br><span class="line">    Price getPrice();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥å¼€å§‹åˆ›å»ºğŸè¿™ä¸ªâ€œäº§å“æ—â€ã€‚æ–°å»ºFruitå®ç°ç±»AppleFruitï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public class AppleFruit extends Fruit&#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void buy() &#123;</span><br><span class="line">        System.out.println(&quot;è´­ä¹°ğŸ&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–°å»ºå¯¹åº”çš„è‹¹æœä»·æ ¼å®ç°<code>ApplePrice</code>ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public class ApplePrice extends Price&#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void pay() &#123;</span><br><span class="line">        System.out.println(&quot;ğŸå•ä»·2å…ƒ&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ›å»ºå®¢æˆ·ç«¯Applicationï¼Œæµ‹è¯•ä¸€æ³¢ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public class Application &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        FruitFactory factory = new AppleFruitFactory();</span><br><span class="line">        factory.getFruit().buy();</span><br><span class="line">        factory.getPrice().pay();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è´­ä¹°ğŸ</span><br><span class="line">ğŸå•ä»·2å…ƒ</span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯åªéœ€è¦é€šè¿‡åˆ›å»º<code>AppleFruitFactory</code>å°±å¯ä»¥è·å¾—è‹¹æœè¿™ä¸ªäº§å“æ—çš„æ‰€æœ‰å†…å®¹ï¼ŒåŒ…æ‹¬è‹¹æœå¯¹è±¡ï¼Œè‹¹æœä»·æ ¼ã€‚è¦æ–°å»ºğŸŒçš„äº§å“æ—ï¼Œåªéœ€è¦å®ç°<code>FruitFactory</code>ã€Priceå’ŒFruitæ¥å£å³å¯ã€‚è¿™ç§æ¨¡å¼çš„ç¼ºç‚¹å’Œå·¥å‚æ–¹æ³•å·®ä¸å¤šï¼Œå°±æ˜¯ç±»çš„ä¸ªæ•°å®¹æ˜“è¿‡å¤šï¼Œå¢åŠ å¤æ‚åº¦ã€‚</p><p>ä¸Šé¢ä¾‹å­UMLå›¾å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img alt="QQæˆªå›¾20191216112922.png" data-src="https://mrbird.cc/img/QQ%E6%88%AA%E5%9B%BE20191216112922.png" class="lazyload"></p><h3 id><a href="#" class="headerlink" title></a></h3><p>å‚è€ƒèµ„æ–™ï¼š<br><a href="https://snailclimb.gitee.io/javaguide/#/docs/system-design/è®¾è®¡æ¨¡å¼" target="_blank" rel="noopener">https://snailclimb.gitee.io/javaguide/#/docs/system-design/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F</a></p><p><a href="https://mrbird.cc/Javaè®¾è®¡æ¨¡å¼.html" target="_blank" rel="noopener">https://mrbird.cc/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F.html</a></p>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥å‚æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ»‘åŠ¨çª—å£</title>
      <link href="/2020/09/05/%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3/"/>
      <url>/2020/09/05/%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3/</url>
      
        <content type="html"><![CDATA[<blockquote><p>æ»‘åŠ¨çª—å£ä¸»è¦ç”¨æ¥å¤„ç†è¿ç»­é—®é¢˜ã€‚æ¯”å¦‚é¢˜ç›®æ±‚è§£â€œè¿ç»­å­ä¸² xxxxâ€ï¼Œâ€œè¿ç»­å­æ•°ç»„ xxxxâ€ï¼Œå°±åº”è¯¥å¯ä»¥æƒ³åˆ°æ»‘åŠ¨çª—å£ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ä¸€èˆ¬æ˜¯ O(N + K) Kæ˜¯çª—å£å¤§å°</p></blockquote><p>ä»ç±»å‹ä¸Šè¯´ä¸»è¦æœ‰ï¼š</p><ul><li>å›ºå®šçª—å£å¤§å°</li><li>çª—å£å¤§å°ä¸å›ºå®šï¼Œæ±‚è§£æœ€å¤§çš„æ»¡è¶³æ¡ä»¶çš„çª—å£</li><li>çª—å£å¤§å°ä¸å›ºå®šï¼Œæ±‚è§£æœ€å°çš„æ»¡è¶³æ¡ä»¶çš„çª—å£</li></ul><h4 id="å›ºå®šçª—å£"><a href="#å›ºå®šçª—å£" class="headerlink" title="å›ºå®šçª—å£"></a>å›ºå®šçª—å£</h4><p>ä¾‹å¦‚ï¼š</p><h4 id="å¯å˜çª—å£"><a href="#å¯å˜çª—å£" class="headerlink" title="å¯å˜çª—å£"></a>å¯å˜çª—å£</h4><p>ä¾‹å¦‚ï¼š<a href="https://leetcode-cn.com/problems/max-consecutive-ones-iii/" target="_blank" rel="noopener">1004. æœ€å¤§è¿ç»­1çš„ä¸ªæ•° III</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">longestOnes</span><span class="params">(<span class="keyword">int</span>[] A, <span class="keyword">int</span> K)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> l = <span class="number">0</span>, r = <span class="number">0</span>,count = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(r&lt;A.length)&#123;</span><br><span class="line">            count += A[r] == <span class="number">0</span> ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span>(count &gt; K)&#123;</span><br><span class="line">                count -= A[l++] == <span class="number">0</span> ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            res = Math.max(res,r-l+<span class="number">1</span>);</span><br><span class="line">            r++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ»‘åŠ¨çª—å£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SpringBootæ•´åˆSwagger2</title>
      <link href="/2020/08/29/SpringBoot%E6%95%B4%E5%90%88Swagger2/"/>
      <url>/2020/08/29/SpringBoot%E6%95%B4%E5%90%88Swagger2/</url>
      
        <content type="html"><![CDATA[<h1 id="SpringBootæ•´åˆSwagger2"><a href="#SpringBootæ•´åˆSwagger2" class="headerlink" title="SpringBootæ•´åˆSwagger2"></a>SpringBootæ•´åˆSwagger2</h1><h2 id="1-Swagger-ç®€ä»‹"><a href="#1-Swagger-ç®€ä»‹" class="headerlink" title="1.Swagger ç®€ä»‹"></a>1.Swagger ç®€ä»‹</h2><p>Swagger æ˜¯ä¸€å¥—åŸºäº OpenAPI è§„èŒƒæ„å»ºçš„å¼€æºå·¥å…·ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬è®¾è®¡ã€æ„å»ºã€è®°å½•ä»¥åŠä½¿ç”¨ Rest APIã€‚Swagger ä¸»è¦åŒ…å«äº†ä»¥ä¸‹ä¸‰ä¸ªéƒ¨åˆ†ï¼š</p><ol><li>Swagger Editorï¼šåŸºäºæµè§ˆå™¨çš„ç¼–è¾‘å™¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒç¼–å†™æˆ‘ä»¬ OpenAPI è§„èŒƒã€‚</li><li>Swagger UIï¼šå®ƒä¼šå°†æˆ‘ä»¬ç¼–å†™çš„ OpenAPI è§„èŒƒå‘ˆç°ä¸ºäº¤äº’å¼çš„ API æ–‡æ¡£ï¼Œåæ–‡æˆ‘å°†ä½¿ç”¨æµè§ˆå™¨æ¥æŸ¥çœ‹å¹¶ä¸”æ“ä½œæˆ‘ä»¬çš„ Rest APIã€‚</li><li>Swagger Codegenï¼šå®ƒå¯ä»¥é€šè¿‡ä¸º OpenAPIï¼ˆä»¥å‰ç§°ä¸º Swaggerï¼‰è§„èŒƒå®šä¹‰çš„ä»»ä½• API ç”ŸæˆæœåŠ¡å™¨å­˜æ ¹å’Œå®¢æˆ·ç«¯ SDK æ¥ç®€åŒ–æ„å»ºè¿‡ç¨‹ã€‚</li></ol><h3 id="2-ä¸ºä»€ä¹ˆè¦ä½¿ç”¨-Swagger"><a href="#2-ä¸ºä»€ä¹ˆè¦ä½¿ç”¨-Swagger" class="headerlink" title="2.ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ Swagger"></a>2.ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ Swagger</h3><p>å½“ä¸‹å¾ˆå¤šå…¬å¸éƒ½é‡‡å–å‰åç«¯åˆ†ç¦»çš„å¼€å‘æ¨¡å¼ï¼Œå‰ç«¯å’Œåç«¯çš„å·¥ä½œç”±ä¸åŒçš„å·¥ç¨‹å¸ˆå®Œæˆã€‚åœ¨è¿™ç§å¼€å‘æ¨¡å¼ä¸‹ï¼Œç»´æŒä¸€ä»½åŠæ—¶æ›´æ–°ä¸”å®Œæ•´çš„ Rest API æ–‡æ¡£å°†ä¼šæå¤§çš„æé«˜æˆ‘ä»¬çš„å·¥ä½œæ•ˆç‡ã€‚ä¼ ç»Ÿæ„ä¹‰ä¸Šçš„æ–‡æ¡£éƒ½æ˜¯åç«¯å¼€å‘äººå‘˜æ‰‹åŠ¨ç¼–å†™çš„ï¼Œç›¸ä¿¡å¤§å®¶ä¹Ÿéƒ½çŸ¥é“è¿™ç§æ–¹å¼å¾ˆéš¾ä¿è¯æ–‡æ¡£çš„åŠæ—¶æ€§ï¼Œè¿™ç§æ–‡æ¡£ä¹…è€Œä¹…ä¹‹ä¹Ÿå°±ä¼šå¤±å»å…¶å‚è€ƒæ„ä¹‰ï¼Œåè€Œè¿˜ä¼šåŠ å¤§æˆ‘ä»¬çš„æ²Ÿé€šæˆæœ¬ã€‚è€Œ Swagger ç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå…¨æ–°çš„ç»´æŠ¤ API æ–‡æ¡£çš„æ–¹å¼ï¼Œä¸‹é¢æˆ‘ä»¬å°±æ¥äº†è§£ä¸€ä¸‹å®ƒçš„ä¼˜ç‚¹ï¼š</p><ol><li>ä»£ç å˜ï¼Œæ–‡æ¡£å˜ã€‚åªéœ€è¦å°‘é‡çš„æ³¨è§£ï¼ŒSwagger å°±å¯ä»¥æ ¹æ®ä»£ç è‡ªåŠ¨ç”Ÿæˆ API æ–‡æ¡£ï¼Œå¾ˆå¥½çš„ä¿è¯äº†æ–‡æ¡£çš„æ—¶æ•ˆæ€§ã€‚</li><li>è·¨è¯­è¨€æ€§ï¼Œæ”¯æŒ 40 å¤šç§è¯­è¨€ã€‚</li><li>Swagger UI å‘ˆç°å‡ºæ¥çš„æ˜¯ä¸€ä»½å¯äº¤äº’å¼çš„ API æ–‡æ¡£ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨æ–‡æ¡£é¡µé¢å°è¯• API çš„è°ƒç”¨ï¼Œçœå»äº†å‡†å¤‡å¤æ‚çš„è°ƒç”¨å‚æ•°çš„è¿‡ç¨‹ã€‚</li><li>è¿˜å¯ä»¥å°†æ–‡æ¡£è§„èŒƒå¯¼å…¥ç›¸å…³çš„å·¥å…·ï¼ˆä¾‹å¦‚ SoapUIï¼‰, è¿™äº›å·¥å…·å°†ä¼šä¸ºæˆ‘ä»¬è‡ªåŠ¨åœ°åˆ›å»ºè‡ªåŠ¨åŒ–æµ‹è¯•ã€‚</li></ol><h2 id="3-å‡†å¤‡-Spring-Boot-Web-é¡¹ç›®"><a href="#3-å‡†å¤‡-Spring-Boot-Web-é¡¹ç›®" class="headerlink" title="3.å‡†å¤‡ Spring Boot Web é¡¹ç›®"></a>3.å‡†å¤‡ Spring Boot Web é¡¹ç›®</h2><p>1.åˆ›å»ºé¡¹ç›®</p><p>2.æ·»åŠ ä¾èµ–</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--    swagger apiæµ‹è¯•    --&gt;</span><br><span class="line">       &lt;dependency&gt;</span><br><span class="line">           &lt;groupId&gt;io.springfox&lt;/groupId&gt;</span><br><span class="line">           &lt;artifactId&gt;springfox-swagger2&lt;/artifactId&gt;</span><br><span class="line">           &lt;version&gt;2.9.2&lt;/version&gt;</span><br><span class="line">       &lt;/dependency&gt;</span><br><span class="line">       &lt;dependency&gt;</span><br><span class="line">           &lt;groupId&gt;io.springfox&lt;/groupId&gt;</span><br><span class="line">           &lt;artifactId&gt;springfox-swagger-ui&lt;/artifactId&gt;</span><br><span class="line">           &lt;version&gt;2.9.2&lt;/version&gt;</span><br><span class="line">       &lt;/dependency&gt;</span><br></pre></td></tr></table></figure><p>3.ç¼–å†™æ¥å£</p><ol><li><p>Controller</p><p><strong>æ³¨æ„æ­¤å¤„çš„<code>@RequestMapping(&quot;/user&quot;)</code>   <code>user</code>ä¸€å®šæ˜¯å·²ç»å®šä¹‰çš„APIModel,å¦åˆ™æ¥å£ä¸æ˜¾ç¤º</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span> <span class="meta">@RequestMapping</span>(<span class="string">"/user"</span>)</span><br><span class="line"><span class="meta">@Api</span>(tags = <span class="string">"ç”¨æˆ·ç®¡ç†"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Resource</span> <span class="keyword">private</span> UserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/query/&#123;id&#125;"</span>)</span><br><span class="line">    <span class="meta">@ApiOperation</span>(<span class="string">"é€šè¿‡IDæŸ¥è¯¢"</span>)</span><br><span class="line">    <span class="meta">@ApiImplicitParam</span>(name = <span class="string">"id"</span>, value = <span class="string">"ç”¨æˆ·ID"</span>, required = <span class="keyword">true</span>, dataType = <span class="string">"int"</span>, paramType = <span class="string">"path"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ResultModel&lt;User&gt; <span class="title">findById</span><span class="params">(@PathVariable <span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        User user = userService.findById(id);</span><br><span class="line">        <span class="keyword">return</span> ResultModel.success(<span class="string">"idæŸ¥è¯¢æˆåŠŸ"</span>, user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/query/ids"</span>)</span><br><span class="line">    <span class="meta">@ApiOperation</span>(<span class="string">"é€šè¿‡IDåˆ—è¡¨æŸ¥è¯¢"</span>)</span><br><span class="line">    <span class="keyword">public</span> ResultModel&lt;List&lt;User&gt;&gt; findByIdIn(<span class="keyword">int</span>[] ids) &#123;</span><br><span class="line">        List&lt;User&gt; users = userService.findByIdIn(ids);</span><br><span class="line">        <span class="keyword">return</span> ResultModel.success(<span class="string">"inæŸ¥è¯¢æˆåŠŸ"</span>, users);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/query/user"</span>)</span><br><span class="line">    <span class="meta">@ApiOperation</span>(<span class="string">"é€šè¿‡ç”¨æˆ·å®ä½“æŸ¥è¯¢"</span>)</span><br><span class="line">    <span class="keyword">public</span> ResultModel&lt;List&lt;User&gt;&gt; findByUser(User user) &#123;</span><br><span class="line">        List&lt;User&gt; users = userService.findByUser(user);</span><br><span class="line">        <span class="keyword">return</span> ResultModel.success(<span class="string">"é€šè¿‡å®ä½“æŸ¥è¯¢æˆåŠŸ"</span>, users);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/query/all"</span>)</span><br><span class="line">    <span class="meta">@ApiOperation</span>(<span class="string">"æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·"</span>)</span><br><span class="line">    <span class="keyword">public</span> ResultModel&lt;List&lt;User&gt;&gt; findAll() &#123;</span><br><span class="line">        List&lt;User&gt; users = userService.findAll();</span><br><span class="line">        <span class="keyword">return</span> ResultModel.success(<span class="string">"å…¨ä½“æŸ¥æ‰¾æˆåŠŸ"</span>, users);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/query/username"</span>)</span><br><span class="line">    <span class="meta">@ApiOperation</span>(<span class="string">"é€šè¿‡ç”¨æˆ·åç§°æ¨¡ç³ŠæŸ¥è¯¢"</span>)</span><br><span class="line">    <span class="meta">@ApiImplicitParam</span>(name = <span class="string">"userName"</span>, value = <span class="string">"ç”¨æˆ·åç§°"</span>)</span><br><span class="line">    <span class="keyword">public</span> ResultModel&lt;List&lt;User&gt;&gt; findByUserName(String userName) &#123;</span><br><span class="line">        List&lt;User&gt; users = userService.findByUserName(userName);</span><br><span class="line">        <span class="keyword">return</span> ResultModel.success(users);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping</span>(<span class="string">"/insert"</span>)</span><br><span class="line">    <span class="meta">@ApiOperation</span>(<span class="string">"æ–°å¢é»˜è®¤ç”¨æˆ·"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ResultModel&lt;Integer&gt; <span class="title">insert</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        User user = <span class="keyword">new</span> User();</span><br><span class="line">        user.setUserName(<span class="string">"zhongshiwen"</span>);</span><br><span class="line">        user.setNickName(<span class="string">"zsw"</span>);</span><br><span class="line">        user.setRealName(<span class="string">"é’Ÿä»•æ–‡"</span>);</span><br><span class="line">        user.setPassword(<span class="string">"zsw123456"</span>);</span><br><span class="line">        user.setGender(<span class="string">"ç”·"</span>);</span><br><span class="line">        Area area = <span class="keyword">new</span> Area();</span><br><span class="line">        area.setLevel((<span class="keyword">byte</span>) <span class="number">5</span>);</span><br><span class="line">        user.setArea(area);</span><br><span class="line">        userService.save(user);</span><br><span class="line">        <span class="keyword">return</span> ResultModel.success(<span class="string">"æ–°å¢ç”¨æˆ·æˆåŠŸ"</span>, user.getId());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@PutMapping</span>(<span class="string">"/update"</span>)</span><br><span class="line">    <span class="meta">@ApiOperation</span>(<span class="string">"æ›´æ–°ç”¨æˆ·ä¿¡æ¯"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ResultModel&lt;Integer&gt; <span class="title">update</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> row = userService.update(user);</span><br><span class="line">        <span class="keyword">return</span> ResultModel.success(row);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@PutMapping</span>(<span class="string">"/update/status"</span>)</span><br><span class="line">    <span class="meta">@ApiOperation</span>(<span class="string">"æ›´æ–°å•ä¸ªç”¨æˆ·çŠ¶æ€"</span>)</span><br><span class="line">    <span class="meta">@ApiImplicitParams</span>(&#123;</span><br><span class="line">            <span class="meta">@ApiImplicitParam</span>(name = <span class="string">"id"</span>, value = <span class="string">"ç”¨æˆ·ID"</span>, required = <span class="keyword">true</span>),</span><br><span class="line">            <span class="meta">@ApiImplicitParam</span>(name = <span class="string">"status"</span>, value = <span class="string">"çŠ¶æ€"</span>, required = <span class="keyword">true</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ResultModel&lt;User&gt; <span class="title">updateStatus</span><span class="params">(<span class="keyword">int</span> id, <span class="keyword">byte</span> status)</span> </span>&#123;</span><br><span class="line">        User user = userService.updateStatus(id, status);</span><br><span class="line">        <span class="keyword">return</span> ResultModel.success(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@DeleteMapping</span>(<span class="string">"/delete"</span>)</span><br><span class="line">    <span class="meta">@ApiOperation</span>(<span class="string">"åˆ é™¤å•ä¸ªç”¨æˆ·"</span>)</span><br><span class="line">    <span class="meta">@ApiImplicitParam</span>(value = <span class="string">"ç”¨æˆ·ID"</span>, required = <span class="keyword">true</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ResultModel&lt;Integer&gt; <span class="title">delete</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ResultModel.success(userService.delete(id));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><ol start="2"><li>Entity</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span> <span class="meta">@NoArgsConstructor</span> <span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@ApiModel</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(<span class="string">"ç”¨æˆ·ID"</span>) <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(<span class="string">"è´¦æˆ·å"</span>) <span class="keyword">private</span> String userName;</span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(<span class="string">"æ³¨å†Œæ—¶é—´"</span>) <span class="keyword">private</span> LocalDateTime registerTime;</span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(<span class="string">"æœ€è¿‘ç™»å½•æ—¶é—´"</span>) <span class="keyword">private</span> LocalDateTime lastLoginTime;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotPersistent</span> <span class="meta">@ApiModelProperty</span>(hidden = <span class="keyword">true</span>)</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">transient</span> Area area; <span class="comment">//ç”¨æˆ·æ‰€åœ¨åœ°åŒº</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotPersistent</span> <span class="meta">@ApiModelProperty</span>(hidden = <span class="keyword">true</span>)</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">transient</span> List&lt;Role&gt; roles; <span class="comment">//ç”¨æˆ·è§’è‰²åˆ—è¡¨</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>è¿”å›ç»“æœ</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Getter</span> <span class="meta">@Setter</span> <span class="meta">@ApiModel</span>(description = <span class="string">"è¿”å›ç»“æœ"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">ResultModel</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(<span class="string">"æ˜¯å¦æˆåŠŸ: true or false"</span>)</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> result;</span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(<span class="string">"æè¿°æ€§åŸå› "</span>)</span><br><span class="line">    <span class="keyword">private</span> String message;</span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(<span class="string">"ä¸šåŠ¡æ•°æ®"</span>)</span><br><span class="line">    <span class="keyword">private</span> T data;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">ResultModel</span><span class="params">(<span class="keyword">boolean</span> result, String message, T data)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.result = result;</span><br><span class="line">        <span class="keyword">this</span>.message = message;</span><br><span class="line">        <span class="keyword">this</span>.data = data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span>&lt;T&gt; ResultModel&lt;T&gt; <span class="title">success</span><span class="params">(T data)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ResultModel&lt;&gt;(<span class="keyword">true</span>, <span class="string">"SUCCESS"</span>, data);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span>&lt;T&gt; ResultModel&lt;T&gt; <span class="title">success</span><span class="params">(String message, T data)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ResultModel&lt;&gt;(<span class="keyword">true</span>, message, data);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ResultModel <span class="title">failure</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ResultModel&lt;&gt;(<span class="keyword">false</span>, <span class="string">"FAILURE"</span>, <span class="keyword">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ResultModel <span class="title">failure</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ResultModel&lt;&gt;(<span class="keyword">false</span>, message, <span class="keyword">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4.é…ç½®Swagger</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span> <span class="meta">@EnableSwagger</span>2</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Swagger2Config</span> </span>&#123;</span><br><span class="line">   <span class="meta">@Value</span>(<span class="string">"$&#123;swagger2.enable&#125;"</span>) <span class="keyword">private</span> <span class="keyword">boolean</span> enable;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Bean</span>(<span class="string">"UserApis"</span>)</span><br><span class="line">   <span class="function"><span class="keyword">public</span> Docket <span class="title">userApis</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">new</span> Docket(DocumentationType.SWAGGER_2)</span><br><span class="line">           .groupName(<span class="string">"ç”¨æˆ·æ¨¡å—"</span>)</span><br><span class="line">           .select()</span><br><span class="line">           .apis(RequestHandlerSelectors.withClassAnnotation(Api<span class="class">.<span class="keyword">class</span>))</span></span><br><span class="line">           .paths(PathSelectors.regex("/user.*"))</span><br><span class="line">           .build()</span><br><span class="line">           .apiInfo(apiInfo())</span><br><span class="line">           .enable(enable);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Bean</span>(<span class="string">"CustomApis"</span>)</span><br><span class="line">   <span class="function"><span class="keyword">public</span> Docket <span class="title">customApis</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">new</span> Docket(DocumentationType.SWAGGER_2)</span><br><span class="line">           .groupName(<span class="string">"å®¢æˆ·æ¨¡å—"</span>)</span><br><span class="line">           .select()</span><br><span class="line">           .apis(RequestHandlerSelectors.withClassAnnotation(Api<span class="class">.<span class="keyword">class</span>))</span></span><br><span class="line">           .paths(PathSelectors.regex("/custom.*"))</span><br><span class="line">           .build()</span><br><span class="line">           .apiInfo(apiInfo())</span><br><span class="line">           .enable(enable);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">private</span> ApiInfo <span class="title">apiInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">new</span> ApiInfoBuilder()</span><br><span class="line">           .title(<span class="string">"XXXXXç³»ç»Ÿå¹³å°æ¥å£æ–‡æ¡£"</span>)</span><br><span class="line">           .description(<span class="string">"æä¾›å­æ¨¡å—1/å­æ¨¡å—2/å­æ¨¡å—3çš„æ–‡æ¡£"</span>)</span><br><span class="line">           .termsOfServiceUrl(<span class="string">"https://kid1999.github.io/"</span>)</span><br><span class="line">           .version(<span class="string">"1.0"</span>)</span><br><span class="line">           .build();</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>5.éªŒè¯</p><p>å¯åŠ¨åº”ç”¨åï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆhttp://{root-path}/swagger-ui.htmlé¡µé¢ï¼Œè®¿é—®åï¼Œæ•ˆæœå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img alt="img" data-src="https://user-gold-cdn.xitu.io/2018/5/18/16371ace7275a3e9?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" class="lazyload"></p><h2 id="4-Swagger-UI-çš„ä½¿ç”¨"><a href="#4-Swagger-UI-çš„ä½¿ç”¨" class="headerlink" title="4.Swagger UI çš„ä½¿ç”¨"></a>4.Swagger UI çš„ä½¿ç”¨</h2><h3 id="æ¥å£æŸ¥çœ‹"><a href="#æ¥å£æŸ¥çœ‹" class="headerlink" title="æ¥å£æŸ¥çœ‹"></a>æ¥å£æŸ¥çœ‹</h3><p>SwaggerUI ä¼šä»¥åˆ—è¡¨çš„æ–¹å¼å±•ç¤ºæ‰€æœ‰æ‰«æåˆ°çš„æ¥å£ï¼Œåˆå§‹çŠ¶æ€æ˜¯æ”¶ç¼©çš„ï¼Œæˆ‘ä»¬åªéœ€è¦ç‚¹å‡»å±•å¼€å°±å¥½ï¼Œè€Œä¸”ä¼šåœ¨å·¦è¾¹æ ‡è¯†æ¥å£çš„è¯·æ±‚æ–¹å¼ï¼ˆGETã€POSTã€PUTã€DELETE ç­‰ç­‰ï¼‰ã€‚</p><p><strong>Swagger æ¥å£åˆ—è¡¨ç•Œé¢</strong></p><p><img alt="å›¾ 5. Swagger æ¥å£åˆ—è¡¨ç•Œé¢" data-src="https://developer.ibm.com/developer/default/articles/j-using-swagger-in-a-spring-boot-project/images/image005.png" class="lazyload"></p><h3 id="æ¥å£è°ƒç”¨"><a href="#æ¥å£è°ƒç”¨" class="headerlink" title="æ¥å£è°ƒç”¨"></a>æ¥å£è°ƒç”¨</h3><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œç‚¹å‡»æ¥å£å±•å¼€åé¡µé¢å³ä¸Šè§’çš„ <strong>Try it out</strong> æŒ‰é’®åï¼Œé¡µé¢ä¼šå˜æˆå¦‚å›¾æ‰€ç¤ºï¼š</p><p><strong>æ¥å£è¯¦æƒ…ç•Œé¢</strong></p><p><img alt="å›¾ 6. æ¥å£è¯¦æƒ…ç•Œé¢" data-src="https://developer.ibm.com/developer/default/articles/j-using-swagger-in-a-spring-boot-project/images/image006.png" class="lazyload"></p><p>SwaggerUI ä¼šç»™æˆ‘ä»¬è‡ªåŠ¨å¡«å……è¯·æ±‚å‚æ•°çš„æ•°æ®ç»“æ„ï¼Œæˆ‘ä»¬éœ€è¦åšçš„åªæ˜¯ç‚¹å‡» <strong>Execute</strong> å³å¯å‘èµ·è°ƒç”¨</p><p><strong>æ¥å£è°ƒç”¨ç•Œé¢</strong></p><p><img alt="å›¾ 7. æ¥å£è°ƒç”¨ç•Œé¢" data-src="https://developer.ibm.com/developer/default/articles/j-using-swagger-in-a-spring-boot-project/images/image007.png" class="lazyload"></p><h3 id="Model"><a href="#Model" class="headerlink" title="Model"></a>Model</h3><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒSwaggerUI ä¼šé€šè¿‡æˆ‘ä»¬åœ¨å®ä½“ä¸Šä½¿ç”¨çš„ <code>@ApiModel</code> æ³¨è§£ä»¥åŠ <code>@ApiModelProperty</code> æ³¨è§£æ¥è‡ªåŠ¨è¡¥å……å®ä½“ä»¥åŠå…¶å±æ€§çš„æè¿°å’Œå¤‡æ³¨ã€‚</p><p><strong>å›¾ 8. å®ä½“ç•Œé¢</strong></p><p><img alt="å›¾ 8. å®ä½“ç•Œé¢" data-src="https://developer.ibm.com/developer/default/articles/j-using-swagger-in-a-spring-boot-project/images/image008.png" class="lazyload"></p><h2 id="5-å¸¸ç”¨çš„Swagger2æ³¨è§£"><a href="#5-å¸¸ç”¨çš„Swagger2æ³¨è§£" class="headerlink" title="5.å¸¸ç”¨çš„Swagger2æ³¨è§£"></a>5.å¸¸ç”¨çš„Swagger2æ³¨è§£</h2><h3 id="Controller-ç›¸å…³æ³¨è§£"><a href="#Controller-ç›¸å…³æ³¨è§£" class="headerlink" title="Controller ç›¸å…³æ³¨è§£"></a>Controller ç›¸å…³æ³¨è§£</h3><p><code>@Api</code>: å¯è®¾ç½®å¯¹æ§åˆ¶å™¨çš„æè¿°ã€‚</p><p><strong>@Api ä¸»è¦å±æ€§</strong></p><table><thead><tr><th align="left"><strong>æ³¨è§£å±æ€§</strong></th><th align="left"><strong>ç±»å‹</strong></th><th align="left"><strong>æè¿°</strong></th></tr></thead><tbody><tr><td align="left">tags</td><td align="left">String[]</td><td align="left">æ§åˆ¶å™¨æ ‡ç­¾ã€‚</td></tr><tr><td align="left">description</td><td align="left">String</td><td align="left">æ§åˆ¶å™¨æè¿°ï¼ˆè¯¥å­—æ®µè¢«ç”³æ˜ä¸ºè¿‡æœŸï¼‰ã€‚</td></tr></tbody></table><h3 id="æ¥å£ç›¸å…³æ³¨è§£"><a href="#æ¥å£ç›¸å…³æ³¨è§£" class="headerlink" title="æ¥å£ç›¸å…³æ³¨è§£"></a>æ¥å£ç›¸å…³æ³¨è§£</h3><p><code>@ApiOperation</code>: å¯è®¾ç½®å¯¹æ¥å£çš„æè¿°ã€‚</p><p><strong>@ApiOperation ä¸»è¦å±æ€§</strong></p><table><thead><tr><th align="left"><strong>æ³¨è§£å±æ€§</strong></th><th align="left"><strong>ç±»å‹</strong></th><th align="left"><strong>æè¿°</strong></th></tr></thead><tbody><tr><td align="left">value</td><td align="left">String</td><td align="left">æ¥å£è¯´æ˜ã€‚</td></tr><tr><td align="left">notes</td><td align="left">String</td><td align="left">æ¥å£å‘å¸ƒè¯´æ˜ã€‚</td></tr><tr><td align="left">tags</td><td align="left">Stirng[]</td><td align="left">æ ‡ç­¾ã€‚</td></tr><tr><td align="left">response</td><td align="left">Class&lt;?&gt;</td><td align="left">æ¥å£è¿”å›ç±»å‹ã€‚</td></tr><tr><td align="left">httpMethod</td><td align="left">String</td><td align="left">æ¥å£è¯·æ±‚æ–¹å¼ã€‚</td></tr></tbody></table><p><code>@ApiIgnore</code>: Swagger æ–‡æ¡£ä¸ä¼šæ˜¾ç¤ºæ‹¥æœ‰è¯¥æ³¨è§£çš„æ¥å£ã€‚ <code>@ApiImplicitParams</code>: ç”¨äºæè¿°æ¥å£çš„éå¯¹è±¡å‚æ•°é›†ã€‚ <code>@ApiImplicitParam</code>: ç”¨äºæè¿°æ¥å£çš„éå¯¹è±¡å‚æ•°ï¼Œä¸€èˆ¬ä¸ <code>@ApiImplicitParams</code> ç»„åˆä½¿ç”¨ã€‚</p><p><strong>@ApiImplicitParam ä¸»è¦å±æ€§</strong></p><table><thead><tr><th align="left"><strong>æ³¨è§£å±æ€§</strong></th><th align="left"><strong>æè¿°</strong></th></tr></thead><tbody><tr><td align="left">paramType</td><td align="left">æŸ¥è¯¢å‚æ•°ç±»å‹ï¼Œå®é™…ä¸Šå°±æ˜¯å‚æ•°æ”¾åœ¨é‚£é‡Œã€‚å–å€¼ï¼špathï¼šä»¥åœ°å€çš„å½¢å¼æäº¤æ•°æ®ï¼Œæ ¹æ® id æŸ¥è¯¢ç”¨æˆ·çš„æ¥å£å°±æ˜¯è¿™ç§å½¢å¼ä¼ å‚ï¼›queryï¼šQuery string çš„æ–¹å¼ä¼ å‚ï¼›headerï¼šä»¥æµçš„å½¢å¼æäº¤ï¼›formï¼šä»¥ Form è¡¨å•çš„å½¢å¼æäº¤ã€‚</td></tr><tr><td align="left">dataType</td><td align="left">å‚æ•°çš„æ•°æ®ç±»å‹ã€‚å–å€¼ï¼šLong å’Œ String</td></tr><tr><td align="left">name</td><td align="left">å‚æ•°åå­—ã€‚</td></tr><tr><td align="left">value</td><td align="left">å‚æ•°æ„ä¹‰çš„æè¿°ã€‚</td></tr><tr><td align="left">required</td><td align="left">æ˜¯å¦å¿…å¡«ã€‚å–å€¼ï¼štrueï¼šå¿…å¡«å‚æ•°ï¼›falseï¼šéå¿…å¡«å‚æ•°ã€‚</td></tr></tbody></table><h3 id="Model-ç›¸å…³æ³¨è§£"><a href="#Model-ç›¸å…³æ³¨è§£" class="headerlink" title="Model ç›¸å…³æ³¨è§£"></a>Model ç›¸å…³æ³¨è§£</h3><p><code>@ApiModel</code>: å¯è®¾ç½®æ¥å£ç›¸å…³å®ä½“çš„æè¿°ã€‚ <code>@ApiModelProperty</code>: å¯è®¾ç½®å®ä½“å±æ€§çš„ç›¸å…³æè¿°ã€‚</p><p><strong>@ApiModelProperty ä¸»è¦å±æ€§</strong></p><table><thead><tr><th align="left"><strong>æ³¨è§£å±æ€§</strong></th><th align="left"><strong>ç±»å‹</strong></th><th align="left"><strong>æè¿°</strong></th></tr></thead><tbody><tr><td align="left">value</td><td align="left">String</td><td align="left">å­—æ®µè¯´æ˜ã€‚</td></tr><tr><td align="left">name</td><td align="left">String</td><td align="left">é‡å†™å­—æ®µåç§°ã€‚</td></tr><tr><td align="left">dataType</td><td align="left">Stirng</td><td align="left">é‡å†™å­—æ®µç±»å‹ã€‚</td></tr><tr><td align="left">required</td><td align="left">boolean</td><td align="left">æ˜¯å¦å¿…å¡«ã€‚</td></tr><tr><td align="left">example</td><td align="left">Stirng</td><td align="left">ä¸¾ä¾‹è¯´æ˜ã€‚</td></tr><tr><td align="left">hidden</td><td align="left">boolean</td><td align="left">æ˜¯å¦åœ¨æ–‡æ¡£ä¸­éšè—è¯¥å­—æ®µã€‚</td></tr><tr><td align="left">allowEmptyValue</td><td align="left">boolean</td><td align="left">æ˜¯å¦å…è®¸ä¸ºç©ºã€‚</td></tr><tr><td align="left">allowableValues</td><td align="left">String</td><td align="left">è¯¥å­—æ®µå…è®¸çš„å€¼ï¼Œå½“æˆ‘ä»¬ API çš„æŸä¸ªå‚æ•°ä¸ºæšä¸¾ç±»å‹æ—¶ï¼Œä½¿ç”¨è¿™ä¸ªå±æ€§å°±å¯ä»¥æ¸…æ¥šåœ°å‘Šè¯‰ API ä½¿ç”¨è€…è¯¥å‚æ•°æ‰€èƒ½å…è®¸ä¼ å…¥çš„å€¼ã€‚</td></tr></tbody></table>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ä»£ç†æ¨¡å¼</title>
      <link href="/2020/08/29/%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/"/>
      <url>/2020/08/29/%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<p>é€‚ç”¨èŒƒå›´ï¼š</p><blockquote><p>ä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ä¸ªä»£ç†ä»¥æ§åˆ¶å¯¹æŸä¸ªå¯¹è±¡çš„è®¿é—®ã€‚ä»£ç†ç±»ä¸»è¦è´Ÿè´£ä¸ºå§”æ‰˜äº†ï¼ˆçœŸå®å¯¹è±¡ï¼‰é¢„å¤„ç†æ¶ˆæ¯ã€è¿‡æ»¤æ¶ˆæ¯ã€ä¼ é€’æ¶ˆæ¯ç»™å§”æ‰˜ç±»ï¼Œä»£ç†ç±»ä¸ç°å®å…·ä½“æœåŠ¡ï¼Œè€Œæ˜¯åˆ©ç”¨å§”æ‰˜ç±»æ¥å®ŒæˆæœåŠ¡ï¼Œå¹¶å°†æ‰§è¡Œç»“æœå°è£…å¤„ç†ã€‚</p></blockquote><p>ä¾‹å¦‚ï¼šæˆ‘ä»¬è¦å»ä¹°ç«è½¦ç¥¨</p><ul><li>æŠ½è±¡æ¥å£ï¼šéƒ½æ˜¯å–ç¥¨çš„</li><li>è¢«ä»£ç†å¯¹è±¡ï¼š12306å®˜æ–¹å”®ç¥¨</li><li>ä»£ç†å¯¹è±¡ï¼šå„ç§ç¬¬ä¸‰æ–¹ä»£ç†å”®å•†</li><li>ç”¨æˆ·å»ä½¿ç”¨ç¬¬ä¸‰æ–¹ä»£ç†ä¹°ç¥¨ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯å®ç°äº†ä»£ç†â€”é€šè¿‡å¯¹ä»£ç†ç±»çš„è®¿é—®æ§åˆ¶è¢«ä»£ç†å¯¹è±¡</li></ul><h2 id="ä¸‰ç§å¸¸ç”¨åŠ¨æ€ä»£ç†"><a href="#ä¸‰ç§å¸¸ç”¨åŠ¨æ€ä»£ç†" class="headerlink" title="ä¸‰ç§å¸¸ç”¨åŠ¨æ€ä»£ç†"></a>ä¸‰ç§å¸¸ç”¨åŠ¨æ€ä»£ç†</h2><ul><li>é™æ€ä»£ç†</li><li>jdkåŠ¨æ€ä»£ç†</li><li>cglibåŠ¨æ€ä»£ç†</li></ul><h3 id="1-é™æ€ä»£ç†"><a href="#1-é™æ€ä»£ç†" class="headerlink" title="1.é™æ€ä»£ç†"></a>1.é™æ€ä»£ç†</h3><blockquote><p>åˆ›å»ºä¸€ä¸ªæ¥å£ï¼Œç„¶ååˆ›å»ºè¢«ä»£ç†çš„ç±»å®ç°è¯¥æ¥å£å¹¶ä¸”å®ç°è¯¥æ¥å£ä¸­çš„æŠ½è±¡æ–¹æ³•ã€‚ä¹‹åå†åˆ›å»ºä¸€ä¸ªä»£ç†ç±»ï¼ŒåŒæ—¶ä½¿å…¶ä¹Ÿå®ç°è¿™ä¸ªæ¥å£ã€‚åœ¨ä»£ç†ç±»ä¸­æŒæœ‰ä¸€ä¸ªè¢«ä»£ç†å¯¹è±¡çš„å¼•ç”¨ï¼Œè€Œååœ¨ä»£ç†ç±»æ–¹æ³•ä¸­è°ƒç”¨è¯¥å¯¹è±¡çš„æ–¹æ³•ã€‚</p></blockquote><ol><li>æ¥å£ï¼š</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public interface SaleTicket &#123;</span><br><span class="line">    void sale(int money);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>è¢«ä»£ç†ç±»ï¼š</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public class SaleBy12306 implements SaleTicket&#123;</span><br><span class="line">    public void sale(int money) &#123;</span><br><span class="line">        if(money &gt; 100)&#123;</span><br><span class="line">            System.out.println(&quot;è´­ç¥¨æˆåŠŸï¼&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        else &#123;</span><br><span class="line">            System.out.println(&quot;è´­ç¥¨å¤±è´¥ï¼&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>ä»£ç†ç±»ï¼š</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public class SaleByOthers implements SaleTicket &#123;</span><br><span class="line">    private final SaleBy12306 saleTicket;</span><br><span class="line"></span><br><span class="line">    public SaleByOthers(SaleBy12306 saleTicket) &#123;</span><br><span class="line">        this.saleTicket = saleTicket;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // ä»£ç†å•† é™¤äº†æ­£å¸¸å–ç¥¨è¿˜èƒ½ æ‰“æŠ˜...ä¹‹ç±»çš„</span><br><span class="line">    public void sale(int money) &#123;</span><br><span class="line">        System.out.println(&quot;æ‰“æŠ˜&quot;);</span><br><span class="line">        saleTicket.sale(money);    // æœ€åè¿˜æ˜¯å»12306å–ç¥¨</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="4"><li>ä»£ç†ç±»è°ƒç”¨ï¼š<br>è¢«ä»£ç†ç±»è¢«ä¼ é€’ç»™äº†ä»£ç†ç±»SaleByOthersï¼Œä»£ç†ç±»åœ¨æ‰§è¡Œå…·ä½“æ–¹æ³•æ—¶é€šè¿‡æ‰€æŒç”¨çš„è¢«ä»£ç†ç±»å®Œæˆè°ƒç”¨ã€‚</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public class Client &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        SaleBy12306 saleBy12306 = new SaleBy12306();</span><br><span class="line">        SaleByOthers saleByOthers = new SaleByOthers(saleBy12306);</span><br><span class="line">        saleByOthers.sale(200);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line">è¾“å‡ºï¼š</span><br><span class="line">æ‰“æŠ˜</span><br><span class="line">è´­ç¥¨æˆåŠŸï¼</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“ï¼š</strong> ä½¿ç”¨é™æ€ä»£ç†å¾ˆå®¹æ˜“å°±å®Œæˆäº†å¯¹ä¸€ä¸ªç±»çš„ä»£ç†æ“ä½œã€‚ä½†æ˜¯é™æ€ä»£ç†çš„ç¼ºç‚¹ä¹Ÿæš´éœ²äº†å‡ºæ¥ï¼šç”±äºä»£ç†åªèƒ½ä¸ºä¸€ä¸ªç±»æœåŠ¡ï¼Œå¦‚æœéœ€è¦ä»£ç†çš„ç±»å¾ˆå¤šï¼Œé‚£ä¹ˆå°±éœ€è¦ç¼–å†™å¤§é‡çš„ä»£ç†ç±»ï¼Œæ¯”è¾ƒç¹çã€‚</p><h3 id="2-åŠ¨æ€ä»£ç†"><a href="#2-åŠ¨æ€ä»£ç†" class="headerlink" title="2.åŠ¨æ€ä»£ç†"></a>2.åŠ¨æ€ä»£ç†</h3><blockquote><p>åˆ©ç”¨åå°„æœºåˆ¶åœ¨è¿è¡Œæ—¶åˆ›å»ºä»£ç†ç±»ï¼Œå®ç°å¯¹è¢«ä»£ç†å¯¹è±¡çš„è®¿é—®æ§åˆ¶ã€‚<br>æ¥å£ã€è¢«ä»£ç†ç±»ä¸å˜ï¼Œæˆ‘ä»¬æ„å»ºä¸€ä¸ªhandlerç±»æ¥å®ç°InvocationHandleræ¥å£ã€‚</p></blockquote><ol><li>æ¥å£ï¼š</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public interface SaleTicket &#123;</span><br><span class="line">    void sale(int money);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>è¢«ä»£ç†ç±»ï¼š</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public class SaleBy12306 implements SaleTicket&#123;</span><br><span class="line">    public void sale(int money) &#123;</span><br><span class="line">        if(money &gt; 100)&#123;</span><br><span class="line">            System.out.println(&quot;è´­ç¥¨æˆåŠŸï¼&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        else &#123;</span><br><span class="line">            System.out.println(&quot;è´­ç¥¨å¤±è´¥ï¼&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>ä»£ç†ç±»ï¼š</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">// å”®ç¥¨ä»£ç†å•† å¤„ç†å™¨</span><br><span class="line">public class SaleTicketHandler implements InvocationHandler &#123;</span><br><span class="line">    private Object object;</span><br><span class="line"></span><br><span class="line">    public SaleTicketHandler(Object object) &#123;</span><br><span class="line">        this.object = object;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * åŠ¨æ€ä»£ç†æ‰§è¡Œæ–¹æ³• ç±»ä¼¼Threadçš„runæ–¹æ³•</span><br><span class="line">     * @param proxy  è¢«ä»£ç†å¯¹è±¡</span><br><span class="line">     * @param method è¢«ä»£ç†å¯¹è±¡çš„æ–¹æ³•</span><br><span class="line">     * @param args  è¢«ä»£ç†æ–¹æ³•å‚æ•°</span><br><span class="line">     * @return</span><br><span class="line">     * @throws Throwable</span><br><span class="line">     */</span><br><span class="line">    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable &#123;</span><br><span class="line">        // ä¸€æ ·åœ¨å”®ç¥¨å‰åå¯ä»¥åšæ“ä½œ</span><br><span class="line">        System.out.println(&quot;å”®ç¥¨å‰....&quot; + method.getName());</span><br><span class="line">        // ä½¿ç”¨åå°„æ‰§è¡Œ12306çš„å”®ç¥¨æ–¹æ³•</span><br><span class="line">        Object reslut = method.invoke(object,args);</span><br><span class="line">        System.out.println(&quot;å”®ç¥¨å....&quot; + method.getName());</span><br><span class="line">        return reslut;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="4"><li>ä»£ç†ç±»è°ƒç”¨ï¼š<br>è¢«ä»£ç†ç±»è¢«ä¼ é€’ç»™äº†ä»£ç†ç±»saleTicketByProxy ï¼Œä»£ç†ç±»åœ¨æ‰§è¡Œå…·ä½“æ–¹æ³•æ—¶é€šè¿‡æ‰€æŒç”¨çš„è¢«ä»£ç†ç±»å®Œæˆè°ƒç”¨ã€‚</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">public class Client &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        SaleBy12306 saleBy12306 = new SaleBy12306();</span><br><span class="line">        InvocationHandler handler = new SaleTicketHandler(saleBy12306);</span><br><span class="line">        /**</span><br><span class="line">         * æ­¤å¤„ä»£ç†ç±»Proxyçš„newProxyInstanceéœ€è¦ä¸‰ä¸ªå‚æ•°</span><br><span class="line">         * 1.è¢«ä»£ç†å¯¹è±¡çš„ç±»åŠ è½½å™¨</span><br><span class="line">         * 2.è¢«ä»£ç†å¯¹è±¡çš„æ¥å£</span><br><span class="line">         * 3.å®é™…çš„ä»£ç†å¯¹è±¡å¤„ç†å™¨ -- ProxyHandler</span><br><span class="line">         */</span><br><span class="line">        SaleTicket saleTicketByProxy = (SaleTicket) Proxy.newProxyInstance(</span><br><span class="line">                saleBy12306.getClass().getClassLoader(),</span><br><span class="line">                saleBy12306.getClass().getInterfaces(),</span><br><span class="line">                handler</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        saleTicketByProxy.sale(200);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡Proxyç±»çš„é™æ€æ–¹æ³•newProxyInstanceè¿”å›ä¸€ä¸ªæ¥å£çš„ä»£ç†å®ä¾‹ã€‚é’ˆå¯¹ä¸åŒçš„ä»£ç†ç±»ï¼Œä¼ å…¥ç›¸åº”çš„ä»£ç†ç¨‹åºæ§åˆ¶å™¨InvocationHandlerã€‚</p><ol start="5"><li>å¦‚æœå†æƒ³åŠ å…¥ä¸€ä¸ªä»£ç†å¯¹è±¡ ä¹Ÿæ˜¯ç›¸åŒçš„å†™æ³•ï¼Œè€Œä¸”å¯ä»¥ä½¿ç”¨åŒ¿åå†…éƒ¨ç±»</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">SaleTicket saleTicketByProxy2 = (SaleTicket) Proxy.newProxyInstance(</span><br><span class="line">        saleBy12306.getClass().getClassLoader(),</span><br><span class="line">        saleBy12306.getClass().getInterfaces(),</span><br><span class="line">        new InvocationHandler()&#123;</span><br><span class="line">            public Object invoke(Object proxy, Method method, Object[] args) throws Throwable &#123;</span><br><span class="line">                return method.invoke(saleBy12306,args);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">);</span><br><span class="line">saleTicketByProxy2.sale(200);</span><br></pre></td></tr></table></figure><p><strong>åŠ¨æ€ä»£ç†åº•å±‚å®ç°:</strong></p><ol><li>é€šè¿‡å®ç° InvocationHandler æ¥å£åˆ›å»ºè‡ªå·±çš„è°ƒç”¨å¤„ç†å™¨ï¼›</li><li>é€šè¿‡ä¸º Proxy ç±»æŒ‡å®š ClassLoader å¯¹è±¡å’Œä¸€ç»„ interface æ¥åˆ›å»ºåŠ¨æ€ä»£ç†ç±»ï¼›</li><li>é€šè¿‡åå°„æœºåˆ¶è·å¾—åŠ¨æ€ä»£ç†ç±»çš„æ„é€ å‡½æ•°ï¼Œå…¶å”¯ä¸€å‚æ•°ç±»å‹æ˜¯è°ƒç”¨å¤„ç†å™¨æ¥å£ç±»å‹ï¼›</li><li>é€šè¿‡æ„é€ å‡½æ•°åˆ›å»ºåŠ¨æ€ä»£ç†ç±»å®ä¾‹ï¼Œæ„é€ æ—¶è°ƒç”¨å¤„ç†å™¨å¯¹è±¡ä½œä¸ºå‚æ•°è¢«ä¼ å…¥ã€‚</li></ol><p><strong>æ€»ç»“ï¼š</strong> JDK åŠ¨æ€ä»£ç†æœ‰ä¸€ä¸ªæœ€è‡´å‘½çš„é—®é¢˜æ˜¯å…¶åªèƒ½ä»£ç†å®ç°äº†æ¥å£çš„ç±»ã€‚<br>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ CGLIB åŠ¨æ€ä»£ç†æœºåˆ¶æ¥é¿å…ã€‚</p><h3 id="3-CGLIBåŠ¨æ€ä»£ç†"><a href="#3-CGLIBåŠ¨æ€ä»£ç†" class="headerlink" title="3.CGLIBåŠ¨æ€ä»£ç†"></a>3.CGLIBåŠ¨æ€ä»£ç†</h3><blockquote><p>CGLIB(Code Generation Library)æ˜¯ä¸€ä¸ªåŸºäºASMçš„å­—èŠ‚ç ç”Ÿæˆåº“ï¼Œå®ƒå…è®¸æˆ‘ä»¬åœ¨è¿è¡Œæ—¶å¯¹å­—èŠ‚ç è¿›è¡Œä¿®æ”¹å’ŒåŠ¨æ€ç”Ÿæˆã€‚CGLIB é€šè¿‡ç»§æ‰¿æ–¹å¼å®ç°ä»£ç†ã€‚å¾ˆå¤šçŸ¥åçš„å¼€æºæ¡†æ¶éƒ½ä½¿ç”¨åˆ°äº†CGLIBï¼Œ ä¾‹å¦‚ Spring ä¸­çš„ AOP æ¨¡å—ä¸­ï¼šå¦‚æœç›®æ ‡å¯¹è±¡å®ç°äº†æ¥å£ï¼Œåˆ™é»˜è®¤é‡‡ç”¨ JDK åŠ¨æ€ä»£ç†ï¼Œå¦åˆ™é‡‡ç”¨ CGLIB åŠ¨æ€ä»£ç†ã€‚</p></blockquote><h4 id="1-CGLIBä»£ç†æœºåˆ¶"><a href="#1-CGLIBä»£ç†æœºåˆ¶" class="headerlink" title="1.CGLIBä»£ç†æœºåˆ¶"></a>1.CGLIBä»£ç†æœºåˆ¶</h4><h5 id="åœ¨-CGLIB-åŠ¨æ€ä»£ç†æœºåˆ¶ä¸­-MethodInterceptor-æ¥å£å’Œ-Enhancer-ç±»æ˜¯æ ¸å¿ƒã€‚"><a href="#åœ¨-CGLIB-åŠ¨æ€ä»£ç†æœºåˆ¶ä¸­-MethodInterceptor-æ¥å£å’Œ-Enhancer-ç±»æ˜¯æ ¸å¿ƒã€‚" class="headerlink" title="åœ¨ CGLIB åŠ¨æ€ä»£ç†æœºåˆ¶ä¸­ MethodInterceptor æ¥å£å’Œ Enhancer ç±»æ˜¯æ ¸å¿ƒã€‚"></a>åœ¨ CGLIB åŠ¨æ€ä»£ç†æœºåˆ¶ä¸­ <code>MethodInterceptor</code> æ¥å£å’Œ <code>Enhancer</code> ç±»æ˜¯æ ¸å¿ƒã€‚</h5><h5 id="ä½ éœ€è¦è‡ªå®šä¹‰-MethodInterceptor-å¹¶é‡å†™-intercept-æ–¹æ³•ï¼Œintercept-ç”¨äºæ‹¦æˆªå¢å¼ºè¢«ä»£ç†ç±»çš„æ–¹æ³•ã€‚"><a href="#ä½ éœ€è¦è‡ªå®šä¹‰-MethodInterceptor-å¹¶é‡å†™-intercept-æ–¹æ³•ï¼Œintercept-ç”¨äºæ‹¦æˆªå¢å¼ºè¢«ä»£ç†ç±»çš„æ–¹æ³•ã€‚" class="headerlink" title="ä½ éœ€è¦è‡ªå®šä¹‰ MethodInterceptor å¹¶é‡å†™ intercept æ–¹æ³•ï¼Œintercept ç”¨äºæ‹¦æˆªå¢å¼ºè¢«ä»£ç†ç±»çš„æ–¹æ³•ã€‚"></a>ä½ éœ€è¦è‡ªå®šä¹‰ <code>MethodInterceptor</code> å¹¶é‡å†™ <code>intercept</code> æ–¹æ³•ï¼Œ<code>intercept</code> ç”¨äºæ‹¦æˆªå¢å¼ºè¢«ä»£ç†ç±»çš„æ–¹æ³•ã€‚</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public interface MethodInterceptor</span><br><span class="line">extends Callback&#123;</span><br><span class="line">    // æ‹¦æˆªè¢«ä»£ç†ç±»ä¸­çš„æ–¹æ³•</span><br><span class="line">    public Object intercept(</span><br><span class="line">        Object obj,</span><br><span class="line">        java.lang.reflect.Method method,</span><br><span class="line">        Object[] args,</span><br><span class="line">        MethodProxy proxy</span><br><span class="line">        ) throws Throwable;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>obj :è¢«ä»£ç†çš„å¯¹è±¡ï¼ˆéœ€è¦å¢å¼ºçš„å¯¹è±¡ï¼‰</li><li>method :è¢«æ‹¦æˆªçš„æ–¹æ³•ï¼ˆéœ€è¦å¢å¼ºçš„æ–¹æ³•ï¼‰</li><li>args :æ–¹æ³•å…¥å‚</li><li>methodProxy :ç”¨äºè°ƒç”¨åŸå§‹æ–¹æ³•</li></ul><p>ä½ å¯ä»¥é€šè¿‡ <code>Enhancer</code>ç±»æ¥åŠ¨æ€è·å–è¢«ä»£ç†ç±»ï¼Œå½“ä»£ç†ç±»è°ƒç”¨æ–¹æ³•çš„æ—¶å€™ï¼Œå®é™…è°ƒç”¨çš„æ˜¯ <code>MethodInterceptor</code> ä¸­çš„ <code>intercept</code> æ–¹æ³•ã€‚</p><h4 id="2-CGLIBä»£ç†ç±»ä½¿ç”¨æµç¨‹"><a href="#2-CGLIBä»£ç†ç±»ä½¿ç”¨æµç¨‹" class="headerlink" title="2.CGLIBä»£ç†ç±»ä½¿ç”¨æµç¨‹"></a>2.CGLIBä»£ç†ç±»ä½¿ç”¨æµç¨‹</h4><ol><li>å®šä¹‰ä¸€ä¸ªç±»ï¼›</li><li>è‡ªå®šä¹‰ <code>MethodInterceptor</code> å¹¶é‡å†™ <code>intercept</code> æ–¹æ³•ï¼Œ<code>intercept</code> ç”¨äºæ‹¦æˆªå¢å¼ºè¢«ä»£ç†ç±»çš„æ–¹æ³•ï¼Œå’Œ JDK åŠ¨æ€ä»£ç†ä¸­çš„ <code>invoke</code> æ–¹æ³•ç±»ä¼¼</li><li>é€šè¿‡ <code>Enhancer</code> ç±»çš„ <code>create()</code>åˆ›å»ºä»£ç†ç±»ï¼›</li></ol><p>Mavenä¾èµ–</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;cglib&lt;/groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;cglib&lt;/artifactId&gt;</span><br><span class="line">  &lt;version&gt;3.3.0&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><p>1.è¢«ä»£ç†ç±»</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public class SaleBy12306 &#123;</span><br><span class="line">    public void sale(int money) &#123;</span><br><span class="line">        if(money &gt; 100)&#123;</span><br><span class="line">            System.out.println(&quot;è´­ç¥¨æˆåŠŸï¼&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        else &#123;</span><br><span class="line">            System.out.println(&quot;è´­ç¥¨å¤±è´¥ï¼&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2.è‡ªå®šä¹‰ <code>MethodInterceptor</code>ï¼ˆæ–¹æ³•æ‹¦æˆªå™¨ï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public class SaleTicketMethodIntercepter implements MethodInterceptor &#123;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @param o           è¢«ä»£ç†çš„å¯¹è±¡ï¼ˆéœ€è¦å¢å¼ºçš„å¯¹è±¡ï¼‰</span><br><span class="line">     * @param method      è¢«æ‹¦æˆªçš„æ–¹æ³•ï¼ˆéœ€è¦å¢å¼ºçš„æ–¹æ³•ï¼‰</span><br><span class="line">     * @param args        æ–¹æ³•å…¥å‚</span><br><span class="line">     * @param methodProxy ç”¨äºè°ƒç”¨åŸå§‹æ–¹æ³•</span><br><span class="line">     */</span><br><span class="line">    public Object intercept(Object o, Method method, Object[] args, MethodProxy methodProxy) throws Throwable &#123;</span><br><span class="line">        //è°ƒç”¨æ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ è‡ªå·±çš„æ“ä½œ</span><br><span class="line">        System.out.println(&quot;before method &quot; + method.getName());</span><br><span class="line">        Object object = methodProxy.invokeSuper(o, args);</span><br><span class="line">        //è°ƒç”¨æ–¹æ³•ä¹‹åï¼Œæˆ‘ä»¬åŒæ ·å¯ä»¥æ·»åŠ è‡ªå·±çš„æ“ä½œ</span><br><span class="line">        System.out.println(&quot;after method &quot; + method.getName());</span><br><span class="line">        return object;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3.è·å–ä»£ç†ç±»</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">public class CglibProxyFactory &#123;</span><br><span class="line"></span><br><span class="line">    public static Object getProxy(Class&lt;?&gt; clazz) &#123;</span><br><span class="line">        // åˆ›å»ºåŠ¨æ€ä»£ç†å¢å¼ºç±»</span><br><span class="line">        Enhancer enhancer = new Enhancer();</span><br><span class="line">        // è®¾ç½®ç±»åŠ è½½å™¨</span><br><span class="line">        enhancer.setClassLoader(clazz.getClassLoader());</span><br><span class="line">        // è®¾ç½®è¢«ä»£ç†ç±»</span><br><span class="line">        enhancer.setSuperclass(clazz);</span><br><span class="line">        // è®¾ç½®æ–¹æ³•æ‹¦æˆªå™¨</span><br><span class="line">        enhancer.setCallback(new SaleTicketMethodIntercepter());</span><br><span class="line">        // åˆ›å»ºä»£ç†ç±»</span><br><span class="line">        return enhancer.create();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4.å®é™…ä½¿ç”¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public class Client &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        SaleBy12306 saleBy12306 = (SaleBy12306) CglibProxyFactory.getProxy(SaleBy12306.class);</span><br><span class="line">        saleBy12306.sale(200);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h3><h4 id="1-JDK-åŠ¨æ€ä»£ç†å’Œ-CGLIB-åŠ¨æ€ä»£ç†å¯¹æ¯”"><a href="#1-JDK-åŠ¨æ€ä»£ç†å’Œ-CGLIB-åŠ¨æ€ä»£ç†å¯¹æ¯”" class="headerlink" title="1.JDK åŠ¨æ€ä»£ç†å’Œ CGLIB åŠ¨æ€ä»£ç†å¯¹æ¯”"></a>1.JDK åŠ¨æ€ä»£ç†å’Œ CGLIB åŠ¨æ€ä»£ç†å¯¹æ¯”</h4><ul><li>JDK åŠ¨æ€ä»£ç†åªèƒ½åªèƒ½ä»£ç†å®ç°äº†æ¥å£çš„ç±»ï¼Œè€Œ CGLIB å¯ä»¥ä»£ç†æœªå®ç°ä»»ä½•æ¥å£çš„ç±»ã€‚  </li><li>å¦å¤–ï¼Œ CGLIB åŠ¨æ€ä»£ç†æ˜¯é€šè¿‡ç”Ÿæˆä¸€ä¸ªè¢«ä»£ç†ç±»çš„å­ç±»æ¥æ‹¦æˆªè¢«ä»£ç†ç±»çš„æ–¹æ³•è°ƒç”¨ï¼Œå› æ­¤ä¸èƒ½ä»£ç†å£°æ˜ä¸º final ç±»å‹çš„ç±»å’Œæ–¹æ³•ã€‚</li><li>å°±äºŒè€…çš„æ•ˆç‡æ¥è¯´ï¼Œå¤§éƒ¨åˆ†æƒ…å†µéƒ½æ˜¯ JDK åŠ¨æ€ä»£ç†æ›´ä¼˜ç§€ï¼Œéšç€ JDK ç‰ˆæœ¬çš„å‡çº§ï¼Œè¿™ä¸ªä¼˜åŠ¿æ›´åŠ æ˜æ˜¾ã€‚</li></ul><h4 id="2-é™æ€ä»£ç†å’ŒåŠ¨æ€ä»£ç†çš„å¯¹æ¯”"><a href="#2-é™æ€ä»£ç†å’ŒåŠ¨æ€ä»£ç†çš„å¯¹æ¯”" class="headerlink" title="2. é™æ€ä»£ç†å’ŒåŠ¨æ€ä»£ç†çš„å¯¹æ¯”"></a>2. é™æ€ä»£ç†å’ŒåŠ¨æ€ä»£ç†çš„å¯¹æ¯”</h4><ul><li>çµæ´»æ€§ ï¼šåŠ¨æ€ä»£ç†æ›´åŠ çµæ´»ï¼Œä¸éœ€è¦å¿…é¡»å®ç°æ¥å£ï¼Œå¯ä»¥ç›´æ¥ä»£ç†å®ç°ç±»ï¼Œå¹¶ä¸”å¯ä»¥ä¸éœ€è¦é’ˆå¯¹æ¯ä¸ªç›®æ ‡ç±»éƒ½åˆ›å»ºä¸€ä¸ªä»£ç†ç±»ã€‚å¦å¤–ï¼Œé™æ€ä»£ç†ä¸­ï¼Œæ¥å£ä¸€æ—¦æ–°å¢åŠ æ–¹æ³•ï¼Œç›®æ ‡å¯¹è±¡å’Œä»£ç†å¯¹è±¡éƒ½è¦è¿›è¡Œä¿®æ”¹ï¼Œè¿™æ˜¯éå¸¸éº»çƒ¦çš„ï¼</li><li>JVM å±‚é¢ ï¼šé™æ€ä»£ç†åœ¨ç¼–è¯‘æ—¶å°±å°†æ¥å£ã€å®ç°ç±»ã€ä»£ç†ç±»è¿™äº›éƒ½å˜æˆäº†ä¸€ä¸ªä¸ªå®é™…çš„ class æ–‡ä»¶ã€‚è€ŒåŠ¨æ€ä»£ç†æ˜¯åœ¨è¿è¡Œæ—¶åŠ¨æ€ç”Ÿæˆç±»å­—èŠ‚ç ï¼Œå¹¶åŠ è½½åˆ° JVM ä¸­çš„ã€‚</li></ul><p>å‚è€ƒèµ„æ–™ï¼š</p><p><a href="https://snailclimb.gitee.io/javaguide/#/docs/java/basic/java-proxy?id=_4-%e9%9d%99%e6%80%81%e4%bb%a3%e7%90%86%e5%92%8c%e5%8a%a8%e6%80%81%e4%bb%a3%e7%90%86%e7%9a%84%e5%af%b9%e6%af%94" target="_blank" rel="noopener">JavaGuide</a><br><a href="https://www.jianshu.com/p/9bcac608c714" target="_blank" rel="noopener">ç®€ä¹¦-javaåŠ¨æ€ä»£ç†</a></p>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä»£ç†æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Jvmåº•å±‚åŸç†æ€»ç»“</title>
      <link href="/2020/08/23/Jvm%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86%E6%80%BB%E7%BB%93/"/>
      <url>/2020/08/23/Jvm%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<h1 id="Java-è™šæ‹Ÿæœºåº•å±‚åŸç†çŸ¥è¯†æ€»ç»“"><a href="#Java-è™šæ‹Ÿæœºåº•å±‚åŸç†çŸ¥è¯†æ€»ç»“" class="headerlink" title="Java è™šæ‹Ÿæœºåº•å±‚åŸç†çŸ¥è¯†æ€»ç»“"></a>Java è™šæ‹Ÿæœºåº•å±‚åŸç†çŸ¥è¯†æ€»ç»“</h1><h2 id="æ¸…å•"><a href="#æ¸…å•" class="headerlink" title="æ¸…å•"></a>æ¸…å•</h2><ul><li><a href="https://github.com/doocs/jvm/blob/master/docs/01-jvm-memory-structure.md" target="_blank" rel="noopener">JVM å†…å­˜ç»“æ„</a></li><li><a href="https://github.com/doocs/jvm/blob/master/docs/02-hotspot-jvm-object.md" target="_blank" rel="noopener">HotSpot è™šæ‹Ÿæœºå¯¹è±¡æ¢ç§˜</a></li><li><a href="https://github.com/doocs/jvm/blob/master/docs/03-gc-algorithms.md" target="_blank" rel="noopener">åƒåœ¾æ”¶é›†ç­–ç•¥ä¸ç®—æ³•</a></li><li><a href="https://github.com/doocs/jvm/blob/master/docs/04-hotspot-gc.md" target="_blank" rel="noopener">HotSpot åƒåœ¾æ”¶é›†å™¨</a></li><li><a href="https://github.com/doocs/jvm/blob/master/docs/05-memory-allocation-gc.md" target="_blank" rel="noopener">å†…å­˜åˆ†é…ä¸å›æ”¶ç­–ç•¥</a></li><li><a href="https://github.com/doocs/jvm/blob/master/docs/06-jvm-performance-tuning.md" target="_blank" rel="noopener">JVM æ€§èƒ½è°ƒä¼˜</a></li><li><a href="https://github.com/doocs/jvm/blob/master/docs/07-class-structure.md" target="_blank" rel="noopener">ç±»æ–‡ä»¶ç»“æ„</a></li><li><a href="https://github.com/doocs/jvm/blob/master/docs/08-load-class-time.md" target="_blank" rel="noopener">ç±»åŠ è½½çš„æ—¶æœº</a></li><li><a href="https://github.com/doocs/jvm/blob/master/docs/09-load-class-process.md" target="_blank" rel="noopener">ç±»åŠ è½½çš„è¿‡ç¨‹</a></li><li><a href="https://github.com/doocs/jvm/blob/master/docs/10-class-loader.md" target="_blank" rel="noopener">ç±»åŠ è½½å™¨</a></li></ul><hr><p><a href="https://github.com/doocs/jvm" target="_blank" rel="noopener">java è™šæ‹Ÿæœºåº•å±‚åŸç†çŸ¥è¯†æ€»ç»“</a></p><p><a href="https://zhuanlan.zhihu.com/p/34426768" target="_blank" rel="noopener">çº¯æ´çš„å¾®ç¬‘jvm</a></p>]]></content>
      
      
      <categories>
          
          <category> javaåŸºç¡€è¯­æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> jvm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº¿æ®µæ ‘</title>
      <link href="/2020/08/21/%E7%BA%BF%E6%AE%B5%E6%A0%91%E6%A8%A1%E6%9D%BF/"/>
      <url>/2020/08/21/%E7%BA%BF%E6%AE%B5%E6%A0%91%E6%A8%A1%E6%9D%BF/</url>
      
        <content type="html"><![CDATA[<h2 id="çº¿æ®µæ ‘"><a href="#çº¿æ®µæ ‘" class="headerlink" title="çº¿æ®µæ ‘"></a>çº¿æ®µæ ‘</h2><blockquote><p>çº¿æ®µæ ‘æ˜¯ç®—æ³•ç«èµ›ä¸­å¸¸ç”¨çš„ç”¨æ¥ç»´æŠ¤ <strong>åŒºé—´ä¿¡æ¯</strong> çš„æ•°æ®ç»“æ„ã€‚</p></blockquote><blockquote><p>çº¿æ®µæ ‘å¯ä»¥åœ¨ çš„æ—¶é—´å¤æ‚åº¦å†…å®ç°<strong>å•ç‚¹ä¿®æ”¹</strong>ã€<strong>åŒºé—´ä¿®æ”¹</strong>ã€<strong>åŒºé—´æŸ¥è¯¢</strong>ï¼ˆåŒºé—´æ±‚å’Œï¼Œæ±‚åŒºé—´æœ€å¤§å€¼ï¼Œæ±‚åŒºé—´æœ€å°å€¼ï¼‰ç­‰æ“ä½œã€‚</p></blockquote><blockquote><p>çº¿æ®µæ ‘ç»´æŠ¤çš„ä¿¡æ¯ï¼Œéœ€è¦æ»¡è¶³å¯åŠ æ€§ï¼Œå³èƒ½ä»¥å¯ä»¥æ¥å—çš„é€Ÿåº¦åˆå¹¶ä¿¡æ¯å’Œä¿®æ”¹ä¿¡æ¯ï¼ŒåŒ…æ‹¬åœ¨ä½¿ç”¨æ‡’æƒ°æ ‡è®°æ—¶ï¼Œæ ‡è®°ä¹Ÿè¦æ»¡è¶³å¯åŠ æ€§ï¼ˆä¾‹å¦‚å–æ¨¡å°±ä¸æ»¡è¶³å¯åŠ æ€§ï¼Œå¯¹ å–æ¨¡ç„¶åå¯¹ å–æ¨¡ï¼Œä¸¤ä¸ªæ“ä½œå°±ä¸èƒ½åˆå¹¶åœ¨ä¸€èµ·åšï¼‰ã€‚</p></blockquote><h3 id="1-åŒºé—´æ±‚å’Œçš„çº¿æ®µæ ‘"><a href="#1-åŒºé—´æ±‚å’Œçš„çº¿æ®µæ ‘" class="headerlink" title="1.åŒºé—´æ±‚å’Œçš„çº¿æ®µæ ‘"></a>1.åŒºé—´æ±‚å’Œçš„çº¿æ®µæ ‘</h3><blockquote><p>è‹¥åªéœ€è¦æ±‚åŒºé—´å’Œï¼Œè€Œä¸éœ€è¦æ”¹å˜åŒºé—´å€¼ â€“&gt; ä½¿ç”¨å‰ç¼€å’Œ</p><p>è‹¥åœ¨æ±‚åŒºé—´å’Œçš„åŸºç¡€ä¸Šï¼Œè¿˜è¦ä¿®æ”¹åŒºé—´æ•°ç»„çš„å€¼ï¼Œä¸ºäº†æ›´å¿«çš„ç»´æŠ¤ä¸€ä¸ªå‰ç¼€å’Œæ•°ç»„ â€”&gt; çº¿æ®µæ ‘</p><p>çº¿æ®µæ ‘å®é™…å°±æ˜¯åœ¨å‰ç¼€å’Œçš„åŸºç¡€ä¸Šä½¿ç”¨äºŒåˆ†æ„å»ºäºŒå‰æœç´¢æ ‘ï¼Œæé«˜ä¿®æ”¹åŒºé—´å€¼çš„æ—¶é—´</p><p>çº¿æ®µæ ‘ä¸€èˆ¬æ”¯æŒä¸‰ä¸ªåŸºæœ¬æ“ä½œï¼šæ„å»ºæ ‘ï¼Œä¿®æ”¹æŸå…ƒç´ çš„å€¼ï¼ŒæŸ¥è¯¢åŒºé—´å’Œ</p></blockquote><p>å¦‚å›¾ï¼šåŸæ•°ç»„å’Œå®ƒå¯¹åº”çš„çº¿æ®µæ ‘</p><img style="zoom:70%" data-src="https://i.loli.net/2020/08/21/Y9XGImNind54BvA.png" class="lazyload"><p>ä¿®æ”¹ä¸‹æ ‡ä¸º4çš„å…ƒç´ ä¸º6åçš„çº¿æ®µæ ‘ï¼š</p><img style="zoom:70%" data-src="https://i.loli.net/2020/08/21/wRps6XunvfmyBQP.png" class="lazyload"><p>ä¸€ä¸ªåŒºé—´æ±‚å’Œçº¿æ®µæ ‘çš„JavaåŸºæœ¬æ¨¡æ¿ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SegmentTree</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] data;   <span class="comment">// åŸå§‹æ•°æ®</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] tree;   <span class="comment">// çº¿æ®µæ ‘</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SegmentTree</span><span class="params">(<span class="keyword">int</span>[] data)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.data = data;</span><br><span class="line">        tree = <span class="keyword">new</span> <span class="keyword">int</span>[data.length*<span class="number">4</span>];     <span class="comment">// çº¿æ®µæ ‘ä¸ºåŸå§‹æ•°æ®4å€</span></span><br><span class="line">        buildTree(<span class="number">0</span>,<span class="number">0</span>,data.length-<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ„å»ºæ ‘</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">buildTree</span><span class="params">(<span class="keyword">int</span> treeIndex, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(l == r)&#123;</span><br><span class="line">            tree[treeIndex] = data[l];</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> leftTreeIndex = <span class="number">2</span> * treeIndex + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> rightTreeIndex = <span class="number">2</span> * treeIndex + <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">int</span> mid = (l+r)/<span class="number">2</span>;</span><br><span class="line">        buildTree(leftTreeIndex, l, mid); <span class="comment">//å…ˆæ„å»ºä¸¤æ£µå­æ ‘</span></span><br><span class="line">        buildTree(rightTreeIndex, mid + <span class="number">1</span>, r);</span><br><span class="line">        tree[treeIndex] = tree[leftTreeIndex] + tree[rightTreeIndex];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ›´æ–°ä¸‹æ ‡ä¸ºindexçš„å€¼ä¸ºval</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> treeIndex, <span class="keyword">int</span> l, <span class="keyword">int</span> r,<span class="keyword">int</span> index,<span class="keyword">int</span> val)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(l == r)&#123;</span><br><span class="line">            data[index] = val;</span><br><span class="line">            tree[treeIndex] = val;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> mid = (l+r)/<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">int</span> leftTreeIndex = <span class="number">2</span> * treeIndex + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> rightTreeIndex = <span class="number">2</span> * treeIndex + <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span>(index &gt;= l &amp;&amp; index &lt;= mid)&#123;</span><br><span class="line">            update(leftTreeIndex, l, mid,index,val);</span><br><span class="line">        &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">            update(rightTreeIndex, mid+<span class="number">1</span>, r,index,val);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è‡ªåº•å¾€ä¸Šæ›´æ–°çº¿æ®µæ ‘</span></span><br><span class="line">        tree[treeIndex] = tree[leftTreeIndex] + tree[rightTreeIndex];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŸ¥è¯¢ L-R åŒºåŸŸçš„å€¼çš„å’Œ</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> treeIndex, <span class="keyword">int</span> l, <span class="keyword">int</span> r,<span class="keyword">int</span> queryL,<span class="keyword">int</span> queryR)</span></span>&#123;</span><br><span class="line">        System.out.println(l + <span class="string">" "</span> + r);</span><br><span class="line">        <span class="keyword">if</span>(queryR &lt; l || queryL &gt; r) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(queryL &lt;= l &amp;&amp; r &lt;= queryR) <span class="keyword">return</span> tree[treeIndex];</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">int</span> mid = l + (r - l) / <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">int</span> leftTreeIndex = <span class="number">2</span> * treeIndex + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">int</span> rightTreeIndex = <span class="number">2</span> * treeIndex + <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">int</span> sum_left =  query(leftTreeIndex, l, mid, queryL, queryR);</span><br><span class="line">            <span class="keyword">int</span> sum_right = query(rightTreeIndex, mid + <span class="number">1</span>, r, queryL, queryR);</span><br><span class="line">            <span class="keyword">return</span> sum_left + sum_right;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è‹¥è¦ä½¿ç”¨æ›´å¤æ‚çš„æ•°æ®ç»“æ„å’Œè¿ç®—è§„åˆ™ï¼Œä¿®æ”¹ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">int</span>[] data;   <span class="comment">// åŸå§‹æ•°æ®</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span>[] tree;   <span class="comment">// çº¿æ®µæ ‘</span></span><br><span class="line">å’Œ</span><br><span class="line"> tree[treeIndex] = tree[leftTreeIndex] + tree[rightTreeIndex];<span class="comment">// æ­¤å¤„åœ¨è¿›è¡ŒåŒºé—´æ±‚å’Œ</span></span><br></pre></td></tr></table></figure><p>å‚è€ƒèµ„æ–™ï¼š<br><a href="https://www.bilibili.com/video/BV1cb411t7AM?from=search&seid=6594271608262607100" target="_blank" rel="noopener">ç¯ç¬¼å¤§ç¥è®²çº¿æ®µæ ‘</a></p><p><a href="https://oi-wiki.org/ds/seg/" target="_blank" rel="noopener">çº¿æ®µæ ‘ç™¾ç§‘</a></p>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> çº¿æ®µæ ‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>javaåå°„æœºåˆ¶</title>
      <link href="/2020/08/19/java%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6/"/>
      <url>/2020/08/19/java%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6/</url>
      
        <content type="html"><![CDATA[<h1 id="javaåå°„æœºåˆ¶"><a href="#javaåå°„æœºåˆ¶" class="headerlink" title="javaåå°„æœºåˆ¶"></a>javaåå°„æœºåˆ¶</h1><blockquote><p><strong>åå°„å°±æ˜¯åœ¨è¿è¡Œæ—¶æ‰çŸ¥é“è¦æ“ä½œçš„ç±»æ˜¯ä»€ä¹ˆï¼Œå¹¶ä¸”å¯ä»¥åœ¨è¿è¡Œæ—¶è·å–ç±»çš„å®Œæ•´æ„é€ ï¼Œå¹¶è°ƒç”¨å¯¹åº”çš„æ–¹æ³•ã€‚</strong></p></blockquote><p><img alt="jvm" data-src="https://pic2.zhimg.com/80/v2-4face8109e0d52ef5894c41c69e4ec6b_720w.jpg?source=1940ef5c" class="lazyload"></p><h4 id="é€šä¿—ç†è§£ï¼š"><a href="#é€šä¿—ç†è§£ï¼š" class="headerlink" title="é€šä¿—ç†è§£ï¼š"></a>é€šä¿—ç†è§£ï¼š</h4><p>å½“æˆ‘ä»¬çš„ç¨‹åºåœ¨è¿è¡Œæ—¶ï¼Œéœ€è¦åŠ¨æ€çš„åŠ è½½ä¸€äº›ç±»è¿™äº›ç±»å¯èƒ½ä¹‹å‰ç”¨ä¸åˆ°æ‰€ä»¥ä¸ç”¨åŠ è½½åˆ°<code>jvm</code>ï¼Œè€Œæ˜¯åœ¨è¿è¡Œæ—¶æ ¹æ®éœ€è¦æ‰åŠ è½½ã€‚ä¾‹å¦‚ï¼šå¤§å®¶å¦‚æœæ¥è§¦è¿‡springï¼Œä¼šå‘ç°å½“ä½ é…ç½®å„ç§å„æ ·çš„beanæ—¶ï¼Œæ˜¯ä»¥é…ç½®æ–‡ä»¶çš„å½¢å¼é…ç½®çš„ï¼Œä½ éœ€è¦ç”¨åˆ°å“ªäº›beanå°±é…å“ªäº›ï¼Œspringå®¹å™¨å°±ä¼šæ ¹æ®ä½ çš„éœ€æ±‚å»åŠ¨æ€åŠ è½½ï¼Œä½ çš„ç¨‹åºå°±èƒ½å¥å£®åœ°è¿è¡Œã€‚</p><h2 id="åå°„æœºåˆ¶"><a href="#åå°„æœºåˆ¶" class="headerlink" title="åå°„æœºåˆ¶"></a>åå°„æœºåˆ¶</h2><blockquote><p>Reflection ä½¿ç”¨ JDK æä¾›çš„åå°„ API è¿›è¡Œåå°„è°ƒç”¨ç±»çš„ä¿¡æ¯</p></blockquote><ul><li>åå°„å°±æ˜¯åœ¨è¿è¡Œæ—¶æ‰çŸ¥é“è¦æ“ä½œçš„ç±»æ˜¯ä»€ä¹ˆï¼Œå¹¶ä¸”å¯ä»¥åœ¨è¿è¡Œæ—¶è·å–ç±»çš„å®Œæ•´æ„é€ ï¼Œå¹¶è°ƒç”¨å¯¹åº”çš„æ–¹æ³•ã€‚</li></ul><p><img alt="image" data-src="https://pics7.baidu.com/feed/8b13632762d0f703ecd825d4bde727382697c577.jpeg?token=12cc273c0cc8b6d4fbf23e5f99a8e14c&s=8070E532C533C0224E7518DB000080B2" class="lazyload"></p><h4 id="æ­£å¸¸ä½¿ç”¨ç±»"><a href="#æ­£å¸¸ä½¿ç”¨ç±»" class="headerlink" title="æ­£å¸¸ä½¿ç”¨ç±»"></a>æ­£å¸¸ä½¿ç”¨ç±»</h4><ol><li>å¼•å…¥åŒ…</li><li>newå®ä¾‹åŒ–</li><li>è·å–å®ä¾‹åŒ–å¯¹è±¡</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Apple apple = new Apple(); //ç›´æ¥åˆå§‹åŒ–ï¼Œã€Œæ­£å°„ã€</span><br><span class="line">apple.setPrice(4);</span><br></pre></td></tr></table></figure><h4 id="åå°„"><a href="#åå°„" class="headerlink" title="åå°„"></a>åå°„</h4><ol><li>ä¸€å¼€å§‹å¹¶ä¸çŸ¥é“åˆå§‹åŒ–çš„ç±»å¯¹è±¡æ˜¯ä»€ä¹ˆ</li><li>æ— æ³•ä½¿ç”¨ new å…³é”®å­—æ¥åˆ›å»ºå¯¹è±¡</li><li>ä½¿ç”¨ JDK æä¾›çš„åå°„ API è¿›è¡Œåå°„è°ƒç”¨</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Class clz = Class.forName(&quot;com.chenshuyi.reflect.Apple&quot;);</span><br><span class="line">Method method = clz.getMethod(&quot;setPrice&quot;, int.class);</span><br><span class="line">Constructor constructor = clz.getConstructor();</span><br><span class="line">Object object = constructor.newInstance();</span><br><span class="line">method.invoke(object, 4);</span><br></pre></td></tr></table></figure><ul><li>ä»è¿™ä¸ªç®€å•çš„ä¾‹å­å¯ä»¥çœ‹å‡ºï¼Œä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬ä½¿ç”¨åå°„è·å–ä¸€ä¸ªå¯¹è±¡çš„æ­¥éª¤ï¼š</li></ul><ol><li><p>è·å–ç±»çš„ Class å¯¹è±¡å®ä¾‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Class clz = Class.forName(&quot;com.zhenai.api.Apple&quot;);</span><br></pre></td></tr></table></figure></li><li><p>æ ¹æ® Class å¯¹è±¡å®ä¾‹è·å– Constructor å¯¹è±¡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Constructor appleConstructor = clz.getConstructor();</span><br></pre></td></tr></table></figure></li><li><p>ä½¿ç”¨ Constructor å¯¹è±¡çš„ newInstance æ–¹æ³•è·å–åå°„ç±»å¯¹è±¡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Object appleObj = appleConstructor.newInstance();</span><br></pre></td></tr></table></figure></li><li><p>è€Œå¦‚æœè¦è°ƒç”¨æŸä¸€ä¸ªæ–¹æ³•ï¼Œåˆ™éœ€è¦ç»è¿‡ä¸‹é¢çš„æ­¥éª¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">è·å–æ–¹æ³•çš„ Method å¯¹è±¡</span><br><span class="line">Method setPriceMethod = clz.getMethod(&quot;setPrice&quot;, int.class);</span><br><span class="line"></span><br><span class="line">åˆ©ç”¨ invoke æ–¹æ³•è°ƒç”¨æ–¹æ³•</span><br><span class="line">setPriceMethod.invoke(appleObj, 14);</span><br></pre></td></tr></table></figure></li></ol><h4 id="Classå¯¹è±¡çš„è·å–æ–¹æ³•"><a href="#Classå¯¹è±¡çš„è·å–æ–¹æ³•" class="headerlink" title="Classå¯¹è±¡çš„è·å–æ–¹æ³•"></a>Classå¯¹è±¡çš„è·å–æ–¹æ³•</h4><p>ç¬¬ä¸€ç§ï¼Œä½¿ç”¨ Class.forName é™æ€æ–¹æ³•ã€‚å½“ä½ çŸ¥é“è¯¥ç±»çš„å…¨è·¯å¾„åæ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨è¯¥æ–¹æ³•è·å– Class ç±»å¯¹è±¡ã€‚</p><p><code>Class clz = Class.forName(&quot;java.lang.String&quot;);</code></p><p>ç¬¬äºŒç§ï¼Œä½¿ç”¨ .class æ–¹æ³•ã€‚<br>è¿™ç§æ–¹æ³•åªé€‚åˆåœ¨ç¼–è¯‘å‰å°±çŸ¥é“æ“ä½œçš„ Classã€‚</p><p><code>Class clz = String.class;</code></p><p>ç¬¬ä¸‰ç§ï¼Œä½¿ç”¨ç±»å¯¹è±¡çš„ getClass() æ–¹æ³•ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">String str = new String(&quot;Hello&quot;);</span><br><span class="line">Class clz = str.getClass();</span><br></pre></td></tr></table></figure><h4 id="åå°„æœºåˆ¶æä¾›çš„åŠŸèƒ½ï¼š"><a href="#åå°„æœºåˆ¶æä¾›çš„åŠŸèƒ½ï¼š" class="headerlink" title="åå°„æœºåˆ¶æä¾›çš„åŠŸèƒ½ï¼š"></a>åå°„æœºåˆ¶æä¾›çš„åŠŸèƒ½ï¼š</h4><ol><li>åœ¨è¿è¡Œæ—¶åˆ¤æ–­ä»»æ„ä¸€ä¸ªå¯¹è±¡æ‰€å±çš„ç±»ï¼›</li><li>åœ¨è¿è¡Œæ—¶æ„é€ ä»»æ„ä¸€ä¸ªç±»çš„å¯¹è±¡ï¼›</li><li>åœ¨è¿è¡Œæ—¶åˆ¤æ–­ä»»æ„ä¸€ä¸ªç±»æ‰€å…·æœ‰çš„æˆå‘˜å˜é‡å’Œæ–¹æ³•ï¼›</li><li>åœ¨è¿è¡Œæ—¶è°ƒç”¨ä»»æ„ä¸€ä¸ªå¯¹è±¡çš„æˆå‘˜å˜é‡å’Œæ–¹æ³•ï¼›</li><li>ç”ŸæˆåŠ¨æ€ä»£ç†ã€‚</li></ol>]]></content>
      
      
      <categories>
          
          <category> javaåŸºç¡€è¯­æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åå°„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>javaå¹¶å‘ç¼–ç¨‹å°ç»“</title>
      <link href="/2020/08/18/java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E5%B0%8F%E7%BB%93/"/>
      <url>/2020/08/18/java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E5%B0%8F%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<hr><p>å‚è€ƒèµ„æ–™ï¼š<br><a href="http://concurrent.redspider.group/" target="_blank" rel="noopener">æ·±å…¥æµ…å‡ºJavaå¤šçº¿ç¨‹</a><br><a href="https://www.liaoxuefeng.com/wiki/1252599548343744/1255943750561472" target="_blank" rel="noopener">å»–é›ªå³°çš„å®˜ç½‘</a></p><h2 id="ä¸€ã€å¹¶å‘åŸºç¡€"><a href="#ä¸€ã€å¹¶å‘åŸºç¡€" class="headerlink" title="ä¸€ã€å¹¶å‘åŸºç¡€"></a>ä¸€ã€å¹¶å‘åŸºç¡€</h2><h3 id="1-çº¿ç¨‹ä¸è¿›ç¨‹"><a href="#1-çº¿ç¨‹ä¸è¿›ç¨‹" class="headerlink" title="1.çº¿ç¨‹ä¸è¿›ç¨‹"></a>1.çº¿ç¨‹ä¸è¿›ç¨‹</h3><p>è¿›ç¨‹ï¼šå•ç‹¬å æœ‰ä¸€å®šçš„å†…å­˜åœ°å€ç©ºé—´ï¼Œæ•°æ®éš”ç¦»ï¼Œæ•°æ®å…±äº«å¤æ‚ï¼ŒåŒæ­¥å¤æ‚ã€‚ç¨³å®šä½†èµ„æºå¼€é”€å¤§ã€‚</p><p>çº¿ç¨‹ï¼šå…±äº«è¿›ç¨‹çš„å†…å­˜èµ„æºï¼Œæ•°æ®å…±äº«ç®€å•ï¼ŒåŒæ­¥å¤æ‚ã€‚å¯é æ€§ä½ä½†èµ„æºå¼€é”€å°ã€‚</p><p>çº¿ç¨‹å¹¶éè¶Šå¤šè¶Šå¥½ï¼Œçº¿ç¨‹è¶Šå¤šï¼Œä¸Šä¸‹æ–‡åˆ‡æ¢è¶Šå¤šï¼Œæ¶ˆè€—å¤§é‡çš„CPUæ—¶é—´ã€‚</p><hr><h3 id="2-å¤šçº¿ç¨‹å…¥é—¨å’Œæ¥å£"><a href="#2-å¤šçº¿ç¨‹å…¥é—¨å’Œæ¥å£" class="headerlink" title="2.å¤šçº¿ç¨‹å…¥é—¨å’Œæ¥å£"></a>2.å¤šçº¿ç¨‹å…¥é—¨å’Œæ¥å£</h3><h4 id="1-Threadç±»"><a href="#1-Threadç±»" class="headerlink" title="1.Threadç±»"></a>1.Threadç±»</h4><ul><li>ç»§æ‰¿<code>Thread</code>ç±»ï¼Œå¹¶é‡å†™<code>run</code>æ–¹æ³•ï¼›</li></ul><h4 id="2-Runnableæ¥å£"><a href="#2-Runnableæ¥å£" class="headerlink" title="2.Runnableæ¥å£"></a>2.Runnableæ¥å£</h4><ul><li>å®ç°Runnableæ¥å£ï¼Œå¹¶é‡å†™<code>run</code>æ–¹æ³•ï¼›</li></ul><h4 id="3-Callableæ¥å£"><a href="#3-Callableæ¥å£" class="headerlink" title="3.Callableæ¥å£"></a>3.Callableæ¥å£</h4><ul><li>Callableä¸€èˆ¬æ˜¯é…åˆçº¿ç¨‹æ± å·¥å…·<code>ExecutorService</code>æ¥ä½¿ç”¨çš„ã€‚æœ‰è¿”å›å€¼</li></ul><h4 id="4-Futureæ¥å£"><a href="#4-Futureæ¥å£" class="headerlink" title="4.Futureæ¥å£"></a>4.Futureæ¥å£</h4><ul><li>æ‹¥æœ‰å–æ¶ˆï¼Œè·å–çº¿ç¨‹çŠ¶æ€çš„åŠŸèƒ½ã€‚æœ‰è¿”å›å€¼</li></ul><h4 id="5-FutureTaskç±»"><a href="#5-FutureTaskç±»" class="headerlink" title="5.FutureTaskç±»"></a>5.FutureTaskç±»</h4><ul><li>åŒæ—¶å®ç°Runnableå’ŒFutureæ¥å£ã€‚æœ‰è¿”å›å€¼</li></ul><hr><h3 id="3-çº¿ç¨‹ç»„å’Œçº¿ç¨‹ä¼˜å…ˆçº§"><a href="#3-çº¿ç¨‹ç»„å’Œçº¿ç¨‹ä¼˜å…ˆçº§" class="headerlink" title="3.çº¿ç¨‹ç»„å’Œçº¿ç¨‹ä¼˜å…ˆçº§"></a>3.çº¿ç¨‹ç»„å’Œçº¿ç¨‹ä¼˜å…ˆçº§</h3><h4 id="1-çº¿ç¨‹ç»„ï¼š"><a href="#1-çº¿ç¨‹ç»„ï¼š" class="headerlink" title="1.çº¿ç¨‹ç»„ï¼š"></a>1.çº¿ç¨‹ç»„ï¼š</h4><ul><li>ä½¿ç”¨çº¿ç¨‹ç»„å¯¹çº¿ç¨‹è¿›è¡Œæ‰¹é‡æ§åˆ¶ã€‚çº¿ç¨‹ç»„æ˜¯ä¸€ä¸ªæ ‡å‡†çš„<strong>å‘ä¸‹å¼•ç”¨</strong>çš„æ ‘çŠ¶ç»“æ„ã€‚</li></ul><h4 id="2-çº¿ç¨‹ä¼˜å…ˆçº§ï¼š"><a href="#2-çº¿ç¨‹ä¼˜å…ˆçº§ï¼š" class="headerlink" title="2.çº¿ç¨‹ä¼˜å…ˆçº§ï¼š"></a>2.çº¿ç¨‹ä¼˜å…ˆçº§ï¼š</h4><ul><li>Javaä¸­çº¿ç¨‹ä¼˜å…ˆçº§å¯ä»¥æŒ‡å®šï¼ŒèŒƒå›´æ˜¯<code>1~10</code>ã€‚</li><li>Javaé»˜è®¤çš„çº¿ç¨‹ä¼˜å…ˆçº§ä¸º5ï¼Œçº¿ç¨‹çš„æ‰§è¡Œé¡ºåºç”±è°ƒåº¦ç¨‹åºæ¥å†³å®šï¼Œçº¿ç¨‹çš„ä¼˜å…ˆçº§ä¼šåœ¨çº¿ç¨‹è¢«è°ƒç”¨ä¹‹å‰è®¾å®šã€‚</li><li>é«˜ä¼˜å…ˆçº§çš„çº¿ç¨‹å°†ä¼šæ¯”ä½ä¼˜å…ˆçº§çš„çº¿ç¨‹æœ‰<strong>æ›´é«˜çš„å‡ ç‡</strong>å¾—åˆ°æ‰§è¡Œã€‚</li><li>ä½¿ç”¨æ–¹æ³•<code>Thread</code>ç±»çš„<code>setPriority()</code>å®ä¾‹æ–¹æ³•æ¥è®¾å®šçº¿ç¨‹çš„ä¼˜å…ˆçº§ã€‚</li><li>æ€»ç»“ï¼šä¼˜å…ˆçº§ä½ è®¾ç½®äº†ï¼Œç†ä¸ç†ä½ å°±æ˜¯ç³»ç»Ÿè°ƒåº¦çš„äº‹æƒ…äº†ã€‚</li></ul><hr><h3 id="4-çº¿ç¨‹çŠ¶æ€åŠè½¬æ¢"><a href="#4-çº¿ç¨‹çŠ¶æ€åŠè½¬æ¢" class="headerlink" title="4.çº¿ç¨‹çŠ¶æ€åŠè½¬æ¢"></a>4.çº¿ç¨‹çŠ¶æ€åŠè½¬æ¢</h3><h4 id="1-æ“ä½œç³»ç»Ÿçº¿ç¨‹ä¸»è¦æœ‰ä»¥ä¸‹ä¸‰ä¸ªçŠ¶æ€ï¼š"><a href="#1-æ“ä½œç³»ç»Ÿçº¿ç¨‹ä¸»è¦æœ‰ä»¥ä¸‹ä¸‰ä¸ªçŠ¶æ€ï¼š" class="headerlink" title="1.æ“ä½œç³»ç»Ÿçº¿ç¨‹ä¸»è¦æœ‰ä»¥ä¸‹ä¸‰ä¸ªçŠ¶æ€ï¼š"></a>1.æ“ä½œç³»ç»Ÿçº¿ç¨‹ä¸»è¦æœ‰ä»¥ä¸‹ä¸‰ä¸ªçŠ¶æ€ï¼š</h4><ul><li>å°±ç»ªçŠ¶æ€(ready)ï¼šçº¿ç¨‹æ­£åœ¨ç­‰å¾…ä½¿ç”¨CPUï¼Œç»è°ƒåº¦ç¨‹åºè°ƒç”¨ä¹‹åå¯è¿›å…¥runningçŠ¶æ€ã€‚</li><li>æ‰§è¡ŒçŠ¶æ€(running)ï¼šçº¿ç¨‹æ­£åœ¨ä½¿ç”¨CPUã€‚</li><li>ç­‰å¾…çŠ¶æ€(waiting): çº¿ç¨‹ç»è¿‡ç­‰å¾…äº‹ä»¶çš„è°ƒç”¨æˆ–è€…æ­£åœ¨ç­‰å¾…å…¶ä»–èµ„æºï¼ˆå¦‚I/Oï¼‰ã€‚</li></ul><h4 id="2-Javaçº¿ç¨‹çš„6ä¸ªçŠ¶æ€"><a href="#2-Javaçº¿ç¨‹çš„6ä¸ªçŠ¶æ€" class="headerlink" title="2.Javaçº¿ç¨‹çš„6ä¸ªçŠ¶æ€"></a>2.Javaçº¿ç¨‹çš„6ä¸ªçŠ¶æ€</h4><ul><li><p>NEWï¼šæœªå¯åŠ¨çŠ¶æ€ã€‚è¿˜æ²¡è°ƒç”¨Threadå®ä¾‹çš„start()æ–¹æ³•ã€‚</p></li><li><p>RUNNABLEï¼šçº¿ç¨‹æ­£åœ¨è¿è¡Œä¸­ã€‚ï¼ˆæ­£åœ¨Javaè™šæ‹Ÿæœºä¸­è¿è¡Œ | ç­‰å¾…CPUåˆ†é…èµ„æºã€‚ï¼‰</p></li><li><p>BLOCKEDï¼šé˜»å¡çŠ¶æ€ã€‚å¤„äºé˜»å¡çŠ¶æ€çš„çº¿ç¨‹æ­£ç­‰å¾…é”çš„é‡Šæ”¾ä»¥è¿›å…¥åŒæ­¥åŒºã€‚</p></li><li><p>WAITINGï¼šç­‰å¾…çŠ¶æ€ã€‚å¤„äºç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹å˜æˆRUNNABLEçŠ¶æ€éœ€è¦å…¶ä»–çº¿ç¨‹å”¤é†’ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">è°ƒç”¨å¦‚ä¸‹<span class="number">3</span>ä¸ªæ–¹æ³•ä¼šä½¿çº¿ç¨‹è¿›å…¥ç­‰å¾…çŠ¶æ€ï¼š</span><br><span class="line">* Object.wait()ï¼šä½¿å½“å‰çº¿ç¨‹å¤„äºç­‰å¾…çŠ¶æ€ç›´åˆ°å¦ä¸€ä¸ªçº¿ç¨‹å”¤é†’å®ƒï¼›</span><br><span class="line">* Thread.join()ï¼šç­‰å¾…çº¿ç¨‹æ‰§è¡Œå®Œæ¯•ï¼Œåº•å±‚è°ƒç”¨çš„æ˜¯Objectå®ä¾‹çš„waitæ–¹æ³•ï¼›</span><br><span class="line">* LockSupport.park()ï¼šé™¤éè·å¾—è°ƒç”¨è®¸å¯ï¼Œå¦åˆ™ç¦ç”¨å½“å‰çº¿ç¨‹è¿›è¡Œçº¿ç¨‹è°ƒåº¦ã€‚</span><br><span class="line"></span><br><span class="line">è°ƒç”¨å¦‚ä¸‹<span class="number">2</span>ä¸ªæ–¹æ³•å”¤é†’çº¿ç¨‹ï¼š</span><br><span class="line">* notify()ï¼šå”¤é†’ä¸€ä¸ªç­‰å¾…çš„çº¿ç¨‹</span><br><span class="line">* notifyAll()ï¼šå”¤é†’æ‰€æœ‰ç­‰å¾…çš„çº¿ç¨‹</span><br></pre></td></tr></table></figure></li><li><p>TIMED_WAITINGï¼šè¶…æ—¶ç­‰å¾…çŠ¶æ€ã€‚çº¿ç¨‹ç­‰å¾…ä¸€ä¸ªå…·ä½“çš„æ—¶é—´ï¼Œæ—¶é—´åˆ°åä¼šè¢«è‡ªåŠ¨å”¤é†’ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">è°ƒç”¨å¦‚ä¸‹æ–¹æ³•ä¼šä½¿çº¿ç¨‹è¿›å…¥è¶…æ—¶ç­‰å¾…çŠ¶æ€ï¼š</span><br><span class="line"></span><br><span class="line">Thread.sleep(<span class="keyword">long</span> millis)ï¼šä½¿å½“å‰çº¿ç¨‹ç¡çœ æŒ‡å®šæ—¶é—´ï¼›</span><br><span class="line">Object.wait(<span class="keyword">long</span> timeout)ï¼šçº¿ç¨‹ä¼‘çœ æŒ‡å®šæ—¶é—´ï¼Œç­‰å¾…æœŸé—´å¯ä»¥é€šè¿‡notify()/notifyAll()å”¤é†’ï¼›</span><br><span class="line">Thread.join(<span class="keyword">long</span> millis)ï¼šç­‰å¾…å½“å‰çº¿ç¨‹æœ€å¤šæ‰§è¡Œmillisæ¯«ç§’ï¼Œå¦‚æœmillisä¸º<span class="number">0</span>ï¼Œåˆ™ä¼šä¸€ç›´æ‰§è¡Œï¼›</span><br><span class="line">LockSupport.parkNanos(<span class="keyword">long</span> nanos)ï¼š é™¤éè·å¾—è°ƒç”¨è®¸å¯ï¼Œå¦åˆ™ç¦ç”¨å½“å‰çº¿ç¨‹è¿›è¡Œçº¿ç¨‹è°ƒåº¦æŒ‡å®šæ—¶é—´ï¼›</span><br><span class="line">LockSupport.parkUntil(<span class="keyword">long</span> deadline)ï¼šåŒä¸Šï¼Œä¹Ÿæ˜¯ç¦æ­¢çº¿ç¨‹è¿›è¡Œè°ƒåº¦æŒ‡å®šæ—¶é—´ï¼›</span><br></pre></td></tr></table></figure></li><li><p>TERMINATEDï¼šç»ˆæ­¢çŠ¶æ€ã€‚æ­¤æ—¶çº¿ç¨‹å·²æ‰§è¡Œå®Œæ¯•ã€‚</p></li></ul><hr><h3 id="5-çº¿ç¨‹é—´é€šä¿¡"><a href="#5-çº¿ç¨‹é—´é€šä¿¡" class="headerlink" title="5.çº¿ç¨‹é—´é€šä¿¡"></a>5.çº¿ç¨‹é—´é€šä¿¡</h3><p>çº¿ç¨‹åŒæ­¥ï¼šçº¿ç¨‹ä¹‹é—´æŒ‰ç…§<strong>ä¸€å®šçš„é¡ºåº</strong>æ‰§è¡Œã€‚</p><ol><li>é”ä¸åŒæ­¥ï¼ˆå¯¹è±¡é”<code>synchronized</code>ï¼‰</li><li>ç­‰å¾…/é€šçŸ¥æœºåˆ¶ï¼ˆåœ¨<code>synchronized</code>åŸºç¡€ä¸Š+ wait()å’Œnotify() é€šçŸ¥å”¤é†’çº¿ç¨‹ï¼‰</li><li>ä¿¡å·é‡ ï¼ˆ<code>Semaphore</code>å¯¹è±¡æˆ–è€…<code>volatile</code>å…³é”®å­—ï¼‰</li><li>ç®¡é“ï¼ˆç®¡é“æ˜¯åŸºäºâ€œç®¡é“æµâ€çš„é€šä¿¡æ–¹å¼ã€‚JDKæä¾›äº†è®¸å¤šï¼‰</li><li>å…¶ä»–ä¿¡é“ç›¸å…³<ol><li><code>join()</code>çº¿ç¨‹ç¤¼è®©ï¼Œæ’é˜Ÿç­‰å¾…å…¶ä»–çº¿ç¨‹å®Œæˆã€‚</li><li><code>sleep()</code>çº¿ç¨‹ç¡çœ ï¼Œä¸é‡Šæ”¾é”ï¼Œï¼ˆwaité‡Šæ”¾ï¼‰</li><li><code>ThreadLocal</code>çº¿ç¨‹æœ¬åœ°å˜é‡ï¼Œå†…éƒ¨æ˜¯ä¸€ä¸ªå¼±å¼•ç”¨çš„<code>Map</code></li><li><code>InheritableThreadLocal</code>æ·»åŠ å­çº¿ç¨‹ç»§æ‰¿çˆ¶çº¿ç¨‹æœ¬åœ°å˜é‡</li></ol></li><li>JDKé€šè®¯å·¥å…·ç±»</li></ol><h2 id="äºŒã€å¹¶å‘åŸç†"><a href="#äºŒã€å¹¶å‘åŸç†" class="headerlink" title="äºŒã€å¹¶å‘åŸç†"></a>äºŒã€å¹¶å‘åŸç†</h2><h3 id="1-javaå†…å­˜æ¨¡å‹åŸºç¡€"><a href="#1-javaå†…å­˜æ¨¡å‹åŸºç¡€" class="headerlink" title="1.javaå†…å­˜æ¨¡å‹åŸºç¡€"></a>1.javaå†…å­˜æ¨¡å‹åŸºç¡€</h3><p><img alt="Javaå†…å­˜æ¨¡å‹" data-src="http://concurrent.redspider.group/article/02/imgs/Java%E8%BF%90%E8%A1%8C%E6%97%B6%E6%95%B0%E6%8D%AE%E5%8C%BA.png" class="lazyload"></p><p><img alt data-src="http://concurrent.redspider.group/article/02/imgs/JMM%E6%8A%BD%E8%B1%A1%E7%A4%BA%E6%84%8F%E5%9B%BE.jpg" class="lazyload"></p><h5 id="å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå„çº¿ç¨‹ä¹‹é—´å˜é‡çš„ä¸€è‡´æ€§é—®é¢˜"><a href="#å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå„çº¿ç¨‹ä¹‹é—´å˜é‡çš„ä¸€è‡´æ€§é—®é¢˜" class="headerlink" title="å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå„çº¿ç¨‹ä¹‹é—´å˜é‡çš„ä¸€è‡´æ€§é—®é¢˜"></a>å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå„çº¿ç¨‹ä¹‹é—´å˜é‡çš„ä¸€è‡´æ€§é—®é¢˜</h5><h3 id="2-é‡æ’åºä¸happens-before"><a href="#2-é‡æ’åºä¸happens-before" class="headerlink" title="2.é‡æ’åºä¸happens-before"></a>2.é‡æ’åºä¸happens-before</h3><ol><li>æŒ‡ä»¤é‡æ’</li></ol><blockquote><p>æŒ‡ä»¤é‡æ’å¯¹äºæé«˜CPUå¤„ç†æ€§èƒ½ååˆ†å¿…è¦ã€‚è™½ç„¶ç”±æ­¤å¸¦æ¥äº†ä¹±åºçš„é—®é¢˜ï¼Œä½†æ˜¯è¿™ç‚¹ç‰ºç‰²æ˜¯å€¼å¾—çš„ã€‚</p><p><strong>æŒ‡ä»¤é‡æ’å¯ä»¥ä¿è¯ä¸²è¡Œè¯­ä¹‰ä¸€è‡´ï¼Œä½†æ˜¯æ²¡æœ‰ä¹‰åŠ¡ä¿è¯å¤šçº¿ç¨‹é—´çš„è¯­ä¹‰ä¹Ÿä¸€è‡´</strong>ã€‚</p></blockquote><ol start="2"><li>é¡ºåºä¸€è‡´æ€§æ¨¡å‹</li></ol><p>Javaå†…å­˜æ¨¡å‹ï¼ˆJMMï¼‰å¯¹äºæ­£ç¡®åŒæ­¥å¤šçº¿ç¨‹ç¨‹åºçš„å†…å­˜ä¸€è‡´æ€§åšäº†ä»¥ä¸‹ä¿è¯ï¼š</p><blockquote><p><strong>å¦‚æœç¨‹åºæ˜¯æ­£ç¡®åŒæ­¥çš„ï¼Œç¨‹åºçš„æ‰§è¡Œå°†å…·æœ‰é¡ºåºä¸€è‡´æ€§</strong>ã€‚ å³ç¨‹åºçš„æ‰§è¡Œç»“æœå’Œè¯¥ç¨‹åºåœ¨é¡ºåºä¸€è‡´æ€§æ¨¡å‹ä¸­æ‰§è¡Œçš„ç»“æœç›¸åŒã€‚</p></blockquote><p>è¿™é‡Œçš„åŒæ­¥åŒ…æ‹¬äº†ä½¿ç”¨<code>volatile</code>ã€<code>final</code>ã€<code>synchronized</code>ç­‰å…³é”®å­—æ¥å®ç°<strong>å¤šçº¿ç¨‹ä¸‹çš„åŒæ­¥</strong>ã€‚</p><ol start="3"><li><p>happens-beforeè§„åˆ™</p><p>JMMæä¾›äº†<strong>happens-beforeè§„åˆ™</strong>ï¼ˆJSR-133è§„èŒƒï¼‰ï¼Œæ»¡è¶³äº†ç¨‹åºå‘˜çš„éœ€æ±‚â€”â€”<strong>ç®€å•æ˜“æ‡‚ï¼Œå¹¶ä¸”æä¾›äº†è¶³å¤Ÿå¼ºçš„å†…å­˜å¯è§æ€§ä¿è¯ã€‚</strong></p><p>æ€»ä¹‹ï¼Œå¦‚æœæ“ä½œA happens-beforeæ“ä½œBï¼Œé‚£ä¹ˆæ“ä½œAåœ¨å†…å­˜ä¸Šæ‰€åšçš„æ“ä½œå¯¹æ“ä½œBéƒ½æ˜¯å¯è§çš„ï¼Œä¸ç®¡å®ƒä»¬åœ¨ä¸åœ¨ä¸€ä¸ªçº¿ç¨‹ã€‚</p></li></ol><h3 id="3-volatileå…±äº«å˜é‡"><a href="#3-volatileå…±äº«å˜é‡" class="headerlink" title="3.volatileå…±äº«å˜é‡"></a>3.volatileå…±äº«å˜é‡</h3><p>volatileå…³é”®å­—æœ‰ç‰¹æ®Šçš„å†…å­˜è¯­ä¹‰ã€‚volatileä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ä¸ªåŠŸèƒ½ï¼š</p><ul><li>ä¿è¯å˜é‡çš„<strong>å†…å­˜å¯è§æ€§</strong></li><li>ç¦æ­¢volatileå˜é‡ä¸æ™®é€šå˜é‡<strong>é‡æ’åº</strong></li></ul><p><strong>åœ¨åŠŸèƒ½ä¸Šï¼Œé”æ¯”volatileæ›´å¼ºå¤§ï¼›åœ¨æ€§èƒ½ä¸Šï¼Œvolatileæ›´æœ‰ä¼˜åŠ¿</strong>ã€‚</p><h3 id="4-synchronizedä¸é”"><a href="#4-synchronizedä¸é”" class="headerlink" title="4.synchronizedä¸é”"></a>4.synchronizedä¸é”</h3><blockquote><p>Javaå¤šçº¿ç¨‹çš„é”éƒ½æ˜¯åŸºäºå¯¹è±¡çš„ã€‚</p><p>CAS: Compare and Swap</p><p>æ¯”è¾ƒå¹¶è®¾ç½®ã€‚ç”¨äºåœ¨ç¡¬ä»¶å±‚é¢ä¸Šæä¾›åŸå­æ€§æ“ä½œã€‚åœ¨ Intel å¤„ç†å™¨ä¸­ï¼Œæ¯”è¾ƒå¹¶äº¤æ¢é€šè¿‡æŒ‡ä»¤cmpxchgå®ç°ã€‚ æ¯”è¾ƒæ˜¯å¦å’Œç»™å®šçš„æ•°å€¼ä¸€è‡´ï¼Œå¦‚æœä¸€è‡´åˆ™ä¿®æ”¹ï¼Œä¸ä¸€è‡´åˆ™ä¸ä¿®æ”¹ã€‚</p></blockquote><h4 id="1-javaå¯¹è±¡å¤´ï¼šï¼ˆjavaé”å­˜æ”¾çš„åœ°æ–¹ï¼‰"><a href="#1-javaå¯¹è±¡å¤´ï¼šï¼ˆjavaé”å­˜æ”¾çš„åœ°æ–¹ï¼‰" class="headerlink" title="1.javaå¯¹è±¡å¤´ï¼šï¼ˆjavaé”å­˜æ”¾çš„åœ°æ–¹ï¼‰"></a>1.javaå¯¹è±¡å¤´ï¼šï¼ˆjavaé”å­˜æ”¾çš„åœ°æ–¹ï¼‰</h4><blockquote><p>æ¯ä¸ªJavaå¯¹è±¡éƒ½æœ‰å¯¹è±¡å¤´ã€‚å¦‚æœæ˜¯éæ•°ç»„ç±»å‹ï¼Œåˆ™ç”¨2ä¸ªå­—å®½æ¥å­˜å‚¨å¯¹è±¡å¤´ï¼Œå¦‚æœæ˜¯æ•°ç»„ï¼Œåˆ™ä¼šç”¨3ä¸ªå­—å®½æ¥å­˜å‚¨å¯¹è±¡å¤´ã€‚</p><p>Mark Word :  å­˜å‚¨å¯¹è±¡çš„<code>hashCode</code>æˆ–é”ä¿¡æ¯ç­‰</p></blockquote><h4 id="2-å‡ ç§é”"><a href="#2-å‡ ç§é”" class="headerlink" title="2.å‡ ç§é”"></a>2.å‡ ç§é”</h4><p>åœ¨Java 6 åŠå…¶ä»¥åï¼Œä¸€ä¸ªå¯¹è±¡å…¶å®æœ‰å››ç§é”çŠ¶æ€ï¼Œå®ƒä»¬çº§åˆ«ç”±ä½åˆ°é«˜ä¾æ¬¡æ˜¯ï¼š</p><ol><li>æ— é”çŠ¶æ€</li><li>åå‘é”çŠ¶æ€</li><li>è½»é‡çº§é”çŠ¶æ€</li><li>é‡é‡çº§é”çŠ¶æ€</li></ol><p>å‡ ç§é”ä¼šéšç€ç«äº‰æƒ…å†µé€æ¸å‡çº§ï¼Œé”çš„å‡çº§å¾ˆå®¹æ˜“å‘ç”Ÿï¼Œä½†æ˜¯é”é™çº§å‘ç”Ÿçš„æ¡ä»¶ä¼šæ¯”è¾ƒè‹›åˆ»</p><h5 id="1-åå‘é”-ï¼š"><a href="#1-åå‘é”-ï¼š" class="headerlink" title="1.åå‘é” ï¼š"></a>1.åå‘é” ï¼š</h5><p>åå‘é”åœ¨èµ„æºæ— ç«äº‰æƒ…å†µä¸‹æ¶ˆé™¤äº†åŒæ­¥è¯­å¥ï¼Œè¿CASæ“ä½œéƒ½ä¸åšäº†ï¼Œæé«˜äº†ç¨‹åºçš„è¿è¡Œæ€§èƒ½ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">é”è®°å½•åå‘çš„çº¿ç¨‹ID</span><br><span class="line">if(ä¸‹æ¬¡è¿›å…¥åŒæ­¥å— == è‡ªå·±çš„ID) æ— éœ€CASæ“ä½œåŠ é”å’Œè§£é”</span><br><span class="line">else å‡çº§ä¸ºè½»é‡çº§é” ç«äº‰</span><br></pre></td></tr></table></figure><p>é€‚ç”¨äºç«äº‰å°‘çš„æƒ…å†µã€‚</p><h5 id="2-è½»é‡çº§é”ï¼š"><a href="#2-è½»é‡çº§é”ï¼š" class="headerlink" title="2.è½»é‡çº§é”ï¼š"></a>2.è½»é‡çº§é”ï¼š</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">å°è¯•ç”¨CASå°†é”çš„Mark Wordæ›¿æ¢ä¸ºæŒ‡å‘é”è®°å½•çš„æŒ‡é’ˆ</span><br><span class="line">if(æˆåŠŸ) å½“å‰çº¿ç¨‹è·å¾—é”</span><br><span class="line">else å½“å‰çº¿ç¨‹å°±å°è¯•ä½¿ç”¨è‡ªæ—‹æ¥ç«äº‰è·å–é”ã€‚</span><br><span class="line"></span><br><span class="line">è‡ªæ—‹åˆ°ä¸€å®šç¨‹åº¦å‡çº§æˆé‡é‡çº§é”ã€‚</span><br></pre></td></tr></table></figure><h5 id="3-é‡é‡çº§é”ï¼š"><a href="#3-é‡é‡çº§é”ï¼š" class="headerlink" title="3.é‡é‡çº§é”ï¼š"></a>3.é‡é‡çº§é”ï¼š</h5><blockquote><p>ä¾èµ–äºæ“ä½œç³»ç»Ÿçš„äº’æ–¥é‡ï¼ˆmutexï¼‰ å®ç°çš„ï¼Œè€Œæ“ä½œç³»ç»Ÿä¸­çº¿ç¨‹é—´çŠ¶æ€çš„è½¬æ¢éœ€è¦ç›¸å¯¹æ¯”è¾ƒé•¿çš„æ—¶é—´ï¼Œæ‰€ä»¥é‡é‡çº§é”æ•ˆç‡å¾ˆä½ï¼Œä½†è¢«é˜»å¡çš„çº¿ç¨‹ä¸ä¼šæ¶ˆè€—CPUã€‚</p></blockquote><p>å½“è°ƒç”¨ä¸€ä¸ªé”å¯¹è±¡çš„<code>wait</code>æˆ–<code>notify</code>æ–¹æ³•æ—¶ï¼Œ<strong>å¦‚å½“å‰é”çš„çŠ¶æ€æ˜¯åå‘é”æˆ–è½»é‡çº§é”åˆ™ä¼šå…ˆè†¨èƒ€æˆé‡é‡çº§é”</strong>ã€‚</p><h5 id="4-å„ç§é”å¯¹æ¯”ï¼š"><a href="#4-å„ç§é”å¯¹æ¯”ï¼š" class="headerlink" title="4.å„ç§é”å¯¹æ¯”ï¼š"></a>4.å„ç§é”å¯¹æ¯”ï¼š</h5><table><thead><tr><th>é”</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>åå‘é”</td><td>åŠ é”å’Œè§£é”ä¸éœ€è¦é¢å¤–çš„æ¶ˆè€—ï¼Œå’Œæ‰§è¡ŒéåŒæ­¥æ–¹æ³•æ¯”ä»…å­˜åœ¨çº³ç§’çº§çš„å·®è·ã€‚</td><td>å¦‚æœçº¿ç¨‹é—´å­˜åœ¨é”ç«äº‰ï¼Œä¼šå¸¦æ¥é¢å¤–çš„é”æ’¤é”€çš„æ¶ˆè€—ã€‚</td><td>é€‚ç”¨äºåªæœ‰ä¸€ä¸ªçº¿ç¨‹è®¿é—®åŒæ­¥å—åœºæ™¯ã€‚</td></tr><tr><td>è½»é‡çº§é”</td><td>ç«äº‰çš„çº¿ç¨‹ä¸ä¼šé˜»å¡ï¼Œæé«˜äº†ç¨‹åºçš„å“åº”é€Ÿåº¦ã€‚</td><td>å¦‚æœå§‹ç»ˆå¾—ä¸åˆ°é”ç«äº‰çš„çº¿ç¨‹ä½¿ç”¨è‡ªæ—‹ä¼šæ¶ˆè€—CPUã€‚</td><td>è¿½æ±‚å“åº”æ—¶é—´ã€‚åŒæ­¥å—æ‰§è¡Œé€Ÿåº¦éå¸¸å¿«ã€‚</td></tr><tr><td>é‡é‡çº§é”</td><td>çº¿ç¨‹ç«äº‰ä¸ä½¿ç”¨è‡ªæ—‹ï¼Œä¸ä¼šæ¶ˆè€—CPUã€‚</td><td>çº¿ç¨‹é˜»å¡ï¼Œå“åº”æ—¶é—´ç¼“æ…¢ã€‚</td><td>è¿½æ±‚ååé‡ã€‚åŒæ­¥å—æ‰§è¡Œæ—¶é—´è¾ƒé•¿ã€‚</td></tr></tbody></table><h3 id="5-CASä¸åŸå­æ“ä½œ"><a href="#5-CASä¸åŸå­æ“ä½œ" class="headerlink" title="5.CASä¸åŸå­æ“ä½œ"></a>5.CASä¸åŸå­æ“ä½œ</h3><p><strong>æ‚²è§‚é”ï¼š</strong></p><p>æ‚²è§‚é”å°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„é”ã€‚å¯¹äºæ‚²è§‚é”æ¥è¯´ï¼Œå®ƒæ€»æ˜¯è®¤ä¸ºæ¯æ¬¡è®¿é—®å…±äº«èµ„æºæ—¶ä¼šå‘ç”Ÿå†²çªï¼Œæ‰€ä»¥å¿…é¡»å¯¹æ¯æ¬¡æ•°æ®æ“ä½œåŠ ä¸Šé”ï¼Œä»¥ä¿è¯ä¸´ç•ŒåŒºçš„ç¨‹åºåŒä¸€æ—¶é—´åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨æ‰§è¡Œã€‚</p><p><strong>ä¹è§‚é”ï¼š</strong></p><p>ä¹è§‚é”åˆç§°ä¸ºâ€œæ— é”â€ï¼Œé¡¾åæ€ä¹‰ï¼Œå®ƒæ˜¯ä¹è§‚æ´¾ã€‚ä¹è§‚é”æ€»æ˜¯å‡è®¾å¯¹å…±äº«èµ„æºçš„è®¿é—®æ²¡æœ‰å†²çªï¼Œçº¿ç¨‹å¯ä»¥ä¸åœåœ°æ‰§è¡Œï¼Œæ— éœ€åŠ é”ä¹Ÿæ— éœ€ç­‰å¾…ã€‚è€Œä¸€æ—¦å¤šä¸ªçº¿ç¨‹å‘ç”Ÿå†²çªï¼Œä¹è§‚é”é€šå¸¸æ˜¯ä½¿ç”¨ä¸€ç§ç§°ä¸ºCASçš„æŠ€æœ¯æ¥ä¿è¯çº¿ç¨‹æ‰§è¡Œçš„å®‰å…¨æ€§ã€‚</p><p>ç”±äºæ— é”æ“ä½œä¸­æ²¡æœ‰é”çš„å­˜åœ¨ï¼Œå› æ­¤ä¸å¯èƒ½å‡ºç°æ­»é”çš„æƒ…å†µï¼Œä¹Ÿå°±æ˜¯è¯´<strong>ä¹è§‚é”å¤©ç”Ÿå…ç–«æ­»é”</strong>ã€‚</p><p>ä¹è§‚é”å¤šç”¨äºâ€œè¯»å¤šå†™å°‘â€œçš„ç¯å¢ƒï¼Œé¿å…é¢‘ç¹åŠ é”å½±å“æ€§èƒ½ï¼›è€Œæ‚²è§‚é”å¤šç”¨äºâ€å†™å¤šè¯»å°‘â€œçš„ç¯å¢ƒï¼Œé¿å…é¢‘ç¹å¤±è´¥å’Œé‡è¯•å½±å“æ€§èƒ½ã€‚</p><ol><li>CASæ¦‚å¿µ</li></ol><p>CASçš„å…¨ç§°æ˜¯ï¼šæ¯”è¾ƒå¹¶äº¤æ¢ï¼ˆCompare And Swapï¼‰ã€‚åœ¨CASä¸­ï¼Œæœ‰è¿™æ ·ä¸‰ä¸ªå€¼ï¼š</p><ul><li>Vï¼šè¦æ›´æ–°çš„å˜é‡(var)</li><li>Eï¼šé¢„æœŸå€¼(expected)</li><li>Nï¼šæ–°å€¼(new)</li></ul><p>æ¯”è¾ƒå¹¶äº¤æ¢çš„è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><p>åˆ¤æ–­Væ˜¯å¦ç­‰äºEï¼Œå¦‚æœç­‰äºï¼Œå°†Vçš„å€¼è®¾ç½®ä¸ºNï¼›å¦‚æœä¸ç­‰ï¼Œè¯´æ˜å·²ç»æœ‰å…¶å®ƒçº¿ç¨‹æ›´æ–°äº†Vï¼Œåˆ™å½“å‰çº¿ç¨‹æ”¾å¼ƒæ›´æ–°ï¼Œä»€ä¹ˆéƒ½ä¸åšã€‚</p><ol start="2"><li><p>Javaå®ç°CASçš„åŸç† - Unsafeç±»</p></li><li><p>åŸå­æ“ä½œ-AtomicIntegerç±»</p></li><li><p>CASå®ç°åŸå­æ“ä½œçš„ä¸‰å¤§é—®é¢˜</p></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1.ABAé—®é¢˜</span><br><span class="line">2.å¾ªç¯æ—¶é—´é•¿å¼€é”€å¤§</span><br><span class="line">3.åªèƒ½ä¿è¯ä¸€ä¸ªå…±äº«å˜é‡çš„åŸå­æ“ä½œ</span><br></pre></td></tr></table></figure><h3 id="6-AQSæŠ½è±¡é˜Ÿåˆ—åŒæ­¥å™¨"><a href="#6-AQSæŠ½è±¡é˜Ÿåˆ—åŒæ­¥å™¨" class="headerlink" title="6.AQSæŠ½è±¡é˜Ÿåˆ—åŒæ­¥å™¨"></a>6.AQSæŠ½è±¡é˜Ÿåˆ—åŒæ­¥å™¨</h3><p><strong>AQS</strong>æ˜¯<code>AbstractQueuedSynchronizer</code>çš„ç®€ç§°ï¼Œå³<code>æŠ½è±¡é˜Ÿåˆ—åŒæ­¥å™¨</code>ï¼Œä»å­—é¢æ„æ€ä¸Šç†è§£:</p><ul><li>æŠ½è±¡ï¼šæŠ½è±¡ç±»ï¼Œåªå®ç°ä¸€äº›ä¸»è¦é€»è¾‘ï¼Œæœ‰äº›æ–¹æ³•ç”±å­ç±»å®ç°ï¼›</li><li>é˜Ÿåˆ—ï¼šä½¿ç”¨å…ˆè¿›å…ˆå‡ºï¼ˆFIFOï¼‰é˜Ÿåˆ—å­˜å‚¨æ•°æ®ï¼›</li><li>åŒæ­¥ï¼šå®ç°äº†åŒæ­¥çš„åŠŸèƒ½ã€‚</li></ul><p>é‚£AQSæœ‰ä»€ä¹ˆç”¨å‘¢ï¼ŸAQSæ˜¯ä¸€ä¸ªç”¨æ¥æ„å»ºé”å’ŒåŒæ­¥å™¨çš„æ¡†æ¶ï¼Œä½¿ç”¨AQSèƒ½ç®€å•ä¸”é«˜æ•ˆåœ°æ„é€ å‡ºåº”ç”¨å¹¿æ³›çš„åŒæ­¥å™¨ï¼Œæ¯”å¦‚æˆ‘ä»¬æåˆ°çš„<code>ReentrantLock</code>ï¼Œ<code>Semaphore</code>ï¼Œ<code>ReentrantReadWriteLock</code>ï¼Œ<code>SynchronousQueue</code>ï¼Œ<code>FutureTask</code>ç­‰ç­‰çš†æ˜¯åŸºäºAQSçš„ã€‚</p><p>â€¦..</p><p>â€¦..</p><h2 id="ä¸‰ã€JDKå¹¶å‘å·¥å…·"><a href="#ä¸‰ã€JDKå¹¶å‘å·¥å…·" class="headerlink" title="ä¸‰ã€JDKå¹¶å‘å·¥å…·"></a>ä¸‰ã€JDKå¹¶å‘å·¥å…·</h2><h4 id="1-çº¿ç¨‹æ± -ThreadPoolExecutor"><a href="#1-çº¿ç¨‹æ± -ThreadPoolExecutor" class="headerlink" title="1.çº¿ç¨‹æ±  ThreadPoolExecutor"></a>1.çº¿ç¨‹æ±  <code>ThreadPoolExecutor</code></h4><p><strong>ä½¿ç”¨çº¿ç¨‹æ± ä¸»è¦æœ‰ä»¥ä¸‹ä¸‰ä¸ªåŸå› </strong>ï¼š</p><ol><li>åˆ›å»º/é”€æ¯çº¿ç¨‹éœ€è¦æ¶ˆè€—ç³»ç»Ÿèµ„æºï¼Œçº¿ç¨‹æ± å¯ä»¥<strong>å¤ç”¨å·²åˆ›å»ºçš„çº¿ç¨‹</strong>ã€‚</li><li><strong>æ§åˆ¶å¹¶å‘çš„æ•°é‡</strong>ã€‚å¹¶å‘æ•°é‡è¿‡å¤šï¼Œå¯èƒ½ä¼šå¯¼è‡´èµ„æºæ¶ˆè€—è¿‡å¤šï¼Œä»è€Œé€ æˆæœåŠ¡å™¨å´©æºƒã€‚ï¼ˆä¸»è¦åŸå› ï¼‰</li><li><strong>å¯ä»¥å¯¹çº¿ç¨‹åšç»Ÿä¸€ç®¡ç†</strong>ã€‚</li></ol><p><strong>å››ç§æ‹’ç»ç­–ç•¥</strong>ï¼šï¼ˆçº¿ç¨‹æ•°é‡å¤§äºæœ€å¤§çº¿ç¨‹æ•°å°±ä¼šé‡‡ç”¨æ‹’ç»å¤„ç†ç­–ç•¥ï¼‰</p><ol><li><strong><code>ThreadPoolExecutor.AbortPolicy</code></strong>ï¼š<strong>é»˜è®¤æ‹’ç»å¤„ç†ç­–ç•¥</strong>ï¼Œä¸¢å¼ƒä»»åŠ¡å¹¶æŠ›å‡º<code>RejectedExecutionException</code>å¼‚å¸¸ã€‚</li><li><strong><code>ThreadPoolExecutor.DiscardPolicy</code></strong>ï¼šä¸¢å¼ƒæ–°æ¥çš„ä»»åŠ¡ï¼Œä½†æ˜¯ä¸æŠ›å‡ºå¼‚å¸¸ã€‚</li><li><strong><code>ThreadPoolExecutor.DiscardOldestPolicy</code></strong>ï¼šä¸¢å¼ƒé˜Ÿåˆ—å¤´éƒ¨ï¼ˆæœ€æ—§çš„ï¼‰çš„ä»»åŠ¡ï¼Œç„¶åé‡æ–°å°è¯•æ‰§è¡Œç¨‹åºï¼ˆå¦‚æœå†æ¬¡å¤±è´¥ï¼Œé‡å¤æ­¤è¿‡ç¨‹ï¼‰ã€‚</li><li><strong><code>ThreadPoolExecutor.CallerRunsPolicy</code></strong>ï¼šç”±è°ƒç”¨çº¿ç¨‹å¤„ç†è¯¥ä»»åŠ¡ã€‚</li></ol><p><strong>å››ç§å¸¸è§çº¿ç¨‹æ± </strong>ï¼š</p><ol><li><code>CacheThreadPool</code> æ ¸å¿ƒçº¿ç¨‹æ•°=0ï¼Œå…¨éƒ¨æ˜¯ä¸´æ—¶çº¿ç¨‹ã€‚</li><li><code>newFixedThreadPool</code> æ ¸å¿ƒçº¿ç¨‹æ•°=æœ€å¤§çº¿ç¨‹æ•°</li><li><code>newSingleThreadExecutor</code> æ ¸å¿ƒçº¿ç¨‹æ•°=æœ€å¤§çº¿ç¨‹æ•°=1</li><li><code>newScheduledThreadPool</code> ä¸€ä¸ªå®šé•¿çº¿ç¨‹æ± </li></ol><h4 id="2-é˜»å¡é˜Ÿåˆ—"><a href="#2-é˜»å¡é˜Ÿåˆ—" class="headerlink" title="2.é˜»å¡é˜Ÿåˆ—"></a>2.é˜»å¡é˜Ÿåˆ—</h4><blockquote><p>æºè‡ªç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼ã€‚</p><p>åªç®¡å¾€é‡Œé¢å­˜ã€å–å°±è¡Œï¼Œè€Œä¸ç”¨æ‹…å¿ƒå¤šçº¿ç¨‹ç¯å¢ƒä¸‹å­˜ã€å–å…±äº«å˜é‡çš„çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚</p></blockquote><ol><li><p><code>BlockingQueue</code>çš„æ“ä½œæ–¹æ³•</p><table><thead><tr><th align="center">æ–¹æ³•\å¤„ç†æ–¹å¼</th><th align="center">æŠ›å‡ºå¼‚å¸¸</th><th align="center">è¿”å›ç‰¹æ®Šå€¼</th><th align="center">ä¸€ç›´é˜»å¡</th><th align="center">è¶…æ—¶é€€å‡º</th></tr></thead><tbody><tr><td align="center">æ’å…¥æ–¹æ³•</td><td align="center">add(e)</td><td align="center">offer(e)</td><td align="center"><strong>put(e)</strong></td><td align="center">offer(e,time,unit)</td></tr><tr><td align="center">ç§»é™¤æ–¹æ³•</td><td align="center">remove()</td><td align="center">poll()</td><td align="center"><strong>take()</strong></td><td align="center">poll(time,unit)</td></tr><tr><td align="center">æ£€æŸ¥æ–¹æ³•</td><td align="center">element()</td><td align="center">peek()</td><td align="center">-</td><td align="center">-</td></tr></tbody></table></li><li><p><code>BlockingQueue</code>çš„å®ç°ç±»</p><ol><li><code>ArrayBlockingQueue</code>  ç”±<strong>æ•°ç»„</strong>ç»“æ„ç»„æˆçš„<strong>æœ‰ç•Œ</strong>é˜»å¡é˜Ÿåˆ—ã€‚</li><li><code>LinkedBlockingQueue</code>  ç”±<strong>é“¾è¡¨</strong>ç»“æ„ç»„æˆçš„<strong>æœ‰ç•Œ</strong>é˜»å¡é˜Ÿåˆ—ã€‚</li><li><code>DelayQueue</code>  <strong>æ²¡æœ‰å¤§å°é™åˆ¶</strong>ï¼Œåªæœ‰å½“å…¶æŒ‡å®šçš„<strong>å»¶è¿Ÿæ—¶é—´</strong>åˆ°äº†ï¼Œæ‰èƒ½å¤Ÿä»é˜Ÿåˆ—ä¸­è·å–åˆ°è¯¥å…ƒç´  ã€‚</li><li><code>PriorityBlockingQueue</code>  ä¼˜å…ˆé˜Ÿåˆ—ï¼Œå†…éƒ¨é‡‡ç”¨éå…¬å¹³é”</li><li><code>SynchronousQueue</code>   <strong>æ²¡æœ‰ä»»ä½•å†…éƒ¨å®¹é‡</strong>ï¼Œå¹¶ä¸”æ¯ä¸ª put å¿…é¡»ç­‰å¾…ä¸€ä¸ª takeï¼Œåä¹‹äº¦ç„¶ã€‚</li></ol><p>å¯¹äºæ— ç•Œé˜Ÿåˆ—ï¼š<strong>ç”Ÿäº§è€…ç”Ÿäº§æ•°æ®çš„é€Ÿåº¦ç»å¯¹ä¸èƒ½å¿«äºæ¶ˆè´¹è€…æ¶ˆè´¹æ•°æ®çš„é€Ÿåº¦ï¼Œå¦åˆ™æ—¶é—´ä¸€é•¿ï¼Œä¼šæœ€ç»ˆè€—å°½æ‰€æœ‰çš„å¯ç”¨å †å†…å­˜ç©ºé—´ã€‚</strong></p></li><li><p>é˜»å¡é˜Ÿåˆ—çš„åŸç†</p></li></ol><ul><li>é˜»å¡é˜Ÿåˆ—çš„åŸç†å¾ˆç®€å•ï¼Œåˆ©ç”¨äº†Locké”çš„å¤šæ¡ä»¶ï¼ˆConditionï¼‰é˜»å¡æ§åˆ¶ã€‚</li></ul><h4 id="3-é”å’Œæ¥å£ç±»"><a href="#3-é”å’Œæ¥å£ç±»" class="headerlink" title="3.é”å’Œæ¥å£ç±»"></a>3.é”å’Œæ¥å£ç±»</h4><blockquote><p>JavaåŸç”Ÿçš„é”â€”â€”åŸºäºå¯¹è±¡çš„é”ï¼Œå®ƒä¸€èˆ¬æ˜¯é…åˆsynchronizedå…³é”®å­—æ¥ä½¿ç”¨çš„ã€‚</p><p>Javaåœ¨<code>java.util.concurrent.locks</code>åŒ…ä¸‹ï¼Œè¿˜ä¸ºæˆ‘ä»¬æä¾›äº†å‡ ä¸ªå…³äºé”çš„ç±»å’Œæ¥å£ã€‚å®ƒä»¬æœ‰æ›´å¼ºå¤§çš„åŠŸèƒ½æˆ–æ›´é«˜çš„æ€§èƒ½ã€‚</p></blockquote><ol><li><h4 id="synchronizedçš„ä¸è¶³ï¼š"><a href="#synchronizedçš„ä¸è¶³ï¼š" class="headerlink" title="synchronizedçš„ä¸è¶³ï¼š"></a>synchronizedçš„ä¸è¶³ï¼š</h4><ul><li>æ— è®ºè¯»å†™ï¼Œ<strong>åŒä¸€æ—¶é—´åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œ</strong>ã€‚</li><li>æ— æ³•çŸ¥é“çº¿ç¨‹æœ‰æ²¡æœ‰æˆåŠŸè·å–åˆ°é”</li><li>å¦‚æœä¸´ç•ŒåŒºå› ä¸ºIOæˆ–è€…sleepæ–¹æ³•ç­‰åŸå› é˜»å¡äº†ï¼Œè€Œå½“å‰çº¿ç¨‹åˆæ²¡æœ‰é‡Šæ”¾é”ï¼Œå°±ä¼šå¯¼è‡´<strong>æ‰€æœ‰çº¿ç¨‹ç­‰å¾…</strong>ã€‚</li></ul></li><li><h4 id="é”çš„å‡ ç§åˆ†ç±»ï¼š"><a href="#é”çš„å‡ ç§åˆ†ç±»ï¼š" class="headerlink" title="é”çš„å‡ ç§åˆ†ç±»ï¼š"></a>é”çš„å‡ ç§åˆ†ç±»ï¼š</h4><ol><li>å¯é‡å…¥é”ï¼ˆ<code>synchronized</code>ã€<code>ReentrantLock</code>ï¼‰å’Œ éå¯é‡å…¥é”</li><li>å…¬å¹³é”ä¸éå…¬å¹³é”  (<code>ReentrantLock</code>æ”¯æŒéå…¬å¹³é”å’Œå…¬å¹³é”ä¸¤ç§ã€‚)</li><li>è¯»å†™é”å’Œæ’å®ƒé”(<code>synchronized</code>ã€<code>ReentrantLock</code>ï¼‰</li></ol></li><li><h4 id="JDKä¸­æœ‰å…³é”çš„ä¸€äº›æ¥å£å’Œç±»"><a href="#JDKä¸­æœ‰å…³é”çš„ä¸€äº›æ¥å£å’Œç±»" class="headerlink" title="JDKä¸­æœ‰å…³é”çš„ä¸€äº›æ¥å£å’Œç±»"></a>JDKä¸­æœ‰å…³é”çš„ä¸€äº›æ¥å£å’Œç±»</h4></li></ol><blockquote><p>JDKä¸­å…³äºå¹¶å‘çš„ç±»å¤§å¤šéƒ½åœ¨<code>java.util.concurrent</code>ï¼ˆä»¥ä¸‹ç®€ç§°<code>juc</code>ï¼‰åŒ…ä¸‹ã€‚</p></blockquote><ol><li>æŠ½è±¡ç±»AQS/AQLS/AOS</li><li>æ¥å£<code>Condition</code>/<code>Lock</code>/<code>ReadWriteLock</code>(è¯»å†™é”)</li><li><code>ReentrantLock</code>å¯é‡å…¥é”</li><li><code>ReentrantReadWriteLock</code>å¯é‡å…¥è¯»å†™é”</li><li><strong><code>StampedLock</code></strong> åŸºäºæ— é”ï¼Œæ€§èƒ½ä¹‹ç‹</li></ol><h4 id="4-å¹¶å‘å®¹å™¨é›†åˆ"><a href="#4-å¹¶å‘å®¹å™¨é›†åˆ" class="headerlink" title="4.å¹¶å‘å®¹å™¨é›†åˆ"></a>4.å¹¶å‘å®¹å™¨é›†åˆ</h4><p>æ•´ä½“æ¶æ„(åˆ—ä¸¾å¸¸ç”¨çš„å®¹å™¨ç±»)</p><p><img alt="æ•´ä½“æ¶æ„" data-src="http://concurrent.redspider.group/article/03/imgs/%E5%B9%B6%E5%8F%91%E5%AE%B9%E5%99%A8.png" class="lazyload"></p><p>å¤§è‡´åˆ†ä¸ºï¼š</p><ol><li>é˜»å¡é˜Ÿåˆ—</li><li><code>CopyOnWrite</code>å®¹å™¨</li><li>å¹¶å‘Mapã€Set</li></ol><h4 id="5-CopyOnWrite"><a href="#5-CopyOnWrite" class="headerlink" title="5.CopyOnWrite"></a>5.CopyOnWrite</h4><blockquote><p><code>CopyOnWrite</code>å®¹å™¨å³<strong>å†™æ—¶å¤åˆ¶çš„å®¹å™¨</strong> ,é€‚åˆè¯»å¤šå†™å°‘,è¯»ä¸åŠ é”</p></blockquote><p><code>CopyOnWrite</code>å®¹å™¨æœ‰<strong>æ•°æ®ä¸€è‡´æ€§</strong>çš„é—®é¢˜ï¼Œå®ƒåªèƒ½ä¿è¯<strong>æœ€ç»ˆæ•°æ®ä¸€è‡´æ€§</strong>ã€‚</p><h4 id="6-é€šè®¯å·¥å…·ç±»"><a href="#6-é€šè®¯å·¥å…·ç±»" class="headerlink" title="6.é€šè®¯å·¥å…·ç±»"></a>6.é€šè®¯å·¥å…·ç±»</h4><blockquote><p>å®ƒä»¬éƒ½åœ¨<code>java.util.concurrent</code>åŒ…ä¸‹ã€‚</p></blockquote><table><thead><tr><th>ç±»</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>Semaphore</td><td>é™åˆ¶çº¿ç¨‹çš„æ•°é‡</td></tr><tr><td>Exchanger</td><td>ä¸¤ä¸ªçº¿ç¨‹äº¤æ¢æ•°æ®</td></tr><tr><td>CountDownLatch</td><td>çº¿ç¨‹ç­‰å¾…ç›´åˆ°è®¡æ•°å™¨å‡ä¸º0æ—¶å¼€å§‹å·¥ä½œ</td></tr><tr><td>CyclicBarrier</td><td>ä½œç”¨è·ŸCountDownLatchç±»ä¼¼ï¼Œä½†æ˜¯å¯ä»¥é‡å¤ä½¿ç”¨</td></tr><tr><td>Phaser</td><td>å¢å¼ºçš„CyclicBarrier</td></tr></tbody></table><h4 id="7-Fork-Joinæ¡†æ¶"><a href="#7-Fork-Joinæ¡†æ¶" class="headerlink" title="7.Fork/Joinæ¡†æ¶"></a>7.Fork/Joinæ¡†æ¶</h4><blockquote><p><strong>åˆ†è€Œæ²»ä¹‹</strong></p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">solve(ä»»åŠ¡):</span><br><span class="line">    if(ä»»åŠ¡å·²ç»åˆ’åˆ†åˆ°è¶³å¤Ÿå°):</span><br><span class="line">        é¡ºåºæ‰§è¡Œä»»åŠ¡</span><br><span class="line">    else:</span><br><span class="line">        for(åˆ’åˆ†ä»»åŠ¡å¾—åˆ°å­ä»»åŠ¡)</span><br><span class="line">            solve(å­ä»»åŠ¡)</span><br><span class="line">        ç»“åˆæ‰€æœ‰å­ä»»åŠ¡çš„ç»“æœåˆ°ä¸Šä¸€å±‚å¾ªç¯</span><br><span class="line">        return æœ€ç»ˆç»“åˆçš„ç»“æœ</span><br></pre></td></tr></table></figure><h4 id="8-Java8-Streamå¹¶è¡Œè®¡ç®—åŸç†"><a href="#8-Java8-Streamå¹¶è¡Œè®¡ç®—åŸç†" class="headerlink" title="8.Java8 Streamå¹¶è¡Œè®¡ç®—åŸç†"></a>8.Java8 Streamå¹¶è¡Œè®¡ç®—åŸç†</h4><blockquote><p>ä»Java 8 å¼€å§‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>Stream</code>æ¥å£ä»¥åŠ<strong>lambdaè¡¨è¾¾å¼</strong>è¿›è¡Œâ€œæµå¼è®¡ç®—â€ã€‚</p><p>å®ƒå¯ä»¥è®©æˆ‘ä»¬å¯¹é›†åˆçš„æ“ä½œæ›´åŠ ç®€æ´ã€æ›´åŠ å¯è¯»ã€æ›´åŠ é«˜æ•ˆã€‚</p><p>Streamæ¥å£æœ‰éå¸¸å¤šç”¨äºé›†åˆè®¡ç®—çš„æ–¹æ³•ï¼Œæ¯”å¦‚åˆ¤ç©ºæ“ä½œemptyã€è¿‡æ»¤æ“ä½œfilterã€æ±‚æœ€maxå€¼ã€æŸ¥æ‰¾æ“ä½œfindFirstå’ŒfindAnyç­‰ç­‰ã€‚</p></blockquote><h4 id="9-è®¡åˆ’ä»»åŠ¡"><a href="#9-è®¡åˆ’ä»»åŠ¡" class="headerlink" title="9.è®¡åˆ’ä»»åŠ¡"></a>9.è®¡åˆ’ä»»åŠ¡</h4><blockquote><p>è‡ªJDK 1.5 å¼€å§‹ï¼ŒJDKæä¾›äº†<code>ScheduledThreadPoolExecutor</code>ç±»ç”¨äºè®¡åˆ’ä»»åŠ¡ï¼ˆåˆç§°å®šæ—¶ä»»åŠ¡ï¼‰</p><p>å†…éƒ¨ä½¿ç”¨ä¼˜åŒ–çš„<code>DelayQueue</code>æ¥å®ç°</p></blockquote><p>è¿™ä¸ªç±»æœ‰ä¸¤ä¸ªç”¨é€”ï¼š</p><ul><li>åœ¨ç»™å®šçš„å»¶è¿Ÿä¹‹åè¿è¡Œä»»åŠ¡</li><li>å‘¨æœŸæ€§é‡å¤æ‰§è¡Œä»»åŠ¡</li></ul><hr><p>æœ¬æ–‡åªæ˜¯ç®€è¦æ¦‚æ‹¬ï¼Œè¯¦æƒ…æŸ¥çœ‹ï¼š</p><p><a href="http://concurrent.redspider.group/" target="_blank" rel="noopener">æ·±å…¥æµ…å‡ºJavaå¤šçº¿ç¨‹</a><br><a href="https://www.liaoxuefeng.com/wiki/1252599548343744/1255943750561472" target="_blank" rel="noopener">å»–é›ªå³°çš„å®˜ç½‘</a></p><p>ã€ŠJava å¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ã€‹</p><p>ã€Šå®æˆ˜Javaé«˜å¹¶å‘ç¨‹åºè®¾è®¡ã€‹</p>]]></content>
      
      
      <categories>
          
          <category> javaåŸºç¡€è¯­æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¹¶å‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>javaæ³¨è§£</title>
      <link href="/2020/05/09/java%E6%B3%A8%E8%A7%A3/"/>
      <url>/2020/05/09/java%E6%B3%A8%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<p>é¤è€ƒèµ„æ–™ï¼š<br><a href="https://juejin.im/post/5b45bd715188251b3a1db54f" target="_blank" rel="noopener">æ³¨è§£è§£æ</a><br><a href="https://juejin.im/post/5d81a92c518825280e3e40dd" target="_blank" rel="noopener">æ³¨è§£ç”¨é€”</a></p><h3 id="1-æ³¨è§£çš„å®è´¨"><a href="#1-æ³¨è§£çš„å®è´¨" class="headerlink" title="1.æ³¨è§£çš„å®è´¨"></a>1.æ³¨è§£çš„å®è´¨</h3><blockquote><p>æ‰€æœ‰çš„æ³¨è§£ç±»å‹éƒ½ç»§æ‰¿è‡ªè¿™ä¸ªæ™®é€šçš„æ¥å£ï¼ˆAnnotationï¼‰</p></blockquote><p>å¦‚ï¼Œ @Override çš„å®šä¹‰ï¼Œå…¶å®å®ƒæœ¬è´¨ä¸Šå°±æ˜¯ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public interface Override extends Annotation&#123;</span><br><span class="line">   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-å…ƒæ³¨è§£"><a href="#2-å…ƒæ³¨è§£" class="headerlink" title="2.å…ƒæ³¨è§£"></a>2.å…ƒæ³¨è§£</h3><blockquote><p>ã€å…ƒæ³¨è§£ã€æ˜¯ç”¨äºä¿®é¥°æ³¨è§£çš„æ³¨è§£ï¼Œé€šå¸¸ç”¨åœ¨æ³¨è§£çš„å®šä¹‰ä¸Š</p></blockquote><ul><li>@Targetï¼šæ³¨è§£çš„ä½œç”¨ç›®æ ‡</li><li>@Retentionï¼šæ³¨è§£çš„ç”Ÿå‘½å‘¨æœŸ</li><li>@Documentedï¼šæ³¨è§£æ˜¯å¦åº”å½“è¢«åŒ…å«åœ¨ JavaDoc æ–‡æ¡£ä¸­</li><li>@Inheritedï¼šæ˜¯å¦å…è®¸å­ç±»ç»§æ‰¿è¯¥æ³¨è§£</li></ul><h5 id="Target-ç”¨äºæŒ‡æ˜è¢«ä¿®é¥°çš„æ³¨è§£æœ€ç»ˆå¯ä»¥ä½œç”¨çš„ç›®æ ‡æ˜¯è°ï¼Œä¹Ÿå°±æ˜¯æŒ‡æ˜ï¼Œä½ çš„æ³¨è§£åˆ°åº•æ˜¯ç”¨æ¥ä¿®é¥°æ–¹æ³•çš„ï¼Ÿä¿®é¥°ç±»çš„ï¼Ÿè¿˜æ˜¯ç”¨æ¥ä¿®é¥°å­—æ®µå±æ€§çš„ã€‚"><a href="#Target-ç”¨äºæŒ‡æ˜è¢«ä¿®é¥°çš„æ³¨è§£æœ€ç»ˆå¯ä»¥ä½œç”¨çš„ç›®æ ‡æ˜¯è°ï¼Œä¹Ÿå°±æ˜¯æŒ‡æ˜ï¼Œä½ çš„æ³¨è§£åˆ°åº•æ˜¯ç”¨æ¥ä¿®é¥°æ–¹æ³•çš„ï¼Ÿä¿®é¥°ç±»çš„ï¼Ÿè¿˜æ˜¯ç”¨æ¥ä¿®é¥°å­—æ®µå±æ€§çš„ã€‚" class="headerlink" title="@Target ç”¨äºæŒ‡æ˜è¢«ä¿®é¥°çš„æ³¨è§£æœ€ç»ˆå¯ä»¥ä½œç”¨çš„ç›®æ ‡æ˜¯è°ï¼Œä¹Ÿå°±æ˜¯æŒ‡æ˜ï¼Œä½ çš„æ³¨è§£åˆ°åº•æ˜¯ç”¨æ¥ä¿®é¥°æ–¹æ³•çš„ï¼Ÿä¿®é¥°ç±»çš„ï¼Ÿè¿˜æ˜¯ç”¨æ¥ä¿®é¥°å­—æ®µå±æ€§çš„ã€‚"></a>@Target ç”¨äºæŒ‡æ˜è¢«ä¿®é¥°çš„æ³¨è§£æœ€ç»ˆå¯ä»¥ä½œç”¨çš„ç›®æ ‡æ˜¯è°ï¼Œä¹Ÿå°±æ˜¯æŒ‡æ˜ï¼Œä½ çš„æ³¨è§£åˆ°åº•æ˜¯ç”¨æ¥ä¿®é¥°æ–¹æ³•çš„ï¼Ÿä¿®é¥°ç±»çš„ï¼Ÿè¿˜æ˜¯ç”¨æ¥ä¿®é¥°å­—æ®µå±æ€§çš„ã€‚</h5><p><img alt data-src="https://user-gold-cdn.xitu.io/2018/7/11/164886bda8c37809?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" class="lazyload"></p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹çš„æ–¹å¼æ¥ä¸ºè¿™ä¸ª value ä¼ å€¼ï¼š</p><blockquote><p>@Target(value = {ElementType.FIELD})</p></blockquote><p>è¢«è¿™ä¸ª @Target æ³¨è§£ä¿®é¥°çš„æ³¨è§£å°†åªèƒ½ä½œç”¨åœ¨æˆå‘˜å­—æ®µä¸Šï¼Œä¸èƒ½ç”¨äºä¿®é¥°æ–¹æ³•æˆ–è€…ç±»ã€‚</p><p>å…¶ä¸­ï¼ŒElementType æ˜¯ä¸€ä¸ªæšä¸¾ç±»å‹ï¼Œæœ‰ä»¥ä¸‹ä¸€äº›å€¼ï¼š</p><ul><li>ElementType.TYPEï¼šå…è®¸è¢«ä¿®é¥°çš„æ³¨è§£ä½œç”¨åœ¨ç±»ã€æ¥å£å’Œæšä¸¾ä¸Š</li><li>ElementType.FIELDï¼šå…è®¸ä½œç”¨åœ¨å±æ€§å­—æ®µä¸Š</li><li>ElementType.METHODï¼šå…è®¸ä½œç”¨åœ¨æ–¹æ³•ä¸Š</li><li>ElementType.PARAMETERï¼šå…è®¸ä½œç”¨åœ¨æ–¹æ³•å‚æ•°ä¸Š</li><li>ElementType.CONSTRUCTORï¼šå…è®¸ä½œç”¨åœ¨æ„é€ å™¨ä¸Š</li><li>ElementType.LOCAL_VARIABLEï¼šå…è®¸ä½œç”¨åœ¨æœ¬åœ°å±€éƒ¨å˜é‡ä¸Š</li><li>ElementType.ANNOTATION_TYPEï¼šå…è®¸ä½œç”¨åœ¨æ³¨è§£ä¸Š</li><li>ElementType.PACKAGEï¼šå…è®¸ä½œç”¨åœ¨åŒ…ä¸Š</li></ul><h5 id="Retention-ç”¨äºæŒ‡æ˜å½“å‰æ³¨è§£çš„ç”Ÿå‘½å‘¨æœŸ"><a href="#Retention-ç”¨äºæŒ‡æ˜å½“å‰æ³¨è§£çš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="@Retention ç”¨äºæŒ‡æ˜å½“å‰æ³¨è§£çš„ç”Ÿå‘½å‘¨æœŸ"></a>@Retention ç”¨äºæŒ‡æ˜å½“å‰æ³¨è§£çš„ç”Ÿå‘½å‘¨æœŸ</h5><p><img alt data-src="https://user-gold-cdn.xitu.io/2018/7/11/164886bdb3a58c5f?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" class="lazyload"></p><p>åŒæ ·çš„ï¼Œå®ƒä¹Ÿæœ‰ä¸€ä¸ª value å±æ€§ï¼š</p><blockquote><p>@Retention(value = RetentionPolicy.RUNTIME</p></blockquote><p>RetentionPolicy ä¾ç„¶æ˜¯ä¸€ä¸ªæšä¸¾ç±»å‹ï¼Œå®ƒæœ‰ä»¥ä¸‹å‡ ä¸ªæšä¸¾å€¼å¯å–ï¼š</p><ul><li>RetentionPolicy.SOURCEï¼šå½“å‰æ³¨è§£ç¼–è¯‘æœŸå¯è§ï¼Œä¸ä¼šå†™å…¥ class æ–‡ä»¶</li><li>RetentionPolicy.CLASSï¼šç±»åŠ è½½é˜¶æ®µä¸¢å¼ƒï¼Œä¼šå†™å…¥ class æ–‡ä»¶</li><li>RetentionPolicy.RUNTIMEï¼šæ°¸ä¹…ä¿å­˜ï¼Œå¯ä»¥åå°„è·å–</li></ul><p>@Retention æ³¨è§£æŒ‡å®šäº†è¢«ä¿®é¥°çš„æ³¨è§£çš„ç”Ÿå‘½å‘¨æœŸï¼Œ</p><ol><li>æ˜¯åªèƒ½åœ¨ç¼–è¯‘æœŸå¯è§ï¼Œç¼–è¯‘åä¼šè¢«ä¸¢å¼ƒ</li><li>ä¼šè¢«ç¼–è¯‘å™¨ç¼–è¯‘è¿› class æ–‡ä»¶ä¸­ï¼Œæ— è®ºæ˜¯ç±»æˆ–æ˜¯æ–¹æ³•ï¼Œä¹ƒè‡³å­—æ®µï¼Œä»–ä»¬éƒ½æ˜¯æœ‰å±æ€§è¡¨çš„ï¼Œè€Œ JAVA è™šæ‹Ÿæœºä¹Ÿå®šä¹‰äº†å‡ ç§æ³¨è§£å±æ€§è¡¨ç”¨äºå­˜å‚¨æ³¨è§£ä¿¡æ¯ï¼Œä½†æ˜¯è¿™ç§å¯è§æ€§ä¸èƒ½å¸¦åˆ°æ–¹æ³•åŒºï¼Œç±»åŠ è½½æ—¶ä¼šäºˆä»¥ä¸¢å¼ƒ</li><li>æœ€åä¸€ç§åˆ™æ˜¯æ°¸ä¹…å­˜åœ¨çš„å¯è§æ€§ã€‚</li></ol><h5 id="Documented-æ³¨è§£ä¿®é¥°çš„æ³¨è§£ï¼Œå½“æˆ‘ä»¬æ‰§è¡Œ-JavaDoc-æ–‡æ¡£æ‰“åŒ…æ—¶ä¼šè¢«ä¿å­˜è¿›-doc-æ–‡æ¡£ï¼Œåä¹‹å°†åœ¨æ‰“åŒ…æ—¶ä¸¢å¼ƒã€‚"><a href="#Documented-æ³¨è§£ä¿®é¥°çš„æ³¨è§£ï¼Œå½“æˆ‘ä»¬æ‰§è¡Œ-JavaDoc-æ–‡æ¡£æ‰“åŒ…æ—¶ä¼šè¢«ä¿å­˜è¿›-doc-æ–‡æ¡£ï¼Œåä¹‹å°†åœ¨æ‰“åŒ…æ—¶ä¸¢å¼ƒã€‚" class="headerlink" title="@Documented æ³¨è§£ä¿®é¥°çš„æ³¨è§£ï¼Œå½“æˆ‘ä»¬æ‰§è¡Œ JavaDoc æ–‡æ¡£æ‰“åŒ…æ—¶ä¼šè¢«ä¿å­˜è¿› doc æ–‡æ¡£ï¼Œåä¹‹å°†åœ¨æ‰“åŒ…æ—¶ä¸¢å¼ƒã€‚"></a>@Documented æ³¨è§£ä¿®é¥°çš„æ³¨è§£ï¼Œå½“æˆ‘ä»¬æ‰§è¡Œ JavaDoc æ–‡æ¡£æ‰“åŒ…æ—¶ä¼šè¢«ä¿å­˜è¿› doc æ–‡æ¡£ï¼Œåä¹‹å°†åœ¨æ‰“åŒ…æ—¶ä¸¢å¼ƒã€‚</h5><h5 id="Inherited-æ³¨è§£ä¿®é¥°çš„æ³¨è§£æ˜¯å…·æœ‰å¯ç»§æ‰¿æ€§çš„ï¼Œä¹Ÿå°±è¯´æˆ‘ä»¬çš„æ³¨è§£ä¿®é¥°äº†ä¸€ä¸ªç±»ï¼Œè€Œè¯¥ç±»çš„å­ç±»å°†è‡ªåŠ¨ç»§æ‰¿çˆ¶ç±»çš„è¯¥æ³¨è§£ã€‚"><a href="#Inherited-æ³¨è§£ä¿®é¥°çš„æ³¨è§£æ˜¯å…·æœ‰å¯ç»§æ‰¿æ€§çš„ï¼Œä¹Ÿå°±è¯´æˆ‘ä»¬çš„æ³¨è§£ä¿®é¥°äº†ä¸€ä¸ªç±»ï¼Œè€Œè¯¥ç±»çš„å­ç±»å°†è‡ªåŠ¨ç»§æ‰¿çˆ¶ç±»çš„è¯¥æ³¨è§£ã€‚" class="headerlink" title="@Inherited æ³¨è§£ä¿®é¥°çš„æ³¨è§£æ˜¯å…·æœ‰å¯ç»§æ‰¿æ€§çš„ï¼Œä¹Ÿå°±è¯´æˆ‘ä»¬çš„æ³¨è§£ä¿®é¥°äº†ä¸€ä¸ªç±»ï¼Œè€Œè¯¥ç±»çš„å­ç±»å°†è‡ªåŠ¨ç»§æ‰¿çˆ¶ç±»çš„è¯¥æ³¨è§£ã€‚"></a>@Inherited æ³¨è§£ä¿®é¥°çš„æ³¨è§£æ˜¯å…·æœ‰å¯ç»§æ‰¿æ€§çš„ï¼Œä¹Ÿå°±è¯´æˆ‘ä»¬çš„æ³¨è§£ä¿®é¥°äº†ä¸€ä¸ªç±»ï¼Œè€Œè¯¥ç±»çš„å­ç±»å°†è‡ªåŠ¨ç»§æ‰¿çˆ¶ç±»çš„è¯¥æ³¨è§£ã€‚</h5><h4 id="3-JAVA-çš„å†…ç½®ä¸‰å¤§æ³¨è§£"><a href="#3-JAVA-çš„å†…ç½®ä¸‰å¤§æ³¨è§£" class="headerlink" title="3.JAVA çš„å†…ç½®ä¸‰å¤§æ³¨è§£"></a>3.JAVA çš„å†…ç½®ä¸‰å¤§æ³¨è§£</h4><p>é™¤äº†ä¸Šè¿°å››ç§å…ƒæ³¨è§£å¤–ï¼ŒJDK è¿˜ä¸ºæˆ‘ä»¬é¢„å®šä¹‰äº†å¦å¤–ä¸‰ç§æ³¨è§£ï¼Œå®ƒä»¬æ˜¯ï¼š</p><ul><li>@Override</li><li>@Deprecated</li><li>@SuppressWarnings</li></ul><h5 id="Override-æ³¨è§£ï¼šè¯¥æ–¹æ³•å·²è¢«æ›¿ä»£ï¼Œå®ƒçš„å®šä¹‰å¦‚ä¸‹ï¼š"><a href="#Override-æ³¨è§£ï¼šè¯¥æ–¹æ³•å·²è¢«æ›¿ä»£ï¼Œå®ƒçš„å®šä¹‰å¦‚ä¸‹ï¼š" class="headerlink" title="@Override æ³¨è§£ï¼šè¯¥æ–¹æ³•å·²è¢«æ›¿ä»£ï¼Œå®ƒçš„å®šä¹‰å¦‚ä¸‹ï¼š"></a>@Override æ³¨è§£ï¼šè¯¥æ–¹æ³•å·²è¢«æ›¿ä»£ï¼Œå®ƒçš„å®šä¹‰å¦‚ä¸‹ï¼š</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@Target(ElementType.METHOD)</span><br><span class="line">@Retention(RetentionPolicy.SOURCE)</span><br><span class="line">public @interface Override &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®ƒæ²¡æœ‰ä»»ä½•çš„å±æ€§ï¼Œæ‰€ä»¥å¹¶ä¸èƒ½å­˜å‚¨ä»»ä½•å…¶ä»–ä¿¡æ¯ã€‚å®ƒåªèƒ½ä½œç”¨äºæ–¹æ³•ä¹‹ä¸Šï¼Œç¼–è¯‘ç»“æŸåå°†è¢«ä¸¢å¼ƒã€‚æ˜¯ä¸€ç§å…¸å‹çš„ã€æ ‡è®°å¼æ³¨è§£ã€ï¼Œä»…è¢«ç¼–è¯‘å™¨å¯çŸ¥ã€‚</p><h5 id="Deprecated-ï¼šæ ‡è®°å½“å‰çš„ç±»æˆ–è€…æ–¹æ³•æˆ–è€…å­—æ®µç­‰å·²ç»ä¸å†è¢«æ¨èä½¿ç”¨äº†ï¼Œå¯èƒ½ä¸‹ä¸€æ¬¡çš„-JDK-ç‰ˆæœ¬å°±ä¼šåˆ é™¤"><a href="#Deprecated-ï¼šæ ‡è®°å½“å‰çš„ç±»æˆ–è€…æ–¹æ³•æˆ–è€…å­—æ®µç­‰å·²ç»ä¸å†è¢«æ¨èä½¿ç”¨äº†ï¼Œå¯èƒ½ä¸‹ä¸€æ¬¡çš„-JDK-ç‰ˆæœ¬å°±ä¼šåˆ é™¤" class="headerlink" title="@Deprecated ï¼šæ ‡è®°å½“å‰çš„ç±»æˆ–è€…æ–¹æ³•æˆ–è€…å­—æ®µç­‰å·²ç»ä¸å†è¢«æ¨èä½¿ç”¨äº†ï¼Œå¯èƒ½ä¸‹ä¸€æ¬¡çš„ JDK ç‰ˆæœ¬å°±ä¼šåˆ é™¤"></a>@Deprecated ï¼šæ ‡è®°å½“å‰çš„ç±»æˆ–è€…æ–¹æ³•æˆ–è€…å­—æ®µç­‰å·²ç»ä¸å†è¢«æ¨èä½¿ç”¨äº†ï¼Œå¯èƒ½ä¸‹ä¸€æ¬¡çš„ JDK ç‰ˆæœ¬å°±ä¼šåˆ é™¤</h5><p><img alt data-src="https://user-gold-cdn.xitu.io/2018/7/11/164886bdc54f9b3d?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" class="lazyload"></p><h5 id="SuppressWarnings-ä¸»è¦ç”¨æ¥å‹åˆ¶-java-çš„è­¦å‘Šï¼Œå®ƒçš„åŸºæœ¬å®šä¹‰å¦‚ä¸‹ï¼š"><a href="#SuppressWarnings-ä¸»è¦ç”¨æ¥å‹åˆ¶-java-çš„è­¦å‘Šï¼Œå®ƒçš„åŸºæœ¬å®šä¹‰å¦‚ä¸‹ï¼š" class="headerlink" title="@SuppressWarnings ä¸»è¦ç”¨æ¥å‹åˆ¶ java çš„è­¦å‘Šï¼Œå®ƒçš„åŸºæœ¬å®šä¹‰å¦‚ä¸‹ï¼š"></a>@SuppressWarnings ä¸»è¦ç”¨æ¥å‹åˆ¶ java çš„è­¦å‘Šï¼Œå®ƒçš„åŸºæœ¬å®šä¹‰å¦‚ä¸‹ï¼š</h5><p><img alt data-src="https://user-gold-cdn.xitu.io/2018/7/11/164886bdbc0a6ae9?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" class="lazyload"><br>value å±æ€§éœ€è¦ä½ ä¸»åŠ¨çš„ä¼ å€¼,è¿™ä¸ª value ä»£è¡¨çš„å°±æ˜¯éœ€è¦è¢«å‹åˆ¶çš„è­¦å‘Šç±»å‹ã€‚</p><h4 id="4-æ³¨è§£è‡ªå®šä¹‰åŠå…¶åº”ç”¨"><a href="#4-æ³¨è§£è‡ªå®šä¹‰åŠå…¶åº”ç”¨" class="headerlink" title="4.æ³¨è§£è‡ªå®šä¹‰åŠå…¶åº”ç”¨"></a>4.æ³¨è§£è‡ªå®šä¹‰åŠå…¶åº”ç”¨</h4><blockquote><p>åªæœ‰@Retentionå®šä¹‰ä¸ºRetentionPolicy.RUNTIMEæ—¶ï¼Œæˆ‘ä»¬æ‰èƒ½é€šè¿‡æ³¨è§£åå°„è·å–åˆ°æ³¨è§£ã€‚</p></blockquote><h5 id="1-è‡ªå®šä¹‰ä¸€ä¸ªæ³¨è§£"><a href="#1-è‡ªå®šä¹‰ä¸€ä¸ªæ³¨è§£" class="headerlink" title="1.è‡ªå®šä¹‰ä¸€ä¸ªæ³¨è§£"></a>1.è‡ªå®šä¹‰ä¸€ä¸ªæ³¨è§£</h5><ol><li>è‡ªå®šä¹‰æ³¨è§£</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@Target(ElementType.FIELD)  //  æ³¨è§£ç”¨äºå­—æ®µä¸Š</span><br><span class="line">@Retention(RetentionPolicy.RUNTIME)  // ä¿ç•™åˆ°è¿è¡Œæ—¶ï¼Œå¯é€šè¿‡æ³¨è§£è·å–</span><br><span class="line">public @interface MyField &#123;</span><br><span class="line">    String description();</span><br><span class="line">    int length();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>é€šè¿‡åå°„è·å–æ³¨è§£</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">public class MyFieldTest &#123;</span><br><span class="line"></span><br><span class="line">    //ä½¿ç”¨æˆ‘ä»¬çš„è‡ªå®šä¹‰æ³¨è§£</span><br><span class="line">    @MyField(description = &quot;ç”¨æˆ·å&quot;, length = 12)</span><br><span class="line">    private String username;</span><br><span class="line"></span><br><span class="line">    @Test</span><br><span class="line">    public void testMyField()&#123;</span><br><span class="line"></span><br><span class="line">        // è·å–ç±»æ¨¡æ¿</span><br><span class="line">        Class c = MyFieldTest.class;</span><br><span class="line"></span><br><span class="line">        // è·å–æ‰€æœ‰å­—æ®µ</span><br><span class="line">        for(Field f : c.getDeclaredFields())&#123;</span><br><span class="line">            // åˆ¤æ–­è¿™ä¸ªå­—æ®µæ˜¯å¦æœ‰MyFieldæ³¨è§£</span><br><span class="line">            if(f.isAnnotationPresent(MyField.class))&#123;</span><br><span class="line">                MyField annotation = f.getAnnotation(MyField.class);</span><br><span class="line">                System.out.println(&quot;å­—æ®µ:[&quot; + f.getName() + &quot;], æè¿°:[&quot; + annotation.description() + &quot;], é•¿åº¦:[&quot; + annotation.length() +&quot;]&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="2-åº”ç”¨åœºæ™¯ä¸€ï¼šè‡ªå®šä¹‰æ³¨è§£-æ‹¦æˆªå™¨-å®ç°ç™»å½•æ ¡éªŒ"><a href="#2-åº”ç”¨åœºæ™¯ä¸€ï¼šè‡ªå®šä¹‰æ³¨è§£-æ‹¦æˆªå™¨-å®ç°ç™»å½•æ ¡éªŒ" class="headerlink" title="2.åº”ç”¨åœºæ™¯ä¸€ï¼šè‡ªå®šä¹‰æ³¨è§£+æ‹¦æˆªå™¨ å®ç°ç™»å½•æ ¡éªŒ"></a>2.åº”ç”¨åœºæ™¯ä¸€ï¼šè‡ªå®šä¹‰æ³¨è§£+æ‹¦æˆªå™¨ å®ç°ç™»å½•æ ¡éªŒ</h5><ol><li>æˆ‘ä»¬ä½¿ç”¨springbootæ‹¦æˆªå™¨å®ç°è¿™æ ·ä¸€ä¸ªåŠŸèƒ½ï¼Œå¦‚æœæ–¹æ³•ä¸ŠåŠ äº†@LoginRequiredï¼Œåˆ™æç¤ºç”¨æˆ·è¯¥æ¥å£éœ€è¦ç™»å½•æ‰èƒ½è®¿é—®ï¼Œå¦åˆ™ä¸éœ€è¦ç™»å½•ã€‚ é¦–å…ˆå®šä¹‰ä¸€ä¸ªLoginRequiredæ³¨è§£</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@Target(ElementType.METHOD)</span><br><span class="line">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="line">public @interface LoginRequired &#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>ç„¶åå†™ä¸¤ä¸ªç®€å•çš„æ¥å£ï¼Œè®¿é—®sourceAï¼ŒsourceBèµ„æº</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">@RestController</span><br><span class="line">public class IndexController &#123;</span><br><span class="line"></span><br><span class="line">    @GetMapping(&quot;/sourceA&quot;)</span><br><span class="line">    public String sourceA()&#123;</span><br><span class="line">        return &quot;ä½ æ­£åœ¨è®¿é—®sourceAèµ„æº&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @GetMapping(&quot;/sourceB&quot;)</span><br><span class="line">    public String sourceB()&#123;</span><br><span class="line">        return &quot;ä½ æ­£åœ¨è®¿é—®sourceBèµ„æº&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>æ²¡æ·»åŠ æ‹¦æˆªå™¨ä¹‹å‰æˆåŠŸè®¿é—®</li><li>å®ç°springçš„HandlerInterceptor ç±»å…ˆå®ç°æ‹¦æˆªå™¨ï¼Œä½†ä¸æ‹¦æˆªï¼Œåªæ˜¯ç®€å•æ‰“å°æ—¥å¿—ï¼Œå¦‚ä¸‹ï¼š</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public class SourceAccessInterceptor implements HandlerInterceptor &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception &#123;</span><br><span class="line">        System.out.println(&quot;è¿›å…¥æ‹¦æˆªå™¨äº†&quot;);</span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="5"><li>å®ç°springç±»WebMvcConfigurerï¼Œåˆ›å»ºé…ç½®ç±»æŠŠæ‹¦æˆªå™¨æ·»åŠ åˆ°æ‹¦æˆªå™¨é“¾ä¸­</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@Configuration</span><br><span class="line">public class InterceptorTrainConfigurer implements WebMvcConfigurer &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void addInterceptors(InterceptorRegistry registry) &#123;</span><br><span class="line">        registry.addInterceptor(new SourceAccessInterceptor()).addPathPatterns(&quot;/**&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶æ‹¦æˆªæˆåŠŸï¼</p><ol start="6"><li>åœ¨sourceBæ–¹æ³•ä¸Šæ·»åŠ æˆ‘ä»¬çš„ç™»å½•æ³¨è§£@LoginRequired</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@RestController</span><br><span class="line">public class IndexController &#123;</span><br><span class="line">    @GetMapping(&quot;/sourceA&quot;)</span><br><span class="line">    public String sourceA()&#123;</span><br><span class="line">        return &quot;ä½ æ­£åœ¨è®¿é—®sourceAèµ„æº&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    @LoginRequired</span><br><span class="line">    @GetMapping(&quot;/sourceB&quot;)</span><br><span class="line">    public String sourceB()&#123;</span><br><span class="line">        return &quot;ä½ æ­£åœ¨è®¿é—®sourceBèµ„æº&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="7"><li>ç®€å•å®ç°ç™»å½•æ‹¦æˆªé€»è¾‘</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception &#123;</span><br><span class="line">    System.out.println(&quot;è¿›å…¥æ‹¦æˆªå™¨äº†&quot;);</span><br><span class="line"></span><br><span class="line">    // åå°„è·å–æ–¹æ³•ä¸Šçš„LoginRequredæ³¨è§£</span><br><span class="line">    HandlerMethod handlerMethod = (HandlerMethod)handler;</span><br><span class="line">    LoginRequired loginRequired = handlerMethod.getMethod().getAnnotation(LoginRequired.class);</span><br><span class="line">    if(loginRequired == null)&#123;</span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // æœ‰LoginRequiredæ³¨è§£è¯´æ˜éœ€è¦ç™»å½•ï¼Œæç¤ºç”¨æˆ·ç™»å½•</span><br><span class="line">    response.setContentType(&quot;application/json; charset=utf-8&quot;);</span><br><span class="line">    response.getWriter().print(&quot;ä½ è®¿é—®çš„èµ„æºéœ€è¦ç™»å½•&quot;);</span><br><span class="line">    return false;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡ŒæˆåŠŸï¼Œè®¿é—®sourceBæ—¶éœ€è¦ç™»å½•äº†ï¼Œè®¿é—®sourceAåˆ™ä¸ç”¨ç™»å½•</p><h5 id="3-åº”ç”¨åœºæ™¯äºŒï¼šè‡ªå®šä¹‰æ³¨è§£-AOP-å®ç°æ—¥å¿—æ‰“å°"><a href="#3-åº”ç”¨åœºæ™¯äºŒï¼šè‡ªå®šä¹‰æ³¨è§£-AOP-å®ç°æ—¥å¿—æ‰“å°" class="headerlink" title="3.åº”ç”¨åœºæ™¯äºŒï¼šè‡ªå®šä¹‰æ³¨è§£+AOP å®ç°æ—¥å¿—æ‰“å°"></a>3.åº”ç”¨åœºæ™¯äºŒï¼šè‡ªå®šä¹‰æ³¨è§£+AOP å®ç°æ—¥å¿—æ‰“å°</h5><ol><li>å…ˆå¯¼å…¥åˆ‡é¢éœ€è¦çš„ä¾èµ–åŒ…</li><li>å®šä¹‰ä¸€ä¸ªæ³¨è§£@MyLog</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@Target(ElementType.METHOD)</span><br><span class="line">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="line">public @interface MyLog &#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>å®šä¹‰ä¸€ä¸ªåˆ‡é¢ç±»ï¼Œè§å¦‚ä¸‹ä»£ç æ³¨é‡Šç†è§£ï¼š</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">@Aspect // 1.è¡¨æ˜è¿™æ˜¯ä¸€ä¸ªåˆ‡é¢ç±»</span><br><span class="line">@Component</span><br><span class="line">public class MyLogAspect &#123;</span><br><span class="line"></span><br><span class="line">    // 2. PointCutè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªåˆ‡ç‚¹ï¼Œ@annotationè¡¨ç¤ºè¿™ä¸ªåˆ‡ç‚¹åˆ‡åˆ°ä¸€ä¸ªæ³¨è§£ä¸Šï¼Œåé¢å¸¦è¯¥æ³¨è§£çš„å…¨ç±»å</span><br><span class="line">    // åˆ‡é¢æœ€ä¸»è¦çš„å°±æ˜¯åˆ‡ç‚¹ï¼Œæ‰€æœ‰çš„æ•…äº‹éƒ½å›´ç»•åˆ‡ç‚¹å‘ç”Ÿ</span><br><span class="line">    // logPointCut()ä»£è¡¨åˆ‡ç‚¹åç§°</span><br><span class="line">    @Pointcut(&quot;@annotation(me.zebin.demo.annotationdemo.aoplog.MyLog)&quot;)</span><br><span class="line">    public void logPointCut()&#123;&#125;;</span><br><span class="line"></span><br><span class="line">    // 3. ç¯ç»•é€šçŸ¥</span><br><span class="line">    @Around(&quot;logPointCut()&quot;)</span><br><span class="line">    public void logAround(ProceedingJoinPoint joinPoint)&#123;</span><br><span class="line">        // è·å–æ–¹æ³•åç§°</span><br><span class="line">        String methodName = joinPoint.getSignature().getName();</span><br><span class="line">        // è·å–å…¥å‚</span><br><span class="line">        Object[] param = joinPoint.getArgs();</span><br><span class="line"></span><br><span class="line">        StringBuilder sb = new StringBuilder();</span><br><span class="line">        for(Object o : param)&#123;</span><br><span class="line">            sb.append(o + &quot;; &quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(&quot;è¿›å…¥[&quot; + methodName + &quot;]æ–¹æ³•,å‚æ•°ä¸º:&quot; + sb.toString());</span><br><span class="line"></span><br><span class="line">        // ç»§ç»­æ‰§è¡Œæ–¹æ³•</span><br><span class="line">        try &#123;</span><br><span class="line">            joinPoint.proceed();</span><br><span class="line">        &#125; catch (Throwable throwable) &#123;</span><br><span class="line">            throwable.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(methodName + &quot;æ–¹æ³•æ‰§è¡Œç»“æŸ&quot;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="4"><li>åœ¨æ­¥éª¤äºŒä¸­çš„IndexControllerå†™ä¸€ä¸ªsourceCè¿›è¡Œæµ‹è¯•ï¼ŒåŠ ä¸Šæˆ‘ä»¬çš„è‡ªå®šä¹‰æ³¨è§£ï¼š</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@MyLog</span><br><span class="line">@GetMapping(&quot;/sourceC/&#123;source_name&#125;&quot;)</span><br><span class="line">public String sourceC(@PathVariable(&quot;source_name&quot;) String sourceName)&#123;</span><br><span class="line">    return &quot;ä½ æ­£åœ¨è®¿é—®sourceCèµ„æº&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="5"><li>å¯åŠ¨springboot webé¡¹ç›®ï¼Œè¾“å…¥è®¿é—®åœ°å€</li></ol>]]></content>
      
      
      <categories>
          
          <category> javaåŸºç¡€è¯­æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ³¨è§£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŠ¨æ€è§„åˆ’æ¨¡æ¿</title>
      <link href="/2020/05/01/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92%E6%A8%A1%E6%9D%BF/"/>
      <url>/2020/05/01/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92%E6%A8%A1%E6%9D%BF/</url>
      
        <content type="html"><![CDATA[<h3 id="åŠ¨æ€è§„åˆ’åˆ†ç±»ï¼š"><a href="#åŠ¨æ€è§„åˆ’åˆ†ç±»ï¼š" class="headerlink" title="åŠ¨æ€è§„åˆ’åˆ†ç±»ï¼š"></a>åŠ¨æ€è§„åˆ’åˆ†ç±»ï¼š</h3><ol><li>çº¿æ€§dp</li><li>åŒºé—´dp</li><li>èƒŒåŒ…dp</li><li>æ ‘å½¢dp</li><li>çŠ¶æ€å‹ç¼©dp</li><li>æ•°ä½dp</li><li>è®¡æ•°å‹dp</li><li>é€’æ¨å‹dp</li><li>æ¦‚ç‡å‹dp</li><li>åšå¼ˆå‹dp</li><li>è®°å¿†åŒ–æœç´¢</li></ol><h4 id="åŠ¨æ€è§„åˆ’æ€è€ƒæ–¹å¼ï¼š"><a href="#åŠ¨æ€è§„åˆ’æ€è€ƒæ–¹å¼ï¼š" class="headerlink" title="åŠ¨æ€è§„åˆ’æ€è€ƒæ–¹å¼ï¼š"></a>åŠ¨æ€è§„åˆ’æ€è€ƒæ–¹å¼ï¼š</h4><p><img alt data-src="https://pic.downk.cc/item/5ea395e3c2a9a83be5423f5e.png" class="lazyload"></p><h4 id="1-çº¿æ€§dp"><a href="#1-çº¿æ€§dp" class="headerlink" title="1.çº¿æ€§dp"></a>1.çº¿æ€§dp</h4><ul><li><p>çº¿æ€§ DP é—®é¢˜æ˜¯æŒ‡é€’æ¨æ–¹ç¨‹å…·æœ‰æ˜æ˜¾çš„çº¿æ€§å…³ç³»ï¼Œæœ‰ä¸€ç»´çº¿æ€§å’ŒäºŒç»´çº¿æ€§ã€‚</p></li><li><p>å¦‚ï¼š</p></li></ul><ol><li><a href="https://leetcode-cn.com/problems/triangle/" target="_blank" rel="noopener">ä¸‰è§’å½¢æœ€å°è·¯å¾„å’Œ</a></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public int minimumTotal(List&lt;List&lt;Integer&gt;&gt; triangle) &#123;</span><br><span class="line">    int len = triangle.size();</span><br><span class="line">    int[] dp = new int[len+1];</span><br><span class="line">    for (int i = len-1; i &gt;=0 ; i--) &#123;</span><br><span class="line">        for (int j = 0; j &lt;=i ; j++) &#123;</span><br><span class="line">            int num = triangle.get(i).get(j);</span><br><span class="line">            dp[j] = Math.min(dp[j],dp[j+1]) + num;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return dp[0];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li><a href="https://leetcode-cn.com/problems/longest-increasing-subsequence/" target="_blank" rel="noopener">æœ€é•¿ä¸Šå‡å­åºåˆ—</a></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public int lengthOfLIS(int[] nums) &#123;</span><br><span class="line">    int max = 0;</span><br><span class="line">    int[] dp = new int[nums.length];</span><br><span class="line">    for (int i = 0; i &lt; nums.length; i++) &#123;</span><br><span class="line">        int count = 0;</span><br><span class="line">        for (int j = 0; j &lt;i ; j++) &#123;</span><br><span class="line">            if(nums[j] &lt; nums[i] &amp;&amp; dp[j] &gt; count) count = dp[j];</span><br><span class="line">        &#125;</span><br><span class="line">        dp[i] = count + 1;</span><br><span class="line">        if(max &lt; dp[i]) max = dp[i];</span><br><span class="line">    &#125;</span><br><span class="line">    return max;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li><a href="https://leetcode-cn.com/problems/longest-common-subsequence/" target="_blank" rel="noopener">æœ€é•¿å…¬å…±å­åºåˆ—</a></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public int longestCommonSubsequence(String text1, String text2) &#123;</span><br><span class="line">    int n = text1.length();</span><br><span class="line">    int m = text2.length();</span><br><span class="line">    int[][] dp = new int[n+1][m+1];</span><br><span class="line">    for (int i = 1; i &lt;=n ; i++) &#123;</span><br><span class="line">        for (int j = 1; j &lt;=m ; j++) &#123;</span><br><span class="line">            if(text1.charAt(i-1) == text2.charAt(j-1)) dp[i][j] = dp[i-1][j-1] +1;</span><br><span class="line">            else dp[i][j] = Math.max(dp[i-1][j],dp[i][j-1]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return dp[n][m];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-åŒºé—´dp"><a href="#2-åŒºé—´dp" class="headerlink" title="2.åŒºé—´dp"></a>2.åŒºé—´dp</h4><ul><li>åŒºé—´DP é—®é¢˜æ˜¯æŒ‡é€’æ¨æ–¹ç¨‹å…·æœ‰æ˜æ˜¾çš„åŒºé—´å…³ç³»ï¼Œæœ‰å·¦ç«¯ç‚¹å’Œå³ç«¯ç‚¹ã€‚</li><li>å¦‚ï¼š</li></ul><ol><li><a href="https://leetcode-cn.com/problems/longest-palindromic-subsequence/" target="_blank" rel="noopener">æœ€é•¿å›æ–‡å­åºåˆ—</a></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public static int longestPalindromeSubseq(String s) &#123;</span><br><span class="line">    int len = s.length();</span><br><span class="line">    char[] chars = s.toCharArray();</span><br><span class="line">    int[][] dp = new int[len][len];</span><br><span class="line">    for (int i = len-1; i &gt;=0; i--) dp[i][i] = 1;    //base case</span><br><span class="line">    for (int i = len-1; i &gt;=0; i--) &#123;</span><br><span class="line">        for (int j = i+1; j &lt;len ; j++) &#123;</span><br><span class="line">            if(chars[i] == chars[j]) dp[i][j] = dp[i+1][j-1]+2;</span><br><span class="line">            else dp[i][j] = Math.max(dp[i+1][j],dp[i][j-1]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return dp[0][len-1];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-èƒŒåŒ…dp"><a href="#3-èƒŒåŒ…dp" class="headerlink" title="3.èƒŒåŒ…dp"></a>3.èƒŒåŒ…dp</h4><ul><li>èƒŒåŒ…DP é—®é¢˜æ˜¯æŒ‡é€’æ¨æ–¹ç¨‹å…·æœ‰æ˜æ˜¾çš„é™åˆ¶æ¡ä»¶</li><li>åœ¨Nä¸­æƒ…å†µä¸­ ä¸”æ»¡è¶³æŸæ¡ä»¶çš„ æƒ…å†µä¸‹ æœ€ä¼˜çš„é€‰æ‹©æƒ…å†µ</li><li>å¦‚åœ¨èƒŒåŒ…é‡é‡ä¸è¶…è¿‡wçš„æƒ…å†µä¸‹ï¼Œä»Nä¸­ç‰©å“ä¸­é€‰æ‹©å‡º æœ€æœ‰ä»·å€¼çš„ç‰©å“ ï¼ˆ01èƒŒåŒ…ï¼‰</li><li>è¯¦æƒ…å‚è€ƒ èƒŒåŒ…æ¨¡æ¿</li></ul><h4 id="4-æ ‘å½¢dp"><a href="#4-æ ‘å½¢dp" class="headerlink" title="4.æ ‘å½¢dp"></a>4.æ ‘å½¢dp</h4><ul><li>åœ¨æ ‘çš„ç»“æ„ä¸Šæ±‚è§£é—®é¢˜ï¼Œå¤§éƒ¨åˆ†å¯ä»¥ç›´æ¥ç”¨é€’å½’+è®°å¿†åŒ–è§£å†³</li><li>å¦‚æœæœ‰æ˜æ˜¾çš„é€’æ¨å…³ç³»ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨é€’æ¨+é€’å½’ ç›´æ¥æ¶ˆé™¤å­é—®é¢˜åŒºé—´çš„é‡å¤è®¡ç®— å³æ ‘å½¢dp</li><li>å¦‚ï¼š</li></ul><ol><li><a href="https://leetcode-cn.com/problems/house-robber-iii/" target="_blank" rel="noopener">æ‰“å®¶åŠ«èˆ III</a></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">public int rob(TreeNode root) &#123;</span><br><span class="line">    int[] res = dfs(root);</span><br><span class="line">    return Math.max(res[0],res[1]);</span><br><span class="line">&#125;</span><br><span class="line">//0 ä»£è¡¨ä¸å·ï¼Œ1 ä»£è¡¨å·</span><br><span class="line">public int[] dfs(TreeNode root) &#123;</span><br><span class="line">    if(root == null) return new int[]&#123;0,0&#125;;</span><br><span class="line">    int[] res = &#123;0,0&#125;;</span><br><span class="line">    int[] left = dfs(root.left);</span><br><span class="line">    int[] right = dfs(root.right);</span><br><span class="line">    res[0] = Math.max(left[0],left[1]) + Math.max(right[0],right[1]);</span><br><span class="line">    res[1] = left[0] + right[0] + root.val;</span><br><span class="line">    return res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="5-çŠ¶å‹dp"><a href="#5-çŠ¶å‹dp" class="headerlink" title="5.çŠ¶å‹dp"></a>5.çŠ¶å‹dp</h4><h5 id="1-å¯¹äºnä¸ªå…ƒç´ é€‰ä¸ä¸é€‰2ç§çŠ¶æ€çš„é—®é¢˜ï¼ˆä½è¿ç®—ï¼‰"><a href="#1-å¯¹äºnä¸ªå…ƒç´ é€‰ä¸ä¸é€‰2ç§çŠ¶æ€çš„é—®é¢˜ï¼ˆä½è¿ç®—ï¼‰" class="headerlink" title="1. å¯¹äºnä¸ªå…ƒç´ é€‰ä¸ä¸é€‰2ç§çŠ¶æ€çš„é—®é¢˜ï¼ˆä½è¿ç®—ï¼‰"></a>1. å¯¹äºnä¸ªå…ƒç´ é€‰ä¸ä¸é€‰2ç§çŠ¶æ€çš„é—®é¢˜ï¼ˆä½è¿ç®—ï¼‰</h5><ul><li>ç”¨2^nè¡¨ç¤ºæ‰€æœ‰çŠ¶æ€ï¼Œç¬¬iä½çš„çŠ¶æ€ å¯¹åº”äºŒè¿›åˆ¶æ•° ç¬¬iä½æ˜¯0 è¿˜æ˜¯1</li></ul><p><img alt data-src="https://pic.downk.cc/item/5eb22c30c2a9a83be5b29bae.png" class="lazyload"></p><h5 id="2-å¯¹äºnä¸ªå…ƒç´ kç§çŠ¶æ€çš„é—®é¢˜ï¼ˆå¹‚è¿ç®—æˆ–ç´¯ä¹˜ï¼‰"><a href="#2-å¯¹äºnä¸ªå…ƒç´ kç§çŠ¶æ€çš„é—®é¢˜ï¼ˆå¹‚è¿ç®—æˆ–ç´¯ä¹˜ï¼‰" class="headerlink" title="2. å¯¹äºnä¸ªå…ƒç´ kç§çŠ¶æ€çš„é—®é¢˜ï¼ˆå¹‚è¿ç®—æˆ–ç´¯ä¹˜ï¼‰"></a>2. å¯¹äºnä¸ªå…ƒç´ kç§çŠ¶æ€çš„é—®é¢˜ï¼ˆå¹‚è¿ç®—æˆ–ç´¯ä¹˜ï¼‰</h5><ul><li>1.å¦‚æœæ¯ç§ç‰©å“é€‰æ‹©çš„æ•°é‡æ˜¯ç›¸åŒçš„ mç§çŠ¶æ€ï¼Œå¯ç”¨m^nè¡¨ç¤ºæ‰€æœ‰çŠ¶æ€</li></ul><p><img alt data-src="https://pic.downk.cc/item/5eb22c30c2a9a83be5b29bae.png" class="lazyload"></p><ul><li>2.å¦‚æœæ¯ç§ç‰©å“çš„é€‰æ‹©æ•°é‡ä¸åŒ<br>ï¼š æ— è®ºå¦‚ä½•éƒ½è¦è®©æ¯ä¸€ç§çŠ¶æ€ä¸ä¸€ä¸ªæ•°å­—ä¸€ä¸€å¯¹åº”</li></ul><ul><li>å¦‚ï¼š</li></ul><ol><li><a href="https://leetcode-cn.com/problems/beautiful-arrangement/" target="_blank" rel="noopener">526. ä¼˜ç¾çš„æ’åˆ—</a></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">public int countArrangement(int N) &#123;</span><br><span class="line">    int dp[]=new int[1&lt;&lt;N];</span><br><span class="line">    dp[0]=1;</span><br><span class="line">    for(int i=0;i&lt;dp.length;i++)&#123;</span><br><span class="line">        int len=1;</span><br><span class="line">        for(int j=0;j&lt;N;j++)</span><br><span class="line">            len+=i&gt;&gt;j&amp;1;</span><br><span class="line">        for(int j=1;j&lt;=N;j++)&#123;</span><br><span class="line">            if((i &gt;&gt; (j - 1) &amp; 1)==0&amp;&amp; (j % len == 0 || len % j == 0)) &#123;</span><br><span class="line">                dp[i | (1 &lt;&lt; j - 1)] += dp[i];   // æˆ–è¿ç®—ï¼Œè¿›è¡ŒçŠ¶æ€è½¬ç§»</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return dp[(1&lt;&lt;N)-1];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="6-æ•°ä½-DP"><a href="#6-æ•°ä½-DP" class="headerlink" title="6.æ•°ä½ DP"></a>6.æ•°ä½ DP</h4><ul><li>ç»™å®šä¸€ä¸ªé—­åŒºé—´[l,r]ï¼Œæ±‚è¿™ä¸ªåŒºé—´ä¸­æ»¡è¶³æŸç§æ¡ä»¶çš„æ•°çš„æ€»é‡</li></ul><h4 id="7-è®¡æ•°å‹-DP"><a href="#7-è®¡æ•°å‹-DP" class="headerlink" title="7.è®¡æ•°å‹ DP"></a>7.è®¡æ•°å‹ DP</h4><ul><li><p>è®¡æ•°å‹DPéƒ½å¯ä»¥ä»¥ç»„åˆæ•°å­¦çš„æ–¹æ³•å†™å‡ºç»„åˆæ•°ï¼Œç„¶ådpæ±‚ç»„åˆæ•°</p></li><li><p>å¦‚ï¼š</p></li></ul><p><a href="https://leetcode-cn.com/problems/unique-paths/" target="_blank" rel="noopener">62. ä¸åŒè·¯å¾„ I</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public static int uniquePaths(int m, int n) &#123;</span><br><span class="line">    int[][] dp = new int[m+1][n+1];</span><br><span class="line">    dp[1][1] = 1;</span><br><span class="line">    for (int i = 1; i &lt;=m ; i++) &#123;</span><br><span class="line">        for (int j = 1; j &lt;=n ; j++) &#123;</span><br><span class="line">            dp[i][j] += dp[i-1][j] + dp[i][j-1];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return dp[m][n];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://leetcode-cn.com/problems/unique-paths-ii/" target="_blank" rel="noopener">63. ä¸åŒè·¯å¾„ II</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public int uniquePathsWithObstacles(int[][] grid) &#123;</span><br><span class="line">    int[][] dp = new int[grid.length+1][grid[0].length+1];</span><br><span class="line">    if(grid[0][0] == 1) return 0;</span><br><span class="line">    dp[1][1] = 1;</span><br><span class="line">    for (int i = 1; i &lt;=grid.length ; i++) &#123;</span><br><span class="line">        for (int j = 1; j &lt;=grid[0].length ; j++) &#123;</span><br><span class="line">            if(grid[i-1][j-1] == 0) dp[i][j] += dp[i-1][j] + dp[i][j-1];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return dp[grid.length][grid[0].length];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="8-é€’æ¨å‹-DP"><a href="#8-é€’æ¨å‹-DP" class="headerlink" title="8.é€’æ¨å‹ DP"></a>8.é€’æ¨å‹ DP</h4><ul><li><p>æ‰€æœ‰çº¿æ€§é€’æ¨å…³ç³»éƒ½å¯ä»¥ç”¨çŸ©é˜µå¿«é€Ÿå¹‚åšï¼Œå¯ä»¥O(logN)ï¼Œæœ€å…¸å‹æ˜¯æ–æ³¢é‚£å¥‘æ•°åˆ—</p></li><li><p>å¦‚ï¼š</p></li></ul><p><a href="https://leetcode-cn.com/problems/climbing-stairs/" target="_blank" rel="noopener">70. çˆ¬æ¥¼æ¢¯</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> public int climbStairs(int n) &#123;</span><br><span class="line">    int tmp = 0;</span><br><span class="line">    int a = 1;</span><br><span class="line">    int b = 2;</span><br><span class="line">    if(n == 1) tmp = 1;</span><br><span class="line">    if(n == 2) tmp = 2;    </span><br><span class="line">    for(int i=3;i&lt;=n;i++)&#123;</span><br><span class="line">        tmp = a+b;</span><br><span class="line">        a = b;</span><br><span class="line">        b = tmp;     </span><br><span class="line">    &#125;</span><br><span class="line">    return tmp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="9-æ¦‚ç‡å‹-DP"><a href="#9-æ¦‚ç‡å‹-DP" class="headerlink" title="9.æ¦‚ç‡å‹ DP"></a>9.æ¦‚ç‡å‹ DP</h4><ul><li><p>ç»™å®šä¸€äº›çš„äº‹ä»¶åŠå…¶å‘ç”Ÿçš„æ¦‚ç‡é—®åœ¨æŸä¸ªæ¡ä»¶ä¸‹å‘ç”Ÿçš„æ¦‚ç‡ ä¸”è¿™äº›äº‹ä»¶ä¹‹é—´æœ‰é€’æ¨å…³ç³»</p></li><li><p>çœ‹ä¼¼å¯ä»¥ç”¨dfsä¹Ÿèƒ½ç”¨dpï¼Œä½†è¦æ³¨æ„æ¦‚ç‡å‹é—®é¢˜éƒ½æœ‰ä¸€ä¸ªç²¾åº¦è¾¹ç•Œ</p></li></ul><ul><li>å¦‚ï¼š</li></ul><p><a href="https://leetcode-cn.com/problems/soup-servings/" target="_blank" rel="noopener">808. åˆ†æ±¤</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">public double soupServings(int N) &#123;</span><br><span class="line">    if(N&gt;=4800) return 1.0;</span><br><span class="line">    int n = (int) Math.ceil(N/25.0);</span><br><span class="line">    double[][] dp = new double[n+1][n+1];</span><br><span class="line">    dp[0][0] = 0.5;</span><br><span class="line">    for (int i = 1; i &lt;= n ; i++) &#123;</span><br><span class="line">        dp[i][0] = 0;</span><br><span class="line">        dp[0][i] = 1;</span><br><span class="line">    &#125;</span><br><span class="line">    for (int i = 1; i &lt;= n; ++i)&#123;</span><br><span class="line">        int a1 = i - 4 &gt; 0 ? i - 4 : 0;//ä¸è¶³4ï¼ŒæŒ‰4ç®—ï¼ˆå®é™…ä¸Šæ˜¯ä¸è¶³100ï¼ŒæŒ‰100ç®—ï¼Œç„¶ååˆ†é…å®Œäº†ï¼Œæ²¡æœ‰å‰©ä½™ï¼‰</span><br><span class="line">        int a2 = i - 3 &gt; 0 ? i - 3 : 0;//ä¸è¶³3ï¼ŒæŒ‰3ç®—ï¼ˆå®é™…ä¸Šæ˜¯ä¸è¶³75ï¼ŒæŒ‰75ç®—ï¼Œç„¶ååˆ†é…å®Œäº†ï¼Œæ²¡æœ‰å‰©ä½™ï¼‰</span><br><span class="line">        int a3 = i - 2 &gt; 0 ? i - 2 : 0;//ä¸è¶³2ï¼ŒæŒ‰2ç®—ï¼ˆå®é™…ä¸Šæ˜¯ä¸è¶³50ï¼ŒæŒ‰75ç®—ï¼Œç„¶ååˆ†é…å®Œäº†ï¼Œæ²¡æœ‰å‰©ä½™ï¼‰</span><br><span class="line">        int a4 = i - 1 &gt; 0 ? i - 1 : 0;//ä¸è¶³1ï¼ŒæŒ‰1ç®—ï¼ˆå®é™…ä¸Šæ˜¯ä¸è¶³25ï¼ŒæŒ‰25ç®—ï¼Œç„¶ååˆ†é…å®Œäº†ï¼Œæ²¡æœ‰å‰©ä½™ï¼‰</span><br><span class="line">        for(int j = 1; j &lt;= n; ++j) &#123;</span><br><span class="line">            int b1 = j;</span><br><span class="line">            int b2 = j - 1 &gt; 0 ? j - 1 : 0;//ä¸è¶³1ï¼ŒæŒ‰1ç®—ï¼ˆå®é™…ä¸Šæ˜¯ä¸è¶³25ï¼ŒæŒ‰25ç®—ï¼Œç„¶ååˆ†é…å®Œäº†ï¼Œæ²¡æœ‰å‰©ä½™ï¼‰</span><br><span class="line">            int b3 = j - 2 &gt; 0 ? j - 2 : 0;//ä¸è¶³2ï¼ŒæŒ‰2ç®—ï¼ˆå®é™…ä¸Šæ˜¯ä¸è¶³50ï¼ŒæŒ‰75ç®—ï¼Œç„¶ååˆ†é…å®Œäº†ï¼Œæ²¡æœ‰å‰©ä½™ï¼‰</span><br><span class="line">            int b4 = j - 3 &gt; 0 ? j - 3 : 0;//ä¸è¶³3ï¼ŒæŒ‰3ç®—ï¼ˆå®é™…ä¸Šæ˜¯ä¸è¶³75ï¼ŒæŒ‰75ç®—ï¼Œç„¶ååˆ†é…å®Œäº†ï¼Œæ²¡æœ‰å‰©ä½™ï¼‰</span><br><span class="line">            //çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼šdp[i][j] = 0.25 * (dp[i-100][j] + dp[i-75][j-25] + dp[i-50][j-50] + dp[i-75][j-25])</span><br><span class="line">            //å°†Nç¼©å°ä¸ºåŸæ¥çš„25åˆ†ä¹‹ä¸€çš„è½¬ç§»æ–¹ç¨‹ï¼šdp[i][j] = 0.25 * (dp[i-4][j] + dp[i-3][j-1] + dp[i-2][j-2] + dp[i-3][j-1])</span><br><span class="line">            dp[i][j]= 0.25 * (dp[a1][b1] + dp[a2][b2] + dp[a3][b3] + dp[a4][b4]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return dp[n][n];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>dfsè§£æ³•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">static Map&lt;String,Double&gt; map;</span><br><span class="line">public double soupServings(int N) &#123;</span><br><span class="line">    if(N&gt;=4800) return 1;</span><br><span class="line">    map = new HashMap&lt;&gt;();</span><br><span class="line">    int n = (int) Math.ceil(N/25.0);</span><br><span class="line">    return dfs(n,n);</span><br><span class="line">&#125;</span><br><span class="line">public static double dfs(int i,int j)&#123;</span><br><span class="line">    if(i&lt;=0 &amp;&amp; j&lt;=0) return 0.5;</span><br><span class="line">    else if(i&lt;=0 &amp;&amp; j&gt;0) return 1;</span><br><span class="line">    else if(i&gt;0 &amp;&amp; j&lt;=0) return 0;</span><br><span class="line">    else if(map.containsKey(i + &quot; &quot; + j)) return map.get(i + &quot; &quot; + j);</span><br><span class="line">    else&#123;</span><br><span class="line">        double sum = 0.25*(dfs(i-4,j)+dfs(i-3,j-1)+</span><br><span class="line">                dfs(i-2,j-2)+dfs(i-1,j-3));</span><br><span class="line">        map.put(i + &quot; &quot; + j,sum);</span><br><span class="line">        return sum;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://leetcode-cn.com/problems/new-21-game/" target="_blank" rel="noopener">837. æ–°21ç‚¹</a><br>åå‘é€’æ¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public double new21Game(int N, int K, int W) &#123;</span><br><span class="line">    double[] dp = new double[N+W+1];</span><br><span class="line">    for (int i = K; i &lt;=N ; i++) dp[i] = 1;</span><br><span class="line">    double sum = 0;</span><br><span class="line">    for (int i = 0; i &lt;W ; i++) sum += dp[K+i];</span><br><span class="line">    for (int i = K-1; i &gt;=0 ; i--) &#123;</span><br><span class="line">        dp[i] = sum/W;</span><br><span class="line">        sum += dp[i] - dp[i+W];</span><br><span class="line">    &#125;</span><br><span class="line">    return dp[0];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åé¢å¾…æ›´æ–°â€¦.</p>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åŠ¨æ€è§„åˆ’ </tag>
            
            <tag> DP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å›æº¯æ¨¡æ¿</title>
      <link href="/2020/04/25/%E5%9B%9E%E6%BA%AF%E6%A8%A1%E6%9D%BF/"/>
      <url>/2020/04/25/%E5%9B%9E%E6%BA%AF%E6%A8%A1%E6%9D%BF/</url>
      
        <content type="html"><![CDATA[<h2 id="å›æº¯"><a href="#å›æº¯" class="headerlink" title="å›æº¯"></a>å›æº¯</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">result = []</span><br><span class="line">def backtrack(è·¯å¾„, é€‰æ‹©åˆ—è¡¨):</span><br><span class="line">    if æ»¡è¶³ç»“æŸæ¡ä»¶:</span><br><span class="line">        result.add(è·¯å¾„)</span><br><span class="line">        return</span><br><span class="line">    </span><br><span class="line">    for é€‰æ‹© in é€‰æ‹©åˆ—è¡¨:</span><br><span class="line">        åšé€‰æ‹©</span><br><span class="line">        backtrack(è·¯å¾„, é€‰æ‹©åˆ—è¡¨)</span><br><span class="line">        æ’¤é”€é€‰æ‹©</span><br></pre></td></tr></table></figure><p>å¦‚LeetCodeç¬¬46é¢˜ï¼Œ<a href="https://leetcode-cn.com/problems/permutations/comments/" target="_blank" rel="noopener">å…¨æ’åˆ—</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">static List&lt;List&lt;Integer&gt;&gt; res;</span><br><span class="line">public List&lt;List&lt;Integer&gt;&gt; permute(int[] nums) &#123;</span><br><span class="line">    res = new ArrayList&lt;&gt;();</span><br><span class="line">    dfs(nums,new ArrayList&lt;&gt;(),new boolean[nums.length]);</span><br><span class="line">    return res;</span><br><span class="line">&#125;</span><br><span class="line">public static void dfs(int[] nums,List&lt;Integer&gt; tmp,boolean[] visd)&#123;</span><br><span class="line">    if(tmp.size()== nums.length) &#123;</span><br><span class="line">        res.add(new ArrayList&lt;&gt;(tmp));</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line">    for (int i = 0; i &lt;nums.length ; i++) &#123;</span><br><span class="line">        if(visd[i]) continue;</span><br><span class="line">        visd[i] = true;     // æ ‡è®° å»é‡</span><br><span class="line">        tmp.add(nums[i]);</span><br><span class="line">        dfs(nums,tmp,visd);</span><br><span class="line">        visd[i] = false;    // è§£é™¤æ ‡è®°ï¼Œæ¢å¤ç°åœº</span><br><span class="line">        tmp.remove(tmp.size()-1);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
            <tag> å›æº¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Springbootå®šæ—¶ä»»åŠ¡@Scheduled</title>
      <link href="/2019/12/26/Springboot%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1-Scheduled/"/>
      <url>/2019/12/26/Springboot%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1-Scheduled/</url>
      
        <content type="html"><![CDATA[<h2 id="Springbootå®šæ—¶ä»»åŠ¡-Scheduled"><a href="#Springbootå®šæ—¶ä»»åŠ¡-Scheduled" class="headerlink" title="Springbootå®šæ—¶ä»»åŠ¡@Scheduled"></a>Springbootå®šæ—¶ä»»åŠ¡@Scheduled</h2><ul><li>é¡¹ç›®å¼€å‘ä¸­ç»å¸¸éœ€è¦æ‰§è¡Œä¸€äº›å®šæ—¶ä»»åŠ¡ï¼Œæ¯”å¦‚åœ¨æ¯å¤©å‡Œæ™¨ï¼Œéœ€è¦æ±‡æ€»åˆ†æå¤„ç†ä¸€äº›æ•°æ® åå­˜å…¥åˆ° MySQL æ•°æ®åº“ä¸­ã€‚</li></ul><h3 id="Java-å®šæ—¶ä»»åŠ¡çš„å‡ ç§å®ç°æ–¹å¼"><a href="#Java-å®šæ—¶ä»»åŠ¡çš„å‡ ç§å®ç°æ–¹å¼" class="headerlink" title="Java å®šæ—¶ä»»åŠ¡çš„å‡ ç§å®ç°æ–¹å¼"></a>Java å®šæ—¶ä»»åŠ¡çš„å‡ ç§å®ç°æ–¹å¼</h3><ul><li>åŸºäº java.util.Timer å®šæ—¶å™¨ï¼Œå®ç°ç±»ä¼¼é—¹é’Ÿçš„å®šæ—¶ä»»åŠ¡</li><li>ä½¿ç”¨ Quartzã€elastic-jobã€xxl-job ç­‰å¼€æºç¬¬ä¸‰æ–¹å®šæ—¶ä»»åŠ¡æ¡†æ¶ï¼Œé€‚åˆåˆ†å¸ƒå¼é¡¹ç›®åº”ç”¨</li><li>ä½¿ç”¨ Spring æä¾›çš„ä¸€ä¸ªæ³¨è§£ï¼š @Scheduleï¼Œå¼€å‘ç®€å•ï¼Œä½¿ç”¨æ¯”è¾ƒæ–¹ä¾¿ï¼Œä¹Ÿæ˜¯æœ¬æ–‡ä»‹ç»çš„ä¸€ç§æ–¹å¼</li></ul><h3 id="åˆ›å»ºå®šæ—¶ä»»åŠ¡"><a href="#åˆ›å»ºå®šæ—¶ä»»åŠ¡" class="headerlink" title="åˆ›å»ºå®šæ—¶ä»»åŠ¡"></a>åˆ›å»ºå®šæ—¶ä»»åŠ¡</h3><ol><li>é¦–å…ˆï¼Œåœ¨é¡¹ç›®å¯åŠ¨ç±»ä¸Šæ·»åŠ  @EnableScheduling æ³¨è§£ï¼Œå¼€å¯å¯¹å®šæ—¶ä»»åŠ¡çš„æ”¯æŒ</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@SpringBootApplication</span><br><span class="line">@EnableScheduling</span><br><span class="line">public class ScheduledApplication &#123;</span><br><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">SpringApplication.run(ScheduledApplication.class, args);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>å…¶æ¬¡ï¼Œç¼–å†™å®šæ—¶ä»»åŠ¡ç±»å’Œæ–¹æ³•ï¼Œå®šæ—¶ä»»åŠ¡ç±»é€šè¿‡ Spring IOC åŠ è½½ï¼Œä½¿ç”¨ @Component æ³¨è§£ï¼Œå®šæ—¶æ–¹æ³•ä½¿ç”¨ @Scheduled æ³¨è§£ã€‚</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@Component</span><br><span class="line">public class ScheduledTask &#123;</span><br><span class="line">    @Scheduled(fixedRate = 3000)</span><br><span class="line">    public void scheduledTask() &#123;</span><br><span class="line">        System.out.println(&quot;ä»»åŠ¡æ‰§è¡Œæ—¶é—´ï¼š&quot; + LocalDateTime.now());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>fixedRate æ˜¯ long ç±»å‹ï¼Œè¡¨ç¤ºä»»åŠ¡æ‰§è¡Œçš„é—´éš”æ¯«ç§’æ•°ï¼Œä»¥ä¸Šä»£ç ä¸­çš„å®šæ—¶ä»»åŠ¡æ¯ 3 ç§’æ‰§è¡Œä¸€æ¬¡ã€‚</li></ul><h3 id="Scheduledè¯¦è§£"><a href="#Scheduledè¯¦è§£" class="headerlink" title="@Scheduledè¯¦è§£"></a>@Scheduledè¯¦è§£</h3><p>åœ¨ä¸Šé¢çš„å…¥é—¨ä¾‹å­ä¸­ï¼Œä½¿ç”¨äº†@Scheduled(fixedRate = 3000) æ³¨è§£æ¥å®šä¹‰æ¯è¿‡ 3 ç§’æ‰§è¡Œçš„ä»»åŠ¡ï¼Œå¯¹äº @Scheduled çš„ä½¿ç”¨å¯ä»¥æ€»ç»“å¦‚ä¸‹å‡ ç§æ–¹å¼ï¼š</p><ul><li>@Scheduled(fixedRate = 3000) ï¼šä¸Šä¸€æ¬¡å¼€å§‹æ‰§è¡Œæ—¶é—´ç‚¹ä¹‹å 3 ç§’å†æ‰§è¡Œï¼ˆfixedRate å±æ€§ï¼šå®šæ—¶ä»»åŠ¡å¼€å§‹åå†æ¬¡æ‰§è¡Œå®šæ—¶ä»»åŠ¡çš„å»¶æ—¶ï¼ˆéœ€ç­‰å¾…ä¸Šæ¬¡å®šæ—¶ä»»åŠ¡å®Œæˆï¼‰ï¼Œå•ä½æ¯«ç§’ï¼‰</li><li>@Scheduled(fixedDelay = 3000) ï¼šä¸Šä¸€æ¬¡æ‰§è¡Œå®Œæ¯•æ—¶é—´ç‚¹ä¹‹å 3 ç§’å†æ‰§è¡Œï¼ˆfixedDelay å±æ€§ï¼šå®šæ—¶ä»»åŠ¡æ‰§è¡Œå®Œæˆåå†æ¬¡æ‰§è¡Œå®šæ—¶ä»»åŠ¡çš„å»¶æ—¶ï¼ˆéœ€ç­‰å¾…ä¸Šæ¬¡å®šæ—¶ä»»åŠ¡å®Œæˆï¼‰ï¼Œå•ä½æ¯«ç§’ï¼‰</li><li>@Scheduled(initialDelay = 1000, fixedRate = 3000) ï¼šç¬¬ä¸€æ¬¡å»¶è¿Ÿ1ç§’åæ‰§è¡Œï¼Œä¹‹åæŒ‰fixedRateçš„è§„åˆ™æ¯ 3 ç§’æ‰§è¡Œä¸€æ¬¡ï¼ˆinitialDelay å±æ€§ï¼šç¬¬ä¸€æ¬¡æ‰§è¡Œå®šæ—¶ä»»åŠ¡çš„å»¶è¿Ÿæ—¶é—´ï¼Œéœ€é…åˆfixedDelayæˆ–è€…fixedRateæ¥ä½¿ç”¨ï¼‰</li><li>@Scheduled(cron=â€0 0 2 1 * ? *â€) ï¼šé€šè¿‡cronè¡¨è¾¾å¼å®šä¹‰è§„åˆ™</li></ul><p>å…¶ä¸­ï¼Œå¸¸ç”¨çš„cronè¡¨è¾¾å¼æœ‰ï¼š</p><ul><li>0 0 2 1 * ? * ï¼šè¡¨ç¤ºåœ¨æ¯æœˆ 1 æ—¥çš„å‡Œæ™¨ 2 ç‚¹æ‰§è¡Œ</li><li>0 15 10 ? * MON-FRI ï¼šè¡¨ç¤ºå‘¨ä¸€åˆ°å‘¨äº”æ¯å¤©ä¸Šåˆ 10:15 æ‰§è¡Œ</li><li>0 15 10 ? 6L 2019-2020 ï¼šè¡¨ç¤º 2019-2020 å¹´çš„æ¯ä¸ªæœˆçš„æœ€åä¸€ä¸ªæ˜ŸæœŸäº”ä¸Šåˆ 10:15 æ‰§è¡Œ</li><li>0 0 10,14,16 * * ? ï¼šæ¯å¤©ä¸Šåˆ 10 ç‚¹ï¼Œä¸‹åˆ 2 ç‚¹ï¼Œ4 ç‚¹æ‰§è¡Œ</li><li>0 0/30 9-17 * * ? ï¼šæœä¹æ™šäº”å·¥ä½œæ—¶é—´å†…æ¯åŠå°æ—¶æ‰§è¡Œ</li><li>0 0 12 ? * WED ï¼šè¡¨ç¤ºæ¯ä¸ªæ˜ŸæœŸä¸‰ä¸­åˆ 12 ç‚¹æ‰§è¡Œ</li><li>0 0 12 * * ? ï¼šæ¯å¤©ä¸­åˆ 12ç‚¹æ‰§è¡Œ</li><li>0 15 10 ? * * ï¼šæ¯å¤©ä¸Šåˆ 10:15 æ‰§è¡Œ</li><li>0 15 10 * * ? ï¼šæ¯å¤©ä¸Šåˆ 10:15 æ‰§è¡Œ</li><li>0 15 10 * * ? * ï¼šæ¯å¤©ä¸Šåˆ 10:15 æ‰§è¡Œ</li><li>0 15 10 * * ? 2019 ï¼š2019 å¹´çš„æ¯å¤©ä¸Šåˆ 10:15 æ‰§è¡Œ</li></ul><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>æœ¬æ–‡ä¸»è¦ä»‹ç»äº†åŸºäº Spring Boot å†…ç½®çš„å®šæ—¶ä»»åŠ¡çš„é…ç½®ä½¿ç”¨ï¼Œä¸»è¦æ¶‰åŠä¸¤ä¸ªæ³¨è§£ï¼Œå››ä¸ªå±æ€§çš„é…ç½®ï¼š</p><ul><li>ä¸»ç¨‹åºå…¥å£ @EnableScheduling å¼€å¯å®šæ—¶ä»»åŠ¡</li><li>å®šæ—¶æ–¹æ³•ä¸Š @Scheduled è®¾ç½®å®šæ—¶</li><li>cronå±æ€§ï¼šæŒ‰cronè§„åˆ™æ‰§è¡Œ</li><li>fixedRate å±æ€§ï¼šä»¥å›ºå®šé€Ÿç‡æ‰§è¡Œ</li><li>fixedDelay å±æ€§ï¼šä¸Šæ¬¡æ‰§è¡Œå®Œæ¯•åå»¶è¿Ÿå†æ‰§è¡Œ</li><li>initialDelay å±æ€§ï¼šç¬¬ä¸€æ¬¡å»¶æ—¶æ‰§è¡Œï¼Œç¬¬ä¸€æ¬¡æ‰§è¡Œå®Œæ¯•åå»¶è¿Ÿåå†æ¬¡æ‰§è¡Œ</li></ul>]]></content>
      
      
      <categories>
          
          <category> Java web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®šæ—¶ä»»åŠ¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Springbootæ•´åˆå¼‚æ­¥é‚®ä»¶æœåŠ¡</title>
      <link href="/2019/12/26/Springboot%E6%95%B4%E5%90%88%E5%BC%82%E6%AD%A5%E9%82%AE%E4%BB%B6%E6%9C%8D%E5%8A%A1/"/>
      <url>/2019/12/26/Springboot%E6%95%B4%E5%90%88%E5%BC%82%E6%AD%A5%E9%82%AE%E4%BB%B6%E6%9C%8D%E5%8A%A1/</url>
      
        <content type="html"><![CDATA[<h2 id="Springbootæ•´åˆå¼‚æ­¥é‚®ä»¶æœåŠ¡"><a href="#Springbootæ•´åˆå¼‚æ­¥é‚®ä»¶æœåŠ¡" class="headerlink" title="Springbootæ•´åˆå¼‚æ­¥é‚®ä»¶æœåŠ¡"></a>Springbootæ•´åˆå¼‚æ­¥é‚®ä»¶æœåŠ¡</h2><ul><li>åœ¨å¾ˆå¤šåœºæ™¯éƒ½éœ€è¦ä½¿ç”¨åˆ°ç”¨æˆ·å’Œç³»ç»Ÿçš„å…¶ä»–äº¤äº’å¦‚ï¼šéªŒè¯ç ã€‚ã€‚ã€‚æ­¤æ—¶å¯ä»¥é€‰æ‹©çŸ­ä¿¡æˆ–è€…é‚®ä»¶çš„å½¢å¼ï¼Œä½†æ˜¯çŸ­ä¿¡ä¸šåŠ¡éœ€è¦æ”¶è´¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±è¿‘é€‰æ‹©é‚®ä»¶æœåŠ¡</li></ul><h3 id="1-å¯¼å…¥ä¾èµ–"><a href="#1-å¯¼å…¥ä¾èµ–" class="headerlink" title="1.å¯¼å…¥ä¾èµ–"></a>1.å¯¼å…¥ä¾èµ–</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--spring boot mail é›†æˆjar--&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-mail&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><h3 id="2-é…ç½®é‚®ä»¶æœåŠ¡"><a href="#2-é…ç½®é‚®ä»¶æœåŠ¡" class="headerlink" title="2.é…ç½®é‚®ä»¶æœåŠ¡"></a>2.é…ç½®é‚®ä»¶æœåŠ¡</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"># é‚®ä»¶è®¾ç½®</span><br><span class="line">spring:</span><br><span class="line">  mail:</span><br><span class="line">    host: smtp.qq.com</span><br><span class="line">    username: 1447250889@qq.com # é‚®ç®±è´¦å·</span><br><span class="line">    password: dsadadasdada    # æˆæƒç ï¼ˆåœ¨é‚®ç®±å¼€å¯pop3å’Œsmtpåä¼šç»™ä½ ï¼‰</span><br><span class="line">    properties:</span><br><span class="line">      mail:</span><br><span class="line">        smtp:</span><br><span class="line">          auth: true</span><br><span class="line">          starttls:</span><br><span class="line">            enable: true</span><br><span class="line">            required: true</span><br><span class="line"># é‚®ç®±ä¿¡æ¯</span><br><span class="line">mail:</span><br><span class="line">  fromMail:</span><br><span class="line">    addr: 1447250889@qq.com</span><br></pre></td></tr></table></figure><h3 id="3-é‚®ç®±å·¥å…·ç±»"><a href="#3-é‚®ç®±å·¥å…·ç±»" class="headerlink" title="3.é‚®ç®±å·¥å…·ç±»"></a>3.é‚®ç®±å·¥å…·ç±»</h3><ul><li>æä¾›å„ç§é‚®ä»¶æœåŠ¡ï¼šçº¯æ–‡æœ¬é‚®ä»¶ï¼Œhtmlé‚®ä»¶â€¦</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br></pre></td><td class="code"><pre><span class="line">package kid1999.upload.utils;</span><br><span class="line"></span><br><span class="line">import lombok.extern.slf4j.Slf4j;</span><br><span class="line">import org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line">import org.springframework.beans.factory.annotation.Value;</span><br><span class="line">import org.springframework.context.annotation.EnableAspectJAutoProxy;</span><br><span class="line">import org.springframework.core.io.FileSystemResource;</span><br><span class="line">import org.springframework.mail.SimpleMailMessage;</span><br><span class="line">import org.springframework.mail.javamail.JavaMailSender;</span><br><span class="line">import org.springframework.mail.javamail.MimeMessageHelper;</span><br><span class="line">import org.springframework.scheduling.annotation.Async;</span><br><span class="line">import org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line">import javax.mail.MessagingException;</span><br><span class="line">import javax.mail.internet.MimeMessage;</span><br><span class="line">import java.io.File;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @author kid1999</span><br><span class="line"> * @title: MailUtil</span><br><span class="line"> * @date 2019/12/22 15:32</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">@Service</span><br><span class="line">@Slf4j</span><br><span class="line">public class MailUtil &#123;</span><br><span class="line"></span><br><span class="line">@Autowired</span><br><span class="line">private JavaMailSender mailSender;</span><br><span class="line"></span><br><span class="line">// æ³¨å…¥å¸¸é‡</span><br><span class="line">@Value(&quot;$&#123;mail.fromMail.addr&#125;&quot;)</span><br><span class="line">private String from;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * å‘é€æ–‡æœ¬é‚®ä»¶</span><br><span class="line"> * @param toAddr</span><br><span class="line"> * @param title</span><br><span class="line"> * @param content</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">@Async(&quot;taskExecutor&quot;)</span><br><span class="line">public void sendTextMail(String toAddr, String title, String content) &#123;</span><br><span class="line">// çº¯æ–‡æœ¬é‚®ä»¶å¯¹è±¡</span><br><span class="line">SimpleMailMessage message = new SimpleMailMessage();</span><br><span class="line">message.setFrom(from);</span><br><span class="line">message.setTo(toAddr);</span><br><span class="line">message.setSubject(title);</span><br><span class="line">message.setText(content);</span><br><span class="line"></span><br><span class="line">try &#123;</span><br><span class="line">mailSender.send(message);</span><br><span class="line">log.info(&quot;Texté‚®ä»¶å·²ç»å‘é€ã€‚&quot;);</span><br><span class="line">&#125; catch (Exception e) &#123;</span><br><span class="line">log.error(&quot;å‘é€Texté‚®ä»¶æ—¶å‘ç”Ÿå¼‚å¸¸ï¼&quot;, e);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * å‘é€htmlé‚®ä»¶</span><br><span class="line"> * @param toAddr</span><br><span class="line"> * @param title</span><br><span class="line"> * @param content</span><br><span class="line"> */</span><br><span class="line">@Async(&quot;taskExecutor&quot;)</span><br><span class="line">public void sendHtmlMail(String toAddr, String title, String content) &#123;</span><br><span class="line">// html é‚®ä»¶å¯¹è±¡</span><br><span class="line">MimeMessage message = mailSender.createMimeMessage();</span><br><span class="line"></span><br><span class="line">try &#123;</span><br><span class="line">//trueè¡¨ç¤ºéœ€è¦åˆ›å»ºä¸€ä¸ªmultipart message</span><br><span class="line">MimeMessageHelper helper = new MimeMessageHelper(message, true);</span><br><span class="line">helper.setFrom(from);</span><br><span class="line">helper.setTo(toAddr);</span><br><span class="line">helper.setSubject(title);</span><br><span class="line">helper.setText(content, true);</span><br><span class="line"></span><br><span class="line">mailSender.send(message);</span><br><span class="line">log.info(&quot;htmlé‚®ä»¶å‘é€æˆåŠŸ&quot;);</span><br><span class="line">&#125; catch (MessagingException e) &#123;</span><br><span class="line">log.error(&quot;å‘é€htmlé‚®ä»¶æ—¶å‘ç”Ÿå¼‚å¸¸ï¼&quot;, e);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * å‘é€å¸¦é™„ä»¶çš„é‚®ä»¶</span><br><span class="line"> * @param toAddr</span><br><span class="line"> * @param title</span><br><span class="line"> * @param content</span><br><span class="line"> * @param filePath</span><br><span class="line"> */</span><br><span class="line">@Async(&quot;taskExecutor&quot;)</span><br><span class="line">public void sendAttachmentsMail(String toAddr, String title, String content, String filePath)&#123;</span><br><span class="line">MimeMessage message = mailSender.createMimeMessage();</span><br><span class="line"></span><br><span class="line">try &#123;</span><br><span class="line">MimeMessageHelper helper = new MimeMessageHelper(message, true);</span><br><span class="line">helper.setFrom(from);</span><br><span class="line">helper.setTo(toAddr);</span><br><span class="line">helper.setSubject(title);</span><br><span class="line">helper.setText(content, true);</span><br><span class="line"></span><br><span class="line">FileSystemResource file = new FileSystemResource(new File(filePath));</span><br><span class="line">String fileName = filePath.substring(filePath.lastIndexOf(File.separator));</span><br><span class="line">helper.addAttachment(fileName, file);</span><br><span class="line">//helper.addAttachment(&quot;test&quot;+fileName, file);</span><br><span class="line"></span><br><span class="line">mailSender.send(message);</span><br><span class="line">log.info(&quot;å¸¦é™„ä»¶çš„é‚®ä»¶å·²ç»å‘é€ã€‚&quot;);</span><br><span class="line">&#125; catch (MessagingException e) &#123;</span><br><span class="line">log.error(&quot;å‘é€å¸¦é™„ä»¶çš„é‚®ä»¶æ—¶å‘ç”Ÿå¼‚å¸¸ï¼&quot;, e);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * å‘é€æ­£æ–‡ä¸­æœ‰é™æ€èµ„æºï¼ˆå›¾ç‰‡ï¼‰çš„é‚®ä»¶</span><br><span class="line"> * @param toAddr</span><br><span class="line"> * @param title</span><br><span class="line"> * @param content</span><br><span class="line"> * @param rscPath</span><br><span class="line"> * @param rscId</span><br><span class="line"> */</span><br><span class="line">@Async(&quot;taskExecutor&quot;)</span><br><span class="line">public void sendInlineResourceMail(String toAddr, String title, String content, String rscPath, String rscId)&#123;</span><br><span class="line">MimeMessage message = mailSender.createMimeMessage();</span><br><span class="line"></span><br><span class="line">try &#123;</span><br><span class="line">MimeMessageHelper helper = new MimeMessageHelper(message, true);</span><br><span class="line">helper.setFrom(from);</span><br><span class="line">helper.setTo(toAddr);</span><br><span class="line">helper.setSubject(title);</span><br><span class="line">helper.setText(content, true);</span><br><span class="line"></span><br><span class="line">FileSystemResource res = new FileSystemResource(new File(rscPath));</span><br><span class="line">helper.addInline(rscId, res);</span><br><span class="line"></span><br><span class="line">mailSender.send(message);</span><br><span class="line">log.info(&quot;åµŒå…¥é™æ€èµ„æºçš„é‚®ä»¶å·²ç»å‘é€ã€‚&quot;);</span><br><span class="line">&#125; catch (MessagingException e) &#123;</span><br><span class="line">log.error(&quot;å‘é€åµŒå…¥é™æ€èµ„æºçš„é‚®ä»¶æ—¶å‘ç”Ÿå¼‚å¸¸ï¼&quot;, e);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * å‘é€é‚®ç®±éªŒè¯ç </span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">@Async(&quot;taskExecutor&quot;)</span><br><span class="line">public void sendMailCode(String toAddr, String title, String mailCode) &#123;</span><br><span class="line">log.info(&quot;å‘é€é‚®ç®±éªŒè¯ç &quot;);</span><br><span class="line">// html é‚®ä»¶å¯¹è±¡</span><br><span class="line">MimeMessage message = mailSender.createMimeMessage();</span><br><span class="line"></span><br><span class="line">String content=&quot;&lt;html&gt;\n&quot; +</span><br><span class="line">&quot;&lt;body&gt;\n&quot; +</span><br><span class="line">&quot;    &lt;h3&gt;ä½ çš„éªŒè¯ç æ˜¯ï¼š&quot;+ mailCode +&quot;&lt;/h3&gt;\n&quot; +</span><br><span class="line">&quot;&lt;/body&gt;\n&quot; +</span><br><span class="line">&quot;&lt;/html&gt;&quot;;</span><br><span class="line"></span><br><span class="line">try &#123;</span><br><span class="line">//trueè¡¨ç¤ºéœ€è¦åˆ›å»ºä¸€ä¸ªmultipart message</span><br><span class="line">MimeMessageHelper helper = new MimeMessageHelper(message, true);</span><br><span class="line">helper.setFrom(from);</span><br><span class="line">helper.setTo(toAddr);</span><br><span class="line">helper.setSubject(title);</span><br><span class="line">helper.setText(content, true);</span><br><span class="line">mailSender.send(message);</span><br><span class="line">log.info(&quot;htmlé‚®ä»¶å‘é€æˆåŠŸ&quot;);</span><br><span class="line">&#125; catch (MessagingException e) &#123;</span><br><span class="line">log.error(&quot;å‘é€htmlé‚®ä»¶æ—¶å‘ç”Ÿå¼‚å¸¸ï¼&quot;, e);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-å‘é€é‚®ä»¶ï¼š"><a href="#4-å‘é€é‚®ä»¶ï¼š" class="headerlink" title="4.å‘é€é‚®ä»¶ï¼š"></a>4.å‘é€é‚®ä»¶ï¼š</h3><ul><li>æœ¬å¤„ä»¥ç”³è¯·ä¿®æ”¹å¯†ç æ—¶ï¼Œéœ€è¦æ ¸å¯¹è´¦å·-é‚®ç®±ï¼Œç„¶åå‘é€éªŒè¯ç åˆ°é‚®ç®±</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">// å¡«å†™è¡¨å• ï¼ˆæ ¸å¯¹è´¦å·ï¼Œé‚®ç®±ï¼‰</span><br><span class="line">@PostMapping(&quot;/checktable&quot;)</span><br><span class="line">@ResponseBody</span><br><span class="line">Result checkTable(HttpServletRequest request,</span><br><span class="line">                  @RequestParam(value = &quot;name&quot;) String name,</span><br><span class="line">                  @RequestParam(value = &quot;email&quot;) String email,</span><br><span class="line">                  @RequestParam(value = &quot;code&quot;) String code)&#123;</span><br><span class="line">log.info(&quot;æ ¸å¯¹è´¦æˆ·ï¼Œé‚®ç®±&quot;);</span><br><span class="line">if(checkVerificationCode(code,request))&#123;</span><br><span class="line">if(name.equals(&quot;&quot;) || email.equals(&quot;&quot;))&#123;</span><br><span class="line">return Result.fail(400,&quot;ç”¨æˆ·åæˆ–é‚®ç®±ä¸èƒ½ä¸ºç©º&quot;);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">User user = userService.findUserByName(name);</span><br><span class="line">if( user == null)&#123;</span><br><span class="line">return Result.fail(400,&quot;ç”¨æˆ·åä¸å­˜åœ¨&quot;);</span><br><span class="line">&#125;</span><br><span class="line">if(!user.getEmail().equals(email))&#123;</span><br><span class="line">return Result.fail(400,&quot;ç”¨æˆ·ï¼Œé‚®ç®±ä¸åŒ¹é…&quot;);</span><br><span class="line">&#125;</span><br><span class="line">String mailCode = RandomUtil.randomString(6);</span><br><span class="line">mailUtil.sendMailCode(email,&quot;ä½ çš„éªŒè¯ç &quot;,mailCode);</span><br><span class="line">request.getSession().setAttribute(&quot;mailCode&quot;,mailCode);</span><br><span class="line">return Result.success(&quot;è¯·å¡«å†™é‚®ç®±éªŒè¯ç &quot;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">return Result.fail(400,&quot;éªŒè¯ç ä¸å¯¹&quot;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¼‚æ­¥äº‹ä»¶ä¼˜åŒ–"><a href="#å¼‚æ­¥äº‹ä»¶ä¼˜åŒ–" class="headerlink" title="å¼‚æ­¥äº‹ä»¶ä¼˜åŒ–"></a>å¼‚æ­¥äº‹ä»¶ä¼˜åŒ–</h2><ul><li>ç”±äºåŒæ­¥äº‹ä»¶ï¼Œå‘é€é‚®ä»¶çš„æ—¶é—´ä¼šå¾ˆé•¿ï¼Œå¦‚æœä½¿ç”¨åŒæ­¥ï¼Œå‰ç«¯ä¼šå¾—ä¸åˆ°è¿”å›ä¸€ç›´åœ¨ç­‰å¾…ï¼Œå½±å“å®¢æˆ·ä½“éªŒ</li><li>ä½¿ç”¨å¼‚æ­¥å³å¯ä¿®å¤è¿™ä¸ªé—®é¢˜</li></ul><h3 id="1-åœ¨springbootä¸­é…ç½®å¼‚æ­¥çº¿ç¨‹æ± "><a href="#1-åœ¨springbootä¸­é…ç½®å¼‚æ­¥çº¿ç¨‹æ± " class="headerlink" title="1.åœ¨springbootä¸­é…ç½®å¼‚æ­¥çº¿ç¨‹æ± "></a>1.åœ¨springbootä¸­é…ç½®å¼‚æ­¥çº¿ç¨‹æ± </h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">package kid1999.upload.config;</span><br><span class="line"></span><br><span class="line">import org.springframework.context.annotation.Bean;</span><br><span class="line">import org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor;</span><br><span class="line"></span><br><span class="line">import java.util.concurrent.Executor;</span><br><span class="line">import java.util.concurrent.ThreadPoolExecutor;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @author kid1999</span><br><span class="line"> * @title: TaskPoolConfig</span><br><span class="line"> * @date 2019/12/22 16:09</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">public class TaskPoolConfig &#123;</span><br><span class="line">@Bean(&quot;taskExecutor&quot;)</span><br><span class="line">public Executor taskExecutor () &#123;</span><br><span class="line">ThreadPoolTaskExecutor executor = new ThreadPoolTaskExecutor();</span><br><span class="line">// æ ¸å¿ƒçº¿ç¨‹æ•°10ï¼šçº¿ç¨‹æ± åˆ›å»ºæ—¶å€™åˆå§‹åŒ–çš„çº¿ç¨‹æ•°</span><br><span class="line">executor.setCorePoolSize(10);</span><br><span class="line">// æœ€å¤§çº¿ç¨‹æ•°20ï¼šçº¿ç¨‹æ± æœ€å¤§çš„çº¿ç¨‹æ•°ï¼Œåªæœ‰åœ¨ç¼“å†²é˜Ÿåˆ—æ»¡äº†ä¹‹åæ‰ä¼šç”³è¯·è¶…è¿‡æ ¸å¿ƒçº¿ç¨‹æ•°çš„çº¿ç¨‹</span><br><span class="line">executor.setMaxPoolSize(15);</span><br><span class="line">// ç¼“å†²é˜Ÿåˆ—200ï¼šç”¨æ¥ç¼“å†²æ‰§è¡Œä»»åŠ¡çš„é˜Ÿåˆ—</span><br><span class="line">executor.setQueueCapacity(200);</span><br><span class="line">// å…è®¸çº¿ç¨‹çš„ç©ºé—²æ—¶é—´60ç§’ï¼šå½“è¶…è¿‡äº†æ ¸å¿ƒçº¿ç¨‹æ•°ä¹‹å¤–çš„çº¿ç¨‹åœ¨ç©ºé—²æ—¶é—´åˆ°è¾¾ä¹‹åä¼šè¢«é”€æ¯</span><br><span class="line">executor.setKeepAliveSeconds(60);</span><br><span class="line">// çº¿ç¨‹æ± åçš„å‰ç¼€ï¼šè®¾ç½®å¥½äº†ä¹‹åå¯ä»¥æ–¹ä¾¿å®šä½å¤„ç†ä»»åŠ¡æ‰€åœ¨çš„çº¿ç¨‹æ± </span><br><span class="line">executor.setThreadNamePrefix(&quot;taskExecutor-&quot;);</span><br><span class="line">        /*</span><br><span class="line">        çº¿ç¨‹æ± å¯¹æ‹’ç»ä»»åŠ¡çš„å¤„ç†ç­–ç•¥ï¼šè¿™é‡Œé‡‡ç”¨äº†CallerRunsPolicyç­–ç•¥ï¼Œ</span><br><span class="line">        å½“çº¿ç¨‹æ± æ²¡æœ‰å¤„ç†èƒ½åŠ›çš„æ—¶å€™ï¼Œè¯¥ç­–ç•¥ä¼šç›´æ¥åœ¨ execute æ–¹æ³•çš„è°ƒç”¨çº¿ç¨‹ä¸­è¿è¡Œè¢«æ‹’ç»çš„ä»»åŠ¡ï¼›</span><br><span class="line">        å¦‚æœæ‰§è¡Œç¨‹åºå·²å…³é—­ï¼Œåˆ™ä¼šä¸¢å¼ƒè¯¥ä»»åŠ¡</span><br><span class="line">         */</span><br><span class="line">executor.setRejectedExecutionHandler(new ThreadPoolExecutor.CallerRunsPolicy());</span><br><span class="line">// è®¾ç½®çº¿ç¨‹æ± å…³é—­çš„æ—¶å€™ç­‰å¾…æ‰€æœ‰ä»»åŠ¡éƒ½å®Œæˆå†ç»§ç»­é”€æ¯å…¶ä»–çš„Bean</span><br><span class="line">executor.setWaitForTasksToCompleteOnShutdown(true);</span><br><span class="line">// è®¾ç½®çº¿ç¨‹æ± ä¸­ä»»åŠ¡çš„ç­‰å¾…æ—¶é—´ï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªæ—¶å€™è¿˜æ²¡æœ‰é”€æ¯å°±å¼ºåˆ¶é”€æ¯ï¼Œä»¥ç¡®ä¿åº”ç”¨æœ€åèƒ½å¤Ÿè¢«å…³é—­ï¼Œè€Œä¸æ˜¯é˜»å¡ä½ã€‚</span><br><span class="line">executor.setAwaitTerminationSeconds(600);</span><br><span class="line">return executor;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-åœ¨ç¨‹åºå…¥å£ç±»æ·»åŠ -EnableAsyncæ³¨è§£"><a href="#2-åœ¨ç¨‹åºå…¥å£ç±»æ·»åŠ -EnableAsyncæ³¨è§£" class="headerlink" title="2.åœ¨ç¨‹åºå…¥å£ç±»æ·»åŠ  @EnableAsyncæ³¨è§£"></a>2.åœ¨ç¨‹åºå…¥å£ç±»æ·»åŠ  @EnableAsyncæ³¨è§£</h3><h3 id="3-åœ¨éœ€è¦å¼‚æ­¥çš„æ–¹æ³•ä¸Šæ³¨å…¥-Async-â€œtaskExecutorâ€-å¼‚æ­¥äº‹ä»¶"><a href="#3-åœ¨éœ€è¦å¼‚æ­¥çš„æ–¹æ³•ä¸Šæ³¨å…¥-Async-â€œtaskExecutorâ€-å¼‚æ­¥äº‹ä»¶" class="headerlink" title="3.åœ¨éœ€è¦å¼‚æ­¥çš„æ–¹æ³•ä¸Šæ³¨å…¥ @Async(â€œtaskExecutorâ€) å¼‚æ­¥äº‹ä»¶"></a>3.åœ¨éœ€è¦å¼‚æ­¥çš„æ–¹æ³•ä¸Šæ³¨å…¥ @Async(â€œtaskExecutorâ€) å¼‚æ­¥äº‹ä»¶</h3><ul><li>æ­¤å¤„çš„æ³¨è§£ä½¿ç”¨çš„ â€œtaskExecutorâ€ å°±æ˜¯æˆ‘ä»¬åˆšæ‰å®šä¹‰çš„ å¼‚æ­¥çº¿ç¨‹æ± </li></ul>]]></content>
      
      
      <categories>
          
          <category> Java web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é‚®ç®± </tag>
            
            <tag> å¼‚æ­¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LayUIå’ŒSpringbootçš„åŸºæœ¬ä½¿ç”¨</title>
      <link href="/2019/12/26/LayUI%E5%92%8CSpringboot%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/"/>
      <url>/2019/12/26/LayUI%E5%92%8CSpringboot%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h2 id="LayUIæ˜¯ä¸€æ¬¾éå¸¸å¥½ç”¨çš„åŠ¨æ€å‰ç«¯åº“"><a href="#LayUIæ˜¯ä¸€æ¬¾éå¸¸å¥½ç”¨çš„åŠ¨æ€å‰ç«¯åº“" class="headerlink" title="LayUIæ˜¯ä¸€æ¬¾éå¸¸å¥½ç”¨çš„åŠ¨æ€å‰ç«¯åº“"></a>LayUIæ˜¯ä¸€æ¬¾éå¸¸å¥½ç”¨çš„åŠ¨æ€å‰ç«¯åº“</h2><ul><li>ä¸»è¦æä¾›ä¸°å¯Œçš„åŠ¨ä½œç»„ä»¶ï¼ŒåŒºåˆ«äºBoostrapé™æ€åº“ç¼ºä¹jsæ”¯æŒ</li></ul><h3 id="1-é¦–å…ˆèŠèŠå‰åç«¯äº¤äº’çš„å‡ ç§æ–¹å¼ï¼š"><a href="#1-é¦–å…ˆèŠèŠå‰åç«¯äº¤äº’çš„å‡ ç§æ–¹å¼ï¼š" class="headerlink" title="1.é¦–å…ˆèŠèŠå‰åç«¯äº¤äº’çš„å‡ ç§æ–¹å¼ï¼š"></a>1.é¦–å…ˆèŠèŠå‰åç«¯äº¤äº’çš„å‡ ç§æ–¹å¼ï¼š</h3><ul><li><ol><li>å‰åç«¯è€¦åˆå¼€å‘ï¼Œåç«¯æ ¹æ®è¯·æ±‚ç”Ÿæˆåœ¨å‰ç«¯æ¨¡æ¿ã€‚</li></ol></li><li><ol start="2"><li>åŠè€¦åˆï¼Œæˆ‘ç°åœ¨å¤§éƒ¨åˆ†çš„çŠ¶æ€ï¼Œåç«¯æ ¹æ®ç”¨æˆ·è¯·æ±‚ç”Ÿæˆåœ¨å‰ç«¯æ¨¡æ¿ï¼Œä½†æ˜¯æ²¡æœ‰æ•°æ®ã€‚å‰ç«¯åˆ©ç”¨ajaxå†è·å–æ•°æ®å¡«å……é¡µé¢ã€‚</li></ol></li><li><ol start="3"><li>å‰åç«¯åˆ†ç¦»ï¼Œçº¯RestFulé£æ ¼å¼€å‘ã€‚ç”¨æˆ·å’Œå‰ç«¯äº¤äº’ï¼Œå‰ç«¯ä½¿ç”¨ä¸‰å¤§æ¡†æ¶ï¼ˆvue,aj,reactï¼‰ï¼Œé€šè¿‡httpåè®®å‘åç«¯è¯·æ±‚æ•°æ®å¡«å……é¡µé¢ï¼ŒåŒæ—¶å®Œæˆæƒé™ç®¡ç†å’Œç”¨æˆ·çš„äº¤äº’ã€‚åç«¯åªè´Ÿè´£æ ¹æ®è¯·æ±‚è¿”å›å¯¹åº”çš„æ•°æ®ï¼ˆå¤šç”¨ä¸€ä¸ªå…¬ç”¨çš„åŒ…è£…ç±»è¿›è¡ŒåŒ…è£…ï¼Œä¼ è¾“jsonï¼‰</li></ol></li></ul><h3 id="2-æ‰€ä»¥ï¼Œæˆ‘ä»¬ä»Šå¤©èŠåˆ°çš„LayUIå°±æ˜¯å±äºåŠè€¦åˆå¼€å‘"><a href="#2-æ‰€ä»¥ï¼Œæˆ‘ä»¬ä»Šå¤©èŠåˆ°çš„LayUIå°±æ˜¯å±äºåŠè€¦åˆå¼€å‘" class="headerlink" title="2.æ‰€ä»¥ï¼Œæˆ‘ä»¬ä»Šå¤©èŠåˆ°çš„LayUIå°±æ˜¯å±äºåŠè€¦åˆå¼€å‘"></a>2.æ‰€ä»¥ï¼Œæˆ‘ä»¬ä»Šå¤©èŠåˆ°çš„LayUIå°±æ˜¯å±äºåŠè€¦åˆå¼€å‘</h3><ul><li>ç”¨æˆ·è¯·æ±‚ â€“&gt; åç«¯æ¸²æŸ“å‰ç«¯æ¨¡æ¿ â€“&gt; LayUIåˆ©ç”¨ajaxè·å–æ•°æ®ï¼Œå¹¶å¡«å……ç”Ÿæˆé¡µé¢ â€“&gt; è¿”å›ç”¨æˆ·</li></ul><h2 id="ä½¿ç”¨LayUIå’ŒSpringbootå®ç°ä½œä¸šçš„æ˜¾ç¤ºå’Œåˆ é™¤"><a href="#ä½¿ç”¨LayUIå’ŒSpringbootå®ç°ä½œä¸šçš„æ˜¾ç¤ºå’Œåˆ é™¤" class="headerlink" title="ä½¿ç”¨LayUIå’ŒSpringbootå®ç°ä½œä¸šçš„æ˜¾ç¤ºå’Œåˆ é™¤"></a>ä½¿ç”¨LayUIå’ŒSpringbootå®ç°ä½œä¸šçš„æ˜¾ç¤ºå’Œåˆ é™¤</h2><h3 id="1-é¦–å…ˆæ˜¯åç«¯è¿”å›æ¨¡æ¿ï¼š"><a href="#1-é¦–å…ˆæ˜¯åç«¯è¿”å›æ¨¡æ¿ï¼š" class="headerlink" title="1.é¦–å…ˆæ˜¯åç«¯è¿”å›æ¨¡æ¿ï¼š"></a>1.é¦–å…ˆæ˜¯åç«¯è¿”å›æ¨¡æ¿ï¼š</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * æŸä¸ªé¡¹ç›®è¯¦æƒ…é¡µé¢</span><br><span class="line"> * @param model</span><br><span class="line"> * @param userId</span><br><span class="line"> * @param workId</span><br><span class="line"> * @return</span><br><span class="line"> */</span><br><span class="line">@GetMapping(&quot;/deatils&quot;)</span><br><span class="line">String Test(Model model,</span><br><span class="line">            @RequestParam(value = &quot;userid&quot;) int userId,</span><br><span class="line">@RequestParam(value = &quot;workid&quot;) int workId)&#123;</span><br><span class="line">HomeWork homeWork = homeworkService.findUserIdByWorkId(workId);</span><br><span class="line">if(homeWork.getUserId() == userId)&#123;</span><br><span class="line">model.addAttribute(&quot;workid&quot;,workId);</span><br><span class="line">return &quot;homeworks/homeworkDetails&quot;;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">return &quot;index&quot;;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-å‰ç«¯åˆå§‹åŒ–æ—¶ï¼Œajaxè·å–æ•°æ®"><a href="#2-å‰ç«¯åˆå§‹åŒ–æ—¶ï¼Œajaxè·å–æ•°æ®" class="headerlink" title="2.å‰ç«¯åˆå§‹åŒ–æ—¶ï¼Œajaxè·å–æ•°æ®"></a>2.å‰ç«¯åˆå§‹åŒ–æ—¶ï¼Œajaxè·å–æ•°æ®</h3><ul><li>æ­¤å¤„æ˜¯LayUIè‡ªå·±å°è£…çš„è¯·æ±‚ï¼Œé»˜è®¤æ˜¯getè¯·æ±‚</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">&lt;script th:inline=&quot;JavaScript&quot;&gt;</span><br><span class="line">   // åŠ è½½è¡¨</span><br><span class="line">    layui.use(&apos;table&apos;, function()&#123;</span><br><span class="line">        var table = layui.table;</span><br><span class="line">        // åŠ è½½è¡¨</span><br><span class="line">        table.render(&#123;</span><br><span class="line">            elem: &apos;#test&apos;</span><br><span class="line">            ,url:&apos;/api/homeworks&apos;</span><br><span class="line">            ,id: &apos;TestId&apos;</span><br><span class="line">            ,where: &#123;</span><br><span class="line">                userid: [[$&#123;session.user.getId()&#125;]],</span><br><span class="line">                workid: [[$&#123;workid&#125;]]</span><br><span class="line">            &#125;</span><br><span class="line">            ,title: &apos;å­¦ç”Ÿä¸Šä¼ ä¿¡æ¯&apos;</span><br><span class="line">            ,totalRow: true</span><br><span class="line">            ,totalRowText: &apos;åˆè®¡ï¼š&apos;</span><br><span class="line">            ,toolbar: &apos;#toolbarDemo&apos;</span><br><span class="line">            ,cols: [</span><br><span class="line">                [</span><br><span class="line">                    &#123;type: &apos;checkbox&apos;, fixed: &apos;left&apos;&#125;</span><br><span class="line">                    ,&#123;field:&apos;id&apos;, title:&apos;å­¦å·&apos;,sort: true&#125;</span><br><span class="line">                    ,&#123;field:&apos;name&apos;, title:&apos;å§“å&apos;&#125;</span><br><span class="line">                    ,&#123;field:&apos;classname&apos;, title:&apos;ç­çº§&apos;,sort: true&#125;</span><br><span class="line">                    ,&#123;field:&apos;uptime&apos;, title:&apos;ä¸Šä¼ æ—¶é—´&apos;,sort: true&#125;</span><br><span class="line">                    ,&#123;field:&apos;filename&apos;, title:&apos;æ–‡ä»¶å&apos;&#125;</span><br><span class="line">                    ,&#123;field:&apos;filesize&apos;, title:&apos;æ–‡ä»¶å¤§å°(kb)&apos;,sort: true&#125;</span><br><span class="line">                    ,&#123;fixed: &apos;right&apos;, align:&apos;center&apos;, toolbar: &apos;#barDemo&apos;&#125; //è¿™é‡Œçš„toolbarå€¼æ˜¯æ¨¡æ¿å…ƒç´ çš„é€‰æ‹©å™¨</span><br><span class="line">                ]</span><br><span class="line">            ]</span><br><span class="line">            ,page: true</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        //ç›‘å¬å¤´å·¥å…·æ äº‹ä»¶</span><br><span class="line">        table.on(&apos;toolbar(test)&apos;, function(obj)&#123;</span><br><span class="line">            var checkStatus = table.checkStatus(obj.config.id)</span><br><span class="line">                ,data = checkStatus.data; //è·å–é€‰ä¸­çš„æ•°æ®</span><br><span class="line">            switch(obj.event)&#123;</span><br><span class="line">                case &apos;download&apos;:</span><br><span class="line">                    console.info(data);</span><br><span class="line">                    console.info(data.length)</span><br><span class="line">                    if(data.length == 0)&#123;</span><br><span class="line">                        layer.msg(&apos;è¯·é€‰æ‹©éœ€è¦ä¸‹è½½çš„æ–‡ä»¶ï¼&apos;);</span><br><span class="line">                    &#125;else&#123;</span><br><span class="line">                        layer.msg(&apos;å¼€å§‹ä¸‹è½½ï¼&apos;);</span><br><span class="line">                        download(data);</span><br><span class="line">                    &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        //ç›‘å¬è¡Œå·¥å…·äº‹ä»¶</span><br><span class="line">        table.on(&apos;tool(test)&apos;, function(obj)&#123; //æ³¨ï¼štool æ˜¯å·¥å…·æ¡äº‹ä»¶åï¼Œtest æ˜¯ table åŸå§‹å®¹å™¨çš„å±æ€§ lay-filter=&quot;å¯¹åº”çš„å€¼&quot;</span><br><span class="line">            var data = obj.data //è·å¾—å½“å‰è¡Œæ•°æ®</span><br><span class="line">                ,layEvent = obj.event; //è·å¾— lay-event å¯¹åº”çš„å€¼</span><br><span class="line">            console.info(data);</span><br><span class="line">            if(layEvent === &apos;detail&apos;)&#123;</span><br><span class="line">                layer.msg(&apos;æŸ¥çœ‹æ“ä½œ&apos;);</span><br><span class="line">            &#125; else if(layEvent === &apos;del&apos;)&#123;</span><br><span class="line">                layer.confirm(&apos;çœŸçš„åˆ é™¤è¡Œå—ï¼Ÿ&apos;, function(index)&#123;</span><br><span class="line">                    obj.del(); //åˆ é™¤å¯¹åº”è¡Œï¼ˆtrï¼‰çš„DOMç»“æ„</span><br><span class="line">                    layer.close(index);</span><br><span class="line">                    //å‘æœåŠ¡ç«¯å‘é€åˆ é™¤æŒ‡ä»¤</span><br><span class="line">                    deleteHomeWork(data);</span><br><span class="line">                    table.reload(&apos;TestId&apos;, &#123;</span><br><span class="line">                    where: &#123;</span><br><span class="line">                        userid: [[$&#123;session.user.getId()&#125;]],</span><br><span class="line">                            worktitle: [[$&#123;worktitle&#125;]],</span><br><span class="line">                            page : 1,</span><br><span class="line">                            pageSize: 10</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;); //åªé‡è½½æ•°æ®</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125; else if(layEvent === &apos;edit&apos;)&#123;</span><br><span class="line">                layer.msg(&apos;ç¼–è¾‘æ“ä½œ&apos;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h3 id="3-åç«¯è¿”å›ajaxæ•°æ®ï¼Œå¸¦åŒ…è£…"><a href="#3-åç«¯è¿”å›ajaxæ•°æ®ï¼Œå¸¦åŒ…è£…" class="headerlink" title="3.åç«¯è¿”å›ajaxæ•°æ®ï¼Œå¸¦åŒ…è£…"></a>3.åç«¯è¿”å›ajaxæ•°æ®ï¼Œå¸¦åŒ…è£…</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * è·å–homeworkåˆ—è¡¨</span><br><span class="line"> */</span><br><span class="line">@GetMapping(&quot;/homeworks&quot;)</span><br><span class="line">@ResponseBody</span><br><span class="line">Layui getHomeworks(@RequestParam(value = &quot;workid&quot;) String workid,</span><br><span class="line">                    @RequestParam(value = &quot;userid&quot;) int userid,</span><br><span class="line">                    @RequestParam(value = &quot;limit&quot;,defaultValue = &quot;10&quot;) int limit,</span><br><span class="line">                    @RequestParam(value = &quot;page&quot;,defaultValue = &quot;1&quot;) int page</span><br><span class="line">)&#123;</span><br><span class="line">    log.info(&quot;è·å–homeworks&quot;);</span><br><span class="line">    List&lt;Student&gt; students = studentService.getStudentsByWorkId(workid,page,limit);</span><br><span class="line">    return Layui.data(1,students);   // ä½¿ç”¨åŒ…è£…ç±»åŒ…è£…è¿”å›ç»“æœ</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">package kid1999.upload.utils;</span><br><span class="line"></span><br><span class="line">import java.util.HashMap;</span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @desc:  LayUI çš„å·¥å…·ç±»</span><br><span class="line"> * @auther: kid1999</span><br><span class="line"> * @date: 2019/12/21 22:05</span><br><span class="line"> **/</span><br><span class="line">public class Layui extends HashMap&lt;String, Object&gt; &#123;</span><br><span class="line">    public static Layui data(Integer count, List&lt;?&gt; data)&#123;</span><br><span class="line">        Layui r = new Layui();</span><br><span class="line">        r.put(&quot;code&quot;, 0);</span><br><span class="line">        r.put(&quot;msg&quot;, &quot;&quot;);</span><br><span class="line">        r.put(&quot;count&quot;, count);</span><br><span class="line">        r.put(&quot;data&quot;, data);</span><br><span class="line">        return r;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-å‰ç«¯è§£åŒ…è£…"><a href="#4-å‰ç«¯è§£åŒ…è£…" class="headerlink" title="4.å‰ç«¯è§£åŒ…è£…"></a>4.å‰ç«¯è§£åŒ…è£…</h3><ul><li>å¦‚ä¸Šï¼Œå®‰è£…æ­¤ç±»åŒ…è£…ä¼šè¢«LayUIè‡ªåŠ¨è§£åŒ…ï¼š</li><li>codeï¼š0 ä¸ºæ­£ç¡®è¿”å›</li><li>msgï¼š ä¿¡æ¯</li><li>dataï¼šæ•°æ®ï¼ˆæ ¸å¿ƒï¼‰</li><li><h3 id="5-å‰ç«¯å‘å‡ºajaxè¯·æ±‚"><a href="#5-å‰ç«¯å‘å‡ºajaxè¯·æ±‚" class="headerlink" title="5.å‰ç«¯å‘å‡ºajaxè¯·æ±‚"></a>5.å‰ç«¯å‘å‡ºajaxè¯·æ±‚</h3></li><li>jqçš„ajaxè¯·æ±‚</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">// åˆ é™¤ä½œä¸š</span><br><span class="line">function deleteHomeWork(data)&#123;</span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        url: &apos;/api/homework&apos;,</span><br><span class="line">        type: &quot;delete&quot;,</span><br><span class="line">        async: true, // æ˜¯å¦å¼‚æ­¥è¯·æ±‚ï¼ˆæ­¤å¤„éœ€è¿™åªä¸ºå¼‚æ­¥è¯·æ±‚trueï¼Œå¦åˆ™bootstrapçš„modalä¸ä¼šé¡ºåºæ˜¾ç¤ºï¼‰</span><br><span class="line">        cache: false, // æ˜¯å¦ç¼“å­˜æ­¤é¡µé¢ï¼Œæ¯æ¬¡éƒ½è¯·æ±‚æœåŠ¡å™¨</span><br><span class="line">        contentType: &quot;application/json&quot;, //&quot;application/x-www-form-urlencoded&quot;, // å†…å®¹ç¼–ç ç±»å‹ï¼Œé»˜è®¤</span><br><span class="line">        dataType: &quot;json&quot;, // é¢„æœŸæœåŠ¡å™¨è¿”å›æ•°æ®æ ¼å¼</span><br><span class="line">        timeout: 3000, // è¶…æ—¶æ—¶é—´ï¼Œ60s</span><br><span class="line">        data: JSON.stringify(data), // è¯·æ±‚å‚æ•°</span><br><span class="line">        success: function(data)&#123;</span><br><span class="line">            if(data.code === 200)&#123;</span><br><span class="line">                layer.msg(data.info);</span><br><span class="line">            &#125;else&#123;</span><br><span class="line">                layer.msg(data.info);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        error: function(xhr, errMsg, e)&#123;</span><br><span class="line">            console.info(JSON.stringify(data));</span><br><span class="line">            layer.msg(errMsg)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="6-åç«¯è¿”å›"><a href="#6-åç«¯è¿”å›" class="headerlink" title="6.åç«¯è¿”å›"></a>6.åç«¯è¿”å›</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * åˆ é™¤studentè®°å½•</span><br><span class="line"> */</span><br><span class="line">@DeleteMapping(&quot;/homework&quot;)</span><br><span class="line">Result deleteHomeWork(@RequestBody Student student)&#123;</span><br><span class="line">    log.info(&quot;åˆ é™¤studentè®°å½•&quot;);</span><br><span class="line">    fastDFSClientUtils.deleteFile(student.getFileurl());</span><br><span class="line">    studentService.deleteStudentById(student.getId());</span><br><span class="line">    return Result.success(&quot;åˆ é™¤æˆåŠŸ&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="â€¦-åé¢éƒ½ç±»ä¼¼äº†"><a href="#â€¦-åé¢éƒ½ç±»ä¼¼äº†" class="headerlink" title="â€¦.åé¢éƒ½ç±»ä¼¼äº†"></a>â€¦.åé¢éƒ½ç±»ä¼¼äº†</h3><p>æ›´å¤šLayUIçš„é—®é¢˜å‚è€ƒå…¶ <a href="https://www.layui.com/doc/" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a> å’Œ <a href="https://www.layui.com/demo/" target="_blank" rel="noopener">ç¤ºä¾‹</a></p>]]></content>
      
      
      <categories>
          
          <category> Java web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LayUI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Springbootæ•´åˆKaptchaæ”¯æŒéªŒè¯ç </title>
      <link href="/2019/12/21/Springboot%E6%95%B4%E5%90%88Kaptcha%E6%94%AF%E6%8C%81%E9%AA%8C%E8%AF%81%E7%A0%81/"/>
      <url>/2019/12/21/Springboot%E6%95%B4%E5%90%88Kaptcha%E6%94%AF%E6%8C%81%E9%AA%8C%E8%AF%81%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<h1 id="Kaptcha"><a href="#Kaptcha" class="headerlink" title="Kaptcha"></a>Kaptcha</h1><ul><li>Kaptchaï¼Œæ˜¯Googleå¼€æºçš„ä¸€ä¸ªå¯é«˜åº¦é…ç½®çš„å®ç”¨éªŒè¯ç ç”Ÿæˆå·¥å…·ã€‚</li></ul><h2 id="1-åœ¨Springbootä¸­å¯¼å…¥ï¼š"><a href="#1-åœ¨Springbootä¸­å¯¼å…¥ï¼š" class="headerlink" title="1.åœ¨Springbootä¸­å¯¼å…¥ï¼š"></a>1.åœ¨Springbootä¸­å¯¼å…¥ï¼š</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> &lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;com.github.penggle&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;kaptcha&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;2.3.2&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><h2 id="2-æ·»åŠ Kaptchaçš„é…ç½®è§„åˆ™"><a href="#2-æ·»åŠ Kaptchaçš„é…ç½®è§„åˆ™" class="headerlink" title="2.æ·»åŠ Kaptchaçš„é…ç½®è§„åˆ™"></a>2.æ·»åŠ Kaptchaçš„é…ç½®è§„åˆ™</h2><ul><li>å¯ç”¨xmlä¹Ÿå¯ä»¥Class ï¼ˆæ­¤å¤„é‡‡ç”¨Classé…ç½®ï¼‰</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">package kid1999.upload.config;</span><br><span class="line"></span><br><span class="line">import com.google.code.kaptcha.impl.DefaultKaptcha;</span><br><span class="line">import com.google.code.kaptcha.util.Config;</span><br><span class="line">import org.springframework.context.annotation.Bean;</span><br><span class="line">import org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line">import java.util.Properties;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @desc:  Kaptcha é…ç½®ç±»</span><br><span class="line"> * @auther: kid1999</span><br><span class="line"> * @date: 2019/12/21 12:19</span><br><span class="line"> **/</span><br><span class="line"></span><br><span class="line">@Service</span><br><span class="line">public class KaptchaConfig &#123;</span><br><span class="line">    @Bean</span><br><span class="line">    public DefaultKaptcha getDefaultKaptcha() &#123;</span><br><span class="line">        com.google.code.kaptcha.impl.DefaultKaptcha defaultKaptcha = new com.google.code.kaptcha.impl.DefaultKaptcha();</span><br><span class="line">        Properties properties = new Properties();</span><br><span class="line">        // å›¾ç‰‡è¾¹æ¡†</span><br><span class="line">        properties.setProperty(&quot;kaptcha.border&quot;, &quot;yes&quot;);</span><br><span class="line">        // è¾¹æ¡†é¢œè‰²</span><br><span class="line">        properties.setProperty(&quot;kaptcha.border.color&quot;, &quot;105,179,90&quot;);</span><br><span class="line">        // å­—ä½“é¢œè‰²</span><br><span class="line">        properties.setProperty(&quot;kaptcha.textproducer.font.color&quot;, &quot;red&quot;);</span><br><span class="line">        // å›¾ç‰‡å®½</span><br><span class="line">        properties.setProperty(&quot;kaptcha.image.width&quot;, &quot;120&quot;);</span><br><span class="line">        // å›¾ç‰‡é«˜</span><br><span class="line">        properties.setProperty(&quot;kaptcha.image.height&quot;, &quot;40&quot;);</span><br><span class="line">        // å­—ä½“å¤§å°</span><br><span class="line">        properties.setProperty(&quot;kaptcha.textproducer.font.size&quot;, &quot;30&quot;);</span><br><span class="line">        // session key</span><br><span class="line">        properties.setProperty(&quot;kaptcha.session.key&quot;, &quot;code&quot;);</span><br><span class="line">        // éªŒè¯ç é•¿åº¦</span><br><span class="line">        properties.setProperty(&quot;kaptcha.textproducer.char.length&quot;, &quot;4&quot;);</span><br><span class="line">        // å­—ä½“</span><br><span class="line">        properties.setProperty(&quot;kaptcha.textproducer.font.names&quot;, &quot;å®‹ä½“,æ¥·ä½“,å¾®è½¯é›…é»‘&quot;);</span><br><span class="line"></span><br><span class="line">        properties.setProperty(&quot;kaptcha.noise.color&quot;, &quot;35,37,38&quot;);</span><br><span class="line"></span><br><span class="line">        Config config = new Config(properties);</span><br><span class="line">        defaultKaptcha.setConfig(config);</span><br><span class="line"></span><br><span class="line">        return defaultKaptcha;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-é…ç½®éªŒè¯ç çš„ç”Ÿæˆå’Œæ ¸å¯¹"><a href="#3-é…ç½®éªŒè¯ç çš„ç”Ÿæˆå’Œæ ¸å¯¹" class="headerlink" title="3.é…ç½®éªŒè¯ç çš„ç”Ÿæˆå’Œæ ¸å¯¹"></a>3.é…ç½®éªŒè¯ç çš„ç”Ÿæˆå’Œæ ¸å¯¹</h2><ul><li>æ–°å»ºä¸€ä¸ªController<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">package kid1999.upload.controller;</span><br><span class="line"></span><br><span class="line">import com.google.code.kaptcha.impl.DefaultKaptcha;</span><br><span class="line">import kid1999.upload.dto.Result;</span><br><span class="line">import lombok.extern.slf4j.Slf4j;</span><br><span class="line">import org.apache.commons.lang3.StringUtils;</span><br><span class="line">import org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line">import org.springframework.stereotype.Controller;</span><br><span class="line">import org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line">import org.springframework.web.servlet.ModelAndView;</span><br><span class="line"></span><br><span class="line">import javax.imageio.ImageIO;</span><br><span class="line">import javax.servlet.ServletOutputStream;</span><br><span class="line">import javax.servlet.http.HttpServletRequest;</span><br><span class="line">import javax.servlet.http.HttpServletResponse;</span><br><span class="line">import javax.servlet.http.HttpSession;</span><br><span class="line">import java.awt.image.BufferedImage;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @desc:</span><br><span class="line"> * @auther: kid1999</span><br><span class="line"> * @date: 2019/12/21 12:20</span><br><span class="line"> **/</span><br><span class="line">@Slf4j</span><br><span class="line">@Controller</span><br><span class="line">@RequestMapping(&quot;/api/kaptcha&quot;)</span><br><span class="line">public class KaptchaController &#123;</span><br><span class="line">    @Autowired</span><br><span class="line">    DefaultKaptcha defaultKaptcha;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * ç”ŸæˆéªŒè¯ç </span><br><span class="line">     * @throws Exception</span><br><span class="line">     */</span><br><span class="line">    @RequestMapping(&quot;/vrifyCode&quot;)</span><br><span class="line">    public ModelAndView getKaptchaImage(HttpServletRequest request, HttpServletResponse response) throws Exception &#123;</span><br><span class="line">        log.info(&quot;ç”ŸæˆéªŒè¯ç &quot;);</span><br><span class="line">        HttpSession session = request.getSession();</span><br><span class="line">        response.setDateHeader(&quot;Expires&quot;, 0);</span><br><span class="line">        response.setHeader(&quot;Cache-Control&quot;,&quot;no-store, no-cache, must-revalidate&quot;);</span><br><span class="line">        response.addHeader(&quot;Cache-Control&quot;, &quot;post-check=0, pre-check=0&quot;);</span><br><span class="line">        response.setHeader(&quot;Pragma&quot;, &quot;no-cache&quot;);</span><br><span class="line">        response.setContentType(&quot;image/jpeg&quot;);</span><br><span class="line">        // è·å–KAPTCHAéªŒè¯çš„éšæœºæ–‡æœ¬</span><br><span class="line">        String capText = defaultKaptcha.createText();</span><br><span class="line">        // å°†ç”Ÿæˆå¥½çš„å›¾ç‰‡æ”¾å…¥ä¼šè¯ä¸­</span><br><span class="line">        session.setAttribute(&quot;vrifyCode&quot;, capText);</span><br><span class="line">        // create the image with the text</span><br><span class="line">        BufferedImage bi = defaultKaptcha.createImage(capText);</span><br><span class="line">        ServletOutputStream out = response.getOutputStream();</span><br><span class="line">        ImageIO.write(bi, &quot;jpg&quot;, out);</span><br><span class="line">        try &#123;</span><br><span class="line">            out.flush();</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            out.close();//å…³é—­</span><br><span class="line">        &#125;</span><br><span class="line">        return null;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * æ ¡å¯¹éªŒè¯ç </span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    public Result checkVerificationCode(String vrifyCode, HttpServletRequest request) &#123;</span><br><span class="line">        String verificationCodeIn = (String) request.getSession().getAttribute(&quot;vrifyCode&quot;);</span><br><span class="line">        request.getSession().removeAttribute(&quot;vrifyCode&quot;);</span><br><span class="line">        if (StringUtils.isEmpty(verificationCodeIn) || !verificationCodeIn.equals(vrifyCode)) &#123;</span><br><span class="line">            return Result.fail(400,&quot;éªŒè¯ç é”™è¯¯ï¼Œæˆ–å·²å¤±æ•ˆ&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        return Result.success(&quot;éªŒè¯é€šè¿‡&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="4-å‰ç«¯çš„é…ç½®"><a href="#4-å‰ç«¯çš„é…ç½®" class="headerlink" title="4.å‰ç«¯çš„é…ç½®"></a>4.å‰ç«¯çš„é…ç½®</h2><ul><li>æ­¤å¤„ä»¥ç™»å½•çš„éªŒè¯ç ä¸ºä¾‹</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;form-group&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;input-group&quot; style=&quot;float: left;width: 195px;&quot;&gt;</span><br><span class="line">        &lt;label&gt;éªŒè¯ç : &lt;/label&gt;</span><br><span class="line">        &lt;input type=&quot;text&quot; name=&quot;code&quot; id=&quot;code&quot; class=&quot;form-control&quot; style=&quot;width: 150px&quot; maxlength=&quot;5&quot; placeholder=&quot;éªŒè¯ç &quot; autocomplete=&quot;off&quot;&gt;&amp;nbsp;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;img id=&quot;captcha-img&quot; style=&quot;width: 120px;height: 40px;display: inline-block;float: right&quot;  src=&quot;/api/kaptcha/vrifyCode&quot; onclick=&quot;this.src=&apos;/api/kaptcha/vrifyCode?d=&apos;+ new Date()*1&quot; title=&quot;çœ‹ä¸æ¸…ï¼Ÿæ¢ä¸€å¼ &quot; /&gt;</span><br><span class="line">    &lt;div class=&quot;clearfix&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure><h2 id="5-æ ¸å¯¹"><a href="#5-æ ¸å¯¹" class="headerlink" title="5.æ ¸å¯¹"></a>5.æ ¸å¯¹</h2><ul><li>åœ¨ç”ŸæˆéªŒè¯ç å›¾ç‰‡çš„æ—¶å€™ï¼Œå·²ç»å°†éªŒè¯ç å†™å…¥sessionä¸­äº†</li><li>æ‰€ä»¥æ­¤æ—¶åªéœ€è¦ä»sessionä¸­è·å–codeéªŒè¯å›ä¼ çš„codeå³å¯</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">/** éªŒè¯ç éªŒè¯</span><br><span class="line"> */</span><br><span class="line">public Boolean checkVerificationCode(String vrifyCode, HttpServletRequest request) &#123;</span><br><span class="line">String verificationCodeIn = (String) request.getSession().getAttribute(&quot;vrifyCode&quot;);</span><br><span class="line">request.getSession().removeAttribute(&quot;vrifyCode&quot;);</span><br><span class="line">if (StringUtils.isEmpty(verificationCodeIn) || !verificationCodeIn.equals(vrifyCode)) &#123;</span><br><span class="line">return false;</span><br><span class="line">&#125;</span><br><span class="line">return true;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ•ˆæœå¦‚ä¸‹ï¼š"><a href="#æ•ˆæœå¦‚ä¸‹ï¼š" class="headerlink" title="æ•ˆæœå¦‚ä¸‹ï¼š"></a>æ•ˆæœå¦‚ä¸‹ï¼š</h3><p><img alt data-src="https://pic1.superbed.cn/item/5dfdc73f76085c3289aac3a2.png" class="lazyload"></p>]]></content>
      
      
      <categories>
          
          <category> Java web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Kaptcha </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MyBatis,Springä¸å‰ç«¯ä¹‹é—´çš„æ—¶é—´æ ¼å¼</title>
      <link href="/2019/12/21/MyBatis-Spring%E4%B8%8E%E5%89%8D%E7%AB%AF%E4%B9%8B%E9%97%B4%E7%9A%84%E6%97%B6%E9%97%B4%E6%A0%BC%E5%BC%8F/"/>
      <url>/2019/12/21/MyBatis-Spring%E4%B8%8E%E5%89%8D%E7%AB%AF%E4%B9%8B%E9%97%B4%E7%9A%84%E6%97%B6%E9%97%B4%E6%A0%BC%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="1-é¦–å…ˆæ˜¯MySQLä¸Javaçš„æ—¶é—´æ ¼å¼å¯¹åº”å›¾"><a href="#1-é¦–å…ˆæ˜¯MySQLä¸Javaçš„æ—¶é—´æ ¼å¼å¯¹åº”å›¾" class="headerlink" title="1.é¦–å…ˆæ˜¯MySQLä¸Javaçš„æ—¶é—´æ ¼å¼å¯¹åº”å›¾"></a>1.é¦–å…ˆæ˜¯MySQLä¸Javaçš„æ—¶é—´æ ¼å¼å¯¹åº”å›¾</h2><p><img alt data-src="https://pic2.superbed.cn/item/5dfdc7fc76085c3289ab0855.png" class="lazyload"></p><h2 id="2-å››ç§æ—¶é—´æ ¼å¼çš„é€‰æ‹©"><a href="#2-å››ç§æ—¶é—´æ ¼å¼çš„é€‰æ‹©" class="headerlink" title="2.å››ç§æ—¶é—´æ ¼å¼çš„é€‰æ‹©"></a>2.å››ç§æ—¶é—´æ ¼å¼çš„é€‰æ‹©</h2><p><img alt data-src="https://gss0.baidu.com/9vo3dSag_xI4khGko9WTAnF6hhy/zhidao/wh%3D600%2C800/sign=312277d3a04bd1130498bf346a9f8837/cdbf6c81800a19d8458917a53efa828ba71e468c.jpg" class="lazyload"></p><ul><li>date åªæœ‰å¹´æœˆæ—¥</li><li>datetime æœ€å®Œæ•´ ä¹Ÿæ˜¯æœ€å å†…å­˜çš„</li><li>timestamp è¾ƒå®Œæ•´ï¼Œä½†æ˜¯æœ€å¤§ä¸Šé™æ˜¯2038å¹´</li><li>time åªè¡¨ç¤ºæ—¶é—´</li><li>year åªè¡¨ç¤ºå¹´</li></ul><h2 id="3-åœ¨Springä¸­è‡ªåŠ¨æ—¶é—´çš„è½¬æ¢"><a href="#3-åœ¨Springä¸­è‡ªåŠ¨æ—¶é—´çš„è½¬æ¢" class="headerlink" title="3.åœ¨Springä¸­è‡ªåŠ¨æ—¶é—´çš„è½¬æ¢"></a>3.åœ¨Springä¸­è‡ªåŠ¨æ—¶é—´çš„è½¬æ¢</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">package kid1999.upload.model;</span><br><span class="line"></span><br><span class="line">import com.baomidou.mybatisplus.annotation.IdType;</span><br><span class="line">import com.baomidou.mybatisplus.annotation.TableId;</span><br><span class="line">import com.baomidou.mybatisplus.annotation.TableName;</span><br><span class="line">import com.fasterxml.jackson.annotation.JsonFormat;</span><br><span class="line">import lombok.Data;</span><br><span class="line">import org.springframework.format.annotation.DateTimeFormat;</span><br><span class="line"></span><br><span class="line">import java.sql.Timestamp;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@Data</span><br><span class="line">@TableName(&quot;homework&quot;)</span><br><span class="line">public class HomeWork &#123;</span><br><span class="line"></span><br><span class="line">  @TableId(type = IdType.AUTO)    // è‡ªå¢</span><br><span class="line">  private int id;</span><br><span class="line">  private String title;</span><br><span class="line">  private String infomation;</span><br><span class="line">  @DateTimeFormat(pattern = &quot;yyyy-MM-dd HH:mm:ss&quot;)</span><br><span class="line">  @JsonFormat(pattern = &quot;yyyy-MM-dd HH:mm:ss&quot;,timezone=&quot;GMT+8&quot;)</span><br><span class="line">  private Timestamp createtime;</span><br><span class="line">  @DateTimeFormat(pattern = &quot;yyyy-MM-dd HH:mm:ss&quot;)</span><br><span class="line">  @JsonFormat(pattern = &quot;yyyy-MM-dd HH:mm:ss&quot;,timezone=&quot;GMT+8&quot;)</span><br><span class="line">  private Timestamp endtime;</span><br><span class="line">  private String type;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>JsonFormat è´Ÿè´£å‰ç«¯å’Œåç«¯çš„è½¬æ¢ json &lt;-&gt; class</li><li>DateTimeFormat è´Ÿè´£åç«¯ä¸æ•°æ®åº“çš„è½¬æ¢ class &lt;-&gt; row</li></ul>]]></content>
      
      
      <categories>
          
          <category> Java web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ—¶é—´æ ¼å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SpringBootæ•´åˆFastDFS</title>
      <link href="/2019/12/21/SpringBoot%E6%95%B4%E5%90%88FastDFS/"/>
      <url>/2019/12/21/SpringBoot%E6%95%B4%E5%90%88FastDFS/</url>
      
        <content type="html"><![CDATA[<h1 id="SpringBoot-æ•´åˆ-FastDFS-å®ç°æ–‡ä»¶ä¸Šä¼ æ‰“åŒ…ä¸‹è½½"><a href="#SpringBoot-æ•´åˆ-FastDFS-å®ç°æ–‡ä»¶ä¸Šä¼ æ‰“åŒ…ä¸‹è½½" class="headerlink" title="SpringBoot æ•´åˆ FastDFS å®ç°æ–‡ä»¶ä¸Šä¼ æ‰“åŒ…ä¸‹è½½"></a>SpringBoot æ•´åˆ FastDFS å®ç°æ–‡ä»¶ä¸Šä¼ æ‰“åŒ…ä¸‹è½½</h1><h2 id="FastDFS"><a href="#FastDFS" class="headerlink" title="FastDFS"></a>FastDFS</h2><ul><li>FastDFSæ˜¯ä¸€ä¸ªå¼€æºçš„è½»é‡çº§åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼Œå®ƒå¯¹æ–‡ä»¶è¿›è¡Œç®¡ç†ï¼ŒåŠŸèƒ½åŒ…æ‹¬ï¼šæ–‡ä»¶å­˜å‚¨ã€æ–‡ä»¶åŒæ­¥ã€æ–‡ä»¶è®¿é—®ï¼ˆæ–‡ä»¶ä¸Šä¼ ã€æ–‡ä»¶ä¸‹è½½ï¼‰ç­‰ï¼Œè§£å†³äº†å¤§å®¹é‡å­˜å‚¨å’Œè´Ÿè½½å‡è¡¡çš„é—®é¢˜ã€‚ç‰¹åˆ«é€‚åˆä»¥æ–‡ä»¶ä¸ºè½½ä½“çš„åœ¨çº¿æœåŠ¡ï¼Œå¦‚ç›¸å†Œç½‘ç«™ã€è§†é¢‘ç½‘ç«™ç­‰ç­‰ã€‚</li></ul><h2 id="1-FastDFSçš„å®‰è£…"><a href="#1-FastDFSçš„å®‰è£…" class="headerlink" title="1.FastDFSçš„å®‰è£…"></a>1.FastDFSçš„å®‰è£…</h2><ul><li>å‚ç…§ baidu | Google</li><li>docker å®‰è£…</li></ul><h2 id="2-ä½¿ç”¨fastdfs-clientæ“ä½œFastDFS"><a href="#2-ä½¿ç”¨fastdfs-clientæ“ä½œFastDFS" class="headerlink" title="2.ä½¿ç”¨fastdfs-clientæ“ä½œFastDFS"></a>2.ä½¿ç”¨fastdfs-clientæ“ä½œFastDFS</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- fastDFS --&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;com.github.tobato&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;fastdfs-client&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.26.7&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;commons-io&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;commons-io&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;2.6&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><h2 id="3-æ·»åŠ FastDFSçš„é…ç½®"><a href="#3-æ·»åŠ FastDFSçš„é…ç½®" class="headerlink" title="3.æ·»åŠ FastDFSçš„é…ç½®"></a>3.æ·»åŠ FastDFSçš„é…ç½®</h2><ul><li>å¯xml å¯ bean å¯yaml(æ­¤å¤„ä½¿ç”¨)</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># fastDFS é…ç½®</span><br><span class="line">fdfs:</span><br><span class="line">  soTimeout: 1500 #socketè¿æ¥è¶…æ—¶æ—¶é•¿</span><br><span class="line">  connectTimeout: 600 #è¿æ¥trackeræœåŠ¡å™¨è¶…æ—¶æ—¶é•¿</span><br><span class="line">  resHost: 10.6.11.xxx</span><br><span class="line">  storagePort: 23000</span><br><span class="line">  thumbImage: #ç¼©ç•¥å›¾ç”Ÿæˆå‚æ•°ï¼Œå¯é€‰</span><br><span class="line">    width: 150</span><br><span class="line">    height: 150</span><br><span class="line">  trackerList: #TrackerListå‚æ•°,æ”¯æŒå¤šä¸ªï¼Œæˆ‘è¿™é‡Œåªæœ‰ä¸€ä¸ªï¼Œå¦‚æœæœ‰å¤šä¸ªåœ¨ä¸‹æ–¹åŠ - x.x.x.x:port</span><br><span class="line">    - 10.16.11.xxx:22122</span><br></pre></td></tr></table></figure><h2 id="4-åŠ è½½FastDFSçš„é…ç½®ä¿¡æ¯"><a href="#4-åŠ è½½FastDFSçš„é…ç½®ä¿¡æ¯" class="headerlink" title="4.åŠ è½½FastDFSçš„é…ç½®ä¿¡æ¯"></a>4.åŠ è½½FastDFSçš„é…ç½®ä¿¡æ¯</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">package kid1999.upload.config;</span><br><span class="line"></span><br><span class="line">import lombok.Data;</span><br><span class="line">import org.springframework.beans.factory.annotation.Value;</span><br><span class="line">import org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @desc:  fastDFSé…ç½®ç±»</span><br><span class="line"> * @auther: kid1999</span><br><span class="line"> * @date: 2019/12/19 19:23</span><br><span class="line"> **/</span><br><span class="line">@Component</span><br><span class="line">@Data</span><br><span class="line">public class FastDfsConfig &#123;</span><br><span class="line">    @Value(&quot;$&#123;fdfs.resHost&#125;&quot;)</span><br><span class="line">    private String resHost;</span><br><span class="line"></span><br><span class="line">    @Value(&quot;$&#123;fdfs.storagePort&#125;&quot;)</span><br><span class="line">    private String storagePort;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="5-é…ç½®è‡ªå·±éœ€è¦çš„FastDFSæ“ä½œ"><a href="#5-é…ç½®è‡ªå·±éœ€è¦çš„FastDFSæ“ä½œ" class="headerlink" title="5.é…ç½®è‡ªå·±éœ€è¦çš„FastDFSæ“ä½œ"></a>5.é…ç½®è‡ªå·±éœ€è¦çš„FastDFSæ“ä½œ</h2><ul><li>å¦‚ä¸Šä¼ ï¼Œä¸‹è½½ï¼ŒæŸ¥çœ‹ä¿¡æ¯ï¼Œåˆ é™¤ â€¦</li><li><a href="https://github.com/tobato/FastDFS_Client" target="_blank" rel="noopener">æ›´å¤šæ“ä½œ</a> å‚è€ƒæºç ä¸­çš„æµ‹è¯•æ¡ˆä¾‹<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line">package kid1999.upload.utils;</span><br><span class="line"></span><br><span class="line">import com.github.tobato.fastdfs.domain.fdfs.FileInfo;</span><br><span class="line">import com.github.tobato.fastdfs.domain.fdfs.StorePath;</span><br><span class="line">import com.github.tobato.fastdfs.domain.proto.storage.DownloadByteArray;</span><br><span class="line">import com.github.tobato.fastdfs.exception.FdfsUnsupportStorePathException;</span><br><span class="line">import com.github.tobato.fastdfs.service.FastFileStorageClient;</span><br><span class="line">import kid1999.upload.config.FastDfsConfig;</span><br><span class="line">import lombok.extern.slf4j.Slf4j;</span><br><span class="line">import org.apache.commons.io.FilenameUtils;</span><br><span class="line">import org.apache.commons.lang3.StringUtils;</span><br><span class="line">import org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line">import org.springframework.stereotype.Component;</span><br><span class="line">import org.springframework.web.multipart.MultipartFile;</span><br><span class="line"></span><br><span class="line">import java.io.IOException;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @author kid1999</span><br><span class="line"> * @desc:</span><br><span class="line"> * @auther: kid1999</span><br><span class="line"> * @date: 2019/12/19 19:25</span><br><span class="line"> **/</span><br><span class="line"></span><br><span class="line">@Slf4j</span><br><span class="line">@Component</span><br><span class="line">public class FastDFSClientUtils &#123;</span><br><span class="line">    @Autowired</span><br><span class="line">    private FastFileStorageClient storageClient;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private FastDfsConfig appConfig;   // é¡¹ç›®å‚æ•°é…ç½®</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * ä¸Šä¼ æ–‡ä»¶</span><br><span class="line">     * @param file æ–‡ä»¶å¯¹è±¡</span><br><span class="line">     * @return æ–‡ä»¶è®¿é—®åœ°å€</span><br><span class="line">     * @throws IOException</span><br><span class="line">     */</span><br><span class="line">    public String uploadFile(MultipartFile file) throws IOException &#123;</span><br><span class="line">        StorePath storePath = storageClient.uploadFile(file.getInputStream(),file.getSize(), FilenameUtils.getExtension(file.getOriginalFilename()),null);</span><br><span class="line">        return getResAccessUrl(storePath);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * æŸ¥è¯¢æ–‡ä»¶ä¿¡æ¯</span><br><span class="line">     * @param fileUrl</span><br><span class="line">     * @return  FileInfo è¿œç¨‹æ–‡ä»¶ä¿¡æ¯</span><br><span class="line">     */</span><br><span class="line">    public FileInfo getFileInfo(String fileUrl)&#123;</span><br><span class="line">        if (StringUtils.isEmpty(fileUrl)) &#123;</span><br><span class="line">            return null;</span><br><span class="line">        &#125;</span><br><span class="line">        StorePath storePath = StorePath.parseFromUrl(fileUrl);</span><br><span class="line">        return storageClient.queryFileInfo(storePath.getGroup(), storePath.getPath());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * åˆ é™¤æ–‡ä»¶</span><br><span class="line">     * @param fileUrl æ–‡ä»¶è®¿é—®åœ°å€</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    public void deleteFile(String fileUrl) &#123;</span><br><span class="line">        if (StringUtils.isEmpty(fileUrl)) &#123;</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        try &#123;</span><br><span class="line">            StorePath storePath = StorePath.parseFromUrl(fileUrl);</span><br><span class="line">            storageClient.deleteFile(storePath.getGroup(), storePath.getPath());</span><br><span class="line">        &#125; catch (FdfsUnsupportStorePathException e) &#123;</span><br><span class="line">            log.warn(e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * ä¸‹è½½æ–‡ä»¶</span><br><span class="line">     * @param fileUrl  æ–‡ä»¶è®¿é—®åœ°å€</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    public byte[] downloadFile(String fileUrl)&#123;</span><br><span class="line">        if(StringUtils.isEmpty(fileUrl))&#123;</span><br><span class="line">            return null;</span><br><span class="line">        &#125;</span><br><span class="line">        try &#123;</span><br><span class="line">            StorePath storePath = StorePath.parseFromUrl(fileUrl);</span><br><span class="line">            DownloadByteArray callback = new DownloadByteArray();</span><br><span class="line">            byte[] content = storageClient.downloadFile(storePath.getGroup(), storePath.getPath(), callback);</span><br><span class="line">            return content;</span><br><span class="line">        &#125;catch (Exception e)&#123;</span><br><span class="line">            log.warn(e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">        return null;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * æ›´æ–°æ–‡ä»¶ï¼ˆå¤å†™ï¼‰</span><br><span class="line">     * @param file</span><br><span class="line">     * @param oldFileUrl    åŸæ–‡ä»¶</span><br><span class="line">     * @return  æ–‡ä»¶è·¯å¾„</span><br><span class="line">     * @throws IOException</span><br><span class="line">     */</span><br><span class="line">    public String updateFile(MultipartFile file,String oldFileUrl) throws IOException &#123;</span><br><span class="line">        deleteFile(oldFileUrl);</span><br><span class="line">        StorePath storePath = storageClient.uploadFile(file.getInputStream(),file.getSize(), FilenameUtils.getExtension(file.getOriginalFilename()),null);</span><br><span class="line">        return getResAccessUrl(storePath);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * å°è£…å®Œæ•´URLåœ°å€</span><br><span class="line">     * @param storePath</span><br><span class="line">     */</span><br><span class="line">    private String getResAccessUrl(StorePath storePath) &#123;</span><br><span class="line">        String fileUrl = &quot;http://&quot; + appConfig.getResHost()</span><br><span class="line">                + &quot;:&quot; + appConfig.getStoragePort() + &quot;/&quot; + storePath.getFullPath();</span><br><span class="line">        return fileUrl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="â€”â€“è¿™é‡Œå·²ç»å®Œæˆæ­£å¸¸çš„CRUDæ“ä½œâ€”â€“"><a href="#â€”â€“è¿™é‡Œå·²ç»å®Œæˆæ­£å¸¸çš„CRUDæ“ä½œâ€”â€“" class="headerlink" title="â€”â€“è¿™é‡Œå·²ç»å®Œæˆæ­£å¸¸çš„CRUDæ“ä½œâ€”â€“"></a>â€”â€“è¿™é‡Œå·²ç»å®Œæˆæ­£å¸¸çš„CRUDæ“ä½œâ€”â€“</h2><h2 id="â€”â€“ä¸‹é¢æ˜¯ä¸€äº›å…·ä½“æ¡ˆä¾‹â€”â€“"><a href="#â€”â€“ä¸‹é¢æ˜¯ä¸€äº›å…·ä½“æ¡ˆä¾‹â€”â€“" class="headerlink" title="â€”â€“ä¸‹é¢æ˜¯ä¸€äº›å…·ä½“æ¡ˆä¾‹â€”â€“"></a>â€”â€“ä¸‹é¢æ˜¯ä¸€äº›å…·ä½“æ¡ˆä¾‹â€”â€“</h2><h2 id="6-å°è£…ä¸Šé¢å®Œæˆä¸Šä¼ æ–‡ä»¶å’Œæ‰¹é‡æ‰“åŒ…ä¸‹è½½"><a href="#6-å°è£…ä¸Šé¢å®Œæˆä¸Šä¼ æ–‡ä»¶å’Œæ‰¹é‡æ‰“åŒ…ä¸‹è½½" class="headerlink" title="6.å°è£…ä¸Šé¢å®Œæˆä¸Šä¼ æ–‡ä»¶å’Œæ‰¹é‡æ‰“åŒ…ä¸‹è½½"></a>6.å°è£…ä¸Šé¢å®Œæˆä¸Šä¼ æ–‡ä»¶å’Œæ‰¹é‡æ‰“åŒ…ä¸‹è½½</h2><ul><li>ä¸Šä¼ æ–‡ä»¶</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">// æ–‡ä»¶ä¸Šä¼ å¤„ç†</span><br><span class="line">@PostMapping(&quot;/upfile&quot;)</span><br><span class="line">@ResponseBody</span><br><span class="line">Result singleFileUpload(@RequestParam(&quot;file&quot;) MultipartFile file,</span><br><span class="line">                        @RequestParam(&quot;workid&quot;) int workid,</span><br><span class="line">                        @RequestParam(&quot;type&quot;) String type,</span><br><span class="line">                        @RequestParam(&quot;remarks&quot;) String remarks,</span><br><span class="line">                        @RequestParam(&quot;name&quot;) String sname,</span><br><span class="line">                        @RequestParam(&quot;studentClass&quot;) String classname,</span><br><span class="line">                        @RequestParam(&quot;studentId&quot;) String studentno,</span><br><span class="line">                        Model model,</span><br><span class="line">                        HttpServletRequest request) &#123;</span><br><span class="line"></span><br><span class="line">Result result = new Result();</span><br><span class="line">if (file.isEmpty())&#123;</span><br><span class="line">return Result.fail(400,&quot;æ–‡ä»¶ä¸å…è®¸ä¸ºç©º&quot;);</span><br><span class="line">&#125;</span><br><span class="line">// è·å–æ¥è®¿é¡µé¢url</span><br><span class="line">String referer = request.getHeader(&quot;referer&quot;);</span><br><span class="line">if(referer != null)&#123;</span><br><span class="line">model.addAttribute(&quot;referer&quot;,referer);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">model.addAttribute(&quot;referer&quot;,request.getHeader(&quot;host&quot;));</span><br><span class="line">&#125;</span><br><span class="line">// æ–‡ä»¶ä¿¡æ¯å¤„ç†</span><br><span class="line">String fname = file.getOriginalFilename();</span><br><span class="line">String filename = &quot;&quot;;</span><br><span class="line">//  å§“å-é¡¹ç›®å   å­¦å·-é¡¹ç›®å   å­¦å·-å§“å-é¡¹ç›®å   ç­çº§-å§“å-é¡¹ç›®å   ç­çº§-å§“å-å­¦å·-é¡¹ç›®å</span><br><span class="line">// å¤„ç†ä¿å­˜çš„æ–‡ä»¶å</span><br><span class="line">switch (type)&#123;</span><br><span class="line">case &quot;1&quot; : filename = sname + &quot;-&quot; + fname;break;</span><br><span class="line">case &quot;2&quot; : filename = studentno + &quot;-&quot; + fname;break;</span><br><span class="line">case &quot;3&quot; : filename = studentno + &quot;-&quot; + sname + &quot;-&quot; + fname;break;</span><br><span class="line">case &quot;4&quot; : filename = classname + &quot;-&quot; + sname + &quot;-&quot; + fname;break;</span><br><span class="line">case &quot;5&quot; : filename = classname + &quot;-&quot; + sname + &quot;-&quot; + studentno + &quot;-&quot; + fname;break;</span><br><span class="line">case &quot;6&quot; : filename = sname + &quot;.&quot; + fname.substring(fname.lastIndexOf(&quot;.&quot;) + 1);break;</span><br><span class="line">case &quot;7&quot; : filename = sname + &quot;.&quot; + fname.substring(fname.lastIndexOf(&quot;.&quot;) + 1);break;</span><br><span class="line">&#125;</span><br><span class="line">log.info(sname+ &quot;--&quot; + studentno + &quot;--&quot; + filename );</span><br><span class="line">// æ„é€ student</span><br><span class="line">Student newStudent = new Student();</span><br><span class="line">newStudent.setName(sname);</span><br><span class="line">newStudent.setClassname(classname);</span><br><span class="line">newStudent.setRemarks(remarks);</span><br><span class="line">newStudent.setUptime(new Timestamp(System.currentTimeMillis()));</span><br><span class="line">newStudent.setWorkid(workid);</span><br><span class="line">newStudent.setFilename(filename);</span><br><span class="line"></span><br><span class="line">// å…ˆæŸ¥çœ‹æ˜¯å¦é‡å¤</span><br><span class="line">Student student = studentService.getStudentBySname(workid,sname);</span><br><span class="line"></span><br><span class="line">// æ–‡ä»¶å·²æäº¤è¿‡äº†</span><br><span class="line">if(student != null)&#123;</span><br><span class="line">try&#123;</span><br><span class="line">newStudent.setId(student.getId());    // æŠŠidå¸¦èµ°</span><br><span class="line">String fileUrl = fastDFSClientUtils.updateFile(file,student.getFileurl());//ä½¿ç”¨fastDFSå†™å…¥</span><br><span class="line">newStudent.setFileurl(fileUrl);</span><br><span class="line">studentService.updateStudent(newStudent);</span><br><span class="line">return Result.success(&quot;ä½ å·²ç»æäº¤è¿‡äº†ï¼Œä¸Šä¼ æˆåŠŸï¼&quot;);</span><br><span class="line">&#125;catch (Exception e)&#123;</span><br><span class="line">return Result.fail(400,&quot;æ–‡ä»¶ä¸Šä¼ å¤±è´¥ï¼&quot;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">try&#123;</span><br><span class="line">String fileUrl = fastDFSClientUtils.uploadFile(file);</span><br><span class="line">newStudent.setFileurl(fileUrl);</span><br><span class="line">studentService.addStudent(newStudent);</span><br><span class="line">return Result.success(&quot;æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼&quot;);</span><br><span class="line">&#125;catch (Exception e)&#123;</span><br><span class="line">return Result.fail(400,&quot;æ–‡ä»¶ä¸Šä¼ å¤±è´¥ï¼&quot;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æ‰¹é‡æ‰“åŒ…ä¸‹è½½</li></ul><p>å°è£…æ‰¹é‡æ‰“åŒ…ä¸‹è½½å·¥å…·</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line">package kid1999.upload.utils;</span><br><span class="line"></span><br><span class="line">import kid1999.upload.dto.ZipModel;</span><br><span class="line">import lombok.extern.slf4j.Slf4j;</span><br><span class="line">import org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line">import org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line">import javax.servlet.http.HttpServletResponse;</span><br><span class="line">import java.io.*;</span><br><span class="line">import java.util.List;</span><br><span class="line">import java.util.zip.ZipEntry;</span><br><span class="line">import java.util.zip.ZipOutputStream;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @desc:</span><br><span class="line"> * @auther: kid1999</span><br><span class="line"> * @date: 2019/12/19 20:21</span><br><span class="line"> **/</span><br><span class="line">@Component</span><br><span class="line">@Slf4j</span><br><span class="line">public class ZipUtil &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private FastDFSClientUtils fastDFSClientUtils;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * å‹ç¼©æ–‡ä»¶åˆ—è¡¨ä¸­çš„æ–‡ä»¶</span><br><span class="line">     *</span><br><span class="line">     * @param files</span><br><span class="line">     * @param outputStream</span><br><span class="line">     * @throws IOException</span><br><span class="line">     */</span><br><span class="line">    public void zipFile(List&lt;ZipModel&gt; files, ZipOutputStream outputStream)&#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            int size = files.size();</span><br><span class="line">            //å‹ç¼©åˆ—è¡¨ä¸­çš„æ–‡ä»¶</span><br><span class="line">            for (int i = 0; i &lt; size; i++) &#123;</span><br><span class="line">                ZipModel zipModel = files.get(i);</span><br><span class="line">                zipFile(zipModel, outputStream);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            log.error(e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * å°†æ–‡ä»¶å†™å…¥åˆ°zipæ–‡ä»¶ä¸­</span><br><span class="line">     *</span><br><span class="line">     * @param zipModel</span><br><span class="line">     * @param outputstream</span><br><span class="line">     * @throws IOException</span><br><span class="line">     */</span><br><span class="line">    public  void zipFile(ZipModel zipModel, ZipOutputStream outputstream) throws IOException &#123;</span><br><span class="line">        if (zipModel != null &amp;&amp; zipModel.getFilePath() != null &amp;&amp; zipModel.getFileName() != null) &#123;</span><br><span class="line">            log.info(zipModel.getFileName() + &quot;,è¢«ä¸‹è½½: &quot; + zipModel.getFilePath());</span><br><span class="line">            byte[] content = fastDFSClientUtils.downloadFile(zipModel.getFilePath());</span><br><span class="line">            InputStream bInStream = new ByteArrayInputStream(content);</span><br><span class="line">            ZipEntry entry = new ZipEntry(zipModel.getFileName());</span><br><span class="line">            outputstream.putNextEntry(entry);</span><br><span class="line">            final int MAX_BYTE = 10 * 1024 * 1024; //æœ€å¤§çš„æµä¸º10M</span><br><span class="line">            long streamTotal = 0;      //æ¥å—æµçš„å®¹é‡</span><br><span class="line">            int streamNum = 0;      //æµéœ€è¦åˆ†å¼€çš„æ•°é‡</span><br><span class="line">            int leaveByte = 0;      //æ–‡ä»¶å‰©ä¸‹çš„å­—ç¬¦æ•°</span><br><span class="line">            byte[] inOutbyte;       //byteæ•°ç»„æ¥å—æ–‡ä»¶çš„æ•°æ®</span><br><span class="line"></span><br><span class="line">            streamTotal = bInStream.available();      //é€šè¿‡availableæ–¹æ³•å–å¾—æµçš„æœ€å¤§å­—ç¬¦æ•°</span><br><span class="line">            streamNum = (int) Math.floor(streamTotal / MAX_BYTE); //å–å¾—æµæ–‡ä»¶éœ€è¦åˆ†å¼€çš„æ•°é‡</span><br><span class="line">            leaveByte = (int) streamTotal % MAX_BYTE;    //åˆ†å¼€æ–‡ä»¶ä¹‹å,å‰©ä½™çš„æ•°é‡</span><br><span class="line"></span><br><span class="line">            if (streamNum &gt; 0) &#123;</span><br><span class="line">                for (int j = 0; j &lt; streamNum; ++j) &#123;</span><br><span class="line">                    inOutbyte = new byte[MAX_BYTE];</span><br><span class="line">                    //è¯»å…¥æµ,ä¿å­˜åœ¨byteæ•°ç»„</span><br><span class="line">                    bInStream.read(inOutbyte, 0, MAX_BYTE);</span><br><span class="line">                    outputstream.write(inOutbyte, 0, MAX_BYTE); //å†™å‡ºæµ</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            //å†™å‡ºå‰©ä¸‹çš„æµæ•°æ®</span><br><span class="line">            inOutbyte = new byte[leaveByte];</span><br><span class="line">            bInStream.read(inOutbyte, 0, leaveByte);</span><br><span class="line">            outputstream.write(inOutbyte);</span><br><span class="line">            outputstream.closeEntry();</span><br><span class="line">            bInStream.close(); //å…³é—­</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * ä¸‹è½½æ‰“åŒ…çš„æ–‡ä»¶</span><br><span class="line">     * @param file</span><br><span class="line">     * @param response</span><br><span class="line">     */</span><br><span class="line">    public void downloadZip(File file, HttpServletResponse response) &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            if (!file.exists()) &#123;</span><br><span class="line">                file.createNewFile();</span><br><span class="line">            &#125;</span><br><span class="line">            // ä»¥æµçš„å½¢å¼ä¸‹è½½æ–‡ä»¶ã€‚</span><br><span class="line">            BufferedInputStream fis = new BufferedInputStream(new FileInputStream(file.getPath()));</span><br><span class="line">            byte[] buffer = new byte[fis.available()];</span><br><span class="line">            fis.read(buffer);</span><br><span class="line">            fis.close();</span><br><span class="line">            // æ¸…ç©ºresponse</span><br><span class="line">            response.reset();</span><br><span class="line"></span><br><span class="line">            OutputStream toClient = new BufferedOutputStream(response.getOutputStream());</span><br><span class="line">            response.setContentType(&quot;application/octet-stream&quot;);</span><br><span class="line">            response.setHeader(&quot;Content-Disposition&quot;, &quot;attachment;filename=&quot; + file.getName());</span><br><span class="line">            toClient.write(buffer);</span><br><span class="line">            toClient.flush();</span><br><span class="line">            toClient.close();</span><br><span class="line">            file.delete();  //å°†ç”Ÿæˆçš„æœåŠ¡å™¨ç«¯æ–‡ä»¶åˆ é™¤</span><br><span class="line">        &#125; catch (IOException ex) &#123;</span><br><span class="line">            ex.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è°ƒç”¨æ‰¹é‡æ‰“åŒ…ä¸‹è½½å·¥å…·</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">package kid1999.upload.controller;</span><br><span class="line"></span><br><span class="line">import kid1999.upload.dto.ZipModel;</span><br><span class="line">import kid1999.upload.utils.ZipUtil;</span><br><span class="line">import lombok.extern.slf4j.Slf4j;</span><br><span class="line">import org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line">import org.springframework.web.bind.annotation.PostMapping;</span><br><span class="line">import org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line">import javax.servlet.http.HttpServletRequest;</span><br><span class="line">import javax.servlet.http.HttpServletResponse;</span><br><span class="line">import java.io.File;</span><br><span class="line">import java.io.FileOutputStream;</span><br><span class="line">import java.util.ArrayList;</span><br><span class="line">import java.util.List;</span><br><span class="line">import java.util.zip.ZipOutputStream;</span><br><span class="line"></span><br><span class="line">@RestController</span><br><span class="line">@Slf4j</span><br><span class="line">public class download &#123;</span><br><span class="line"></span><br><span class="line">@Autowired</span><br><span class="line">private ZipUtil zipUtil;</span><br><span class="line"></span><br><span class="line">@PostMapping(&quot;download&quot;)</span><br><span class="line">void download(HttpServletRequest request,</span><br><span class="line"> HttpServletResponse response) &#123;</span><br><span class="line">try &#123;</span><br><span class="line">if (request.getParameterValues(&quot;filenames&quot;) == null) &#123;</span><br><span class="line">response.sendRedirect(request.getHeader(&quot;REFERER&quot;));</span><br><span class="line">&#125; else &#123;</span><br><span class="line">List&lt;ZipModel&gt; zipModelList = new ArrayList&lt;&gt;();</span><br><span class="line">String[] filenames = request.getParameterValues(&quot;filenames&quot;);</span><br><span class="line">for (int i = 0; i &lt; filenames.length; i++) &#123;</span><br><span class="line">String[] files = filenames[i].split(&quot; &quot;);</span><br><span class="line">zipModelList.add(new ZipModel(files[0], files[1]));</span><br><span class="line">&#125;</span><br><span class="line">//todo:è®¾ç½®æ‰“åŒ…åçš„æ–‡ä»¶å</span><br><span class="line">String fileName = &quot;File.zip&quot;;</span><br><span class="line">//todo:ä¸´æ—¶æ–‡ä»¶ç›®å½•,ç”¨äºå­˜å‚¨æ‰“åŒ…çš„ä¸‹è½½æ–‡ä»¶</span><br><span class="line">String globalUploadPath = request.getSession().getServletContext().getRealPath(&quot;/&quot;);</span><br><span class="line">String outFilePath = globalUploadPath + File.separator + fileName;</span><br><span class="line">File file = new File(outFilePath);</span><br><span class="line">//æ–‡ä»¶è¾“å‡ºæµ å‹ç¼©æµ</span><br><span class="line">ZipOutputStream toClient = new ZipOutputStream(new FileOutputStream(file));</span><br><span class="line">//todo:è°ƒç”¨é€šç”¨æ–¹æ³•ä¸‹è½½fastfdsæ–‡ä»¶ï¼Œæ‰“åŒ…æˆzipæ–‡ä»¶</span><br><span class="line">zipUtil.zipFile(zipModelList, toClient);</span><br><span class="line">toClient.close();</span><br><span class="line">response.setHeader(&quot;content-disposition&quot;, &quot;attachment;fileName=&quot; + fileName);</span><br><span class="line">//todo:å°†zipæ–‡ä»¶ä¸‹è½½ä¸‹æ¥</span><br><span class="line">zipUtil.downloadZip(file, response);</span><br><span class="line">&#125;</span><br><span class="line">&#125; catch (Exception e) &#123;</span><br><span class="line">log.error(e.getMessage());</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Java web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> FastDFS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç´ æ•°ç­›æ³•</title>
      <link href="/2019/12/15/%E7%B4%A0%E6%95%B0%E7%AD%9B%E6%B3%95/"/>
      <url>/2019/12/15/%E7%B4%A0%E6%95%B0%E7%AD%9B%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h2 id="åŸƒå¼ç­›æ³•"><a href="#åŸƒå¼ç­›æ³•" class="headerlink" title="åŸƒå¼ç­›æ³•"></a>åŸƒå¼ç­›æ³•</h2><ul><li>O(n*logn)</li></ul><p>åŸç†: åˆ©ç”¨ä¸€ä¸ªæ•°ç»„ä¿å­˜0-nçš„æ•°æ®,æœªè®¿é—®è¿‡çš„å°±æ˜¯ç´ æ•°,æ¯æ¬¡ç´ æ•°ä»ç´ æ•°Nå¼€å§‹,ä¾æ¬¡é€’åŠ æ™’é™¤éç´ æ•°,ç›´åˆ°æœ€åå‰©ä¸‹çš„éƒ½æ˜¯ç´ æ•°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">åŸƒå¼ ç­›æ³•</span><br><span class="line">public int countPrimes(int n) &#123;</span><br><span class="line">    int res = 0;</span><br><span class="line">    boolean[] flag = new boolean[n+1];</span><br><span class="line">    for(int i=2;i&lt;n;i++)&#123;</span><br><span class="line">        if(!flag[i]) res++;</span><br><span class="line">        for(int j=2*i;j&lt;n;j+=i)&#123;</span><br><span class="line">            flag[j] = true;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ¬§å¼ç­›æ³•"><a href="#æ¬§å¼ç­›æ³•" class="headerlink" title="æ¬§å¼ç­›æ³•"></a>æ¬§å¼ç­›æ³•</h2><ul><li>O(n)</li></ul><p>åŸç†: åœ¨åŸƒå¼ç­›æ³•çš„åŸºç¡€ä¸Šæ’é™¤é‚£äº›é‡å¤ç­›é€‰çš„è®¡ç®—.</p><p>primeæ•°ç»„ ä¸­çš„ç´ æ•°æ˜¯é€’å¢çš„,å½“ i èƒ½æ•´é™¤ prime[j]ï¼Œé‚£ä¹ˆ i<em>prime[j+1] è¿™ä¸ªåˆæ•°è‚¯å®šè¢« prime[j] ä¹˜ä»¥æŸä¸ªæ•°ç­›æ‰ã€‚<br>å› ä¸ºiä¸­å«æœ‰prime[j], prime[j] æ¯” prime[j+1] å°ã€‚æ¥ä¸‹å»çš„ç´ æ•°åŒç†ã€‚æ‰€ä»¥ä¸ç”¨ç­›ä¸‹å»äº†ã€‚<br>åœ¨æ»¡è¶³i%prme[j]==0è¿™ä¸ªæ¡ä»¶ä¹‹å‰ä»¥åŠç¬¬ä¸€æ¬¡æ»¡è¶³æ”¹æ¡ä»¶æ—¶,prime[j]å¿…å®šæ˜¯prime[j]</em>içš„æœ€å°å› å­ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">// æ¬§å¼ ç­›æ³•</span><br><span class="line"> public int countPrimes(int n) &#123;</span><br><span class="line">    byte[] check = new byte[n];//ç”¨æ¥æ ‡è®°æ˜¯å¦å·²ç»è®¿é—®è¿‡äº†ï¼Œå¦‚æœè®¿é—®è¿‡äº†å°±æ‰“1ï¼Œæ²¡è®¿é—®è¿‡æ‰“0</span><br><span class="line">    int[] primeList = new int[n]; //ç”¨æ¥è®°ç´ æ•°</span><br><span class="line"></span><br><span class="line">    int count = 0;//ç”¨æ¥è®°å½•ç´ æ•°ä¸ªæ•°</span><br><span class="line">    for(int i = 2;i&lt; n;i++) &#123;</span><br><span class="line">        if(check[i]==0) &#123;    //æ‰“äº†1çš„å°±ä¸ä¼šå†çœ‹äº†ï¼Œé‡å¤èµ‹å€¼æµªè´¹æ—¶é—´</span><br><span class="line">            primeList[count++] = i; //countå˜é‡è®°å½•ç´ æ•°ä¸ªæ•°ï¼Œæ•°ç»„è®°å½•å·²çŸ¥çš„ç´ æ•°çš„å€¼</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        for(int j=0;j&lt;count&amp;&amp;i*primeList[j]&lt;n;j++) &#123;</span><br><span class="line">            check[i*primeList[j]] = 1; //æ ‡è®° x=i*primeList[j],xä½ç½®æ˜¯æˆ‘è®¿é—®è¿‡çš„ä½ç½®ï¼Œæ‰“1</span><br><span class="line">            if(i%primeList[j]==0) &#123;   //è¿™ä¸€éƒ¨åˆ†ä¸å¥½ç†è§£ï¼Œæ¯”æ–¹è¯´6ï¼Œä¹‹å‰è®¿é—®è¿‡ï¼ˆ2,3ï¼‰ï¼Œé‚£ä¹ˆ6%2==0,ä¸ç”¨å†æ£€æŸ¥6%3äº†ï¼ŒçœŸæ­£è´Ÿè´£è®°å½•æ•°æ®çš„æ˜¯countå˜é‡</span><br><span class="line">                break;</span><br><span class="line">            &#125;           </span><br><span class="line">        &#125;          </span><br><span class="line">    &#125;  </span><br><span class="line">    return count;   </span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><h2 id="æ™®é€šä¼˜åŒ–ç­›æ³•"><a href="#æ™®é€šä¼˜åŒ–ç­›æ³•" class="headerlink" title="æ™®é€šä¼˜åŒ–ç­›æ³•"></a>æ™®é€šä¼˜åŒ–ç­›æ³•</h2><p>åŸç†: åªç”¨éå†åˆ°iåˆ°sqrt(n),æ¯é‡åˆ°ä¸€ä¸ªè´¨æ•°,ä» iå¹³æ–¹ å¼€å§‹ä»¥ æ­¥è¿›ä¸ºi çš„ç­›</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">// æ™®é€šä¼˜åŒ– ç­›æ³•    </span><br><span class="line">public int countPrimes(int n) &#123;</span><br><span class="line">    boolean[] nums = new boolean[n];</span><br><span class="line">    //åªéœ€è¦éå†åˆ°nçš„å¹³æ–¹æ ¹</span><br><span class="line">    int sqrt = (int)Math.sqrt(n);</span><br><span class="line">    for (int i = 2; i &lt;= sqrt; i++) &#123;</span><br><span class="line">        if (!nums[i]) &#123;</span><br><span class="line">            for (int j = i * i; j &lt; n; j += i) &#123;</span><br><span class="line">                nums[j] = true;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    int res = 0;</span><br><span class="line">    for (int i = 2; i &lt; n; i++) &#123;</span><br><span class="line">        if (!nums[i])&#123;</span><br><span class="line">            res++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç»è¿‡è¯•éªŒå¯¹æ¯”ï¼Œæ¬§å¼ç­›å’Œæ™®é€šä¼˜åŒ–çš„ç­›æ³•æ‹¥æœ‰ç›¸ä¼¼çš„é€Ÿåº¦ï¼Œè€Œæ™®é€šä¼˜åŒ–æ›´åˆ©äºç†è§£ï¼Œæ‰€ä»¥æ¨èä½¿ç”¨æœ€åä¸€ç§æ–¹æ³•"><a href="#ç»è¿‡è¯•éªŒå¯¹æ¯”ï¼Œæ¬§å¼ç­›å’Œæ™®é€šä¼˜åŒ–çš„ç­›æ³•æ‹¥æœ‰ç›¸ä¼¼çš„é€Ÿåº¦ï¼Œè€Œæ™®é€šä¼˜åŒ–æ›´åˆ©äºç†è§£ï¼Œæ‰€ä»¥æ¨èä½¿ç”¨æœ€åä¸€ç§æ–¹æ³•" class="headerlink" title="ç»è¿‡è¯•éªŒå¯¹æ¯”ï¼Œæ¬§å¼ç­›å’Œæ™®é€šä¼˜åŒ–çš„ç­›æ³•æ‹¥æœ‰ç›¸ä¼¼çš„é€Ÿåº¦ï¼Œè€Œæ™®é€šä¼˜åŒ–æ›´åˆ©äºç†è§£ï¼Œæ‰€ä»¥æ¨èä½¿ç”¨æœ€åä¸€ç§æ–¹æ³•"></a>ç»è¿‡è¯•éªŒå¯¹æ¯”ï¼Œæ¬§å¼ç­›å’Œæ™®é€šä¼˜åŒ–çš„ç­›æ³•æ‹¥æœ‰ç›¸ä¼¼çš„é€Ÿåº¦ï¼Œè€Œæ™®é€šä¼˜åŒ–æ›´åˆ©äºç†è§£ï¼Œæ‰€ä»¥æ¨èä½¿ç”¨æœ€åä¸€ç§æ–¹æ³•</h3>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç´ æ•°ç­›æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>äºŒåˆ†æ¨¡æ¿</title>
      <link href="/2019/12/15/%E4%BA%8C%E5%88%86%E6%A8%A1%E6%9D%BF/"/>
      <url>/2019/12/15/%E4%BA%8C%E5%88%86%E6%A8%A1%E6%9D%BF/</url>
      
        <content type="html"><![CDATA[<h2 id="äºŒåˆ†æ¨¡æ¿"><a href="#äºŒåˆ†æ¨¡æ¿" class="headerlink" title="äºŒåˆ†æ¨¡æ¿"></a>äºŒåˆ†æ¨¡æ¿</h2><ul><li>æœ‰å•è°ƒæ€§ä¸€å®šå¯ä»¥äºŒåˆ†ï¼Œå¯ä»¥äºŒåˆ†çš„ï¼Œä¸ä¸€å®šå…·æœ‰å•è°ƒæ€§</li></ul><h4 id="1-æ•´æ•°äºŒåˆ†æ¨¡æ¿"><a href="#1-æ•´æ•°äºŒåˆ†æ¨¡æ¿" class="headerlink" title="1.æ•´æ•°äºŒåˆ†æ¨¡æ¿"></a>1.æ•´æ•°äºŒåˆ†æ¨¡æ¿</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">bool check(int x) &#123;/* ... */&#125; // æ£€æŸ¥xæ˜¯å¦æ»¡è¶³æŸç§æ€§è´¨</span><br><span class="line"></span><br><span class="line">// åŒºé—´[l, r]è¢«åˆ’åˆ†æˆ[l, mid]å’Œ[mid + 1, r]æ—¶ä½¿ç”¨ï¼š</span><br><span class="line">int bsearch_1(int l, int r)</span><br><span class="line">&#123;</span><br><span class="line">    while (l &lt; r)</span><br><span class="line">    &#123;</span><br><span class="line">        int mid = l + r &gt;&gt; 1;</span><br><span class="line">        if (check(mid)) r = mid;    // check()åˆ¤æ–­midæ˜¯å¦æ»¡è¶³æ€§è´¨</span><br><span class="line">        else l = mid + 1;</span><br><span class="line">    &#125;</span><br><span class="line">    return l;</span><br><span class="line">&#125;</span><br><span class="line">// åŒºé—´[l, r]è¢«åˆ’åˆ†æˆ[l, mid - 1]å’Œ[mid, r]æ—¶ä½¿ç”¨ï¼š</span><br><span class="line">int bsearch_2(int l, int r)</span><br><span class="line">&#123;</span><br><span class="line">    while (l &lt; r)</span><br><span class="line">    &#123;</span><br><span class="line">        int mid = l + r + 1 &gt;&gt; 1;   //å‘å³é€¼è¿‘æ—¶ä¿è¯+1å‘ä¸Šå–æ•´</span><br><span class="line">        if (check(mid)) l = mid;</span><br><span class="line">        else r = mid - 1;</span><br><span class="line">    &#125;</span><br><span class="line">    return l;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// åŒºé—´[l, r]è¢«åˆ’åˆ†æˆ[l, mid - 1]å’Œ[mid+1, r]æ—¶ä½¿ç”¨ï¼š</span><br><span class="line">int bsearch_3(int l, int r)</span><br><span class="line">&#123;</span><br><span class="line">    while(l&lt;=r)&#123;</span><br><span class="line">        int mid = l+r&gt;&gt;1;</span><br><span class="line">        if(check(mid)) return mid;</span><br><span class="line">        else if(target &gt; M.get(mid)) r = mid-1;</span><br><span class="line">        else l = mid+1;</span><br><span class="line">    &#125;</span><br><span class="line">    return -1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="ä¸¤ä¸ªæ¨¡æ¿çš„åŒºåˆ«"><a href="#ä¸¤ä¸ªæ¨¡æ¿çš„åŒºåˆ«" class="headerlink" title="ä¸¤ä¸ªæ¨¡æ¿çš„åŒºåˆ«:"></a>ä¸¤ä¸ªæ¨¡æ¿çš„åŒºåˆ«:</h5><p>å½“target==nums[mid] æ—¶è¿”å› r = mid; å‘å·¦é€¼è¿‘,è¿”å›å·¦è¾¹ç•Œ</p><p>å½“target==nums[mid] æ—¶è¿”å› l = mid; å‘å³é€¼è¿‘,è¿”å›å³è¾¹ç•Œ</p><h4 id="2-å°æ•°äºŒåˆ†æ¨¡æ¿"><a href="#2-å°æ•°äºŒåˆ†æ¨¡æ¿" class="headerlink" title="2.å°æ•°äºŒåˆ†æ¨¡æ¿"></a>2.å°æ•°äºŒåˆ†æ¨¡æ¿</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">bool check(double x) &#123;/* ... */&#125; // æ£€æŸ¥xæ˜¯å¦æ»¡è¶³æŸç§æ€§è´¨</span><br><span class="line"></span><br><span class="line">double bsearch_3(double l, double r)</span><br><span class="line">&#123;</span><br><span class="line">    const double eps = 1e-6;   // eps è¡¨ç¤ºç²¾åº¦ï¼Œå–å†³äºé¢˜ç›®å¯¹ç²¾åº¦çš„è¦æ±‚</span><br><span class="line">    while (r - l &gt; eps)</span><br><span class="line">    &#123;</span><br><span class="line">        double mid = (l + r) / 2;</span><br><span class="line">        if (check(mid)) r = mid;</span><br><span class="line">        else l = mid;</span><br><span class="line">    &#125;</span><br><span class="line">    return l;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å¤‡æ³¨ï¼š"><a href="#å¤‡æ³¨ï¼š" class="headerlink" title="å¤‡æ³¨ï¼š"></a>å¤‡æ³¨ï¼š</h3><ul><li>æœç´¢æ—¶å¯ä»¥ç”¨äºŒåˆ†ä¹Ÿå¯ä»¥ç”¨åŒæŒ‡é’ˆ</li><li>äºŒåˆ†éœ€è¦å¯¹ä¸­é—´å€¼è¿›è¡Œæ¯”è¾ƒçš„æƒ…å†µ</li><li>åŒæŒ‡é’ˆéœ€è¦å¯¹ä¸¤ä¸ªæ•°çš„å’Œè¿›è¡Œæ¯”è¾ƒçš„æƒ…å†µ</li></ul>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> äºŒåˆ† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¿«é€Ÿå¹‚</title>
      <link href="/2019/12/15/%E5%BF%AB%E9%80%9F%E5%B9%82/"/>
      <url>/2019/12/15/%E5%BF%AB%E9%80%9F%E5%B9%82/</url>
      
        <content type="html"><![CDATA[<h4 id="1-a-b-é¢˜é“¾æ¥"><a href="#1-a-b-é¢˜é“¾æ¥" class="headerlink" title="1. a ^ b : é¢˜é“¾æ¥"></a>1. a ^ b : <a href="https://www.acwing.com/problem/content/877/" target="_blank" rel="noopener">é¢˜é“¾æ¥</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">a ^ b = </span><br><span class="line">a * a * a * a * a .....</span><br><span class="line">æŠŠ æŒ‡æ•°b åŒ–ä½œäºŒè¿›åˆ¶  = </span><br><span class="line">a ^ 1 * a ^ 2 * a ^ 4 ....</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// ä¾‹å¦‚: æ±‚ m^k % p</span><br><span class="line">public static int qmi(int m, int k, int p)&#123;</span><br><span class="line">int res = 1, t = m;</span><br><span class="line">while(k &gt; 0)&#123;</span><br><span class="line">if( (k&amp;1) == 1)&#123;</span><br><span class="line">res = res * t % p;</span><br><span class="line">&#125;</span><br><span class="line">t = t * t % p;  //t^1 t^2 t^4 ...</span><br><span class="line">k = k&gt;&gt;1;</span><br><span class="line">&#125;</span><br><span class="line">return res % p;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-a-b-é¢˜é“¾æ¥"><a href="#2-a-b-é¢˜é“¾æ¥" class="headerlink" title="2. a * b : é¢˜é“¾æ¥"></a>2. a * b : <a href="https://www.acwing.com/problem/content/92/" target="_blank" rel="noopener">é¢˜é“¾æ¥</a></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">a * b = </span><br><span class="line">a + a + a + a + a .....</span><br><span class="line">æŠŠ æŒ‡æ•°b åŒ–ä½œäºŒè¿›åˆ¶  = </span><br><span class="line">a * 1 + a * 2 + a * 4 ....</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// ä¾‹å¦‚: æ±‚ m*k % p</span><br><span class="line">public static int qci(int m, int k, int p)&#123;</span><br><span class="line">int res = 0, t = m;</span><br><span class="line">while(k &gt; 0)&#123;</span><br><span class="line">if((b&amp;1) == 1) res = (res + t) % p;</span><br><span class="line">        t = (t * 2) % p;</span><br><span class="line">        b &gt;&gt;= 1;</span><br><span class="line">&#125;</span><br><span class="line">return res % p;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¿«é€Ÿå¹‚ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>èƒŒåŒ…æ¨¡æ¿</title>
      <link href="/2019/12/15/%E8%83%8C%E5%8C%85%E6%A8%A1%E6%9D%BF/"/>
      <url>/2019/12/15/%E8%83%8C%E5%8C%85%E6%A8%A1%E6%9D%BF/</url>
      
        <content type="html"><![CDATA[<h2 id="1-ç®€ä»‹"><a href="#1-ç®€ä»‹" class="headerlink" title="1. ç®€ä»‹"></a>1. ç®€ä»‹</h2><ol><li><p>0-1èƒŒåŒ…é—®é¢˜ : å¯¹äºç‰©å“è€Œè¨€åªèƒ½é€‰æ‹©1ä¸ªæˆ–è€…0ä¸ªä¸¤ç§æƒ…å†µ(é€‰ä¸é€‰)</p></li><li><p>å®Œå…¨èƒŒåŒ… : å¯¹äºç‰©å“è€Œè¨€å¯ä»¥æ— é™åˆ¶é€‰å–,ä¹Ÿå¯ä»¥ä¸é€‰</p></li><li><p>å¤šé‡èƒŒåŒ… : å¯¹äºæŸç‰©å“è€Œè¨€æœ€å¤šèƒ½å¤Ÿé€‰æ‹©ä»sä¸ª,åŒæ ·ä¹Ÿå¯ä¸é€‰</p></li><li><p>æ··åˆèƒŒåŒ… : æœ‰äº›ç‰©å“å¯ä»¥é€‰æ‹©1,æœ‰äº›ç‰©å“å¯ä»¥é€‰æ‹©æ— æ•°ä¸ª,æœ‰äº›ç‰©å“åªèƒ½é€‰æ‹©æ˜¯s[i]ä¸ª.å³:01èƒŒåŒ…+å®Œå…¨èƒŒåŒ…+å¤šé‡èƒŒåŒ…</p></li><li><p>äºŒç»´è´¹ç”¨èƒŒåŒ… : åœ¨é‡é‡çš„åŸºç¡€ä¸Šå¢åŠ ç©ºé—´çš„é™åˆ¶</p></li><li><p>åˆ†ç»„èƒŒåŒ…:å¤šé‡èƒŒåŒ…çš„æ™®éç‰ˆæœ¬ ä¸€äº›ç‰©å“æ†ç»‘åœ¨ä¸€èµ·,æ¯ä¸€ç»„ç‰©å“ä¸­åªèƒ½é€‰æ‹©å…¶ä¸­çš„ä¸€ä¸ªç‰©å“s[i]</p></li><li><p>è´ªå¿ƒ : å¯¹äºç‰©å“åªéœ€è¦ä»·å€¼æ¯”æœ€å¤§,ç‰©å“å¯åˆ†</p></li></ol><h3 id="1-0-1èƒŒåŒ…-å‚è€ƒ"><a href="#1-0-1èƒŒåŒ…-å‚è€ƒ" class="headerlink" title="1. 0-1èƒŒåŒ… å‚è€ƒ"></a>1. 0-1èƒŒåŒ… <a href="https://www.acwing.com/problem/content/2/" target="_blank" rel="noopener">å‚è€ƒ</a></h3><p>dp è§£é‡Š : å‰iä¸ªç‰©å“åœ¨ç©ºé—´ä¸ºjçš„æƒ…å†µä¸‹çš„ (æœ€å€¼)</p><h5 id="1-æœ´ç´ ç‰ˆ"><a href="#1-æœ´ç´ ç‰ˆ" class="headerlink" title="1.æœ´ç´ ç‰ˆ"></a>1.æœ´ç´ ç‰ˆ</h5><p><code>æ™®é€š0-1èƒŒåŒ…:  dp[i][j] = max(dp[i-1][j] , dp[i-1][jâˆ’w[i]] + v[i])</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">import java.util.Scanner;</span><br><span class="line"></span><br><span class="line">public class Main &#123;</span><br><span class="line">  public static void main(String[] args) &#123;</span><br><span class="line">    Scanner sc = new Scanner(System.in);</span><br><span class="line">    int w = sc.nextInt();</span><br><span class="line">    int n = sc.nextInt();</span><br><span class="line">    int[][] dp = new int[n+1][w+1];</span><br><span class="line">    int[] weight = new int[n+1];</span><br><span class="line">    int[] value = new int[n+1];</span><br><span class="line">    for (int i = 1; i &lt;=n ; i++) &#123;</span><br><span class="line">      weight[i] = sc.nextInt();</span><br><span class="line">      value[i] = sc.nextInt();</span><br><span class="line">    &#125;</span><br><span class="line">    // è‹¥æ˜¯æ¯”ç¬¬iä¸ªç‰©å“åœ¨j çš„ç©ºé—´ä¸‹æ”¾ä¸ä¸‹ å°±å–å‰ä¸€ä¸ªç‰©å“çš„æœ€å¤§å€¼ å¡«å…… ,è‹¥æ”¾å¾—ä¸‹ å°±æ¯”è¾ƒæ”¾äºä¸æ”¾ </span><br><span class="line">    for (int i = 1; i &lt;=n ; i++) &#123;</span><br><span class="line">      for (int j = 1; j &lt;=w ; j++) &#123;</span><br><span class="line">        if(weight[i] &gt; j)&#123;</span><br><span class="line">          dp[i][j] = dp[i-1][j];</span><br><span class="line">        &#125;else&#123;      //å˜æ•°åœ¨è¿™é‡Œ dpé€’æ¨æ–¹ç¨‹</span><br><span class="line">          int v1 = dp[i-1][j];</span><br><span class="line">          int v2 = dp[i-1][j-weight[i]] + value[i]*weight[i]; </span><br><span class="line">          dp[i][j] = Math.max(v1,v2);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    System.out.println(dp[n][w]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="2-ä¸€ç»´ç©ºé—´ä¼˜åŒ–ç‰ˆ"><a href="#2-ä¸€ç»´ç©ºé—´ä¼˜åŒ–ç‰ˆ" class="headerlink" title="2.ä¸€ç»´ç©ºé—´ä¼˜åŒ–ç‰ˆ"></a>2.ä¸€ç»´ç©ºé—´ä¼˜åŒ–ç‰ˆ</h5><p><code>ç©ºé—´ä¼˜åŒ–0-1èƒŒåŒ…:  f[j] = max(f[j] , f[jâˆ’w[i]] + v[i])</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">for (int i = 1; i &lt;= n; i++)</span><br><span class="line">for (int j = W; j &gt;= w[i]; j--)</span><br><span class="line">f[j] = max(f[j], f[j - w[i]] + v[i]);</span><br><span class="line">printf(&quot;%d\n&quot;, f[W]);</span><br></pre></td></tr></table></figure><h4 id="ç†è§£ç©ºé—´ä¼˜åŒ–"><a href="#ç†è§£ç©ºé—´ä¼˜åŒ–" class="headerlink" title="ç†è§£ç©ºé—´ä¼˜åŒ–:"></a>ç†è§£ç©ºé—´ä¼˜åŒ–:</h4><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å†…å±‚å¾ªç¯å¯¹äºå®¹é‡çš„è®¡ç®—æ˜¯é€†åºçš„ã€‚æœ¬æ¥ä¹‹å‰äºŒç»´çš„æ•°ç»„ï¼Œæ˜¯åˆ©ç”¨ä¸Šä¸€å±‚æ¥è½¬ç§»åˆ°ä¸‹ä¸€å±‚æ¥è¡¨ç¤ºæ¯ä¸ªç‰©å“æœ€å¤šåªèƒ½æ‹¿ä¸€æ¬¡ã€‚ç°åœ¨ä¸¢å¼ƒäº†ä¸€ä¸ªç‰©å“ç»´åº¦ï¼Œæ— æ³•è¿™æ ·è¡¨ç¤ºã€‚æ‰€ä»¥å¯ä»¥å€’åºæšä¸¾ç©ºé—´å¤§å°ï¼Œè½¬ç§»ä¹‹å‰çš„çŠ¶æ€éƒ½æ˜¯æœªæ›´æ–°çš„ï¼Œè¿™æ ·æ¥è¡¨ç¤ºæ¯ä¸ªç‰©å“åªèƒ½å¤Ÿæ‹¿ä¸€æ¬¡</p><p>å½“æˆ‘ä»¬è®¡ç®—f[j]æ—¶ï¼Œç”¨åˆ°äº†f[j]å’Œf[j-w[i]]ï¼Œf[j]è¡¨ç¤ºä¸æ‹¿å½“å‰çš„ç‰©å“ï¼Œf[j-w[i]]è¡¨ç¤ºæ‹¿å½“å‰çš„ç‰©å“ã€‚å› ä¸ºå¯¹äºå®¹é‡æ˜¯ä»å¤§åˆ°å°é€†åºè®¡ç®—çš„ï¼Œæ‰€ä»¥f[j-w[i]]æ˜¯æ²¡æœ‰è¢«æ›´æ–°è¿‡çš„ï¼Œè¡¨ç¤ºè¿˜æ²¡æœ‰æ‹¿å½“å‰å±‚çš„ç‰©å“ï¼Œè¿™æ ·å°±è¡¨ç¤ºæ¯ä¸ªç‰©å“æœ€å¤šåªèƒ½æ‹¿ä¸€æ¬¡ã€‚</p><p>è€Œå¦‚æœæ­£å‘ä»å°åˆ°å¤§è¿›è¡Œè®¡ç®—ï¼Œf[j-w[i]]åˆ™æ˜¯å·²ç»æ›´æ–°è¿‡çš„ï¼Œè¿™æ ·å°±è¡¨ç¤ºæ¯ä¸ªç‰©å“éƒ½èƒ½æ‹¿æ— æ•°æ¬¡ï¼Œè¿™æ ·æ­£å‘è®¡ç®—å°±æˆäº†å®Œå…¨èƒŒåŒ…ã€‚</p><h3 id="2-å®Œå…¨èƒŒåŒ…-å‚è€ƒ"><a href="#2-å®Œå…¨èƒŒåŒ…-å‚è€ƒ" class="headerlink" title="2.å®Œå…¨èƒŒåŒ… å‚è€ƒ"></a>2.å®Œå…¨èƒŒåŒ… <a href="https://www.acwing.com/problem/content/3/" target="_blank" rel="noopener">å‚è€ƒ</a></h3><h5 id="1-æœ´ç´ ç‰ˆ-1"><a href="#1-æœ´ç´ ç‰ˆ-1" class="headerlink" title="1.æœ´ç´ ç‰ˆ"></a>1.æœ´ç´ ç‰ˆ</h5><p><code>dp[i][j] = max(dp[i-1][j] , dp[i][jâˆ’w[i]] + v[i])</code></p><p>æœ´ç´ ç‰ˆç±»ä¼¼ä¸Šé¢ åªæ˜¯dpé€’æ¨æ—¶å¯ä»¥æ˜¯ <code>max(dp[i-1][j] , dp[i][jâˆ’w[i]] + v[i])</code> å³å¯ä»¥å¤šæ¬¡é€‰æ‹©æœ¬ç‰©å“</p><h5 id="2-ä¸€ç»´ç©ºé—´ä¼˜åŒ–ç‰ˆ-1"><a href="#2-ä¸€ç»´ç©ºé—´ä¼˜åŒ–ç‰ˆ-1" class="headerlink" title="2.ä¸€ç»´ç©ºé—´ä¼˜åŒ–ç‰ˆ"></a>2.ä¸€ç»´ç©ºé—´ä¼˜åŒ–ç‰ˆ</h5><p>æ­¤ä¸ºæ´›è°·1616é¢˜,æ±‚å•ä½æ—¶é—´å†…é‡‡è¯ä»·å€¼æœ€å¤§<br>(è¿ç”¨ä¸€ç»´ä¼˜åŒ–ç©ºé—´)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import java.util.Scanner;</span><br><span class="line">public class P1616 &#123;</span><br><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">Scanner sc = new Scanner(System.in);</span><br><span class="line">int t = sc.nextInt();</span><br><span class="line">int m = sc.nextInt();</span><br><span class="line">int[] dp = new int[t+1];</span><br><span class="line">int[] weight = new int[m+1];</span><br><span class="line">int[] value = new int[m+1];</span><br><span class="line">for (int i = 1; i &lt;=m ; i++) &#123;</span><br><span class="line">weight[i] = sc.nextInt();</span><br><span class="line">value[i] = sc.nextInt();</span><br><span class="line">&#125;</span><br><span class="line">for (int i = 1; i &lt;=m ; i++) &#123;</span><br><span class="line">for (int j = weight[i]; j &lt;=t; j++) &#123;</span><br><span class="line">dp[j] = Math.max(dp[j],dp[j-weight[i]] + value[i]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">System.out.println(dp[t]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-å¤šé‡èƒŒåŒ…-å‚è€ƒ"><a href="#3-å¤šé‡èƒŒåŒ…-å‚è€ƒ" class="headerlink" title="3.å¤šé‡èƒŒåŒ… å‚è€ƒ"></a>3.å¤šé‡èƒŒåŒ… <a href="https://www.acwing.com/problem/content/4/" target="_blank" rel="noopener">å‚è€ƒ</a></h3><ul><li>è§£æ³•ç±»ä¼¼01èƒŒåŒ… è½¬åŒ–ä¸º0kèƒŒåŒ…<h5 id="1-æœ´ç´ ç‰ˆ-2"><a href="#1-æœ´ç´ ç‰ˆ-2" class="headerlink" title="1.æœ´ç´ ç‰ˆ"></a>1.æœ´ç´ ç‰ˆ</h5><code>dp[i][j] = max(dp[i-1][j-k*w[i]] + k*v[i]) | 0&lt;=k&lt;=n[i]</code></li></ul><ul><li>æœ´ç´ ç‰ˆç±»: åœ¨å‰iä¸ªç‰©å“å¯é€‰ï¼Œå®¹é‡ä¸ºjçš„æƒ…å†µä¸‹ï¼Œé€‰kä¸ªç‰©å“çš„æœ€å¤§å€¼</li><li>å³å¯ä»¥é€‰æ‹©kæ¬¡æœ¬ç‰©å“</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import java.util.Scanner;</span><br><span class="line">public class Main &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        Scanner sc = new Scanner(System.in);</span><br><span class="line">        int n = sc.nextInt();</span><br><span class="line">        int v = sc.nextInt();</span><br><span class="line">        int[] weight = new int[n+1];</span><br><span class="line">        int[] values = new int[n+1];</span><br><span class="line">        int[] counts = new int[n+1];</span><br><span class="line">        for (int i = 0; i &lt;n ; i++) &#123;</span><br><span class="line">            weight[i] = sc.nextInt();</span><br><span class="line">            values[i] = sc.nextInt();</span><br><span class="line">            counts[i] = sc.nextInt();</span><br><span class="line">        &#125;</span><br><span class="line">        int[] dp = new int[v+1];</span><br><span class="line">        for (int i = 0; i &lt;n ; i++) &#123;</span><br><span class="line">            for (int j = v; j &gt;= 0 ; j--) &#123;</span><br><span class="line">                for (int k = 1; k&lt;=counts[i] &amp;&amp; k*weight[i] &lt;= j ; k++) &#123;</span><br><span class="line">                    dp[j] = Math.max(dp[j],dp[j-k*weight[i]]+k*values[i]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(dp[v]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="2-äºŒè¿›åˆ¶ä¼˜åŒ–"><a href="#2-äºŒè¿›åˆ¶ä¼˜åŒ–" class="headerlink" title="2.äºŒè¿›åˆ¶ä¼˜åŒ–"></a>2.äºŒè¿›åˆ¶ä¼˜åŒ–</h5><ul><li>é¦–å…ˆå°†æ‰€æœ‰k*w å•ç‹¬è¡¨ç¤ºæˆä¸€ä¸ªä¸ªé‡kwä»·å€¼kvçš„ç‰©å“</li><li>åˆ©ç”¨ç±»ä¼¼å¿«é€Ÿå¹‚çš„æ€æƒ³ï¼Œç”¨k = 1,2,4,8.. + ä½™æ•°å¯ä»¥è¡¨ç¤ºå–kæ¬¡è¯¥ç‰©å“</li><li>æ—¶é—´å¤æ‚åº¦ä»N^3 é™åˆ°N^2*logN</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">        Scanner sc = new Scanner(System.in);</span><br><span class="line">        int n = sc.nextInt();</span><br><span class="line">        int w = sc.nextInt();</span><br><span class="line">        List&lt;Pair&lt;Integer,Integer&gt;&gt; goods = new ArrayList&lt;&gt;();</span><br><span class="line">        for (int i = 0; i &lt;n ; i++) &#123;</span><br><span class="line">            int weight = sc.nextInt();</span><br><span class="line">            int value = sc.nextInt();</span><br><span class="line">            int count = sc.nextInt();</span><br><span class="line">            for (int j = 1; j &lt;=count ; j*=2) &#123;</span><br><span class="line">                count -= j;</span><br><span class="line">                goods.add(new Pair&lt;&gt;(weight*j,value*j));</span><br><span class="line">            &#125;</span><br><span class="line">            if(count &gt; 0) goods.add(new Pair&lt;&gt;(count*weight,count*value));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        int[] dp = new int[w+1];</span><br><span class="line">        for (Pair&lt;Integer,Integer&gt; good:goods) &#123;</span><br><span class="line">            for (int j = w; j &gt;=good.getKey() ; j--) &#123;</span><br><span class="line">                dp[j] = Math.max(dp[j],dp[j-good.getKey()]+good.getValue());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(dp[w]);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="4-æ··åˆèƒŒåŒ…-å‚è€ƒ"><a href="#4-æ··åˆèƒŒåŒ…-å‚è€ƒ" class="headerlink" title="4.æ··åˆèƒŒåŒ… å‚è€ƒ"></a>4.æ··åˆèƒŒåŒ… <a href="https://www.acwing.com/problem/content/7/" target="_blank" rel="noopener">å‚è€ƒ</a></h3><ul><li><p>å°†å„ç§èƒŒåŒ…åˆ†ç±»å¤„ç†</p><h5 id="1-æœ´ç´ ç‰ˆ-3"><a href="#1-æœ´ç´ ç‰ˆ-3" class="headerlink" title="1.æœ´ç´ ç‰ˆ"></a>1.æœ´ç´ ç‰ˆ</h5></li><li><p>å°†å¤šé‡èƒŒåŒ…å¤„ç†ä¸º01èƒŒåŒ…</p></li><li><p>å¯¹01å’Œå®Œå…¨èƒŒåŒ…åˆ†å¼€å¤„ç†</p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">import java.util.ArrayList;</span><br><span class="line">import java.util.List;</span><br><span class="line">import java.util.Scanner;</span><br><span class="line"></span><br><span class="line">public class æ··åˆèƒŒåŒ… &#123;</span><br><span class="line"></span><br><span class="line">    private static class Thing&#123;</span><br><span class="line">        int kind;   // ç§ç±»</span><br><span class="line">        int weight;  // é‡é‡</span><br><span class="line">        int value;   // ä»·å€¼</span><br><span class="line">        Thing(int kind,int weight,int value)&#123;</span><br><span class="line">            this.kind = kind;</span><br><span class="line">            this.value = value;</span><br><span class="line">            this.weight = weight;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        Scanner sc = new Scanner(System.in);</span><br><span class="line">        int n = sc.nextInt();</span><br><span class="line">        int w = sc.nextInt();</span><br><span class="line">        List&lt;Thing&gt; things = new ArrayList&lt;&gt;();</span><br><span class="line">        for (int i = 0; i &lt;n ; i++) &#123;</span><br><span class="line">            int weight = sc.nextInt();</span><br><span class="line">            int value = sc.nextInt();</span><br><span class="line">            int count = sc.nextInt();</span><br><span class="line">            if(count &lt; 0) things.add(new Thing(-1,weight,value));       // 01èƒŒåŒ…</span><br><span class="line">            else if(count == 0) things.add(new Thing(0,weight,value));  // å®Œå…¨èƒŒåŒ…</span><br><span class="line">            else&#123;                                                            // å¤šé‡èƒŒåŒ…</span><br><span class="line">                for (int j = 1; j &lt;=count ; j*=2) &#123;</span><br><span class="line">                    count -= j;</span><br><span class="line">                    things.add(new Thing(-1,weight*j,value*j));</span><br><span class="line">                &#125;</span><br><span class="line">                if(count &gt; 0) things.add(new Thing(-1,weight*count,value*count));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        int[] dp = new int[w+1];</span><br><span class="line">        for (Thing thing:things) &#123;</span><br><span class="line">            if(thing.kind &lt; 0)&#123;</span><br><span class="line">                for (int j = w; j &gt;=thing.weight ; j--) dp[j] = Math.max(dp[j],dp[j-thing.weight]+thing.value);</span><br><span class="line">            &#125;else&#123;</span><br><span class="line">                for (int j = thing.weight; j &lt;= w ; j++) dp[j] = Math.max(dp[j],dp[j-thing.weight]+thing.value);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(dp[w]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-äºŒç»´è´¹ç”¨èƒŒåŒ…-å‚è€ƒ"><a href="#5-äºŒç»´è´¹ç”¨èƒŒåŒ…-å‚è€ƒ" class="headerlink" title="5.äºŒç»´è´¹ç”¨èƒŒåŒ… å‚è€ƒ"></a>5.äºŒç»´è´¹ç”¨èƒŒåŒ… <a href="https://www.acwing.com/problem/content/8/" target="_blank" rel="noopener">å‚è€ƒ</a></h3><ul><li><p>dp[i] å˜ä¸ºäºŒç»´çš„ dp[i][j] è¡¨ç¤ºäºŒç»´ç©ºé—´çš„å®¹é‡</p><h5 id="1-æœ´ç´ ç‰ˆ-4"><a href="#1-æœ´ç´ ç‰ˆ-4" class="headerlink" title="1.æœ´ç´ ç‰ˆ"></a>1.æœ´ç´ ç‰ˆ</h5></li><li><p>å’Œä¸€ç»´èƒŒåŒ…ç±»ä¼¼ï¼Œåªæ˜¯åšäºŒç»´çš„æ‰©å±•äº†</p></li><li><p>å¦‚æœ¬é¢˜å°±æ˜¯åœ¨01èƒŒåŒ…çš„åŸºç¡€ä¸Šåšäº†ç©ºé—´çš„é™åˆ¶</p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import java.util.Scanner;</span><br><span class="line">public class äºŒç»´è´¹ç”¨èƒŒåŒ… &#123;</span><br><span class="line">    // åœ¨é‡é‡çš„åŸºç¡€ä¸Š é™åˆ¶ä½“ç§¯</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        Scanner sc = new Scanner(System.in);</span><br><span class="line">        int n = sc.nextInt();</span><br><span class="line">        int w = sc.nextInt();   // é‡é‡</span><br><span class="line">        int v = sc.nextInt();   // ä½“ç§¯</span><br><span class="line">        int[][] dp = new int[w+1][v+1];</span><br><span class="line">        for (int i = 0; i &lt;n ; i++) &#123;</span><br><span class="line">            int weight = sc.nextInt();</span><br><span class="line">            int volume = sc.nextInt();</span><br><span class="line">            int value = sc.nextInt();</span><br><span class="line">            for (int j = w; j &gt;=weight ; j--) &#123;</span><br><span class="line">                for (int k = v; k &gt;=volume ; k--) &#123;</span><br><span class="line">                    dp[j][k] = Math.max(dp[j][k],dp[j-weight][k-volume]+value);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(dp[w][v]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="6-åˆ†ç»„èƒŒåŒ…-å‚è€ƒ"><a href="#6-åˆ†ç»„èƒŒåŒ…-å‚è€ƒ" class="headerlink" title="6.åˆ†ç»„èƒŒåŒ… å‚è€ƒ"></a>6.åˆ†ç»„èƒŒåŒ… <a href="https://www.acwing.com/problem/content/9/" target="_blank" rel="noopener">å‚è€ƒ</a></h3><ul><li>å®é™…ä¸Šä¹Ÿæ˜¯åŸºäº01èƒŒåŒ…</li><li>æ˜¯å¤šé‡èƒŒåŒ…çš„æ™®éç‰ˆï¼Œç›¸å½“äºå¤šé‡èƒŒåŒ…çš„åˆ†è§£ä¸º wâ€¦kwçš„ç‰©å“ è€Œåˆ†ç»„èƒŒåŒ…å°±æ˜¯w[0]..w[k]çš„ç‰©å“ åŒç»„ç‰©å“ä¹‹é—´æ— å…³è”</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">import java.util.Scanner;</span><br><span class="line">public class åˆ†ç»„èƒŒåŒ… &#123;</span><br><span class="line">    // åœ¨01èƒŒåŒ…çš„åŸºç¡€ä¸Š åˆ’åˆ†ç»„</span><br><span class="line">    // ç›¸å½“äº å¤šé‡èƒŒåŒ…çš„ æ™®éæƒ…å†µ</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        Scanner sc = new Scanner(System.in);</span><br><span class="line">        int n = sc.nextInt();</span><br><span class="line">        int w = sc.nextInt();</span><br><span class="line">        int[] dp = new int[w+1];</span><br><span class="line">        for (int i = 0; i &lt; n; i++) &#123;</span><br><span class="line">            int len = sc.nextInt();</span><br><span class="line">            int[] weight = new int[len+1];</span><br><span class="line">            int[] values = new int[len+1];</span><br><span class="line">            for (int j = 0; j &lt;len ; j++) &#123;</span><br><span class="line">                weight[j] = sc.nextInt();</span><br><span class="line">                values[j] = sc.nextInt();</span><br><span class="line">            &#125;</span><br><span class="line">            for (int j = w; j &gt;=0 ; j--) &#123;</span><br><span class="line">                for (int k = 0; k &lt; len; k++) &#123;</span><br><span class="line">                    if(j &gt;= weight[k]) dp[j] = Math.max(dp[j],dp[j-weight[k]]+values[k]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(dp[w]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> èƒŒåŒ…é—®é¢˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æœ€å°å…¬å€æ•°ä¸æœ€å¤§å…¬å› æ•°</title>
      <link href="/2019/12/15/%E6%9C%80%E5%B0%8F%E5%85%AC%E5%80%8D%E6%95%B0%E4%B8%8E%E6%9C%80%E5%A4%A7%E5%85%AC%E5%9B%A0%E6%95%B0/"/>
      <url>/2019/12/15/%E6%9C%80%E5%B0%8F%E5%85%AC%E5%80%8D%E6%95%B0%E4%B8%8E%E6%9C%80%E5%A4%A7%E5%85%AC%E5%9B%A0%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<h3 id="1-æ±‚ä¸¤ä¸ªæ•°æœ€å¤§å…¬çº¦æ•°"><a href="#1-æ±‚ä¸¤ä¸ªæ•°æœ€å¤§å…¬çº¦æ•°" class="headerlink" title="1.æ±‚ä¸¤ä¸ªæ•°æœ€å¤§å…¬çº¦æ•°"></a>1.æ±‚ä¸¤ä¸ªæ•°æœ€å¤§å…¬çº¦æ•°</h3><p>æ¬§å‡ é‡Œå¾—ç®—æ³•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public static int gcd(int x,int y)&#123;</span><br><span class="line">if(x&gt;y)&#123;</span><br><span class="line">int tmp = x;</span><br><span class="line">x = y;</span><br><span class="line">y = tmp;</span><br><span class="line">&#125;</span><br><span class="line">return x == 0 ? y : gcd(y%x,x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-æ±‚ä¸¤ä¸ªæ•°æœ€å°å…¬å€æ•°"><a href="#2-æ±‚ä¸¤ä¸ªæ•°æœ€å°å…¬å€æ•°" class="headerlink" title="2.æ±‚ä¸¤ä¸ªæ•°æœ€å°å…¬å€æ•°"></a>2.æ±‚ä¸¤ä¸ªæ•°æœ€å°å…¬å€æ•°</h3><p>åœ¨æ±‚çš„æœ€å¤§å…¬çº¦æ•°çš„åŸºç¡€ä¸Š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//æ±‚aã€bçš„æœ€å°å…¬å€æ•°</span><br><span class="line">int lcm(int a, int b)&#123;</span><br><span class="line">    return a*b/gcd(a, b);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å³<br><code>lcm(a,b) * gcd(a,b) = a * b</code></p>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°è®º </tag>
            
            <tag> æœ€å°å…¬å€æ•°-æœ€å¤§å…¬å› æ•° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸­å›½å‰©ä½™å®šç†</title>
      <link href="/2019/12/15/%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86/"/>
      <url>/2019/12/15/%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h3 id="æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼š"><a href="#æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼š" class="headerlink" title="æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼š"></a>æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼š</h3><ul><li>è¯¦è§æœ€å¤§å…¬å› æ•°gcd å’Œ æœ€å°å…¬å€æ•°lcm</li></ul><h3 id="æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼š"><a href="#æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼š" class="headerlink" title="æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼š"></a>æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼š</h3><ul><li>å¯¹äºä¸å®Œå…¨ä¸º 0 çš„éè´Ÿæ•´æ•° aå’Œbï¼Œgcdï¼ˆaï¼Œbï¼‰è¡¨ç¤º aï¼Œb çš„æœ€å¤§å…¬çº¦æ•°ï¼Œå¿…ç„¶å­˜åœ¨æ•´æ•°å¯¹ xï¼Œy ï¼Œä½¿å¾— gcdï¼ˆaï¼Œbï¼‰=ax+byã€‚</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">private static int extend_getGCD(int a, int b, int x, int y) &#123;</span><br><span class="line">int temp,ans;</span><br><span class="line">if (b == 0) &#123;</span><br><span class="line">x = 1;</span><br><span class="line">y = 0;</span><br><span class="line">return a;</span><br><span class="line">&#125;</span><br><span class="line">    ans = extend_getGCD(b, a%b, x, y); </span><br><span class="line">temp = x;</span><br><span class="line">x = y;</span><br><span class="line">y = temp - a / b * y;</span><br><span class="line">return ans;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><h3 id="ä¸­å›½å‰©ä½™å®šç†"><a href="#ä¸­å›½å‰©ä½™å®šç†" class="headerlink" title="ä¸­å›½å‰©ä½™å®šç†"></a>ä¸­å›½å‰©ä½™å®šç†</h3><ul><li>ä¹Ÿå°±æ˜¯ ç»™ä½ ä¸€ç»„åŒä½™æ–¹ç¨‹ï¼Œå¹¶ä¿è¯ä¸¤ä¸¤äº’è´¨ æ±‚æœ€å°çš„æ»¡è¶³æ–¹ç¨‹çš„éè´Ÿæ•´æ•° X</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">import java.util.Scanner;</span><br><span class="line">/**</span><br><span class="line"> * @author kid1999</span><br><span class="line"> * @title: P1495</span><br><span class="line"> * @date 2019/11/12 20:33</span><br><span class="line"> */</span><br><span class="line">public class P1495 &#123;</span><br><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">// è¾“å…¥æ•°æ®</span><br><span class="line">Scanner sc = new Scanner(System.in);</span><br><span class="line">int n = sc.nextInt();</span><br><span class="line">long nums[] = new long[n+1];</span><br><span class="line">long mod[] = new long[n+1];</span><br><span class="line">for (int i = 0; i &lt;n ; i++) &#123;</span><br><span class="line">nums[i] = sc.nextInt();</span><br><span class="line">mod[i] = sc.nextInt();</span><br><span class="line">&#125;</span><br><span class="line">// ç”¨ åŒä½™çš„ åŠ æ³• æ€§è´¨ ç»Ÿè®¡å‡º sum(ai)</span><br><span class="line">// å…¶ä¸­ ai = é™¤iä»¥å¤–çš„numç›¸åŠ  å¾—lcm_num å†ç”¨lcm_num*n mod num[i] == mod[i]</span><br><span class="line">long res = 0;</span><br><span class="line">for (int i = 0; i &lt;n ; i++) &#123;</span><br><span class="line">long lcm_num = 1;</span><br><span class="line">for (int j = 0; j &lt;n ; j++) &#123;</span><br><span class="line">if(j == i) continue;</span><br><span class="line">lcm_num = lcm(lcm_num,nums[j]);</span><br><span class="line">&#125;</span><br><span class="line">int k = 1;</span><br><span class="line">while (true)&#123;</span><br><span class="line">if(lcm_num*k % nums[i] == mod[i])&#123;</span><br><span class="line">res += lcm_num*k;</span><br><span class="line">break;</span><br><span class="line">&#125;</span><br><span class="line">k++;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">// è®¡ç®—å‡º æœ€å°å…¬å€æ•°</span><br><span class="line">long stander = 1;</span><br><span class="line">for (int i = 0; i &lt;n ; i++) &#123;</span><br><span class="line">stander = lcm(stander,nums[i]);</span><br><span class="line">&#125;</span><br><span class="line">// é€¼è¿‘æœ€å°çš„ ç»“æœ</span><br><span class="line">while (res - stander &gt;= 0)&#123;</span><br><span class="line">res -= stander;</span><br><span class="line">&#125;</span><br><span class="line">System.out.println(res);</span><br><span class="line">&#125;</span><br><span class="line">public static long gcd(long a,long b)&#123;</span><br><span class="line">return a == 0 ? b : gcd(b%a, a);</span><br><span class="line">&#125;</span><br><span class="line">public static long lcm(long a,long b)&#123;</span><br><span class="line">return (a*b)/gcd(a,b);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç›¸å…³èµ„æ–™ï¼š"><a href="#ç›¸å…³èµ„æ–™ï¼š" class="headerlink" title="ç›¸å…³èµ„æ–™ï¼š"></a>ç›¸å…³èµ„æ–™ï¼š</h3><p><a href="https://www.cnblogs.com/yefeng1627/archive/2012/12/31/2841058.html" target="_blank" rel="noopener">åŒä½™çº¿æ€§æ–¹ç¨‹ç»„</a></p><p><a href="http://www.voidcn.com/article/p-hrgcksch-rt.html" target="_blank" rel="noopener">æ¬§å‡ é‡Œå¾—ç®—æ³•æ‰©å±•</a></p><p><a href="https://www.youtube.com/watch?v=bFisuyRQEGk" target="_blank" rel="noopener">æ¥ç€æ²¹ç®¡çš„ä¸­å›½å‰©ä½™å®šç†è®²è§£</a></p>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¸­å›½å‰©ä½™å®šç† </tag>
            
            <tag> æ•°è®º </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…³äºjavaçš„ç®—æ³•IOè¯»å†™ä¼˜åŒ–</title>
      <link href="/2019/12/15/%E5%85%B3%E4%BA%8Ejava%E7%9A%84%E7%AE%97%E6%B3%95IO%E8%AF%BB%E5%86%99%E4%BC%98%E5%8C%96/"/>
      <url>/2019/12/15/%E5%85%B3%E4%BA%8Ejava%E7%9A%84%E7%AE%97%E6%B3%95IO%E8%AF%BB%E5%86%99%E4%BC%98%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<h4 id="1-æ™®é€šå†™æ³•"><a href="#1-æ™®é€šå†™æ³•" class="headerlink" title="1.æ™®é€šå†™æ³•"></a>1.æ™®é€šå†™æ³•</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Scanner sc = new Scanner(System.in);</span><br><span class="line">int n = sc.nextInt();</span><br></pre></td></tr></table></figure><h4 id="2-è¯»å–æµ‹è¯•æ–‡ä»¶"><a href="#2-è¯»å–æµ‹è¯•æ–‡ä»¶" class="headerlink" title="2.è¯»å–æµ‹è¯•æ–‡ä»¶"></a>2.è¯»å–æµ‹è¯•æ–‡ä»¶</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Scanner sc = new Scanner(new FileInputStream(&quot;path&quot;));</span><br><span class="line">int n = sc.nextInt();</span><br></pre></td></tr></table></figure><h4 id="3-bufferReaderåŠ é€Ÿè¯»å†™"><a href="#3-bufferReaderåŠ é€Ÿè¯»å†™" class="headerlink" title="3.bufferReaderåŠ é€Ÿè¯»å†™"></a>3.bufferReaderåŠ é€Ÿè¯»å†™</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BufferedReader bf = new BufferedReader(new InputStreamReader(new FileInputStream(&quot;path&quot;)));</span><br><span class="line">String s = bf.readLine();</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MybatisPlusçš„åŸºç¡€ä½¿ç”¨</title>
      <link href="/2019/12/11/MybatisPlus%E7%9A%84%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/"/>
      <url>/2019/12/11/MybatisPlus%E7%9A%84%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h2 id="Mybatis-Plusçš„åŸºç¡€ä½¿ç”¨"><a href="#Mybatis-Plusçš„åŸºç¡€ä½¿ç”¨" class="headerlink" title="Mybatis Plusçš„åŸºç¡€ä½¿ç”¨"></a>Mybatis Plusçš„åŸºç¡€ä½¿ç”¨</h2><ul><li>ä¸ºç®€åŒ–å¼€å‘è€Œç”Ÿ</li></ul><h3 id="1-å®ä½“ç±»çš„å®šä¹‰"><a href="#1-å®ä½“ç±»çš„å®šä¹‰" class="headerlink" title="1.å®ä½“ç±»çš„å®šä¹‰"></a>1.å®ä½“ç±»çš„å®šä¹‰</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">@Data</span><br><span class="line">@TableName(&quot;userswork&quot;)  // æ˜ å°„è¡¨</span><br><span class="line">public class Userwork &#123;</span><br><span class="line">  @TableId(type = IdType.AUTO)  // ä¸»é”®ç­–ç•¥</span><br><span class="line">  private int id;</span><br><span class="line">  private int workid;</span><br><span class="line">  private int userid;</span><br><span class="line">  </span><br><span class="line">  @TableField(exist = false) // åˆ—ç­–ç•¥ï¼šæ˜¯å¦å¯¹åº”è¡¨å±æ€§ï¼ŒæŸ¥è¯¢æ—¶æ˜¯å¦è¿”å›ç»“æœ....</span><br><span class="line">  private int other;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-Mapperçš„ä¹¦å†™ï¼ˆå¤šè¡¨æŸ¥è¯¢ä½¿ç”¨SQLæ‹¼æ¥ï¼‰"><a href="#2-Mapperçš„ä¹¦å†™ï¼ˆå¤šè¡¨æŸ¥è¯¢ä½¿ç”¨SQLæ‹¼æ¥ï¼‰" class="headerlink" title="2.Mapperçš„ä¹¦å†™ï¼ˆå¤šè¡¨æŸ¥è¯¢ä½¿ç”¨SQLæ‹¼æ¥ï¼‰"></a>2.Mapperçš„ä¹¦å†™ï¼ˆå¤šè¡¨æŸ¥è¯¢ä½¿ç”¨SQLæ‹¼æ¥ï¼‰</h3><ul><li>ç»§æ‰¿BaseMapperå®ç°åŸºæœ¬çš„CURDåŠŸèƒ½</li><li>ç®€å•è¯­å¥å¯ä»¥ä½¿ç”¨è‡ªå¸¦çš„CRUD </li><li>å¤æ‚è¯­å¥ä¹Ÿå¯ä»¥ä½¿ç”¨sqlè¯­å¥æ‹¼æ¥</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">package kid1999.upload.mapper;</span><br><span class="line"></span><br><span class="line">import com.baomidou.mybatisplus.core.mapper.BaseMapper;</span><br><span class="line">import kid1999.upload.model.HomeWork;</span><br><span class="line">import org.apache.ibatis.annotations.Insert;</span><br><span class="line">import org.apache.ibatis.annotations.Mapper;</span><br><span class="line">import org.apache.ibatis.annotations.Select;</span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">@Mapper</span><br><span class="line">public interface homeworkMapper extends BaseMapper&lt;HomeWork&gt; &#123;</span><br><span class="line"></span><br><span class="line">    @Select(&quot;select * from homework where title = #&#123;title&#125; and id in (select workid from userswork where userid = #&#123;userId&#125;)&quot;)</span><br><span class="line">    HomeWork findHKByTitleAndUserID(String title,int userId);</span><br><span class="line"></span><br><span class="line">    @Insert(&quot;insert into homework(title, infomation, createtime, endtime, type, addr) values (#&#123;title&#125;,#&#123;infomation&#125; ,#&#123;createtime&#125; ,#&#123;endtime&#125; ,#&#123;type&#125; ,#&#123;addr&#125; )&quot;)</span><br><span class="line">    void addHomeWork(HomeWork homeWork);</span><br><span class="line"></span><br><span class="line">    @Select(&quot;select * from homework where id in (select workid from userswork where userid = #&#123;userid&#125; ) &quot;)</span><br><span class="line">    List&lt;HomeWork&gt; findByUserId(Integer userid);</span><br><span class="line">    </span><br><span class="line">    @Select(&quot;select addr from homework where id = (select workid from student where student.id = #&#123;uid&#125;)&quot;)</span><br><span class="line">    String findaddrBySid(int uid);</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    @Select(&quot;select * from homework where title = #&#123;title&#125; and id in (select workid from userwork where userid = #&#123;userId&#125;)&quot;)</span><br><span class="line">    HomeWork findHKByTitle(String title,int userId);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-åœ¨Serviceä¸­å®ç°ä¸€äº›ç®€å•çš„å•è¡¨CRUD"><a href="#3-åœ¨Serviceä¸­å®ç°ä¸€äº›ç®€å•çš„å•è¡¨CRUD" class="headerlink" title="3.åœ¨Serviceä¸­å®ç°ä¸€äº›ç®€å•çš„å•è¡¨CRUD"></a>3.åœ¨Serviceä¸­å®ç°ä¸€äº›ç®€å•çš„å•è¡¨CRUD</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">package kid1999.upload.service;</span><br><span class="line"></span><br><span class="line">import com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;</span><br><span class="line">import kid1999.upload.mapper.userMapper;</span><br><span class="line">import kid1999.upload.model.User;</span><br><span class="line">import org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line">import org.springframework.beans.factory.annotation.Value;</span><br><span class="line">import org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@Service</span><br><span class="line">public class userService &#123;</span><br><span class="line"></span><br><span class="line">  @Autowired</span><br><span class="line">  private userMapper userMapper;</span><br><span class="line"></span><br><span class="line">  // ç®€å•æŸ¥è¯¢ä½¿ç”¨ QueryWrapper </span><br><span class="line">  public User findUserByName(String name) &#123;</span><br><span class="line">    QueryWrapper wrapper = new QueryWrapper();</span><br><span class="line">    wrapper.eq(&quot;name&quot;,name);</span><br><span class="line">    return userMapper.selectOne(wrapper);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // å¢åŠ  ä½¿ç”¨è‡ªå¸¦çš„ insert</span><br><span class="line">  public int addUser(User user) &#123;</span><br><span class="line">    return userMapper.insert(user);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public User login(User user) &#123;</span><br><span class="line">    QueryWrapper&lt;User&gt; wrapper = new QueryWrapper&lt;&gt;();</span><br><span class="line">    wrapper.eq(&quot;name&quot;,user.getName())</span><br><span class="line">            .eq(&quot;password&quot;,user.getPassword());</span><br><span class="line">    return userMapper.selectOne(wrapper);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  // æ›´æ–°student</span><br><span class="line">  public int updateStudent(Student student) &#123;</span><br><span class="line">QueryWrapper&lt;Student&gt; wrapper = new QueryWrapper&lt;&gt;();</span><br><span class="line">wrapper.eq(&quot;id&quot;,student.getId())</span><br><span class="line">.eq(&quot;name&quot;,student.getName());</span><br><span class="line">return studentMapper.update(student,wrapper);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åç»­å†ä¿®è®¢-ã€‚ã€‚ã€‚ã€‚"><a href="#åç»­å†ä¿®è®¢-ã€‚ã€‚ã€‚ã€‚" class="headerlink" title="åç»­å†ä¿®è®¢ ã€‚ã€‚ã€‚ã€‚"></a>åç»­å†ä¿®è®¢ ã€‚ã€‚ã€‚ã€‚</h3>]]></content>
      
      
      <categories>
          
          <category> Java web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MyBatisPlus </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>EasyMockçš„ç®€å•ä½¿ç”¨</title>
      <link href="/2019/12/10/EasyMock%E7%9A%84%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/"/>
      <url>/2019/12/10/EasyMock%E7%9A%84%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h2 id="EasyMockç®€å•ä½¿ç”¨"><a href="#EasyMockç®€å•ä½¿ç”¨" class="headerlink" title="EasyMockç®€å•ä½¿ç”¨"></a>EasyMockç®€å•ä½¿ç”¨</h2><h4 id="1-å®‰è£…ä½¿ç”¨ï¼Œä¸è¯´äº†â€¦"><a href="#1-å®‰è£…ä½¿ç”¨ï¼Œä¸è¯´äº†â€¦" class="headerlink" title="1.å®‰è£…ä½¿ç”¨ï¼Œä¸è¯´äº†â€¦"></a>1.å®‰è£…ä½¿ç”¨ï¼Œä¸è¯´äº†â€¦</h4><h4 id="2-æ•°æ®éšæœºç”Ÿæˆè§„åˆ™ï¼š"><a href="#2-æ•°æ®éšæœºç”Ÿæˆè§„åˆ™ï¼š" class="headerlink" title="2.æ•°æ®éšæœºç”Ÿæˆè§„åˆ™ï¼š"></a>2.æ•°æ®éšæœºç”Ÿæˆè§„åˆ™ï¼š</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">&quot;cname&quot;: &quot;@cname&quot;,//ä¸­æ–‡äººå</span><br><span class="line">&quot;id&quot;: &quot;@id&quot;,//ç”Ÿæˆ20 ä½æ•°å­—</span><br><span class="line">&quot;title&quot;: &quot;@ctitle&quot;,//ä¸­æ–‡title</span><br><span class="line">&quot;city&quot;: &quot;@city&quot;,//ä¸­æ–‡åŸå¸‚</span><br><span class="line">&quot;ip&quot;: &quot;@ip&quot;,//ip åœ°å€</span><br><span class="line">&quot;email&quot;: &quot;@email&quot;,//email</span><br><span class="line">&quot;url&quot;: &quot;@url&quot;,//url</span><br><span class="line">&quot;cfirst&quot;: &quot;@cfirst&quot;,//å§“åï¼Œå§“</span><br><span class="line">&quot;clast&quot;: &quot;@clast&quot;,//å§“åï¼Œå</span><br><span class="line">&quot;cword&quot;: &quot;@cword(&apos;123456&apos;)&quot;,//123456 ä»ä¸­é€‰å–ä¸€ä¸ªå­—ç¬¦</span><br><span class="line">&quot;csentence&quot;: &quot;@csentence(1,5)&quot;,//æ–‡å­—æ–‡æ®µ</span><br><span class="line">&quot;csentence5&quot;: &quot;@csentence(5)&quot;,//æ–‡å­—æ–‡æ®µ</span><br><span class="line">&quot;cparagraph&quot;: &quot;@cparagraph(1,3)&quot;,//æ–‡å­—æ–‡æ®µ</span><br><span class="line">&quot;string&quot;: &quot;@string(11)&quot;,//è¾“å‡º11 ä¸ªå­—ç¬¦é•¿åº¦çš„å­—ç¬¦ä¸²</span><br><span class="line">&quot;float&quot;: &quot;@float(0,10)&quot;,//0 åˆ° 10 çš„æµ®ç‚¹æ•°</span><br><span class="line">&quot;int&quot;: &quot;@integer(60,70)&quot;,//60 åˆ° 70 ä¹‹é—´çš„æ•´æ•°</span><br><span class="line">&quot;boolean&quot;: &quot;@boolean&quot;,//boolean ç±»å‹ true,false</span><br><span class="line">&quot;array|1-3&quot;: [&#123;</span><br><span class="line">&quot;id&quot;: &quot;@integer(1,10)&quot;,//æ•´æ•° 1åˆ°10 å–æ•´æ•°</span><br><span class="line">&quot;name&quot;: &quot;cname&quot;</span><br><span class="line">&#125;],//æ•°ç»„ï¼ˆéšæœº 1 åˆ°3ä¸ªï¼‰</span><br><span class="line">&quot;array_sort_add|+1&quot;: [&quot;1&quot;, &quot;2&quot;, &quot;3&quot;],//æ•°ç»„1ï¼Œ2ï¼Œ3è½®è¯¢è¾“å‡º</span><br><span class="line">&quot;boolean|1-2&quot;: true,//boolean ç±»å‹ true,false</span><br><span class="line">&quot;actionType|1&quot;: [&apos;click_url&apos;, &apos;open_resource_detail&apos;, &apos;open_resource_search&apos;],</span><br><span class="line">&quot;payload&quot;: function() &#123;</span><br><span class="line">Â  Â  Â  var returnClickUrl = &#123;</span><br><span class="line">Â  Â  Â  Â  &quot;linkUrl&quot;: &quot;http://tob.zhisland.com/apph5&quot;</span><br><span class="line">Â  Â  Â  &#125;;</span><br><span class="line">Â  Â  Â  var returnResourceDetail = &#123;</span><br><span class="line">Â  Â  Â  Â  &quot;resourceId&quot;: &quot;606&quot;</span><br><span class="line">Â  Â  Â  &#125;;</span><br><span class="line">Â  Â  Â  var returnResourceSearch = &#123;</span><br><span class="line">Â  Â  Â  Â  &quot;keyWords&quot;: &quot;&quot;,</span><br><span class="line">Â  Â  Â  Â  &quot;tagCategory&quot;: &quot;1&quot;,</span><br><span class="line">Â  Â  Â  Â  &quot;tag&quot;: &quot;1&quot;</span><br><span class="line">Â  Â  Â  &#125;;</span><br><span class="line">Â  Â  Â  var s = this.actionType == &apos;click_url&apos; ? returnClickUrl : this.actionType == &apos;open_resource_detail&apos; ? returnResourceDetail : returnResourceSearch;</span><br><span class="line">Â  Â  Â  return s;</span><br><span class="line">&#125;//function è¿”å›è®¾ç½®è¿”å›çš„æ•°æ®</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Java web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> EasyMock </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰åç«¯åˆ†é¡µçš„ç®€å•å®ç°</title>
      <link href="/2019/12/03/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E9%A1%B5%E7%9A%84%E7%AE%80%E5%8D%95%E5%AE%9E%E7%8E%B0/"/>
      <url>/2019/12/03/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E9%A1%B5%E7%9A%84%E7%AE%80%E5%8D%95%E5%AE%9E%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰åç«¯åˆ†é¡µçš„ç®€å•å®ç°"><a href="#å‰åç«¯åˆ†é¡µçš„ç®€å•å®ç°" class="headerlink" title="å‰åç«¯åˆ†é¡µçš„ç®€å•å®ç°"></a>å‰åç«¯åˆ†é¡µçš„ç®€å•å®ç°</h2><ul><li>Vue.js Element-UI</li><li>SpringBoot Jpa</li></ul><p>åŸºæœ¬æ•ˆæœå›¾å¦‚ä¸‹ï¼š<br><img alt data-src="https://ae01.alicdn.com/kf/Hbf0b27aa338e4964809bce09f3eacacch.png" class="lazyload"></p><h3 id="1-å‰ç«¯åŸºäºElementçš„åˆ†é¡µç»„ä»¶"><a href="#1-å‰ç«¯åŸºäºElementçš„åˆ†é¡µç»„ä»¶" class="headerlink" title="1.å‰ç«¯åŸºäºElementçš„åˆ†é¡µç»„ä»¶"></a>1.å‰ç«¯åŸºäºElementçš„åˆ†é¡µç»„ä»¶</h3><p>Elementåˆ†é¡µç»„ä»¶ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;block&quot; style=&quot;margin-top:15px;&quot;&gt;</span><br><span class="line">      &lt;el-pagination align=&apos;center&apos;</span><br><span class="line">      @current-change=&quot;handleCurrentChange&quot; // æ”¹å˜é¡µç æ—¶è§¦å‘çš„æ–¹æ³•ï¼Œè¿˜æœ‰å¾ˆå¤šå…¶ä»–çš„è§¦å‘äº‹ä»¶</span><br><span class="line">      :current-page=&quot;currentPage&quot;   // å½“å‰é¡µ</span><br><span class="line">      :page-size=&quot;pageSize&quot;         // åˆ†é¡µå¤§å°</span><br><span class="line">      layout=&quot;total, prev, pager, next&quot;     // åˆ†é¡µæ¡çš„åŠŸèƒ½(ä¸»é¢˜) å¯å®šåˆ¶</span><br><span class="line">      :total=&quot;total&quot;&gt;   // å…ƒç´ æ€»æ•°é‡</span><br><span class="line">      &lt;/el-pagination&gt;   </span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure><p>å®šä¹‰æ•°æ®å‚æ•°ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tableData:[],  // å…ƒç´ åˆ—è¡¨</span><br><span class="line">currentPage: 1, // å½“å‰é¡µç </span><br><span class="line">total: 0,  // æ€»æ¡æ•°</span><br><span class="line">pageSize: 10,   // æ¯é¡µçš„æ•°æ®æ¡æ•°</span><br><span class="line">....</span><br></pre></td></tr></table></figure><p>è¯·æ±‚åç«¯æ•°æ®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// get page</span><br><span class="line">to_getPage()&#123;</span><br><span class="line">    var self = this;</span><br><span class="line">    this.$axios.get(&quot;/member?currentPage=&quot; + self.currentPage + &quot;&amp;pageSize=&quot; + self.pageSize).then((response)=&gt;&#123;</span><br><span class="line">        let data = response.data;</span><br><span class="line">        console.info(data);</span><br><span class="line">        self.tableData = data.content;</span><br><span class="line">        self.total = data.totalElements;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><h3 id="2-åç«¯åŸºäºJpaçš„ç®€å•åˆ†é¡µæ–¹æ³•"><a href="#2-åç«¯åŸºäºJpaçš„ç®€å•åˆ†é¡µæ–¹æ³•" class="headerlink" title="2.åç«¯åŸºäºJpaçš„ç®€å•åˆ†é¡µæ–¹æ³•"></a>2.åç«¯åŸºäºJpaçš„ç®€å•åˆ†é¡µæ–¹æ³•</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@GetMapping(&quot;/member&quot;)</span><br><span class="line">Page&lt;Member&gt; getmembers(Integer pageSize,</span><br><span class="line">Integer currentPage)&#123;</span><br><span class="line">// ç”Ÿæˆä¸€ä¸ªåˆ†é¡µå™¨ï¼ŒåŒ…æ‹¬å½“å‰é¡µï¼Œå¤§å°ï¼Œæ’åºè§„åˆ™</span><br><span class="line">Pageable pageable = PageRequest.of(currentPage,pageSize,Sort.by(&quot;memId&quot;));</span><br><span class="line">return memberRepository.findAll(pageable);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-æ›´å¤šå…³äºJpaåˆ†é¡µçš„æ­¥éª¤çŸ¥è¯†ç‚¹ï¼š"><a href="#3-æ›´å¤šå…³äºJpaåˆ†é¡µçš„æ­¥éª¤çŸ¥è¯†ç‚¹ï¼š" class="headerlink" title="3.æ›´å¤šå…³äºJpaåˆ†é¡µçš„æ­¥éª¤çŸ¥è¯†ç‚¹ï¼š"></a>3.æ›´å¤šå…³äºJpaåˆ†é¡µçš„æ­¥éª¤çŸ¥è¯†ç‚¹ï¼š</h3><ol><li>åˆ›å»ºå®ä½“ç±»</li><li>å®šä¹‰Repositoryå¹¶ç»§æ‰¿<code>PagingAndSortingRepository</code>æˆ–å…¶å­ç±» å¦‚ï¼š<code>JpaRepository</code></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// ç›¸åº”çº¦å®šå¥½çš„åˆ†é¡µæ–¹æ³•å°±é€ä¸Šé—¨æ¥äº†</span><br><span class="line">public interface ArticleRepository extends PagingAndSortingRepository&lt;Article,Long&gt; &#123;</span><br><span class="line">     //æŸ¥è¯¢articleè¡¨çš„æ‰€æœ‰æ•°æ®ï¼Œä¼ å…¥Pageableåˆ†é¡µå‚æ•°ï¼Œä¸éœ€è¦è‡ªå·±å†™SQL</span><br><span class="line">    Page&lt;Article&gt; findAll(Pageable pageable);</span><br><span class="line">    //æ ¹æ®authorå­—æ®µæŸ¥è¯¢articleè¡¨æ•°æ®ï¼Œä¼ å…¥Pageableåˆ†é¡µå‚æ•°ï¼Œä¸éœ€è¦è‡ªå·±å†™SQL</span><br><span class="line">    Page&lt;Article&gt; findByAuthor(String author, Pageable pageable);</span><br><span class="line">    //æ ¹æ®authorå­—æ®µå’Œtitleå­—æ®µï¼ŒæŸ¥è¯¢articleè¡¨æ•°æ®ï¼Œä¼ å…¥Pageableåˆ†é¡µå‚æ•°ï¼Œä¸éœ€è¦è‡ªå·±å†™SQL</span><br><span class="line">    Slice&lt;Article&gt; findByAuthorAndTitle(String author, String title, Pageable pageable);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>ç”Ÿæˆåˆ†é¡µå™¨ å®ç°åˆ†é¡µ</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// æŸ¥è¯¢ç¬¬ä¸€é¡µ(ä»0å¼€å§‹)çš„æ•°æ®ï¼Œæ¯é¡µ10æ¡æ•°æ®</span><br><span class="line">Pageable pageable = PageRequest.of(0, 10);   //ç¬¬ä¸€é¡µ</span><br><span class="line">//Pageable pageable = PageRequest.of(1, 10);  //ç¬¬äºŒé¡µ</span><br><span class="line">//Pageable pageable = PageRequest.of(2, 10);  // ç¬¬ä¸‰é¡µ</span><br><span class="line">//æ•°æ®åº“æ“ä½œè·å–æŸ¥è¯¢ç»“æœ</span><br><span class="line">Page&lt;Article&gt; articlePage = articleRepository.findAll(pageable);</span><br><span class="line">//å°†æŸ¥è¯¢ç»“æœè½¬æ¢ä¸ºList</span><br><span class="line">List&lt;Article&gt; articleList = articlePage.getContent();</span><br></pre></td></tr></table></figure><ol start="4"><li>å®ç°æ’åº</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// ç®€å•æ’åº</span><br><span class="line">articleRepository.findAll(Sort.by(&quot;createTime&quot;));</span><br><span class="line"></span><br><span class="line">// å¤åˆæ’åº</span><br><span class="line">articleRepository.findAll(Sort.by(&quot;author&quot;).ascending()</span><br><span class="line">                        .and(Sort.by(&quot;createTime&quot;).descending()));</span><br><span class="line"></span><br><span class="line">// åˆ†é¡µæ’åº</span><br><span class="line">Pageable pageable = PageRequest.of(0, 10,Sort.by(&quot;createTime&quot;));</span><br></pre></td></tr></table></figure><ol start="5"><li>å…³äºåˆ†é¡µå™¨çš„è¿”å›å¯¹è±¡Page<obj>ç»§æ‰¿è‡ªSliceï¼Œè¿™é‡Œä»‹ç»ä¸€äº›æ–¹æ³•å†…å®¹</obj></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">List &lt;T&gt;  getContentï¼ˆï¼‰; //è·å–å…ƒç´ æ•°ç»„</span><br><span class="line"></span><br><span class="line">Pageable  getPageableï¼ˆï¼‰; //å½“å‰åˆ‡ç‰‡çš„åˆ†é¡µä¿¡æ¯</span><br><span class="line"></span><br><span class="line">boolean  hasContentï¼ˆï¼‰; //æ˜¯å¦æœ‰æŸ¥è¯¢ç»“æœï¼Ÿ</span><br><span class="line"></span><br><span class="line">boolean  isFirstï¼ˆï¼‰;  //æ˜¯å¦æ˜¯ç¬¬ä¸€ä¸ªåˆ‡ç‰‡</span><br><span class="line"></span><br><span class="line">boolean  isLastï¼ˆï¼‰;  //æ˜¯å¦æ˜¯æœ€åä¸€ä¸ªåˆ‡ç‰‡</span><br><span class="line"></span><br><span class="line">Pageable nextPageable(); // ä¸‹ä¸€ä¸ªåˆ‡ç‰‡çš„åˆ†é¡µä¿¡æ¯</span><br><span class="line"></span><br><span class="line">Pageable previousPageable(); // ä¸Šä¸€ä¸ªåˆ‡ç‰‡çš„åˆ†é¡µä¿¡æ¯</span><br></pre></td></tr></table></figure><ol start="6"><li>Pageçš„æ–¹æ³•</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//æ€»é¡µæ•°</span><br><span class="line">int getTotalPages();</span><br><span class="line"></span><br><span class="line">//æ€»æ•°æ®æ¡æ•°</span><br><span class="line">long getTotalElements();</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Java web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JPA </tag>
            
            <tag> Element-UI </tag>
            
            <tag> Axios </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰åç«¯é€šè®¯å®æµ‹</title>
      <link href="/2019/12/03/%E5%89%8D%E5%90%8E%E7%AB%AF%E9%80%9A%E8%AE%AF%E5%AE%9E%E6%B5%8B/"/>
      <url>/2019/12/03/%E5%89%8D%E5%90%8E%E7%AB%AF%E9%80%9A%E8%AE%AF%E5%AE%9E%E6%B5%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰åç«¯é€šè®¯å®æµ‹"><a href="#å‰åç«¯é€šè®¯å®æµ‹" class="headerlink" title="å‰åç«¯é€šè®¯å®æµ‹"></a>å‰åç«¯é€šè®¯å®æµ‹</h1><h2 id="ä»¥Vue-jsä¸ºä»£è¡¨çš„å‰ç«¯"><a href="#ä»¥Vue-jsä¸ºä»£è¡¨çš„å‰ç«¯" class="headerlink" title="ä»¥Vue.jsä¸ºä»£è¡¨çš„å‰ç«¯"></a>ä»¥Vue.jsä¸ºä»£è¡¨çš„å‰ç«¯</h2><h4 id="1-åŸºäºaxiosçš„è¯·æ±‚"><a href="#1-åŸºäºaxiosçš„è¯·æ±‚" class="headerlink" title="1.åŸºäºaxiosçš„è¯·æ±‚"></a>1.åŸºäºaxiosçš„è¯·æ±‚</h4><ul><li>åœ¨main.jsä¸­é…ç½®é»˜è®¤è¯·æ±‚åœ°å€ï¼š<code>axios.defaults.baseURL = &#39;http://localhost:9999/&#39;;</code></li><li>åœ¨main.jsä¸­é…ç½®å…¨å±€ä½¿ç”¨axiosï¼š<code>Vue.prototype.$axios = axios;</code></li></ul><h2 id="ä»¥Springbootä¸ºä»£è¡¨çš„åç«¯"><a href="#ä»¥Springbootä¸ºä»£è¡¨çš„åç«¯" class="headerlink" title="ä»¥Springbootä¸ºä»£è¡¨çš„åç«¯"></a>ä»¥Springbootä¸ºä»£è¡¨çš„åç«¯</h2><h4 id="1-é…ç½®è·¨åŸŸå…è®¸"><a href="#1-é…ç½®è·¨åŸŸå…è®¸" class="headerlink" title="1.é…ç½®è·¨åŸŸå…è®¸"></a>1.é…ç½®è·¨åŸŸå…è®¸</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">package io.kid19999.backstage.config;</span><br><span class="line"></span><br><span class="line">import org.springframework.context.annotation.Bean;</span><br><span class="line">import org.springframework.context.annotation.Configuration;</span><br><span class="line">import org.springframework.web.cors.CorsConfiguration;</span><br><span class="line">import org.springframework.web.cors.UrlBasedCorsConfigurationSource;</span><br><span class="line">import org.springframework.web.filter.CorsFilter;</span><br><span class="line"></span><br><span class="line">@Configuration</span><br><span class="line">public class CorsConfig &#123;</span><br><span class="line">  private CorsConfiguration buildConfig() &#123;</span><br><span class="line">    CorsConfiguration corsConfiguration = new CorsConfiguration();</span><br><span class="line">    corsConfiguration.addAllowedOrigin(&quot;*&quot;); // 1å…è®¸ä»»ä½•åŸŸåä½¿ç”¨</span><br><span class="line">    corsConfiguration.addAllowedHeader(&quot;*&quot;); // 2å…è®¸ä»»ä½•å¤´</span><br><span class="line">    corsConfiguration.addAllowedMethod(&quot;*&quot;); // 3å…è®¸ä»»ä½•æ–¹æ³•ï¼ˆpostã€getç­‰ï¼‰</span><br><span class="line">    return corsConfiguration;</span><br><span class="line">  &#125;</span><br><span class="line">  @Bean</span><br><span class="line">  public CorsFilter corsFilter() &#123;</span><br><span class="line">    UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();</span><br><span class="line">    source.registerCorsConfiguration(&quot;/**&quot;, buildConfig()); // 4</span><br><span class="line">    return new CorsFilter(source);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç»¼åˆæµ‹è¯•ï¼š"><a href="#ç»¼åˆæµ‹è¯•ï¼š" class="headerlink" title="ç»¼åˆæµ‹è¯•ï¼š"></a>ç»¼åˆæµ‹è¯•ï¼š</h2><h4 id="ç´ æå‡†å¤‡ï¼š"><a href="#ç´ æå‡†å¤‡ï¼š" class="headerlink" title="ç´ æå‡†å¤‡ï¼š"></a>ç´ æå‡†å¤‡ï¼š</h4><ul><li>å‰ç«¯ å¯¹è±¡</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">data()&#123;</span><br><span class="line">    return&#123;</span><br><span class="line">        data:&#123;&apos;adminId&apos;:&apos;kid&apos;,&apos;adminPwd&apos;:&apos;132456456&apos;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><ul><li>åç«¯ å¯¹è±¡<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import lombok.Data;</span><br><span class="line"></span><br><span class="line">@Data</span><br><span class="line">public class Login &#123;</span><br><span class="line">  private String adminId;</span><br><span class="line">  private String adminPwd;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="1-POSTæµ‹è¯•ï¼š"><a href="#1-POSTæµ‹è¯•ï¼š" class="headerlink" title="1.POSTæµ‹è¯•ï¼š"></a>1.POSTæµ‹è¯•ï¼š</h3><ul><li>åŸºäºå¯¹è±¡çš„ä¼ è¾“ï¼š</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">å‰ç«¯ï¼š </span><br><span class="line">putObj()&#123;</span><br><span class="line">    var self = this;</span><br><span class="line">    this.$axios.put(&apos;/test&apos;, self.data).then(function (response) &#123;</span><br><span class="line">        console.info(self.data);</span><br><span class="line">        console.log(response.data);</span><br><span class="line">    &#125;).catch(function (error) &#123;</span><br><span class="line">        console.error(&quot;è¯·æ±‚é”™è¯¯ï¼&quot;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">åç«¯ï¼š</span><br><span class="line">postè¯·æ±‚ï¼Œå¦‚æœæ˜¯æ¥æ”¶jsonæ ¼å¼ï¼ˆè¦æ±‚ä¼ è¾“å‚æ•°æ˜¯json(application/json;charset=utf-8)ï¼Œæ¥æ”¶å‚æ•°è¦æ˜¯ä¸€ä¸ªå‚æ•°æˆ–è€…æ˜¯ä¸€ä¸ªå¯¹è±¡å¹¶ä¸”å‚æ•°å‰åŠ ä¸Š@RequestBodyæ³¨è§£ï¼‰ï¼›å¦‚æœæ˜¯è¡¨å•æäº¤(application/x-www-form-urlencoded)ï¼Œæ¥æ”¶å‚æ•°æ²¡æœ‰è¦æ±‚å³å¯ä»¥æ˜¯å¯¹è±¡ä¹Ÿå¯ä»¥æ˜¯å¤šä¸ªå‚æ•°çš„æ¥æ”¶æ–¹å¼</span><br><span class="line">@PutMapping(&quot;/test&quot;)</span><br><span class="line">Result putObj(@RequestBody Login login)&#123;</span><br><span class="line">System.out.println(login);</span><br><span class="line">Result result = new Result();</span><br><span class="line">result.setStatusCode(1);</span><br><span class="line">result.setInfo(&quot;put obj success&quot;);</span><br><span class="line">return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>åŸºäºè¡¨å•çš„ä¼ è¾“ï¼š</li><li>åŸºäº FormData å¡«å……ï¼ˆContent-Type: multipart/form-dataï¼‰åè®®<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">å‰ç«¯ï¼š </span><br><span class="line">postForm()&#123;</span><br><span class="line">    var self = this;</span><br><span class="line">    let data = new FormData();</span><br><span class="line">    data.append(&apos;adminId&apos;,&apos;kid&apos;);</span><br><span class="line">    data.append(&apos;adminPwd&apos;,&apos;132456456&apos;);</span><br><span class="line">    this.$axios.post(&apos;/test2&apos;, data).then(function (response) &#123;</span><br><span class="line">        console.info(self.data);</span><br><span class="line">        console.log(response.data);</span><br><span class="line">    &#125;).catch(function (error) &#123;</span><br><span class="line">        console.error(&quot;è¯·æ±‚é”™è¯¯ï¼&quot;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">åç«¯ï¼š</span><br><span class="line">@PostMapping(&quot;/test2&quot;)</span><br><span class="line">Result postForm(@RequestParam(&quot;adminId&quot;) String adminId,</span><br><span class="line">@RequestParam(&quot;adminPwd&quot;) String adminPwd)&#123;</span><br><span class="line">System.out.println(adminId + &quot; &quot; + adminPwd);</span><br><span class="line">Result result = new Result();</span><br><span class="line">result.setStatusCode(1);</span><br><span class="line">result.setInfo(&quot;post form success&quot;);</span><br><span class="line">return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="2-PUTæµ‹è¯•ï¼š"><a href="#2-PUTæµ‹è¯•ï¼š" class="headerlink" title="2.PUTæµ‹è¯•ï¼š"></a>2.PUTæµ‹è¯•ï¼š</h3><ul><li>åŸºäºå¯¹è±¡çš„ä¼ è¾“ï¼š</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">å‰ç«¯ï¼š </span><br><span class="line">post()&#123;</span><br><span class="line">    var self = this;</span><br><span class="line">    this.$axios.post(&apos;/test&apos;, self.data).then(function (response) &#123;</span><br><span class="line">        console.info(self.data);</span><br><span class="line">        console.log(response.data);</span><br><span class="line">    &#125;).catch(function (error) &#123;</span><br><span class="line">        console.error(&quot;è¯·æ±‚é”™è¯¯ï¼&quot;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">åç«¯ï¼š</span><br><span class="line">@PostMapping(&quot;/test&quot;)</span><br><span class="line">Result toPost(@RequestBody Login login)&#123;</span><br><span class="line">System.out.println(login);</span><br><span class="line">Result result = new Result();</span><br><span class="line">result.setStatusCode(1);</span><br><span class="line">result.setInfo(&quot;success&quot;);</span><br><span class="line">return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>åŸºäºè¡¨å•çš„ä¼ è¾“ï¼š</li><li>åŸºäºqsåº“ï¼Œ(Content-Type: application/x-www-form-urlencoded)åè®®<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">å‰ç«¯ï¼š </span><br><span class="line">putForm()&#123;</span><br><span class="line">    var self = this;</span><br><span class="line">    this.$axios.put(&apos;/test2&apos;, qs.stringify(self.data)</span><br><span class="line">    ).then(function (response) &#123;</span><br><span class="line">        console.info(self.data);</span><br><span class="line">        console.log(response.data);</span><br><span class="line">    &#125;).catch(function (error) &#123;</span><br><span class="line">        console.error(&quot;è¯·æ±‚é”™è¯¯ï¼&quot;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">åç«¯ï¼š</span><br><span class="line">@PutMapping(&quot;/test2&quot;)</span><br><span class="line">Result putForm(@RequestParam(&quot;adminId&quot;) String adminId,</span><br><span class="line">   @RequestParam(&quot;adminPwd&quot;) String adminPwd)&#123;</span><br><span class="line">System.out.println(adminId + &quot; &quot; + adminPwd);</span><br><span class="line">Result result = new Result();</span><br><span class="line">result.setStatusCode(1);</span><br><span class="line">result.setInfo(&quot;put form success&quot;);</span><br><span class="line">return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="3-GETæµ‹è¯•ï¼š"><a href="#3-GETæµ‹è¯•ï¼š" class="headerlink" title="3.GETæµ‹è¯•ï¼š"></a>3.GETæµ‹è¯•ï¼š</h3><ul><li>åªèƒ½ï¼ï¼ï¼  åŸºäºè¡¨å•çš„ä¼ è¾“ï¼š</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">å‰ç«¯ï¼š </span><br><span class="line">getForm()&#123;</span><br><span class="line">    var self = this;</span><br><span class="line">    this.$axios.get(&apos;/test&apos;, &#123;params: self.data&#125;).then(function (response) &#123;</span><br><span class="line">        console.info(self.data);</span><br><span class="line">        console.log(response.data);</span><br><span class="line">    &#125;).catch(function (error) &#123;</span><br><span class="line">        console.error(&quot;è¯·æ±‚é”™è¯¯ï¼&quot;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">åç«¯ï¼š</span><br><span class="line"></span><br><span class="line">@GetMapping(&quot;/test&quot;)</span><br><span class="line">Result getObj(@RequestParam(&quot;adminId&quot;) String adminId,</span><br><span class="line">  @RequestParam(&quot;adminPwd&quot;) String adminPwd)&#123;</span><br><span class="line">System.out.println(adminId + &quot; &quot; + adminPwd);</span><br><span class="line">Result result = new Result();</span><br><span class="line">result.setStatusCode(1);</span><br><span class="line">result.setInfo(&quot;get obj success&quot;);</span><br><span class="line">return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-DELETEæµ‹è¯•ï¼š"><a href="#4-DELETEæµ‹è¯•ï¼š" class="headerlink" title="4.DELETEæµ‹è¯•ï¼š"></a>4.DELETEæµ‹è¯•ï¼š</h3><ul><li>åŸºäºå¯¹è±¡çš„ä¼ è¾“ï¼š</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">å‰ç«¯ï¼š </span><br><span class="line">deleteObj()&#123;</span><br><span class="line">    var self = this;</span><br><span class="line">    this.$axios.delete(&apos;/test&apos;, &#123;data: self.data&#125;).then(function (response) &#123;</span><br><span class="line">        console.info(self.data);</span><br><span class="line">        console.log(response.data);</span><br><span class="line">    &#125;).catch(function (error) &#123;</span><br><span class="line">        console.error(&quot;è¯·æ±‚é”™è¯¯ï¼&quot;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">åç«¯ï¼š</span><br><span class="line">@DeleteMapping(&quot;/test&quot;)</span><br><span class="line">Result deleteObj(@RequestBody Login login)&#123;</span><br><span class="line">System.out.println(login);</span><br><span class="line">Result result = new Result();</span><br><span class="line">result.setStatusCode(1);</span><br><span class="line">result.setInfo(&quot;delete obj success&quot;);</span><br><span class="line">return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>åŸºäºè¡¨å•çš„ä¼ è¾“ï¼š</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">å‰ç«¯ï¼š </span><br><span class="line">deleteForm()&#123;</span><br><span class="line">    var self = this;</span><br><span class="line">    this.$axios.delete(&apos;/test2&apos;, &#123;params: self.data&#125;).then(function (response) &#123;</span><br><span class="line">        console.info(self.data);</span><br><span class="line">        console.log(response.data);</span><br><span class="line">    &#125;).catch(function (error) &#123;</span><br><span class="line">        console.error(&quot;è¯·æ±‚é”™è¯¯ï¼&quot;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">åç«¯ï¼š</span><br><span class="line">@DeleteMapping(&quot;/test2&quot;)</span><br><span class="line">Result deletForm(@RequestParam(&quot;adminId&quot;) String adminId,</span><br><span class="line"> @RequestParam(&quot;adminPwd&quot;) String adminPwd)&#123;</span><br><span class="line">System.out.println(adminId + &quot; &quot; + adminPwd);</span><br><span class="line">Result result = new Result();</span><br><span class="line">result.setStatusCode(1);</span><br><span class="line">result.setInfo(&quot;delete form success&quot;);</span><br><span class="line">return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ol><li>postå’Œputç±»ä¼¼å¯ç”¨å„ç§æ–¹å¼ä¼ è¾“ï¼Œä¹Ÿæœ€ä¸ºå®‰å…¨</li><li>getåªèƒ½ç”¨è¡¨å•ä¼ è¾“ï¼Œ {params: self.data}</li><li>deleteä¸¤ç§æ–¹å¼éƒ½èƒ½ï¼Œä½†æ˜¯å‚æ•°æ ¼å¼ç•¥æœ‰ä¸åŒï¼šè¡¨å•{params: self.data}ï¼Œå¯¹è±¡{data: self.data}</li></ol><h4 id="æ¨èé˜…è¯»"><a href="#æ¨èé˜…è¯»" class="headerlink" title="æ¨èé˜…è¯»"></a>æ¨èé˜…è¯»</h4><ul><li><a href="https://juejin.im/post/5d7a019bf265da03a31d65bb" target="_blank" rel="noopener">axiosåŸºæœ¬ä½¿ç”¨</a></li><li><a href="https://segmentfault.com/a/1190000015261229" target="_blank" rel="noopener">axiosä¸­postçš„ä¸‰ç§æ–¹å¼</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> Java web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Axios </tag>
            
            <tag> Vue.js </tag>
            
            <tag> SpringBoot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Thymeleafæ¨¡æ¿æŠ€æœ¯å°è¯•</title>
      <link href="/2019/11/30/Thymeleaf%E6%A8%A1%E6%9D%BF%E6%8A%80%E6%9C%AF%E5%B0%9D%E8%AF%95/"/>
      <url>/2019/11/30/Thymeleaf%E6%A8%A1%E6%9D%BF%E6%8A%80%E6%9C%AF%E5%B0%9D%E8%AF%95/</url>
      
        <content type="html"><![CDATA[<h1 id="Thymeleaf-æ¨¡æ¿æŠ€æœ¯å°è¯•"><a href="#Thymeleaf-æ¨¡æ¿æŠ€æœ¯å°è¯•" class="headerlink" title="Thymeleaf æ¨¡æ¿æŠ€æœ¯å°è¯•"></a>Thymeleaf æ¨¡æ¿æŠ€æœ¯å°è¯•</h1><ul><li><p>Thymeleafæ˜¯ä¸€ä¸ªJava XML / XHTML / HTML5 æ¨¡æ¿å¼•æ“ ï¼Œå¯ä»¥åœ¨Webï¼ˆåŸºäºservlet ï¼‰å’ŒéWebç¯å¢ƒä¸­å·¥ä½œã€‚ å®ƒæ›´é€‚åˆåœ¨åŸºäºMVCçš„Webåº”ç”¨ç¨‹åºçš„è§†å›¾å±‚æä¾›XHTML / HTML5ï¼Œä½†å®ƒç”šè‡³å¯ä»¥åœ¨è„±æœºç¯å¢ƒä¸­å¤„ç†ä»»ä½•XMLæ–‡ä»¶ã€‚ å®ƒæä¾›å®Œæ•´çš„Spring Frameworkã€‚</p></li><li><p>åœ¨Webåº”ç”¨ç¨‹åºä¸­ï¼ŒThymeleafæ—¨åœ¨æˆä¸ºJavaServer Pages ï¼ˆJSPï¼‰çš„å®Œå…¨æ›¿ä»£å“ï¼Œå¹¶å®ç°è‡ªç„¶æ¨¡æ¿çš„æ¦‚å¿µï¼šæ¨¡æ¿æ–‡ä»¶å¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ï¼Œå¹¶ä¸”ä»ç„¶å¯ä»¥æ­£ç¡®æ˜¾ç¤ºä¸ºç½‘é¡µã€‚</p></li><li><p><a href="https://www.thymeleaf.org/doc/tutorials/3.0/usingthymeleaf.html" target="_blank" rel="noopener">Thymeleaf 3.0 å®˜æ–¹æ–‡æ¡£</a></p></li></ul><h2 id="Thymeleaf-å¸¸ç”¨å…³é”®å­—"><a href="#Thymeleaf-å¸¸ç”¨å…³é”®å­—" class="headerlink" title="Thymeleaf å¸¸ç”¨å…³é”®å­—"></a>Thymeleaf å¸¸ç”¨å…³é”®å­—</h2><p><img alt data-src="https://ae01.alicdn.com/kf/Ha6d22c20c9d245df8d8521475655a66aB.png" class="lazyload"></p><h2 id="1-åˆ›å»ºHTML"><a href="#1-åˆ›å»ºHTML" class="headerlink" title="1.åˆ›å»ºHTML"></a>1.åˆ›å»ºHTML</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;html xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;</span><br></pre></td></tr></table></figure><h2 id="2-è·å–å˜é‡å€¼-â€¦"><a href="#2-è·å–å˜é‡å€¼-â€¦" class="headerlink" title="2.è·å–å˜é‡å€¼${â€¦}"></a>2.è·å–å˜é‡å€¼${â€¦}</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;p th:text=&quot;&apos;Helloï¼, &apos; + $&#123;name&#125; + &apos;!&apos;&quot;&gt;3333&lt;/p&gt;</span><br></pre></td></tr></table></figure><h2 id="3-é“¾æ¥è¡¨è¾¾å¼-â€¦"><a href="#3-é“¾æ¥è¡¨è¾¾å¼-â€¦" class="headerlink" title="3.é“¾æ¥è¡¨è¾¾å¼: @{â€¦}"></a>3.é“¾æ¥è¡¨è¾¾å¼: @{â€¦}</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=&quot;details.html&quot; th:href=&quot;@&#123;/order/details(orderId=$&#123;o.id&#125;)&#125;&quot;&gt;view&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;details.html&quot; th:href=&quot;@&#123;order/&#123;orderId&#125;/details(orderId=$&#123;o.id&#125;)&#125;&quot;&gt;Contentè·¯å¾„,é»˜è®¤è®¿é—®staticä¸‹çš„orderæ–‡ä»¶å¤¹&lt;/a&gt;</span><br></pre></td></tr></table></figure><h2 id="4-æ–‡æœ¬æ›¿æ¢"><a href="#4-æ–‡æœ¬æ›¿æ¢" class="headerlink" title="4.æ–‡æœ¬æ›¿æ¢"></a>4.æ–‡æœ¬æ›¿æ¢</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;span th:text=&quot;&apos;Welcome to our application, &apos; + $&#123;user.name&#125; + &apos;!&apos;&quot;&gt;</span><br></pre></td></tr></table></figure><h2 id="5-è¿ç®—ç¬¦"><a href="#5-è¿ç®—ç¬¦" class="headerlink" title="5.è¿ç®—ç¬¦"></a>5.è¿ç®—ç¬¦</h2><ul><li>é»˜è®¤æ”¯æŒ</li></ul><h2 id="6-æ¡ä»¶"><a href="#6-æ¡ä»¶" class="headerlink" title="6.æ¡ä»¶"></a>6.æ¡ä»¶</h2><ul><li>if/unless</li><li>ä½¿ç”¨th:ifå’Œth:unlesså±æ€§è¿›è¡Œæ¡ä»¶åˆ¤æ–­</li><li>th:unlessäºth:ifæ°å¥½ç›¸åï¼Œåªæœ‰è¡¨è¾¾å¼ä¸­çš„æ¡ä»¶ä¸æˆç«‹ï¼Œæ‰ä¼šæ˜¾ç¤ºå…¶å†…å®¹ã€‚<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;a th:href=&quot;@&#123;/login&#125;&quot; th:unless=$&#123;session.user != null&#125;&gt;Login&lt;/a&gt;</span><br></pre></td></tr></table></figure></li><li>switch</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;div th:switch=&quot;$&#123;user.role&#125;&quot;&gt;</span><br><span class="line">  &lt;p th:case=&quot;&apos;admin&apos;&quot;&gt;User is an administrator&lt;/p&gt;</span><br><span class="line">  &lt;p th:case=&quot;#&#123;roles.manager&#125;&quot;&gt;User is a manager&lt;/p&gt;</span><br><span class="line">  &lt;p th:case=&quot;*&quot;&gt;User is some other thing&lt;/p&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure><h2 id="7-å¾ªç¯"><a href="#7-å¾ªç¯" class="headerlink" title="7.å¾ªç¯"></a>7.å¾ªç¯</h2><ul><li>th:each</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;tr th:each=&quot;prod : $&#123;prods&#125;&quot;&gt;</span><br><span class="line">    &lt;td th:text=&quot;$&#123;prod.name&#125;&quot;&gt;Onions&lt;/td&gt;</span><br><span class="line">    &lt;td th:text=&quot;$&#123;prod.price&#125;&quot;&gt;2.41&lt;/td&gt;</span><br><span class="line">    &lt;td th:text=&quot;$&#123;prod.inStock&#125;? #&#123;true&#125; : #&#123;false&#125;&quot;&gt;yes&lt;/td&gt;</span><br><span class="line">&lt;/tr&gt;</span><br></pre></td></tr></table></figure><h2 id="8-æ¨¡æ¿å¸ƒå±€"><a href="#8-æ¨¡æ¿å¸ƒå±€" class="headerlink" title="8.æ¨¡æ¿å¸ƒå±€"></a>8.æ¨¡æ¿å¸ƒå±€</h2><ul><li>Thymeleaféœ€è¦æˆ‘ä»¬å®šä¹‰è¿™äº›éƒ¨åˆ†ï¼Œâ€œç‰‡æ®µâ€ï¼Œä»¥ä¾¿åŒ…å«ï¼Œè¿™å¯ä»¥ä½¿ç”¨th:fragmentå±æ€§æ¥å®Œæˆã€‚</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;div th:fragment=&quot;navbar&quot;&gt;</span><br><span class="line">      &amp;copy; 2011 The Good Thymes Virtual Grocery</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><ul><li>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…¶ä¸­ä¸€ä¸ªth:insertæˆ–th:replaceå±æ€§è½»æ¾åœ°åœ¨æˆ‘ä»¬çš„ä¸»é¡µä¸­åŒ…å«è¿™äº›ç‰‡æ®µã€‚</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">  ...</span><br><span class="line">  &lt;div th:insert=&quot;~&#123;base :: navbar&#125;&quot;&gt;&lt;/div&gt;</span><br><span class="line">  æˆ–è€…</span><br><span class="line">  &lt;div th:insert=&quot;base :: navbar&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Java web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Thymeleaf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Shiroå®‰å…¨æ¡†æ¶åŸºç¡€çŸ¥è¯†ç‚¹</title>
      <link href="/2019/11/27/Shiro%E5%AE%89%E5%85%A8%E6%A1%86%E6%9E%B6%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E7%82%B9/"/>
      <url>/2019/11/27/Shiro%E5%AE%89%E5%85%A8%E6%A1%86%E6%9E%B6%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E7%82%B9/</url>
      
        <content type="html"><![CDATA[<h1 id="ShiroåŸºç¡€çŸ¥è¯†ç‚¹"><a href="#ShiroåŸºç¡€çŸ¥è¯†ç‚¹" class="headerlink" title="ShiroåŸºç¡€çŸ¥è¯†ç‚¹"></a>ShiroåŸºç¡€çŸ¥è¯†ç‚¹</h1><ul><li><p>Apache Shiro æ˜¯ASFæ——ä¸‹çš„ä¸€æ¬¾å¼€æºè½¯ä»¶ï¼ˆShiroå‘éŸ³ä¸ºâ€œshee-rohâ€ï¼Œæ—¥è¯­â€œå ¡å’ï¼ˆCastleï¼‰â€çš„æ„æ€ï¼‰ï¼Œæä¾›äº†ä¸€ä¸ªå¼ºå¤§è€Œçµæ´»çš„å®‰å…¨æ¡†æ¶ã€‚å¯ä¸ºä»»ä½•åº”ç”¨æä¾›å®‰å…¨ä¿éšœâ€” ä»å‘½ä»¤è¡Œåº”ç”¨ã€ç§»åŠ¨åº”ç”¨åˆ°å¤§å‹ç½‘ç»œåŠä¼ä¸šåº”ç”¨ã€‚</p></li><li><p>Apache Shiroæä¾›äº†è®¤è¯ã€æˆæƒã€åŠ å¯†å’Œä¼šè¯ç®¡ç†åŠŸèƒ½ï¼Œå°†å¤æ‚çš„é—®é¢˜éšè—èµ·æ¥ï¼Œæä¾›æ¸…æ™°ç›´è§‚çš„APIä½¿å¼€å‘è€…å¯ä»¥å¾ˆè½»æ¾åœ°å¼€å‘è‡ªå·±çš„ç¨‹åºå®‰å…¨ä»£ç ã€‚å¹¶ä¸”åœ¨å®ç°æ­¤ç›®æ ‡æ—¶æ— é¡»ä¾èµ–ç¬¬ä¸‰æ–¹çš„æ¡†æ¶ã€å®¹å™¨æˆ–æœåŠ¡ï¼Œå½“ç„¶ä¹Ÿèƒ½åšåˆ°ä¸è¿™äº›ç¯å¢ƒçš„æ•´åˆï¼Œä½¿å…¶åœ¨ä»»ä½•ç¯å¢ƒä¸‹éƒ½å¯æ‹¿æ¥ä½¿ç”¨ã€‚</p></li></ul><h2 id="Shiroçš„æ ¸å¿ƒå››éƒ¨åˆ†"><a href="#Shiroçš„æ ¸å¿ƒå››éƒ¨åˆ†" class="headerlink" title="Shiroçš„æ ¸å¿ƒå››éƒ¨åˆ†"></a>Shiroçš„æ ¸å¿ƒå››éƒ¨åˆ†</h2><ul><li><p>è®¤è¯ï¼ˆAuthenticationï¼‰ï¼šç”¨æˆ·èº«ä»½è¯†åˆ«ã€‚æœ‰æ—¶å¯çœ‹ä½œä¸ºâ€œç™»å½•ï¼ˆloginï¼‰â€ï¼Œå®ƒæ˜¯ç”¨æˆ·è¯æ˜è‡ªå·±æ˜¯è°çš„ä¸€ä¸ªè¡Œä¸ºã€‚</p></li><li><p>æˆæƒï¼ˆAuthorizationï¼‰ï¼šè®¿é—®æ§åˆ¶è¿‡ç¨‹ï¼Œå¥½æ¯”å†³å®šâ€œè®¤è¯ï¼ˆwhoï¼‰â€å¯ä»¥è®¿é—®â€œä»€ä¹ˆï¼ˆwhatï¼‰â€.</p></li><li><p>ä¼šè¯ç®¡ç†ï¼ˆSessionManagementï¼‰ï¼šç®¡ç†ç”¨æˆ·çš„ä¼šè¯ï¼ˆsessionsï¼‰ï¼Œç”šè‡³åœ¨æ²¡æœ‰WEBæˆ–EJBå®¹å™¨çš„ç¯å¢ƒä¸­ã€‚ç®¡ç†ç”¨æˆ·ä¸æ—¶é—´ç›¸å…³çš„çŠ¶æ€ã€‚</p></li><li><p>åŠ å¯†ï¼ˆCryptographyï¼‰ï¼šä½¿ç”¨åŠ å¯†ç®—æ³•ä¿æŠ¤æ•°æ®æ›´åŠ å®‰å…¨ï¼Œé˜²æ­¢æ•°æ®è¢«å·çª¥ã€‚</p></li></ul><h3 id="1-Springæ•´åˆShiro"><a href="#1-Springæ•´åˆShiro" class="headerlink" title="1.Springæ•´åˆShiro"></a>1.Springæ•´åˆShiro</h3><ol><li>pom ä¾èµ–<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--æ•´åˆshiro--&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.apache.shiro&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;shiro-spring-boot-starter&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.4.1&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure></li></ol><h3 id="2-ShiroConfig"><a href="#2-ShiroConfig" class="headerlink" title="2. ShiroConfig"></a>2. ShiroConfig</h3><ul><li>shiroçš„åŸºæœ¬é…ç½®</li><li>1.ShiroFilterFactoryBean    #Shiroå¯¹å¤–çš„æ¥å£ï¼Œä»£è¡¨å½“å‰â€œç”¨æˆ·â€</li><li>2.DefaultWebSecurityManager   #å…³è”realm</li><li>3.UserRealm   #è´Ÿè´£ç™»å½•éªŒè¯å’Œèµ„æºæˆæƒ</li><li><img alt data-src="https://pic2.zhimg.com/80/v2-8526e78cc56a9505dcca6d0f3fcac3dd_hd.jpg" class="lazyload"><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">package io.kid1999.operatesystem.config;</span><br><span class="line"></span><br><span class="line">import org.apache.shiro.spring.web.ShiroFilterFactoryBean;</span><br><span class="line">import org.apache.shiro.web.mgt.DefaultWebSecurityManager;</span><br><span class="line">import org.springframework.beans.factory.annotation.Qualifier;</span><br><span class="line">import org.springframework.context.annotation.Bean;</span><br><span class="line">import org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line">import java.util.LinkedHashMap;</span><br><span class="line">import java.util.Map;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @author kid1999</span><br><span class="line"> * @title: Shiro çš„ é…ç½®</span><br><span class="line"> * @date 2019/11/26 21:27</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">@Configuration</span><br><span class="line">public class ShiroConfig &#123;</span><br><span class="line"></span><br><span class="line">// 3. åˆ›å»º ShiroFilterFactoryBean</span><br><span class="line">@Bean</span><br><span class="line">public ShiroFilterFactoryBean getShiroFilterFactoryBean(@Qualifier(&quot;securityManager&quot;) DefaultWebSecurityManager securityManager)&#123;</span><br><span class="line">ShiroFilterFactoryBean shiroFilterFactoryBean = new ShiroFilterFactoryBean();</span><br><span class="line">// è®¾ç½®å®‰å…¨ç®¡ç†å™¨</span><br><span class="line">shiroFilterFactoryBean.setSecurityManager(securityManager);</span><br><span class="line"></span><br><span class="line">/**  æ·»åŠ Shiroçš„å†…ç½®è¿‡æ»¤å™¨</span><br><span class="line"> * å¸¸ç”¨ï¼š</span><br><span class="line"> * anon : æ— éœ€è®¤è¯ï¼ˆç™»å½•ï¼‰ å¯ä»¥è®¿é—®</span><br><span class="line"> * authc ï¼šå¿…é¡»è®¤è¯æ‰å¯ä»¥è®¿é—®</span><br><span class="line"> * user : å¦‚æœä½¿ç”¨remenberMeåŠŸèƒ½å¯ä»¥ç›´æ¥è®¿é—®</span><br><span class="line"> * perms: è¯¥èµ„æºå¿…é¡»è·å¾—ç›¸å…³æƒé™æ‰å¯è®¿é—®</span><br><span class="line"> * role: è¯¥èµ„æºå¿…é¡»è·å¾—è§’è‰²æƒé™æ‰å¯ä»¥è®¿é—®</span><br><span class="line"> *</span><br><span class="line"> *  æ³¨æ„ï¼š è¿™ä¸ªæˆæƒæ‹¦æˆªé“¾ æ˜¯æŒ‰é¡ºåºæ‰§è¡Œçš„ï¼ï¼ï¼</span><br><span class="line"> */</span><br><span class="line">Map&lt;String,String&gt; filterMap = new LinkedHashMap&lt;&gt;();</span><br><span class="line">filterMap.put(&quot;/&quot;,&quot;anon&quot;);</span><br><span class="line">filterMap.put(&quot;/login&quot;,&quot;anon&quot;);</span><br><span class="line">filterMap.put(&quot;/error&quot;,&quot;anon&quot;);</span><br><span class="line">//filterMap.put(&quot;/admin&quot;,&quot;authc&quot;);</span><br><span class="line"></span><br><span class="line">// æƒé™è¿‡æ»¤å™¨  ä¹Ÿå¯ä»¥è®¾ç½®è§’è‰²è¿‡æ»¤</span><br><span class="line">filterMap.put(&quot;/admin&quot;,&quot;perms[user:admin]&quot;);</span><br><span class="line"></span><br><span class="line">shiroFilterFactoryBean.setLoginUrl(&quot;/login&quot;);       // è®¾ç½®è·³è½¬çš„ç™»å½•é¡µé¢</span><br><span class="line">shiroFilterFactoryBean.setUnauthorizedUrl(&quot;/noAuth&quot;);   // è®¾ç½®æœªæˆæƒè®¿é—®é¡µé¢</span><br><span class="line">shiroFilterFactoryBean.setFilterChainDefinitionMap(filterMap);</span><br><span class="line"></span><br><span class="line">return shiroFilterFactoryBean;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 2. åˆ›å»ºDefaultWebSecurityManager </span><br><span class="line">// æ‰€æœ‰ä¸å®‰å…¨æœ‰å…³çš„æ“ä½œéƒ½ä¼šä¸SecurityManagerè¿›è¡Œäº¤äº’</span><br><span class="line">@Bean(name = &quot;securityManager&quot;)</span><br><span class="line">public DefaultWebSecurityManager getDefaultWebSecurityManager(@Qualifier(&quot;getRealm&quot;) UserRealm userRealm)&#123;</span><br><span class="line">DefaultWebSecurityManager securityManager = new DefaultWebSecurityManager();</span><br><span class="line">// å…³è”realm</span><br><span class="line">securityManager.setRealm(getRealm());</span><br><span class="line">return securityManager;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 1. åˆ›å»ºRealm</span><br><span class="line">// Shiroä»Realmè·å–å®‰å…¨æ•°æ®ï¼ˆç”¨æˆ·ã€è§’è‰²ã€æƒé™ï¼‰</span><br><span class="line">@Bean</span><br><span class="line">public UserRealm getRealm()&#123;</span><br><span class="line">return new UserRealm();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="3-UserRealm"><a href="#3-UserRealm" class="headerlink" title="3. UserRealm"></a>3. UserRealm</h3><ul><li>Shiroä»ä»Realmè·å–å®‰å…¨æ•°æ®ï¼ˆå¦‚ç”¨æˆ·ã€è§’è‰²ã€æƒé™ï¼‰<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">package io.kid1999.operatesystem.config;</span><br><span class="line"></span><br><span class="line">import io.kid1999.operatesystem.model.Admin;</span><br><span class="line">import io.kid1999.operatesystem.repository.AdminRepository;</span><br><span class="line">import org.apache.shiro.authc.*;</span><br><span class="line">import org.apache.shiro.authz.AuthorizationInfo;</span><br><span class="line">import org.apache.shiro.authz.SimpleAuthorizationInfo;</span><br><span class="line">import org.apache.shiro.realm.AuthorizingRealm;</span><br><span class="line">import org.apache.shiro.subject.PrincipalCollection;</span><br><span class="line">import org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @author kid1999</span><br><span class="line"> * @title: UserRealm è‡ªå®šä¹‰ realm å¤„ç† æˆæƒå’Œè®¤è¯</span><br><span class="line"> * @date 2019/11/26 21:29</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">public class UserRealm extends AuthorizingRealm  &#123;</span><br><span class="line">@Autowired</span><br><span class="line">private AdminRepository adminRepository;</span><br><span class="line"></span><br><span class="line">// æˆæƒæ‰§è¡Œé€»è¾‘</span><br><span class="line">@Override</span><br><span class="line">protected AuthorizationInfo doGetAuthorizationInfo(PrincipalCollection principalCollection) &#123;</span><br><span class="line">System.out.println(&quot;æˆæƒæ‰§è¡Œé€»è¾‘&quot;);</span><br><span class="line"></span><br><span class="line">// ç»™èµ„æºè¿›è¡Œæˆæƒ</span><br><span class="line">SimpleAuthorizationInfo info = new SimpleAuthorizationInfo();</span><br><span class="line"></span><br><span class="line">// æ·»åŠ èµ„æºæˆæƒå­—ç¬¦ä¸²</span><br><span class="line">info.addStringPermission(&quot;user:admin&quot;);</span><br><span class="line"></span><br><span class="line">return info;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// è®¤è¯æ‰§è¡Œé€»è¾‘</span><br><span class="line">@Override</span><br><span class="line">protected AuthenticationInfo doGetAuthenticationInfo(AuthenticationToken authenticationToken) throws AuthenticationException &#123;</span><br><span class="line">System.out.println(&quot;è®¤è¯æ‰§è¡Œé€»è¾‘&quot;);</span><br><span class="line"></span><br><span class="line">// 1. è·å–ä¼ æ¥éªŒè¯çš„token</span><br><span class="line">UsernamePasswordToken token = (UsernamePasswordToken) authenticationToken;</span><br><span class="line">String name = token.getUsername();</span><br><span class="line">String password = String.valueOf(token.getPassword());</span><br><span class="line">// 2. é€šè¿‡ç”¨æˆ·å å–å‡ºæ•°æ®åº“çš„æ•°æ®</span><br><span class="line">Admin user = adminRepository.findByAdminId(name);</span><br><span class="line"></span><br><span class="line">// 3. åˆ¤æ–­ç”¨æˆ·å</span><br><span class="line">if (user == null)&#123;</span><br><span class="line">return null;        // æ‰¾ä¸åˆ°ç”¨æˆ·å æŠ¥ UnknownAccountException</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 4. åˆ¤æ–­å¯†ç </span><br><span class="line">/**</span><br><span class="line"> * arg0: å›ä¼ loginçš„æ•°æ®</span><br><span class="line"> * arg1: æ•°æ®åº“çš„å¯†ç </span><br><span class="line"> * arg2: realm çš„name</span><br><span class="line"> */</span><br><span class="line">return new SimpleAuthenticationInfo(&quot;&quot;,user.getAdminPwd(),&quot;&quot;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="4-AdminRepository-é“¾æ¥æ•°æ®åº“"><a href="#4-AdminRepository-é“¾æ¥æ•°æ®åº“" class="headerlink" title="4.AdminRepository é“¾æ¥æ•°æ®åº“"></a>4.AdminRepository é“¾æ¥æ•°æ®åº“</h3><ul><li>Realm ä¼šè¿æ¥æ•°æ®æº è¿›è¡Œèº«ä»½éªŒè¯</li><li>æ­¤å¤„æ”¾ä¸Šæˆ‘çš„JPA</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">package io.kid1999.operatesystem.repository;</span><br><span class="line">import io.kid1999.operatesystem.model.Admin;</span><br><span class="line">import org.springframework.data.jpa.repository.JpaRepository;</span><br><span class="line">import org.springframework.data.jpa.repository.Query;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @author kid1999</span><br><span class="line"> * @title: ManagerRepository</span><br><span class="line"> * @date 2019/11/24 10:07</span><br><span class="line"> */</span><br><span class="line">public interface AdminRepository extends JpaRepository&lt;Admin,Integer&gt; &#123;</span><br><span class="line">@Query(value = &quot;select * from admin m where m.admin_id = ?1 and m.admin_pwd = ?2&quot; ,nativeQuery = true)</span><br><span class="line">Admin login(String studentId, String passWord);</span><br><span class="line"></span><br><span class="line">Admin findByAdminId(String adminId);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-ç™»å½•Controller"><a href="#5-ç™»å½•Controller" class="headerlink" title="5.ç™»å½•Controller"></a>5.ç™»å½•Controller</h3><ul><li>æ­¤å¤„æ²¡æœ‰ä½¿ç”¨åŠ å¯† å’Œ ç¼“å­˜æœºåˆ¶<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * ä½¿ç”¨Shiroå®ç°ç™»å½•</span><br><span class="line"> */</span><br><span class="line">@PostMapping(&quot;/login&quot;)</span><br><span class="line">String toLogin(String studentId,</span><br><span class="line">               String passWord,</span><br><span class="line">               Model model)&#123;</span><br><span class="line">// 1.è·å–Subject</span><br><span class="line">Subject subject = SecurityUtils.getSubject();</span><br><span class="line">// 2.å°è£…ç™»å½•æ–¹æ³•</span><br><span class="line">UsernamePasswordToken token = new UsernamePasswordToken(studentId,passWord);</span><br><span class="line">// 3.æ‰§è¡Œç™»å½•æ–¹æ³•</span><br><span class="line">try &#123;</span><br><span class="line">subject.login(token);       // è°ƒç”¨loginæ–¹æ³• -&gt; realm åšéªŒè¯</span><br><span class="line">return &quot;admin&quot;;</span><br><span class="line">&#125;catch (UnknownAccountException e)&#123;</span><br><span class="line">model.addAttribute(&quot;msg&quot;,&quot;ç”¨æˆ·åä¸å­˜åœ¨&quot;);</span><br><span class="line">return &quot;login&quot;;</span><br><span class="line">&#125;catch (IncorrectCredentialsException e)&#123;</span><br><span class="line">model.addAttribute(&quot;msg&quot;,&quot;å¯†ç é”™è¯¯&quot;);</span><br><span class="line">return &quot;login&quot;;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="6-æ•´åˆredisæ¥ç®¡sessionå’Œç¼“å­˜"><a href="#6-æ•´åˆredisæ¥ç®¡sessionå’Œç¼“å­˜" class="headerlink" title="6.æ•´åˆredisæ¥ç®¡sessionå’Œç¼“å­˜"></a>6.æ•´åˆredisæ¥ç®¡sessionå’Œç¼“å­˜</h3><ol><li>å†å¯¼å…¥ä¸¤ä¸ªåŒ…</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.apache.shiro&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;shiro-ehcache&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.4.1&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- shiro+redisç¼“å­˜æ’ä»¶ --&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.crazycake&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;shiro-redis&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;3.2.3&lt;/version&gt;</span><br><span class="line">    &lt;!--     å‰”é™¤è¿™ä¸ªé”™è¯¯ä¾èµ–       --&gt;</span><br><span class="line">    &lt;exclusions&gt;</span><br><span class="line">        &lt;exclusion&gt;</span><br><span class="line">            &lt;groupId&gt;org.apache.shiro&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;shiro-core&lt;/artifactId&gt;</span><br><span class="line">        &lt;/exclusion&gt;</span><br><span class="line">    &lt;/exclusions&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><ol start="2"><li>åœ¨ShiroConfig é…ç½®åˆ° securityManager </li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// 2. åˆ›å»ºDefaultWebSecurityManager  ç®¡ç†å™¨</span><br><span class="line">@Bean(name = &quot;securityManager&quot;)</span><br><span class="line">public DefaultWebSecurityManager getDefaultWebSecurityManager(@Qualifier(&quot;getRealm&quot;) UserRealm userRealm)&#123;</span><br><span class="line">DefaultWebSecurityManager securityManager = new DefaultWebSecurityManager();</span><br><span class="line">// å…³è”realm</span><br><span class="line">securityManager.setRealm(getRealm());</span><br><span class="line">// è‡ªå®šä¹‰ç¼“å­˜å®ç° ä½¿ç”¨redis</span><br><span class="line">securityManager.setCacheManager(cacheManager());</span><br><span class="line">// è‡ªå®šä¹‰sessionç®¡ç† ä½¿ç”¨redis</span><br><span class="line">securityManager.setSessionManager(sessionManager());</span><br><span class="line">return securityManager;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="7-æ•´åˆredisæ¥ç®¡sessionå’Œç¼“å­˜"><a href="#7-æ•´åˆredisæ¥ç®¡sessionå’Œç¼“å­˜" class="headerlink" title="7.æ•´åˆredisæ¥ç®¡sessionå’Œç¼“å­˜"></a>7.æ•´åˆredisæ¥ç®¡sessionå’Œç¼“å­˜</h3><ol><li>ç»§æ‰¿FormAuthenticationFilter é‡å†™ä¸€äº›æ–¹æ³•</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">package io.kid19999.backstage.config.Shiro;</span><br><span class="line"></span><br><span class="line">import io.kid19999.backstage.repository.SignLogRepository;</span><br><span class="line">import org.apache.shiro.authc.AuthenticationException;</span><br><span class="line">import org.apache.shiro.authc.AuthenticationToken;</span><br><span class="line">import org.apache.shiro.subject.Subject;</span><br><span class="line">import org.apache.shiro.web.filter.authc.FormAuthenticationFilter;</span><br><span class="line">import org.apache.shiro.web.util.WebUtils;</span><br><span class="line">import org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"></span><br><span class="line">import javax.servlet.ServletRequest;</span><br><span class="line">import javax.servlet.ServletResponse;</span><br><span class="line">import javax.servlet.http.HttpServletRequest;</span><br><span class="line">import javax.servlet.http.HttpSession;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @desc:   è‡ªå®šä¹‰ ç™»å½•éªŒè¯ çš„æ“ä½œ</span><br><span class="line"> * @auther: kid1999</span><br><span class="line"> * @date: 2019/11/28 20:52</span><br><span class="line"> **/</span><br><span class="line"></span><br><span class="line">public class AuthenticationFilter extends FormAuthenticationFilter &#123;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private SignLogRepository signLogRepository;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected boolean onLoginSuccess(AuthenticationToken token, Subject subject, ServletRequest request, ServletResponse response) throws Exception &#123;</span><br><span class="line">        //è·å–å·²ç™»å½•çš„ç”¨æˆ·ä¿¡æ¯</span><br><span class="line">        String username = (String) subject.getPrincipal();</span><br><span class="line">        //è·å–session</span><br><span class="line">        HttpServletRequest httpServletRequest = WebUtils.toHttp(request);</span><br><span class="line">        HttpSession session = httpServletRequest.getSession();</span><br><span class="line">        //æŠŠç”¨æˆ·ä¿¡æ¯ä¿å­˜åˆ°session</span><br><span class="line">        session.setAttribute(&quot;activeUser&quot;, username);</span><br><span class="line"></span><br><span class="line">        System.out.println(&quot;login success&quot;);</span><br><span class="line">        System.out.println(token.getPrincipal());</span><br><span class="line">        String name = token.getPrincipal().toString();</span><br><span class="line">        System.out.println(name);</span><br><span class="line"></span><br><span class="line">        return super.onLoginSuccess(token, subject, request, response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected boolean onAccessDenied(ServletRequest request, ServletResponse response) throws Exception &#123;</span><br><span class="line">        System.out.println(&quot;æ‹’ç»è®¿é—®&quot;);</span><br><span class="line">        return super.onAccessDenied(request, response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected boolean onLoginFailure(AuthenticationToken token, AuthenticationException e, ServletRequest request, ServletResponse response) &#123;</span><br><span class="line">        System.out.println(&quot;ç™»å½•å¤±è´¥&quot;);</span><br><span class="line">        return super.onLoginFailure(token, e, request, response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>åœ¨ShiroConfig æ³¨å…¥ è‡ªå®šä¹‰æ‹¦æˆªå™¨</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// æ³¨å…¥ æ‹¦æˆªå™¨å’Œè®¤è¯</span><br><span class="line">shiroFilterFactoryBean.setFilterChainDefinitionMap(filterMap);</span><br><span class="line">Map&lt;String,Filter&gt; filter = new HashMap&lt;&gt;();</span><br><span class="line">filter.put(&quot;authc&quot;,new AuthenticationFilter());</span><br><span class="line">shiroFilterFactoryBean.setFilters(filter);</span><br></pre></td></tr></table></figure><ol start="3"><li>æ‹¦æˆªå™¨çš„å®é™…å·¥ä½œæµç¨‹ï¼š<br><a href="https://blog.wuwii.com/shiro-2.html" target="_blank" rel="noopener">è¯¦è§</a></li></ol><h3 id="8-Vueçš„ç®€å•å®‰å…¨è®¤è¯ï¼š"><a href="#8-Vueçš„ç®€å•å®‰å…¨è®¤è¯ï¼š" class="headerlink" title="8.Vueçš„ç®€å•å®‰å…¨è®¤è¯ï¼š"></a>8.Vueçš„ç®€å•å®‰å…¨è®¤è¯ï¼š</h3><ol><li><p>å¯¼å…¥vue-cookies ä½¿ç”¨cookieä¿å­˜å½“å‰ç”¨æˆ·çš„çŠ¶æ€</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import VueCookies from &apos;vue-cookies&apos;</span><br><span class="line">Vue.use(VueCookies);</span><br></pre></td></tr></table></figure></li><li><p>ä½¿ç”¨é’©å­å‡½æ•°å¯¹è·¯ç”±è¿›è¡Œæƒé™è·³è½¬</p></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">router.beforeEach((to, from, next) =&gt; &#123;</span><br><span class="line">  let cookieRoles = window.$cookies.get(&quot;role&quot;);</span><br><span class="line">  if(to.path === &apos;/&apos;)&#123;</span><br><span class="line">    next();</span><br><span class="line">  &#125; else if (!cookieRoles &amp;&amp; to.path !== &apos;/login&apos;) &#123; // cookieä¸­æœ‰ç™»é™†ç”¨æˆ·ä¿¡æ¯è·³è½¬é¡µé¢ï¼Œå¦åˆ™åˆ°ç™»é™†é¡µé¢</span><br><span class="line">    next(&apos;/login&apos;);</span><br><span class="line">  &#125; else if (to.meta.permission) &#123;// å¦‚æœè¯¥é¡µé¢é…ç½®äº†æƒé™å±æ€§ï¼ˆè‡ªå®šä¹‰permissionï¼‰</span><br><span class="line">    // å¦‚æœæ˜¯ç®¡ç†å‘˜æƒé™åˆ™å¯è¿›å…¥</span><br><span class="line">    roles.indexOf(&apos;admin&apos;) &gt; -1 ? next() : next(&apos;/403&apos;);</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    next();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ol start="3"><li>ç™»å½•åè¿”å›çŠ¶æ€ å­˜å…¥cookieä¸­ é»˜è®¤ä¿å­˜ä¸€å¤©</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">this.$axios.post(&apos;/login&apos;, qs.stringify(data), &#123;headers:&#123;&apos;Content-Type&apos;:&apos;application/x-www-form-urlencoded&apos;&#125;&#125;).then(function (response) &#123;</span><br><span class="line">      let res = response.data;</span><br><span class="line">      if(res[&apos;reslut&apos;] === 1)&#123;</span><br><span class="line">        self.$store.commit(&apos;Login&apos;);</span><br><span class="line">        let arr = res[&apos;info&apos;].split(&apos; &apos;);</span><br><span class="line">        window.$cookies.set(&quot;role&quot;,arr[1]);</span><br><span class="line">        window.$cookies.set(&quot;sessionId&quot;,arr[0]);</span><br><span class="line">        self.$router.push(&quot;/&quot;);</span><br><span class="line">        self.$message.success(&#123;message:&quot;ç™»å½•æˆåŠŸ&quot;&#125;);</span><br><span class="line">      &#125;else&#123;</span><br><span class="line">        self.$message.error(res[&apos;info&apos;]);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;).catch(function (error) &#123;</span><br><span class="line">      console.log(error);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure><h2 id="æµç¨‹æ€»ç»“ï¼š"><a href="#æµç¨‹æ€»ç»“ï¼š" class="headerlink" title="æµç¨‹æ€»ç»“ï¼š"></a>æµç¨‹æ€»ç»“ï¼š</h2><ol><li>é¦–å…ˆ ShiroFilterFactoryBean æŸ¥è¯¢æ‹¦æˆªè§„åˆ™ è·³è½¬ loginï¼ˆæˆ–è€…è‡ªå·±è®¿é—®loginï¼‰</li><li>ç™»å½•éªŒè¯Controller è°ƒç”¨ subject.login(token)</li><li>Realmæ¥æ”¶ä¿¡æ¯ï¼Œå¹¶ä¸”å’Œæ•°æ®æºçš„æ•°æ®è¿›è¡Œå¯¹æ¯” è¿”å› åˆ¤æ–­ç»“æœ</li><li>å¦‚æœä¸æˆåŠŸ è¿”å›é”™è¯¯ï¼Œå¦‚æœæˆåŠŸ å»å¾€èµ„æºç½‘ç«™ã€‚ </li><li>ShiroFilterFactoryBean åˆ¤æ–­èµ„æºè®¿é—®æƒé™</li><li>è°ƒç”¨ Realmçš„ æˆæƒæ–¹æ³• ä»æ•°æ®æºè·å– ç”¨æˆ·æƒé™ è¿”å›ç»“æœ</li><li>å¦‚æœ ä¸æˆåŠŸ è¿”å›é”™è¯¯ã€‚æˆåŠŸ å…è®¸è®¿é—® </li></ol><h3 id="æ€è€ƒï¼š"><a href="#æ€è€ƒï¼š" class="headerlink" title="æ€è€ƒï¼š"></a>æ€è€ƒï¼š</h3><p><img alt data-src="https://ae01.alicdn.com/kf/H0c51e33d70144f179cf8600f263263e3R.png" class="lazyload"><br>å‰ç«¯éªŒè¯cookieæ˜¯å¯è§çš„ role å®¹æ˜“è¢«æŸ¥çœ‹ ä¿®æ”¹ä¸å®‰å…¨</p><p>åç«¯å†æ¬¡éªŒè¯ sessionæ˜¯å¦å­˜åœ¨(è¶…æ—¶è¢«æŠ¹é™¤|logoutè¢«æŠ¹é™¤)</p><p>æ¯æ¬¡è®¿é—®çš„æ—¶å€™å…ˆå»è¿‡æ»¤å™¨ä¸€ä¸‹æ˜¯å¦sessionå­˜åœ¨</p><hr><p>å‚è€ƒèµ„æ–™ï¼š</p><p><a href="https://zhuanlan.zhihu.com/p/63910997" target="_blank" rel="noopener">çŸ¥ä¹-Shiroè¯¦è§£</a></p><p><a href="https://juejin.im/post/5ac78b31f265da237411387e" target="_blank" rel="noopener">æ˜é‡‘-springæ•´åˆshiro</a></p><p><a href="https://www.bilibili.com/video/av40342174" target="_blank" rel="noopener">Bç«™è§†é¢‘</a></p><ul><li><p>Apache Shiro æ˜¯ASFæ——ä¸‹çš„ä¸€æ¬¾å¼€æºè½¯ä»¶ï¼ˆShiroå‘éŸ³ä¸ºâ€œshee-rohâ€ï¼Œæ—¥è¯­â€œå ¡å’ï¼ˆCastleï¼‰â€çš„æ„æ€ï¼‰ï¼Œæä¾›äº†ä¸€ä¸ªå¼ºå¤§è€Œçµæ´»çš„å®‰å…¨æ¡†æ¶ã€‚å¯ä¸ºä»»ä½•åº”ç”¨æä¾›å®‰å…¨ä¿éšœâ€” ä»å‘½ä»¤è¡Œåº”ç”¨ã€ç§»åŠ¨åº”ç”¨åˆ°å¤§å‹ç½‘ç»œåŠä¼ä¸šåº”ç”¨ã€‚</p></li><li><p>Apache Shiroæä¾›äº†è®¤è¯ã€æˆæƒã€åŠ å¯†å’Œä¼šè¯ç®¡ç†åŠŸèƒ½ï¼Œå°†å¤æ‚çš„é—®é¢˜éšè—èµ·æ¥ï¼Œæä¾›æ¸…æ™°ç›´è§‚çš„APIä½¿å¼€å‘è€…å¯ä»¥å¾ˆè½»æ¾åœ°å¼€å‘è‡ªå·±çš„ç¨‹åºå®‰å…¨ä»£ç ã€‚å¹¶ä¸”åœ¨å®ç°æ­¤ç›®æ ‡æ—¶æ— é¡»ä¾èµ–ç¬¬ä¸‰æ–¹çš„æ¡†æ¶ã€å®¹å™¨æˆ–æœåŠ¡ï¼Œå½“ç„¶ä¹Ÿèƒ½åšåˆ°ä¸è¿™äº›ç¯å¢ƒçš„æ•´åˆï¼Œä½¿å…¶åœ¨ä»»ä½•ç¯å¢ƒä¸‹éƒ½å¯æ‹¿æ¥ä½¿ç”¨ã€‚</p></li></ul><h2 id="Shiroçš„æ ¸å¿ƒå››éƒ¨åˆ†-1"><a href="#Shiroçš„æ ¸å¿ƒå››éƒ¨åˆ†-1" class="headerlink" title="Shiroçš„æ ¸å¿ƒå››éƒ¨åˆ†"></a>Shiroçš„æ ¸å¿ƒå››éƒ¨åˆ†</h2><ul><li><p>è®¤è¯ï¼ˆAuthenticationï¼‰ï¼šç”¨æˆ·èº«ä»½è¯†åˆ«ã€‚æœ‰æ—¶å¯çœ‹ä½œä¸ºâ€œç™»å½•ï¼ˆloginï¼‰â€ï¼Œå®ƒæ˜¯ç”¨æˆ·è¯æ˜è‡ªå·±æ˜¯è°çš„ä¸€ä¸ªè¡Œä¸ºã€‚</p></li><li><p>æˆæƒï¼ˆAuthorizationï¼‰ï¼šè®¿é—®æ§åˆ¶è¿‡ç¨‹ï¼Œå¥½æ¯”å†³å®šâ€œè®¤è¯ï¼ˆwhoï¼‰â€å¯ä»¥è®¿é—®â€œä»€ä¹ˆï¼ˆwhatï¼‰â€.</p></li><li><p>ä¼šè¯ç®¡ç†ï¼ˆSessionManagementï¼‰ï¼šç®¡ç†ç”¨æˆ·çš„ä¼šè¯ï¼ˆsessionsï¼‰ï¼Œç”šè‡³åœ¨æ²¡æœ‰WEBæˆ–EJBå®¹å™¨çš„ç¯å¢ƒä¸­ã€‚ç®¡ç†ç”¨æˆ·ä¸æ—¶é—´ç›¸å…³çš„çŠ¶æ€ã€‚</p></li><li><p>åŠ å¯†ï¼ˆCryptographyï¼‰ï¼šä½¿ç”¨åŠ å¯†ç®—æ³•ä¿æŠ¤æ•°æ®æ›´åŠ å®‰å…¨ï¼Œé˜²æ­¢æ•°æ®è¢«å·çª¥ã€‚</p></li></ul><h3 id="1-Springæ•´åˆShiro-1"><a href="#1-Springæ•´åˆShiro-1" class="headerlink" title="1.Springæ•´åˆShiro"></a>1.Springæ•´åˆShiro</h3><ol><li>pom ä¾èµ–<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--æ•´åˆshiro--&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.apache.shiro&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;shiro-spring-boot-starter&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.4.1&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure></li></ol><h3 id="2-ShiroConfig-1"><a href="#2-ShiroConfig-1" class="headerlink" title="2. ShiroConfig"></a>2. ShiroConfig</h3><ul><li>shiroçš„åŸºæœ¬é…ç½®</li><li>1.ShiroFilterFactoryBean    #Shiroå¯¹å¤–çš„æ¥å£ï¼Œä»£è¡¨å½“å‰â€œç”¨æˆ·â€</li><li>2.DefaultWebSecurityManager   #å…³è”realm</li><li>3.UserRealm   #è´Ÿè´£ç™»å½•éªŒè¯å’Œèµ„æºæˆæƒ</li><li><img alt data-src="https://pic2.zhimg.com/80/v2-8526e78cc56a9505dcca6d0f3fcac3dd_hd.jpg" class="lazyload"><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">package io.kid1999.operatesystem.config;</span><br><span class="line"></span><br><span class="line">import org.apache.shiro.spring.web.ShiroFilterFactoryBean;</span><br><span class="line">import org.apache.shiro.web.mgt.DefaultWebSecurityManager;</span><br><span class="line">import org.springframework.beans.factory.annotation.Qualifier;</span><br><span class="line">import org.springframework.context.annotation.Bean;</span><br><span class="line">import org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line">import java.util.LinkedHashMap;</span><br><span class="line">import java.util.Map;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @author kid1999</span><br><span class="line"> * @title: Shiro çš„ é…ç½®</span><br><span class="line"> * @date 2019/11/26 21:27</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">@Configuration</span><br><span class="line">public class ShiroConfig &#123;</span><br><span class="line"></span><br><span class="line">// 3. åˆ›å»º ShiroFilterFactoryBean</span><br><span class="line">@Bean</span><br><span class="line">public ShiroFilterFactoryBean getShiroFilterFactoryBean(@Qualifier(&quot;securityManager&quot;) DefaultWebSecurityManager securityManager)&#123;</span><br><span class="line">ShiroFilterFactoryBean shiroFilterFactoryBean = new ShiroFilterFactoryBean();</span><br><span class="line">// è®¾ç½®å®‰å…¨ç®¡ç†å™¨</span><br><span class="line">shiroFilterFactoryBean.setSecurityManager(securityManager);</span><br><span class="line"></span><br><span class="line">/**  æ·»åŠ Shiroçš„å†…ç½®è¿‡æ»¤å™¨</span><br><span class="line"> * å¸¸ç”¨ï¼š</span><br><span class="line"> * anon : æ— éœ€è®¤è¯ï¼ˆç™»å½•ï¼‰ å¯ä»¥è®¿é—®</span><br><span class="line"> * authc ï¼šå¿…é¡»è®¤è¯æ‰å¯ä»¥è®¿é—®</span><br><span class="line"> * user : å¦‚æœä½¿ç”¨remenberMeåŠŸèƒ½å¯ä»¥ç›´æ¥è®¿é—®</span><br><span class="line"> * perms: è¯¥èµ„æºå¿…é¡»è·å¾—ç›¸å…³æƒé™æ‰å¯è®¿é—®</span><br><span class="line"> * role: è¯¥èµ„æºå¿…é¡»è·å¾—è§’è‰²æƒé™æ‰å¯ä»¥è®¿é—®</span><br><span class="line"> *</span><br><span class="line"> *  æ³¨æ„ï¼š è¿™ä¸ªæˆæƒæ‹¦æˆªé“¾ æ˜¯æŒ‰é¡ºåºæ‰§è¡Œçš„ï¼ï¼ï¼</span><br><span class="line"> */</span><br><span class="line">Map&lt;String,String&gt; filterMap = new LinkedHashMap&lt;&gt;();</span><br><span class="line">filterMap.put(&quot;/&quot;,&quot;anon&quot;);</span><br><span class="line">filterMap.put(&quot;/login&quot;,&quot;anon&quot;);</span><br><span class="line">filterMap.put(&quot;/error&quot;,&quot;anon&quot;);</span><br><span class="line">//filterMap.put(&quot;/admin&quot;,&quot;authc&quot;);</span><br><span class="line"></span><br><span class="line">// æƒé™è¿‡æ»¤å™¨  ä¹Ÿå¯ä»¥è®¾ç½®è§’è‰²è¿‡æ»¤</span><br><span class="line">filterMap.put(&quot;/admin&quot;,&quot;perms[user:admin]&quot;);</span><br><span class="line"></span><br><span class="line">shiroFilterFactoryBean.setLoginUrl(&quot;/login&quot;);       // è®¾ç½®è·³è½¬çš„ç™»å½•é¡µé¢</span><br><span class="line">shiroFilterFactoryBean.setUnauthorizedUrl(&quot;/noAuth&quot;);   // è®¾ç½®æœªæˆæƒè®¿é—®é¡µé¢</span><br><span class="line">shiroFilterFactoryBean.setFilterChainDefinitionMap(filterMap);</span><br><span class="line"></span><br><span class="line">return shiroFilterFactoryBean;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 2. åˆ›å»ºDefaultWebSecurityManager </span><br><span class="line">// æ‰€æœ‰ä¸å®‰å…¨æœ‰å…³çš„æ“ä½œéƒ½ä¼šä¸SecurityManagerè¿›è¡Œäº¤äº’</span><br><span class="line">@Bean(name = &quot;securityManager&quot;)</span><br><span class="line">public DefaultWebSecurityManager getDefaultWebSecurityManager(@Qualifier(&quot;getRealm&quot;) UserRealm userRealm)&#123;</span><br><span class="line">DefaultWebSecurityManager securityManager = new DefaultWebSecurityManager();</span><br><span class="line">// å…³è”realm</span><br><span class="line">securityManager.setRealm(getRealm());</span><br><span class="line">return securityManager;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 1. åˆ›å»ºRealm</span><br><span class="line">// Shiroä»Realmè·å–å®‰å…¨æ•°æ®ï¼ˆç”¨æˆ·ã€è§’è‰²ã€æƒé™ï¼‰</span><br><span class="line">@Bean</span><br><span class="line">public UserRealm getRealm()&#123;</span><br><span class="line">return new UserRealm();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="3-UserRealm-1"><a href="#3-UserRealm-1" class="headerlink" title="3. UserRealm"></a>3. UserRealm</h3><ul><li>Shiroä»ä»Realmè·å–å®‰å…¨æ•°æ®ï¼ˆå¦‚ç”¨æˆ·ã€è§’è‰²ã€æƒé™ï¼‰<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">package io.kid1999.operatesystem.config;</span><br><span class="line"></span><br><span class="line">import io.kid1999.operatesystem.model.Admin;</span><br><span class="line">import io.kid1999.operatesystem.repository.AdminRepository;</span><br><span class="line">import org.apache.shiro.authc.*;</span><br><span class="line">import org.apache.shiro.authz.AuthorizationInfo;</span><br><span class="line">import org.apache.shiro.authz.SimpleAuthorizationInfo;</span><br><span class="line">import org.apache.shiro.realm.AuthorizingRealm;</span><br><span class="line">import org.apache.shiro.subject.PrincipalCollection;</span><br><span class="line">import org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @author kid1999</span><br><span class="line"> * @title: UserRealm è‡ªå®šä¹‰ realm å¤„ç† æˆæƒå’Œè®¤è¯</span><br><span class="line"> * @date 2019/11/26 21:29</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">public class UserRealm extends AuthorizingRealm  &#123;</span><br><span class="line">@Autowired</span><br><span class="line">private AdminRepository adminRepository;</span><br><span class="line"></span><br><span class="line">// æˆæƒæ‰§è¡Œé€»è¾‘</span><br><span class="line">@Override</span><br><span class="line">protected AuthorizationInfo doGetAuthorizationInfo(PrincipalCollection principalCollection) &#123;</span><br><span class="line">System.out.println(&quot;æˆæƒæ‰§è¡Œé€»è¾‘&quot;);</span><br><span class="line"></span><br><span class="line">// ç»™èµ„æºè¿›è¡Œæˆæƒ</span><br><span class="line">SimpleAuthorizationInfo info = new SimpleAuthorizationInfo();</span><br><span class="line"></span><br><span class="line">// æ·»åŠ èµ„æºæˆæƒå­—ç¬¦ä¸²</span><br><span class="line">info.addStringPermission(&quot;user:admin&quot;);</span><br><span class="line"></span><br><span class="line">return info;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// è®¤è¯æ‰§è¡Œé€»è¾‘</span><br><span class="line">@Override</span><br><span class="line">protected AuthenticationInfo doGetAuthenticationInfo(AuthenticationToken authenticationToken) throws AuthenticationException &#123;</span><br><span class="line">System.out.println(&quot;è®¤è¯æ‰§è¡Œé€»è¾‘&quot;);</span><br><span class="line"></span><br><span class="line">// 1. è·å–ä¼ æ¥éªŒè¯çš„token</span><br><span class="line">UsernamePasswordToken token = (UsernamePasswordToken) authenticationToken;</span><br><span class="line">String name = token.getUsername();</span><br><span class="line">String password = String.valueOf(token.getPassword());</span><br><span class="line">// 2. é€šè¿‡ç”¨æˆ·å å–å‡ºæ•°æ®åº“çš„æ•°æ®</span><br><span class="line">Admin user = adminRepository.findByAdminId(name);</span><br><span class="line"></span><br><span class="line">// 3. åˆ¤æ–­ç”¨æˆ·å</span><br><span class="line">if (user == null)&#123;</span><br><span class="line">return null;        // æ‰¾ä¸åˆ°ç”¨æˆ·å æŠ¥ UnknownAccountException</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 4. åˆ¤æ–­å¯†ç </span><br><span class="line">/**</span><br><span class="line"> * arg0: å›ä¼ loginçš„æ•°æ®</span><br><span class="line"> * arg1: æ•°æ®åº“çš„å¯†ç </span><br><span class="line"> * arg2: realm çš„name</span><br><span class="line"> */</span><br><span class="line">return new SimpleAuthenticationInfo(&quot;&quot;,user.getAdminPwd(),&quot;&quot;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="4-AdminRepository-é“¾æ¥æ•°æ®åº“-1"><a href="#4-AdminRepository-é“¾æ¥æ•°æ®åº“-1" class="headerlink" title="4.AdminRepository é“¾æ¥æ•°æ®åº“"></a>4.AdminRepository é“¾æ¥æ•°æ®åº“</h3><ul><li>Realm ä¼šè¿æ¥æ•°æ®æº è¿›è¡Œèº«ä»½éªŒè¯</li><li>æ­¤å¤„æ”¾ä¸Šæˆ‘çš„JPA</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">package io.kid1999.operatesystem.repository;</span><br><span class="line">import io.kid1999.operatesystem.model.Admin;</span><br><span class="line">import org.springframework.data.jpa.repository.JpaRepository;</span><br><span class="line">import org.springframework.data.jpa.repository.Query;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @author kid1999</span><br><span class="line"> * @title: ManagerRepository</span><br><span class="line"> * @date 2019/11/24 10:07</span><br><span class="line"> */</span><br><span class="line">public interface AdminRepository extends JpaRepository&lt;Admin,Integer&gt; &#123;</span><br><span class="line">@Query(value = &quot;select * from admin m where m.admin_id = ?1 and m.admin_pwd = ?2&quot; ,nativeQuery = true)</span><br><span class="line">Admin login(String studentId, String passWord);</span><br><span class="line"></span><br><span class="line">Admin findByAdminId(String adminId);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-ç™»å½•Controller-1"><a href="#5-ç™»å½•Controller-1" class="headerlink" title="5.ç™»å½•Controller"></a>5.ç™»å½•Controller</h3><ul><li>æ­¤å¤„æ²¡æœ‰ä½¿ç”¨åŠ å¯† å’Œ ç¼“å­˜æœºåˆ¶<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * ä½¿ç”¨Shiroå®ç°ç™»å½•</span><br><span class="line"> */</span><br><span class="line">@PostMapping(&quot;/login&quot;)</span><br><span class="line">String toLogin(String studentId,</span><br><span class="line">               String passWord,</span><br><span class="line">               Model model)&#123;</span><br><span class="line">// 1.è·å–Subject</span><br><span class="line">Subject subject = SecurityUtils.getSubject();</span><br><span class="line">// 2.å°è£…ç™»å½•æ–¹æ³•</span><br><span class="line">UsernamePasswordToken token = new UsernamePasswordToken(studentId,passWord);</span><br><span class="line">// 3.æ‰§è¡Œç™»å½•æ–¹æ³•</span><br><span class="line">try &#123;</span><br><span class="line">subject.login(token);       // è°ƒç”¨loginæ–¹æ³• -&gt; realm åšéªŒè¯</span><br><span class="line">return &quot;admin&quot;;</span><br><span class="line">&#125;catch (UnknownAccountException e)&#123;</span><br><span class="line">model.addAttribute(&quot;msg&quot;,&quot;ç”¨æˆ·åä¸å­˜åœ¨&quot;);</span><br><span class="line">return &quot;login&quot;;</span><br><span class="line">&#125;catch (IncorrectCredentialsException e)&#123;</span><br><span class="line">model.addAttribute(&quot;msg&quot;,&quot;å¯†ç é”™è¯¯&quot;);</span><br><span class="line">return &quot;login&quot;;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="æµç¨‹æ€»ç»“ï¼š-1"><a href="#æµç¨‹æ€»ç»“ï¼š-1" class="headerlink" title="æµç¨‹æ€»ç»“ï¼š"></a>æµç¨‹æ€»ç»“ï¼š</h2><ol><li>é¦–å…ˆ ShiroFilterFactoryBean æŸ¥è¯¢æ‹¦æˆªè§„åˆ™ è·³è½¬ loginï¼ˆæˆ–è€…è‡ªå·±è®¿é—®loginï¼‰</li><li>ç™»å½•éªŒè¯Controller è°ƒç”¨ subject.login(token)</li><li>Realmæ¥æ”¶ä¿¡æ¯ï¼Œå¹¶ä¸”å’Œæ•°æ®æºçš„æ•°æ®è¿›è¡Œå¯¹æ¯” è¿”å› åˆ¤æ–­ç»“æœ</li><li>å¦‚æœä¸æˆåŠŸ è¿”å›é”™è¯¯ï¼Œå¦‚æœæˆåŠŸ å»å¾€èµ„æºç½‘ç«™ã€‚ </li><li>ShiroFilterFactoryBean åˆ¤æ–­èµ„æºè®¿é—®æƒé™</li><li>è°ƒç”¨ Realmçš„ æˆæƒæ–¹æ³• ä»æ•°æ®æºè·å– ç”¨æˆ·æƒé™ è¿”å›ç»“æœ</li><li>å¦‚æœ ä¸æˆåŠŸ è¿”å›é”™è¯¯ã€‚æˆåŠŸ å…è®¸è®¿é—® </li></ol><hr><p>å‚è€ƒèµ„æ–™ï¼š</p><p><a href="https://zhuanlan.zhihu.com/p/63910997" target="_blank" rel="noopener">çŸ¥ä¹-Shiroè¯¦è§£</a></p><p><a href="https://www.bilibili.com/video/av40342174" target="_blank" rel="noopener">Bç«™è§†é¢‘</a></p>]]></content>
      
      
      <categories>
          
          <category> Java web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Shiro </tag>
            
            <tag> security </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JpaåŸºç¡€çŸ¥è¯†ç‚¹</title>
      <link href="/2019/11/27/Jpa%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E7%82%B9/"/>
      <url>/2019/11/27/Jpa%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E7%82%B9/</url>
      
        <content type="html"><![CDATA[<h1 id="JpaåŸºç¡€çŸ¥è¯†ç‚¹"><a href="#JpaåŸºç¡€çŸ¥è¯†ç‚¹" class="headerlink" title="JpaåŸºç¡€çŸ¥è¯†ç‚¹"></a>JpaåŸºç¡€çŸ¥è¯†ç‚¹</h1><ul><li>JPAæ˜¯Java Persistence APIçš„ç®€ç§°ï¼Œä¸­æ–‡åJavaæŒä¹…å±‚APIï¼Œæ˜¯JDK 5.0æ³¨è§£æˆ–XMLæè¿°å¯¹è±¡ï¼å…³ç³»è¡¨çš„æ˜ å°„å…³ç³»ï¼Œå¹¶å°†è¿è¡ŒæœŸçš„å®ä½“å¯¹è±¡æŒä¹…åŒ–åˆ°æ•°æ®åº“ä¸­ã€‚</li><li>Spring Data JPAæ˜¯è¾ƒå¤§çš„Spring Dataç³»åˆ—çš„ä¸€éƒ¨åˆ†ï¼Œå¯è½»æ¾å®ç°åŸºäºJPAçš„å­˜å‚¨åº“ã€‚è¯¥æ¨¡å—å¤„ç†å¯¹åŸºäºJPAçš„æ•°æ®è®¿é—®å±‚çš„å¢å¼ºæ”¯æŒã€‚å®ƒä½¿æ„å»ºä½¿ç”¨æ•°æ®è®¿é—®æŠ€æœ¯çš„Springæ”¯æŒçš„åº”ç”¨ç¨‹åºå˜å¾—æ›´åŠ å®¹æ˜“ã€‚</li></ul><h2 id="1-JPAçš„åŸºæœ¬é…ç½®"><a href="#1-JPAçš„åŸºæœ¬é…ç½®" class="headerlink" title="1.JPAçš„åŸºæœ¬é…ç½®"></a>1.JPAçš„åŸºæœ¬é…ç½®</h2><ol><li>pomä¾èµ–</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><h2 id="2-é¡¹ç›®é…ç½®æ–‡ä»¶"><a href="#2-é¡¹ç›®é…ç½®æ–‡ä»¶" class="headerlink" title="2. é¡¹ç›®é…ç½®æ–‡ä»¶"></a>2. é¡¹ç›®é…ç½®æ–‡ä»¶</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  # mysql é…ç½®ï¼š</span><br><span class="line">  datasource:</span><br><span class="line">    driver-class-name: com.mysql.cj.jdbc.Driver</span><br><span class="line">    url: jdbc:mysql://10.16.11.211:3306/test?serverTimezone=UTC&amp;useUnicode=true&amp;characterEncoding=utf8</span><br><span class="line">    username: root</span><br><span class="line">    password: root</span><br><span class="line">  jpa:</span><br><span class="line">    hibernate:</span><br><span class="line">      ddl-auto: update</span><br><span class="line">    show-sql: true</span><br><span class="line">    database-platform: org.hibernate.dialect.MySQL5InnoDBDialect  #ä¸åŠ è¿™å¥åˆ™é»˜è®¤ä¸ºmyisamå¼•æ“</span><br><span class="line">    open-in-view: true</span><br></pre></td></tr></table></figure><h2 id="3-åˆ›å»ºä¸€ä¸ªç®€å•å®ä½“ç±»"><a href="#3-åˆ›å»ºä¸€ä¸ªç®€å•å®ä½“ç±»" class="headerlink" title="3. åˆ›å»ºä¸€ä¸ªç®€å•å®ä½“ç±»"></a>3. åˆ›å»ºä¸€ä¸ªç®€å•å®ä½“ç±»</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">package io.kid1999.teacher_manager.model;</span><br><span class="line">import lombok.Data;</span><br><span class="line">import javax.persistence.*;</span><br><span class="line"></span><br><span class="line">@Entity     // è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªæ•°æ®åº“å®ä½“</span><br><span class="line">@Table(name = &quot;user&quot;)   // è¡¨ç¤ºå¯¹äºçš„è¡¨ï¼Œä¸è®¾ç½®nameæ—¶ é»˜è®¤å’Œç±»åç›¸åŒ</span><br><span class="line">@Data   </span><br><span class="line">public class User &#123;</span><br><span class="line"></span><br><span class="line">@Id     // æŒ‡å®š ID</span><br><span class="line">@GeneratedValue  // æŒ‡å®šä¸»é”®ç”Ÿæˆç­–ç•¥ï¼Œé»˜è®¤è‡ªå¢é•¿</span><br><span class="line">@Column(name = &quot;id&quot;)</span><br><span class="line">private Integer id;</span><br><span class="line"></span><br><span class="line">@Basic   // é»˜è®¤ä¼šåŠ ä¸Šè¿™ä¸ªæ³¨è§£ï¼Œè¡¨ç¤ºè¯¥å±æ€§åˆ°æ•°æ®åº“åŒåå­—æ®µçš„æ˜ å°„</span><br><span class="line">private String addr;</span><br><span class="line"></span><br><span class="line">@Column(name = &quot;name&quot;)      // é»˜è®¤ä¸å†™çš„æ—¶å€™=Basic è¡¨ç¤ºè¯¥å±æ€§åˆ°æ•°æ®åº“nameå­—æ®µçš„æ˜ å°„</span><br><span class="line">private String name;</span><br><span class="line"></span><br><span class="line">@Transient  // è¡¨ç¤ºæ­¤å­—æ®µä¸æ•°æ®åº“æ— å…³ï¼Œå–æ¶ˆ@Basic</span><br><span class="line">private String info;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@GeneratedValue JPAè‡ªå¸¦çš„å‡ ç§ä¸»é”®ç”Ÿæˆç­–ç•¥ï¼š</span><br><span class="line">TABLEï¼š ä½¿ç”¨ä¸€ä¸ªç‰¹å®šçš„æ•°æ®åº“è¡¨æ ¼æ¥ä¿å­˜ä¸»é”®ã€‚</span><br><span class="line">SEQUENCEï¼š æ ¹æ®åº•å±‚æ•°æ®åº“çš„åºåˆ—æ¥ç”Ÿæˆä¸»é”®ï¼Œæ¡ä»¶æ˜¯æ•°æ®åº“æ”¯æŒåºåˆ—ã€‚è¿™ä¸ªå€¼è¦ä¸generatorä¸€èµ·ä½¿ç”¨ï¼Œgenerator æŒ‡å®šç”Ÿæˆä¸»é”®ä½¿ç”¨çš„ç”Ÿæˆå™¨ï¼ˆå¯èƒ½æ˜¯orcaleä¸­è‡ªå·±ç¼–å†™çš„åºåˆ—ï¼‰ã€‚</span><br><span class="line">IDENTITYï¼š ä¸»é”®ç”±æ•°æ®åº“è‡ªåŠ¨ç”Ÿæˆï¼ˆä¸»è¦æ˜¯æ”¯æŒè‡ªåŠ¨å¢é•¿çš„æ•°æ®åº“ï¼Œå¦‚mysqlï¼‰ã€‚</span><br><span class="line">AUTOï¼š ä¸»é”®ç”±ç¨‹åºæ§åˆ¶ï¼Œä¹Ÿæ˜¯GenerationTypeçš„é»˜è®¤å€¼ã€‚</span><br></pre></td></tr></table></figure><h2 id="4-åˆ›å»ºä¸€äº›å…³è”å…³ç³»çš„å¯¹è±¡"><a href="#4-åˆ›å»ºä¸€äº›å…³è”å…³ç³»çš„å¯¹è±¡" class="headerlink" title="4. åˆ›å»ºä¸€äº›å…³è”å…³ç³»çš„å¯¹è±¡"></a>4. åˆ›å»ºä¸€äº›å…³è”å…³ç³»çš„å¯¹è±¡</h2><ul><li>å…³è”å…³ç³»å¿…é¡»æ³¨æ„ç»´æŠ¤ç«¯å’Œè¢«ç»´æŠ¤ç«¯çš„é€‰å–</li><li><ol><li>åœ¨ä¸€å¯¹å¤šä¸­ï¼Œå¤šçš„ä¸€æ–¹ä½œä¸ºç»´æŠ¤ç«¯ï¼Œä¸€çš„ä¸€æ–¹ä½œä¸ºè¢«ç»´æŠ¤ç«¯</li></ol></li><li><ol start="2"><li>åœ¨ä¸€å¯¹ä¸€ä¸­ï¼Œä»»æ„é€‰å–ä¸€æ–¹ä½œä¸ºç»´æŠ¤ç«¯ï¼Œå®ä¸€æ–¹ä½œä¸ºè¢«ç»´æŠ¤ç«¯</li></ol></li><li><ol start="3"><li>åœ¨å¤šå¯¹å¤šä¸­ï¼Œä»»æ„é€‰å–ä¸€æ–¹ä½œä¸ºç»´æŠ¤ç«¯ï¼Œä½†å¿…é¡»è®°ä½ä¸­é—´è¡¨çš„å…³ç³»ç”±ç»´æŠ¤ç«¯è´Ÿè´£</li></ol></li></ul><h3 id="1-å¤šå¯¹ä¸€-çš„é…ç½®"><a href="#1-å¤šå¯¹ä¸€-çš„é…ç½®" class="headerlink" title="1. å¤šå¯¹ä¸€ çš„é…ç½®"></a>1. å¤šå¯¹ä¸€ çš„é…ç½®</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">package io.kid1999.teacher_manager.model;</span><br><span class="line">import lombok.Data;</span><br><span class="line">import javax.persistence.*;</span><br><span class="line"></span><br><span class="line">@Data</span><br><span class="line">@Entity</span><br><span class="line">@Table</span><br><span class="line">public class Student &#123;</span><br><span class="line">    @Id</span><br><span class="line">    private Integer studentId;</span><br><span class="line">    private String studentName;</span><br><span class="line">    private Integer gradeId;</span><br><span class="line">    </span><br><span class="line">    /**</span><br><span class="line">     * å¤šå¯¹ä¸€ ManyToOne</span><br><span class="line">     * JPAä¸­ï¼Œmanyä¸€ç«¯ä½œä¸ºç»´æŠ¤ç«¯ï¼ŒOneä¸€ç«¯ä½œä¸ºè¢«ç»´æŠ¤ç«¯</span><br><span class="line">     * manyä¸€æ–¹æŒ‡å®š@ManyToOneæ³¨è§£ ï¼Œå¹¶ä½¿ç”¨ @JoinClomnæŒ‡å®šå…³è”çš„å¤–é”®</span><br><span class="line">     */</span><br><span class="line"></span><br><span class="line">    @ManyToOne(targetEntity = Grade.class,fetch = FetchType.LAZY)  //å¯¹åº”çš„å¯¹è±¡,ä¸”è®¾ç½®ä¸ºæ‡’åŠ è½½ï¼ˆä¸åœ¨æ¯ä¸€æ¬¡æŸ¥è¯¢æ—¶éƒ½è¿›è¡Œå¤šè¡¨å…³è”ï¼‰</span><br><span class="line">    @JoinColumn(name = &quot;gradeId&quot;,insertable = false,updatable = false)   //å¯¹åº”å…³è”çš„é”®,åœ¨æ’å…¥æ›´æ–°æ—¶ä¸æ’å…¥grade</span><br><span class="line">    private Grade grade;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    // å¿…é¡»é‡æ–°toString  ä¸ç„¶åœ¨æ‰“å°æ—¶å€™ä¼šé€’å½’æŸ¥è¯¢ grade</span><br><span class="line">    @Override</span><br><span class="line">    public String toString() &#123;</span><br><span class="line">        return &quot;Student&#123;&quot; +</span><br><span class="line">                &quot;studentId=&quot; + studentId +</span><br><span class="line">                &quot;, studentName=&apos;&quot; + studentName + &apos;\&apos;&apos; +</span><br><span class="line">                &quot;, gradeId=&quot; + gradeId +</span><br><span class="line">                &apos;&#125;&apos;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-ä¸€å¯¹å¤š-çš„é…ç½®"><a href="#2-ä¸€å¯¹å¤š-çš„é…ç½®" class="headerlink" title="2. ä¸€å¯¹å¤š çš„é…ç½®"></a>2. ä¸€å¯¹å¤š çš„é…ç½®</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">package io.kid1999.teacher_manager.model;</span><br><span class="line"></span><br><span class="line">import lombok.Data;</span><br><span class="line">import javax.persistence.*;</span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">@Data</span><br><span class="line">@Entity</span><br><span class="line">@Table</span><br><span class="line">public class Grade &#123;</span><br><span class="line">    @Id</span><br><span class="line">    private Integer gradeId;</span><br><span class="line">    private String gradeName;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * ä¸€å¯¹å¤š OneTOMany</span><br><span class="line">     * å¯ä»¥åœ¨ One ä¸€æ–¹æŒ‡å®š@OneToManyæ³¨é‡Š å¹¶è®¾ç½® mappedByå±æ€§ï¼Œä»¥æŒ‡å®šä»–æ˜¯è¿™ä¸€å…³è”ä¸­è¢«ç»´æŠ¤çš„ä¸€ç«¯</span><br><span class="line">     */</span><br><span class="line">    @OneToMany(mappedBy = &quot;grade&quot;)</span><br><span class="line">    private List&lt;Student&gt; students;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æµ‹è¯•ï¼šå­¦ç”Ÿå’Œç­çº§ä¹‹é—´çš„å¤šå¯¹ä¸€å…³ç³»"><a href="#æµ‹è¯•ï¼šå­¦ç”Ÿå’Œç­çº§ä¹‹é—´çš„å¤šå¯¹ä¸€å…³ç³»" class="headerlink" title="æµ‹è¯•ï¼šå­¦ç”Ÿå’Œç­çº§ä¹‹é—´çš„å¤šå¯¹ä¸€å…³ç³»"></a>æµ‹è¯•ï¼šå­¦ç”Ÿå’Œç­çº§ä¹‹é—´çš„å¤šå¯¹ä¸€å…³ç³»</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">  @Autowired</span><br><span class="line">  private StudentRepository studentRepository;</span><br><span class="line"></span><br><span class="line">@Autowired</span><br><span class="line">private GradeRepository gradeRepository;</span><br><span class="line"></span><br><span class="line">@Test</span><br><span class="line">@Transactional</span><br><span class="line">void TestManyToOne()&#123;</span><br><span class="line">    Student student = new Student();</span><br><span class="line">    student.setStudentId(1212);</span><br><span class="line">    student.setStudentName(&quot;kid&quot;);</span><br><span class="line">    student.setGradeId(1);</span><br><span class="line">    studentRepository.save(student);    // æ’å…¥</span><br><span class="line">    Grade grade = studentRepository.getOne(1212).getGrade();</span><br><span class="line">    System.out.println(grade.getGradeId() + grade.getGradeName());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Test</span><br><span class="line">@Transactional</span><br><span class="line">void TestOnTomany()&#123;</span><br><span class="line">    Grade grade = new Grade();</span><br><span class="line">    grade.setGradeId(2);</span><br><span class="line">    grade.setGradeName(&quot;math&quot;);</span><br><span class="line">    gradeRepository.save(grade);    // æ’å…¥</span><br><span class="line">    List&lt;Student&gt; students = gradeRepository.getOne(1).getStudents();   // å¤–é”®æŸ¥è¯¢</span><br><span class="line">    System.out.println(students);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-ä¸€å¯¹ä¸€-çš„é…ç½®"><a href="#3-ä¸€å¯¹ä¸€-çš„é…ç½®" class="headerlink" title="3. ä¸€å¯¹ä¸€ çš„é…ç½®"></a>3. ä¸€å¯¹ä¸€ çš„é…ç½®</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">package io.kid1999.teacher_manager.model;</span><br><span class="line"></span><br><span class="line">import lombok.Data;</span><br><span class="line">import javax.persistence.*;</span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">@Data</span><br><span class="line">@Entity</span><br><span class="line">@Table</span><br><span class="line">public class Grade &#123;</span><br><span class="line">    @Id</span><br><span class="line">    private Integer gradeId;</span><br><span class="line">    private String gradeName;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * ä¸€å¯¹å¤š OneTOMany</span><br><span class="line">     * å¯ä»¥åœ¨ One ä¸€æ–¹æŒ‡å®š@OneToManyæ³¨é‡Š å¹¶è®¾ç½® mappedByå±æ€§ï¼Œä»¥æŒ‡å®šä»–æ˜¯è¿™ä¸€å…³è”ä¸­è¢«ç»´æŠ¤çš„ä¸€ç«¯</span><br><span class="line">     */</span><br><span class="line">    @OneToMany(mappedBy = &quot;grade&quot;, fetch = FetchType.LAZY)</span><br><span class="line">    private List&lt;Student&gt; students;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * ä¸€å¯¹ä¸€ è¢«ç»´æŠ¤ç«¯</span><br><span class="line">     */</span><br><span class="line">    @OneToOne(mappedBy = &quot;grade&quot;)</span><br><span class="line">    private Teacher teacher;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String toString() &#123;</span><br><span class="line">        return &quot;Grade&#123;&quot; +</span><br><span class="line">                &quot;gradeId=&quot; + gradeId +</span><br><span class="line">                &quot;, gradeName=&apos;&quot; + gradeName + &apos;\&apos;&apos; +</span><br><span class="line">                &apos;&#125;&apos;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">package io.kid1999.teacher_manager.model;</span><br><span class="line"></span><br><span class="line">import lombok.Data;</span><br><span class="line">import javax.persistence.*;</span><br><span class="line"></span><br><span class="line">@Entity</span><br><span class="line">@Table</span><br><span class="line">@Data</span><br><span class="line">public class Teacher &#123;</span><br><span class="line">    @Id</span><br><span class="line">    @GeneratedValue</span><br><span class="line">    private Integer teacherId;</span><br><span class="line">    private String teacherName;</span><br><span class="line">    private Integer gradeId;</span><br><span class="line"></span><br><span class="line">    // OnToOne ç»´æŠ¤ç«¯</span><br><span class="line">    @OneToOne</span><br><span class="line">    @JoinColumn(name = &quot;gradeId&quot;,insertable = false,updatable = false,unique = true) // æŸ¥è¯¢å”¯ä¸€</span><br><span class="line">    private Grade grade;</span><br><span class="line"></span><br><span class="line">    // é‡å†™toString</span><br><span class="line">    @Override</span><br><span class="line">    public String toString() &#123;</span><br><span class="line">        return &quot;Teacher&#123;&quot; +</span><br><span class="line">                &quot;teacherId=&quot; + teacherId +</span><br><span class="line">                &quot;, taacherName=&quot; + teacherName +</span><br><span class="line">                &quot;, gradeId=&quot; + gradeId +</span><br><span class="line">                &apos;&#125;&apos;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æµ‹è¯•-æ•™å¸ˆå’Œç­çº§ä¹‹é—´çš„ä¸€å¯¹ä¸€å…³ç³»"><a href="#æµ‹è¯•-æ•™å¸ˆå’Œç­çº§ä¹‹é—´çš„ä¸€å¯¹ä¸€å…³ç³»" class="headerlink" title="æµ‹è¯• æ•™å¸ˆå’Œç­çº§ä¹‹é—´çš„ä¸€å¯¹ä¸€å…³ç³»"></a>æµ‹è¯• æ•™å¸ˆå’Œç­çº§ä¹‹é—´çš„ä¸€å¯¹ä¸€å…³ç³»</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">@Transactional</span><br><span class="line">void TestOneToOne()&#123;</span><br><span class="line">//    Teacher teacher = new Teacher();</span><br><span class="line">//    teacher.setGradeId(2);</span><br><span class="line">//    teacher.setTeacherName(&quot;hello&quot;);</span><br><span class="line">//    teacherResitory.saveAndFlush(teacher);</span><br><span class="line">    Teacher teacher1 = teacherResitory.getOne(7);</span><br><span class="line">    Grade grade = teacher1.getGrade();</span><br><span class="line">    System.out.println(grade);</span><br><span class="line">    System.out.println(grade.getStudents());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-å¤šå¯¹å¤š-çš„é…ç½®"><a href="#3-å¤šå¯¹å¤š-çš„é…ç½®" class="headerlink" title="3.å¤šå¯¹å¤š çš„é…ç½®"></a>3.å¤šå¯¹å¤š çš„é…ç½®</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">package io.kid1999.teacher_manager.model;</span><br><span class="line"></span><br><span class="line">import lombok.Data;</span><br><span class="line">import javax.persistence.*;</span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">@Data</span><br><span class="line">@Entity</span><br><span class="line">@Table</span><br><span class="line">public class Student &#123;</span><br><span class="line">    @Id</span><br><span class="line">    private Integer studentId;</span><br><span class="line">    private String studentName;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * å¤šå¯¹ä¸€ ManyToOne</span><br><span class="line">     * JPAä¸­ï¼Œmanyä¸€ç«¯ä½œä¸ºç»´æŠ¤ç«¯ï¼ŒOneä¸€ç«¯ä½œä¸ºè¢«ç»´æŠ¤ç«¯</span><br><span class="line">     * manyä¸€æ–¹æŒ‡å®š@ManyToOneæ³¨è§£ ï¼Œå¹¶ä½¿ç”¨ @JoinClomnæŒ‡å®šå…³è”çš„å¤–é”®</span><br><span class="line">     */</span><br><span class="line"></span><br><span class="line">    private Integer gradeId;</span><br><span class="line">    @ManyToOne(targetEntity = Grade.class,fetch = FetchType.LAZY)  //å¯¹åº”çš„å¯¹è±¡,ä¸”è®¾ç½®ä¸ºæ‡’åŠ è½½ï¼ˆä¸åœ¨æ¯ä¸€æ¬¡æŸ¥è¯¢æ—¶éƒ½è¿›è¡Œå¤šè¡¨å…³è”ï¼‰</span><br><span class="line">    @JoinColumn(name = &quot;gradeId&quot;,insertable = false,updatable = false)   //å¯¹åº”å…³è”çš„é”®,åœ¨æ’å…¥æ›´æ–°æ—¶ä¸æ’å…¥grade</span><br><span class="line">    private Grade grade;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * å¤šå¯¹å¤šçš„ç»´æŠ¤ç«¯  éœ€è¦ä¸€ä¸ªä¸­é—´è¡¨è¿›è¡Œç»´æŠ¤</span><br><span class="line">     */</span><br><span class="line">    @ManyToMany</span><br><span class="line">    @JoinTable(name = &quot;students_roles&quot;,  // æŒ‡å®šä¸­é—´è¡¨å</span><br><span class="line">        joinColumns =&#123;@JoinColumn(name = &quot;studentId&quot;,referencedColumnName = &quot;studentId&quot;)&#125;,   // æŒ‡å®šä¸­é—´è¡¨å’Œstudentçš„å…³è”</span><br><span class="line">        inverseJoinColumns = &#123;@JoinColumn(name = &quot;roleId&quot;,referencedColumnName = &quot;roleId&quot;)&#125;  // æŒ‡å®šä¸­é—´è¡¨å’Œroleçš„å…³è”</span><br><span class="line">    )</span><br><span class="line">    private List&lt;Role&gt; roles;</span><br><span class="line"></span><br><span class="line">    // å¿…é¡»é‡æ–°toString  ä¸ç„¶åœ¨æ‰“å°æ—¶å€™ä¼šé€’å½’æŸ¥è¯¢ grade</span><br><span class="line">    @Override</span><br><span class="line">    public String toString() &#123;</span><br><span class="line">        return &quot;Student&#123;&quot; +</span><br><span class="line">                &quot;studentId=&quot; + studentId +</span><br><span class="line">                &quot;, studentName=&apos;&quot; + studentName + &apos;\&apos;&apos; +</span><br><span class="line">                &quot;, gradeId=&quot; + gradeId +</span><br><span class="line">                &apos;&#125;&apos;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">package io.kid1999.teacher_manager.model;</span><br><span class="line"></span><br><span class="line">import lombok.Data;</span><br><span class="line">import javax.persistence.*;</span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">@Data</span><br><span class="line">@Entity</span><br><span class="line">@Table</span><br><span class="line">public class Role &#123;</span><br><span class="line">    @Id</span><br><span class="line">    private Integer roleId;</span><br><span class="line">    private String roleName;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * å¤šå¯¹å¤š è¢«ç»´æŠ¤ç«¯</span><br><span class="line">     */</span><br><span class="line">    @ManyToMany(mappedBy = &quot;roles&quot;)</span><br><span class="line">    private List&lt;Student&gt; students;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æµ‹è¯•-å­¦ç”Ÿå’Œèº«ä»½ä¹‹é—´çš„å¤šå¯¹å¤šå…³ç³»"><a href="#æµ‹è¯•-å­¦ç”Ÿå’Œèº«ä»½ä¹‹é—´çš„å¤šå¯¹å¤šå…³ç³»" class="headerlink" title="æµ‹è¯• å­¦ç”Ÿå’Œèº«ä»½ä¹‹é—´çš„å¤šå¯¹å¤šå…³ç³»"></a>æµ‹è¯• å­¦ç”Ÿå’Œèº«ä»½ä¹‹é—´çš„å¤šå¯¹å¤šå…³ç³»</h4><ul><li>é€‰å–çš„å­¦ç”Ÿä½œä¸ºç»´æŠ¤ç«¯ æ‰€ä»¥åªèƒ½åœ¨å­¦ç”Ÿæ³¨å†Œæ—¶æ·»åŠ å¯¹åº”çš„å…³ç³»<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">@Transactional</span><br><span class="line">void TestManyToMany()&#123;</span><br><span class="line">    Student student = new Student();</span><br><span class="line">    student.setStudentId(123);</span><br><span class="line">    student.setStudentName(&quot;kid&quot;);</span><br><span class="line">    student.setGradeId(2);</span><br><span class="line">    student.setRoles(roleRepository.findAll());</span><br><span class="line">    studentRepository.save(student);    // æ’å…¥</span><br><span class="line"></span><br><span class="line">//    Role role = new Role();</span><br><span class="line">//    role.setRoleId(1);</span><br><span class="line">//    role.setRoleName(&quot;hello&quot;);</span><br><span class="line">//    roleRepository.save(role);</span><br><span class="line"></span><br><span class="line">//    Student student = studentRepository.getOne(111);</span><br><span class="line">//    List&lt;Role&gt; roles = student.getRoles();</span><br><span class="line">//    System.out.println(roles);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h4 id="æ³¨æ„ç‚¹ï¼š"><a href="#æ³¨æ„ç‚¹ï¼š" class="headerlink" title="æ³¨æ„ç‚¹ï¼š"></a>æ³¨æ„ç‚¹ï¼š</h4><ol><li>ç»´æŠ¤ç«¯å’Œè¢«ç»´æŠ¤ç«¯çš„é€‰å–</li><li>æ‡’åŠ è½½</li><li>JoinColumnå…³è”åˆ—æ˜¯å¦éœ€è¦æ’å…¥å’Œæ›´æ–°</li><li>toStringçš„æ­»å¾ªç¯é—®é¢˜</li></ol><h2 id="4-Repository-å±‚-å®ç°-Repository-æ ‡å‡†"><a href="#4-Repository-å±‚-å®ç°-Repository-æ ‡å‡†" class="headerlink" title="4. Repository å±‚ å®ç° Repository æ ‡å‡†"></a>4. Repository å±‚ å®ç° Repository æ ‡å‡†</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@Repository</span><br><span class="line">public interface AccountRepository extends JpaRepository&lt;Account,String&gt; &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="5-Repository-çš„ç»§æ‰¿å…³ç³»"><a href="#5-Repository-çš„ç»§æ‰¿å…³ç³»" class="headerlink" title="5.Repository çš„ç»§æ‰¿å…³ç³»"></a>5.Repository çš„ç»§æ‰¿å…³ç³»</h2><p><img alt data-src="https://pic1.superbed.cn/item/5ddd4baf8e0e2e3ee99f0395.png" class="lazyload"></p><ul><li>epositoryï¼šç©ºæ¥å£ï¼Œè¡¨åä»»ä½•ç»§æ‰¿å®ƒçš„å‡ä¸ºä»“åº“æ¥å£ç±»</li><li>CrudRepositoryï¼šç»§æ‰¿Repositoryï¼Œå®ç°äº†ä¸€ç»„CRUDç›¸å…³çš„æ–¹æ³•</li><li>PagingAndSortingRepositoryï¼šç»§æ‰¿CrudRepositoryï¼Œå®ç°äº†ä¸€ç»„åˆ†é¡µã€æ’åºç›¸å…³çš„æ–¹æ³•</li><li>JpaRepositoryï¼šç»§æ‰¿PagingAndSortRepositoryï¼Œå®ç°ä¸€ç»„JPAè§„èŒƒç›¸å…³çš„æ–¹æ³•<br>è‡ªå®šä¹‰çš„XxxRepositoryéœ€è¦ç»§æ‰¿JpaRepositoryï¼Œè¿™æ ·è¯¥æ¥å£å°±å…·å¤‡äº†é€šç”¨çš„æ•°æ®è®¿é—®æ§åˆ¶å±‚çš„èƒ½åŠ›ã€‚</li></ul><p><img alt data-src="https://pic1.superbed.cn/item/5ddd4baf8e0e2e3ee99f0393.png" class="lazyload"></p><h2 id="6-Repositoryçš„å‡ ç§å†™æ³•"><a href="#6-Repositoryçš„å‡ ç§å†™æ³•" class="headerlink" title="6.Repositoryçš„å‡ ç§å†™æ³•"></a>6.Repositoryçš„å‡ ç§å†™æ³•</h2><h4 id="è‡ªå¸¦çš„æ–¹æ³•"><a href="#è‡ªå¸¦çš„æ–¹æ³•" class="headerlink" title="è‡ªå¸¦çš„æ–¹æ³•"></a>è‡ªå¸¦çš„æ–¹æ³•</h4><ul><li>å¦‚ï¼š Save(), findAll()ï¼Œ getXXX() â€¦.<h4 id="ç®€å•å‘½åæ‹¼å‡‘"><a href="#ç®€å•å‘½åæ‹¼å‡‘" class="headerlink" title="ç®€å•å‘½åæ‹¼å‡‘"></a>ç®€å•å‘½åæ‹¼å‡‘</h4></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">List&lt;User&gt; findUserByName(String name);</span><br></pre></td></tr></table></figure><h4 id="ä½¿ç”¨HSQL"><a href="#ä½¿ç”¨HSQL" class="headerlink" title="ä½¿ç”¨HSQL"></a>ä½¿ç”¨HSQL</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">/**  2. HQL</span><br><span class="line"> * HQL å’Œ JPQL è¯­æ³•æ˜¯ä¸€æ ·çš„</span><br><span class="line"> * sqlå¸¸ç”¨å…³é”®å­—å’ŒJPQLä¸€æ ·</span><br><span class="line"> * JPQLç‰¹ç‚¹ï¼š å­—æ®µï¼Œè¡¨å ç”±å¯¹è±¡ç±»å‹å’Œå±æ€§ä»£æ›¿ ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰</span><br><span class="line"> * ç¼–ç è§„èŒƒï¼š Sqlå¸¸ç”¨å…³é”®å­—å…¨éƒ¨å¤§å†™,ä¸èƒ½ä½¿ç”¨ *</span><br><span class="line"> */</span><br><span class="line"> </span><br><span class="line"> // 1.é€šè¿‡ ï¼Ÿ1 ä¼ å‚</span><br><span class="line">@Query(&quot;SELECT u FROM User u WHERE u.name = ?1&quot;)</span><br><span class="line">List&lt;User&gt; findUserByHSql(String name);</span><br><span class="line"></span><br><span class="line">// 2.é€šè¿‡ å‚æ•°å ä¼ å‚</span><br><span class="line">@Query(&quot;SELECT u FROM User u WHERE u.name = :name&quot;)</span><br><span class="line">List&lt;User&gt; findUserByHsqlAndParams(@Param(&quot;name&quot;) String name);</span><br></pre></td></tr></table></figure><ul><li>ï¼ŸåŠ æ•°å­—è¡¨ç¤ºå ä½ç¬¦ï¼Œï¼Ÿ1ä»£è¡¨åœ¨æ–¹æ³•å‚æ•°é‡Œçš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼ŒåŒºåˆ«äºå…¶ä»–çš„indexï¼Œè¿™é‡Œä»1å¼€å§‹ </li><li>JPQLçš„è¯­æ³•ä¸­ï¼Œè¡¨åçš„ä½ç½®å¯¹åº”Entityçš„åç§°ï¼Œå­—æ®µå¯¹åº”Entityçš„å±æ€§</li><li>:åŠ ä¸Šå˜é‡åï¼Œè¿™é‡Œæ˜¯ä¸æ–¹æ³•å‚æ•°ä¸­æœ‰@Paramçš„å€¼åŒ¹é…çš„ï¼Œè€Œä¸æ˜¯ä¸å®é™…å‚æ•°åŒ¹é…çš„</li></ul><h4 id="ä½¿ç”¨-åŸå§‹-SQL"><a href="#ä½¿ç”¨-åŸå§‹-SQL" class="headerlink" title="ä½¿ç”¨ åŸå§‹ SQL"></a>ä½¿ç”¨ åŸå§‹ SQL</h4><ul><li>é›·åŒHQLï¼Œ åœ¨@Query ä¸­ åŠ å…¥ nativeQuery = true</li><li>æ³¨æ„åœ¨ä¿®æ”¹æ•°æ®çš„æ“ä½œä¸­å¿…é¡»åŠ  @Transactional äº‹åŠ¡æ³¨è§£</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">//æ›´æ–°</span><br><span class="line">@Transactional</span><br><span class="line">@Modifying</span><br><span class="line">@Query(value = &quot;update user a set a.name=?1 where a.id= ?2&quot;,nativeQuery = true)</span><br><span class="line">int updateName(String name,Integer id);</span><br><span class="line"></span><br><span class="line">// åˆ é™¤</span><br><span class="line">@Transactional</span><br><span class="line">@Modifying</span><br><span class="line">@Query(value = &quot;delete from user where id = ?1&quot;,nativeQuery = true)</span><br><span class="line">void deletIdBysql(Integer id);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// ä½¿ç”¨ HQL åˆ é™¤æ•°æ®</span><br><span class="line">@Transactional</span><br><span class="line">@Modifying</span><br><span class="line">@Query(&quot;delete from User u where u.id = ?1&quot;)</span><br><span class="line">void deletId(Integer id);</span><br></pre></td></tr></table></figure><ul><li>æ•°æ®ä¿®æ”¹æ“ä½œéœ€è¦åŠ ä¸Šäº‹åŠ¡æ³¨è§£ï¼Œä¿è¯æ•°æ®çš„ä¸€è‡´æ€§</li></ul>]]></content>
      
      
      <categories>
          
          <category> Java web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hello world </tag>
            
            <tag> JPA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MyBatisåŸºç¡€çŸ¥è¯†ç‚¹</title>
      <link href="/2019/11/25/MyBatis%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E7%82%B9/"/>
      <url>/2019/11/25/MyBatis%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E7%82%B9/</url>
      
        <content type="html"><![CDATA[<h1 id="MyBatisåŸºç¡€çŸ¥è¯†ç‚¹"><a href="#MyBatisåŸºç¡€çŸ¥è¯†ç‚¹" class="headerlink" title="MyBatisåŸºç¡€çŸ¥è¯†ç‚¹"></a>MyBatisåŸºç¡€çŸ¥è¯†ç‚¹</h1><h2 id="1-åŸºç¡€é…ç½®"><a href="#1-åŸºç¡€é…ç½®" class="headerlink" title="1.åŸºç¡€é…ç½®"></a>1.åŸºç¡€é…ç½®</h2><h5 id="1-æ·»åŠ ä¾èµ–åŒ…"><a href="#1-æ·»åŠ ä¾èµ–åŒ…" class="headerlink" title="1.æ·»åŠ ä¾èµ–åŒ…"></a>1.æ·»åŠ ä¾èµ–åŒ…</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--mysql--&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;mysql&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;8.0.16&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;2.0.1&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><h5 id="2-é…ç½®log4j"><a href="#2-é…ç½®log4j" class="headerlink" title="2.é…ç½®log4j"></a>2.é…ç½®log4j</h5><p>åœ¨ resources ç›®å½•ä¸‹å¢åŠ æ–‡ä»¶ log4j.properties</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">log4j.rootLogger=INFO, stdout</span><br><span class="line">log4j.appender.stdout=org.apache.log4j.ConsoleAppender</span><br><span class="line">log4j.appender.stdout.layout=org.apache.log4j.PatternLayout</span><br><span class="line">log4j.appender.stdout.layout.ConversionPattern=%5p [%t] - %m%n</span><br></pre></td></tr></table></figure><h5 id="3-è‡ªå®šä¹‰model-POJOç±»"><a href="#3-è‡ªå®šä¹‰model-POJOç±»" class="headerlink" title="3.è‡ªå®šä¹‰model (POJOç±»)"></a>3.è‡ªå®šä¹‰model (POJOç±»)</h5><h5 id="4-MyBatis-çš„å…¨å±€é…ç½®"><a href="#4-MyBatis-çš„å…¨å±€é…ç½®" class="headerlink" title="4.MyBatis çš„å…¨å±€é…ç½®"></a>4.MyBatis çš„å…¨å±€é…ç½®</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE configuration</span><br><span class="line">        PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span><br><span class="line">        &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">    &lt;!-- æ•°æ®åº“è¿æ¥é…ç½® --&gt;</span><br><span class="line">    &lt;environments default=&quot;development&quot;&gt;</span><br><span class="line">        &lt;environment id=&quot;development&quot;&gt;</span><br><span class="line">            &lt;transactionManager type=&quot;JDBC&quot;/&gt;</span><br><span class="line">            &lt;dataSource type=&quot;POOLED&quot;&gt;</span><br><span class="line">                &lt;property name=&quot;driver&quot; value=&quot;com.mysql.jdbc.Driver&quot;/&gt;</span><br><span class="line">                &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://127.0.0.1:3306/blog_db?useUnicode=true&amp;amp;characterEncoding=utf8&quot;/&gt;</span><br><span class="line">                &lt;property name=&quot;username&quot; value=&quot;root&quot;/&gt;</span><br><span class="line">                &lt;property name=&quot;password&quot; value=&quot;root&quot;/&gt;</span><br><span class="line">            &lt;/dataSource&gt;</span><br><span class="line">        &lt;/environment&gt;</span><br><span class="line">    &lt;/environments&gt;</span><br><span class="line">    &lt;!-- æ˜ å°„æ–‡ä»¶é…ç½® --&gt;</span><br><span class="line">    &lt;mappers&gt;</span><br><span class="line">        &lt;mapper resource=&quot;mapper/UserMapper.xml&quot;/&gt;</span><br><span class="line">    &lt;/mappers&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure><h5 id="5-è‡ªå®šä¹‰æ˜ å°„æ¥å£"><a href="#5-è‡ªå®šä¹‰æ˜ å°„æ¥å£" class="headerlink" title="5.è‡ªå®šä¹‰æ˜ å°„æ¥å£"></a>5.è‡ªå®šä¹‰æ˜ å°„æ¥å£</h5><p>æ­¤æ¥å£å¯¹åº”æ˜ å°„é…ç½®ä¸­çš„sqlè¯­å¥ å®ç°sqlè½¬å¯¹è±¡ å¯¹è±¡è½¬sql</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public interface UserMapper &#123;</span><br><span class="line">    //æ ¹æ®idè·å–ç”¨æˆ·ä¿¡æ¯</span><br><span class="line">    User findById(Long id);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="6-ç¼–å†™XMLæ˜ å°„æ–‡ä»¶"><a href="#6-ç¼–å†™XMLæ˜ å°„æ–‡ä»¶" class="headerlink" title="6.ç¼–å†™XMLæ˜ å°„æ–‡ä»¶"></a>6.ç¼–å†™XMLæ˜ å°„æ–‡ä»¶</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper PUBLIC</span><br><span class="line">        &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><br><span class="line">        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span><br><span class="line">        &lt;!-- å¯¹åº”æ˜ å°„æ¥å£çš„å‘½åç©ºé—´ --&gt;</span><br><span class="line">&lt;mapper namespace=&quot;mapper.UserMapper&quot;&gt;</span><br><span class="line">    &lt;!-- findByIdå¯¹åº”æ¥å£ä¸­çš„æ–¹æ³• --&gt;</span><br><span class="line">    &lt;select id=&quot;findById&quot; parameterType=&quot;java.lang.Long&quot; resultType=&quot;bean.User&quot;&gt;</span><br><span class="line">        select * from blog_db.user where id=#&#123;id&#125;</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br><span class="line"></span><br><span class="line">æ³¨é‡Šï¼š</span><br><span class="line">id å¯¹åº” æ¥å£ä¸­çš„æ–¹æ³•å</span><br><span class="line">parameterType ï¼š sqlè¯­å¥ä¸­å‚æ•°çš„ç±»å‹</span><br><span class="line">resultType ï¼šè¿”å›ç»“æœç±»å‹</span><br><span class="line">#&#123;id&#125; ï¼š å ä½</span><br></pre></td></tr></table></figure><h5 id="7-ä¸»å‡½æ•°è°ƒç”¨"><a href="#7-ä¸»å‡½æ•°è°ƒç”¨" class="headerlink" title="7.ä¸»å‡½æ•°è°ƒç”¨"></a>7.ä¸»å‡½æ•°è°ƒç”¨</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">public class Main &#123;</span><br><span class="line">  public static void main(String[] args) throws Exception&#123;</span><br><span class="line">    // 1.æ–°å»ºsessionå·¥å‚æ„å»ºç±»</span><br><span class="line">    SqlSessionFactoryBuilder sqlSessionFactoryBuilder = new SqlSessionFactoryBuilder();</span><br><span class="line">    // 2.sessionå·¥å‚æ„å»ºç±»  è¯»å–é…ç½®æ–‡ä»¶æ„é€  sessionå·¥å‚</span><br><span class="line">    SqlSessionFactory sessionFactory = sqlSessionFactoryBuilder.build(</span><br><span class="line">            Resources.getResourceAsReader(&quot;mybatis-config.xml&quot;),</span><br><span class="line">            &quot;development&quot;  // è¿™ä¸ªå‚æ•°å¯ä»¥çœç•¥ï¼Œå› ä¸º mybatis-config.xml çš„&lt;environments&gt;æ ‡ç­¾æŒ‡å®šäº†é»˜è®¤ç¯å¢ƒä¸ºdevelopment</span><br><span class="line">    );</span><br><span class="line">    // 3.ä¼šè¯å·¥å‚ æ„å»º ä¼šè¯</span><br><span class="line">    SqlSession sqlSession = sessionFactory.openSession();</span><br><span class="line">    // 4.è°ƒç”¨sessionçš„æ“ä½œæ•°æ®åº“çš„ä¸€ä¸ªæ“ä½œ</span><br><span class="line">    UserMapper userMapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line">    User user = userMapper.findById(1L);</span><br><span class="line">    System.out.println(user);</span><br><span class="line">    // 5.å…³é—­ä¼šè¯</span><br><span class="line">    sqlSession.close();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åŸºæœ¬ä½¿ç”¨ç»“æŸâ€”â€”â€”â€”â€”â€”â€”â€”â€”"><a href="#åŸºæœ¬ä½¿ç”¨ç»“æŸâ€”â€”â€”â€”â€”â€”â€”â€”â€”" class="headerlink" title="åŸºæœ¬ä½¿ç”¨ç»“æŸâ€”â€”â€”â€”â€”â€”â€”â€”â€”"></a>åŸºæœ¬ä½¿ç”¨ç»“æŸâ€”â€”â€”â€”â€”â€”â€”â€”â€”</h3><h4 id="1-ä½¿classçš„å­—æ®µä¸sqlä¸­ä¸ä¸€è‡´çš„å­—æ®µ-ä¸€ä¸€å¯¹åº”"><a href="#1-ä½¿classçš„å­—æ®µä¸sqlä¸­ä¸ä¸€è‡´çš„å­—æ®µ-ä¸€ä¸€å¯¹åº”" class="headerlink" title="1.ä½¿classçš„å­—æ®µä¸sqlä¸­ä¸ä¸€è‡´çš„å­—æ®µ ä¸€ä¸€å¯¹åº”"></a>1.ä½¿classçš„å­—æ®µä¸sqlä¸­ä¸ä¸€è‡´çš„å­—æ®µ ä¸€ä¸€å¯¹åº”</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">æ–¹æ¡ˆä¸€  æ–°å»ºmapè§„åˆ™ï¼š</span><br><span class="line">&lt;!-- æ­¤å¤„å°†Userå¯¹è±¡çš„usernameä¸sqlçš„nameå¯¹åº” --&gt;</span><br><span class="line">&lt;resultMap id=&quot;userResult&quot; type=&quot;bean.User&quot;&gt;</span><br><span class="line">    &lt;result property=&quot;username&quot; column=&quot;name&quot; javaType=&quot;String&quot; jdbcType=&quot;VARCHAR&quot;/&gt;</span><br><span class="line">&lt;/resultMap&gt;</span><br><span class="line">                                        &lt;!-- æ­¤å¤„éµå¾ªuserResultçš„æ˜ å°„è§„åˆ™ --&gt;</span><br><span class="line">&lt;select id=&quot;findById&quot; parameterType=&quot;Long&quot; resultMap=&quot;userResult&quot; resultType=&quot;bean.User&quot;&gt;</span><br><span class="line">    select * from blog_db.user where id=#&#123;id&#125;</span><br><span class="line">&lt;/select&gt;</span><br><span class="line"></span><br><span class="line">æ–¹æ¡ˆäºŒ  ä¿®æ”¹æŸ¥è¯¢è¯­å¥ä½¿ç¬¦åˆå­—æ®µï¼š</span><br><span class="line">select id, name AS username, email, password from blog_db.user where id=#&#123;id&#125;</span><br></pre></td></tr></table></figure><h4 id="2-å¤šå‚æ•°æŸ¥è¯¢"><a href="#2-å¤šå‚æ•°æŸ¥è¯¢" class="headerlink" title="2.å¤šå‚æ•°æŸ¥è¯¢"></a>2.å¤šå‚æ•°æŸ¥è¯¢</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">æ–¹æ¡ˆä¸€ï¼š ä½¿ç”¨é»˜è®¤çš„param*å ä½</span><br><span class="line">åœ¨æ¥å£ä¸­é…ç½®ï¼š</span><br><span class="line">User findUserByNameAndPassWd(String name,String passwd);</span><br><span class="line">åœ¨xmlä¸­é…ç½®ï¼š</span><br><span class="line">&lt;select id=&quot;findUserByNameAndPassWd&quot; resultType=&quot;model.User&quot;&gt;</span><br><span class="line">  select * from blog_db.user where name=#&#123;param1&#125; and password=#&#123;param2&#125;</span><br><span class="line">&lt;/select&gt;</span><br><span class="line"></span><br><span class="line">æ–¹æ¡ˆäºŒï¼šä½¿ç”¨æ³¨è§£æ³¨å…¥å‚æ•°å ä½¿ç”¨å‚æ•°å ä½</span><br><span class="line">åœ¨æ¥å£ä¸­é…ç½®ï¼š</span><br><span class="line">User findUserByNameAndPassWd2(@Param(&quot;name&quot;) String name, @Param(&quot;passwd&quot;) String passwd);</span><br><span class="line">åœ¨xmlä¸­é…ç½®ï¼š</span><br><span class="line">&lt;select id=&quot;findUserByNameAndPassWd2&quot; resultType=&quot;model.User&quot;&gt;</span><br><span class="line">  select * from blog_db.user where name=#&#123;name&#125; and password=#&#123;passwd&#125;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure><h4 id="3-Sortçš„å°ç»†èŠ‚"><a href="#3-Sortçš„å°ç»†èŠ‚" class="headerlink" title="3.Sortçš„å°ç»†èŠ‚"></a>3.Sortçš„å°ç»†èŠ‚</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">æ’åºçš„å‚æ•°ä¸èƒ½ä½¿ç”¨#&#123;&#125; åªèƒ½ç”¨$&#123;&#125;</span><br><span class="line">&lt;select id=&quot;TestSort&quot; resultType=&quot;model.User&quot;&gt;</span><br><span class="line">  select * from blog_db.user order by $&#123;orderRule&#125; desc</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure><h4 id="4-äº‹åŠ¡ï¼š"><a href="#4-äº‹åŠ¡ï¼š" class="headerlink" title="4.äº‹åŠ¡ï¼š"></a>4.äº‹åŠ¡ï¼š</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">å¾—åˆ°ä¸€ä¸ªæ•°æ®åº“çš„æ“ä½œå¯¹è±¡</span><br><span class="line">UserMapper userMapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line">ç„¶åè¿›è¡Œæ“ä½œï¼š</span><br><span class="line">å¯¹äºinsert delete å’Œ update éœ€è¦æœ‰æ‰‹åŠ¨æäº¤äº‹åŠ¡</span><br><span class="line">userMapper.xxx(æ“ä½œ)</span><br><span class="line">sqlSession.rollback(true);  // å¼ºåˆ¶å›æ»š</span><br><span class="line">sqlSession.commit();  //æäº¤</span><br><span class="line">sqlSession.commit(true);  // å¼ºåˆ¶æäº¤</span><br></pre></td></tr></table></figure><h4 id="5-åŠ¨æ€Sql"><a href="#5-åŠ¨æ€Sql" class="headerlink" title="5.åŠ¨æ€Sql"></a>5.åŠ¨æ€Sql</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">å¦‚æœè¯¥å­—æ®µä¸ä¸ºç©ºå°±åŠ å…¥whereä¸­è¿›è¡Œæ¯”è¾ƒ</span><br><span class="line">&lt;select id=&quot;find&quot; resultType=&quot;model.User&quot; parameterType=&quot;model.User&quot;&gt;</span><br><span class="line">    select * from blog_db.user</span><br><span class="line">    &lt;where&gt;</span><br><span class="line">        &lt;if test=&quot; id != null&quot;&gt;</span><br><span class="line">            and id = #&#123;id&#125;</span><br><span class="line">        &lt;/if&gt;</span><br><span class="line">        &lt;if test=&quot;name != null&quot;&gt;</span><br><span class="line">            and name = #&#123;name&#125;</span><br><span class="line">        &lt;/if&gt;</span><br><span class="line">        &lt;if test=&quot;email != null&quot;&gt;</span><br><span class="line">            and email = #&#123;email&#125;</span><br><span class="line">        &lt;/if&gt;</span><br><span class="line">        &lt;if test=&quot;password != null&quot;&gt;</span><br><span class="line">            and password = #&#123;password&#125;</span><br><span class="line">        &lt;/if&gt;</span><br><span class="line">    &lt;/where&gt;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure><h4 id="6-ä¸€å¯¹ä¸€å’Œä¸€å¯¹å¤šè¿è¡¨æŸ¥è¯¢-è¿”å›æ··åˆå€¼"><a href="#6-ä¸€å¯¹ä¸€å’Œä¸€å¯¹å¤šè¿è¡¨æŸ¥è¯¢-è¿”å›æ··åˆå€¼" class="headerlink" title="6.ä¸€å¯¹ä¸€å’Œä¸€å¯¹å¤šè¿è¡¨æŸ¥è¯¢ è¿”å›æ··åˆå€¼"></a>6.ä¸€å¯¹ä¸€å’Œä¸€å¯¹å¤šè¿è¡¨æŸ¥è¯¢ è¿”å›æ··åˆå€¼</h4><ol><li>ä½¿ç”¨æ‰©å±•ç±»ï¼Œå­˜å‚¨è¿”å›çš„æ•°æ® ï¼ˆä¸€å¯¹ä¸€ï¼‰</li><li>æ¨¡å‹é‡Œæœ‰æ¨¡å‹  ï¼ˆä¸€å¯¹ä¸€ï¼‰</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;resultMap id=&quot;blogResult&quot; type=&quot;bean.Blog&quot;&gt;</span><br><span class="line">    &lt;result property=&quot;id&quot; column=&quot;blog_id&quot;/&gt;</span><br><span class="line">    &lt;result property=&quot;ownerId&quot; column=&quot;user_id&quot;/&gt;</span><br><span class="line">    &lt;result property=&quot;title&quot; column=&quot;blog_title&quot;/&gt;</span><br><span class="line">    &lt;result property=&quot;content&quot; column=&quot;blog_content&quot;/&gt;</span><br><span class="line">    &lt;!--æ¨¡å‹é‡Œæœ‰æ¨¡å‹ association--&gt;</span><br><span class="line">    &lt;association property=&quot;user&quot; javaType=&quot;bean.User&quot;&gt;</span><br><span class="line">        &lt;id property=&quot;id&quot; column=&quot;user_id&quot;/&gt;</span><br><span class="line">        &lt;result property=&quot;name&quot; column=&quot;user_name&quot;/&gt;</span><br><span class="line">        &lt;result property=&quot;email&quot; column=&quot;user_email&quot;/&gt;</span><br><span class="line">        &lt;result property=&quot;password&quot; column=&quot;user_password&quot;/&gt;</span><br><span class="line">    &lt;/association&gt;</span><br><span class="line"></span><br><span class="line">&lt;/resultMap&gt;</span><br><span class="line"></span><br><span class="line">&lt;select id=&quot;findById&quot; parameterType=&quot;Long&quot; resultMap=&quot;blogResult&quot; resultType=&quot;bean.Blog&quot;&gt;</span><br><span class="line">    SELECT</span><br><span class="line">        blog.id AS blog_id,</span><br><span class="line">        blog.title AS blog_title,</span><br><span class="line">        blog.content AS blog_content,</span><br><span class="line">        user.id AS user_id,</span><br><span class="line">        user.name AS user_name,</span><br><span class="line">        user.email AS user_email,</span><br><span class="line">        user.password AS user_password</span><br><span class="line">    FROM blog, user </span><br><span class="line">    WHERE </span><br><span class="line">        blog.id = #&#123;id&#125; </span><br><span class="line">        AND user.id=blog.owner_id;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure><h4 id="3-æ¨¡å‹é‡Œæœ‰é›†åˆ-ï¼ˆä¸€å¯¹å¤šï¼‰"><a href="#3-æ¨¡å‹é‡Œæœ‰é›†åˆ-ï¼ˆä¸€å¯¹å¤šï¼‰" class="headerlink" title="3. æ¨¡å‹é‡Œæœ‰é›†åˆ  ï¼ˆä¸€å¯¹å¤šï¼‰"></a>3. æ¨¡å‹é‡Œæœ‰é›†åˆ  ï¼ˆä¸€å¯¹å¤šï¼‰</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">    &lt;!--é¦–å…ˆåˆ›å»ºmapæ˜ å°„å…³ç³»--&gt;</span><br><span class="line">&lt;resultMap id=&quot;userResult&quot; type=&quot;model.User&quot;&gt;</span><br><span class="line">    &lt;result property=&quot;id&quot; column=&quot;user_id&quot;/&gt;</span><br><span class="line">    &lt;result property=&quot;name&quot; column=&quot;user_name&quot;/&gt;</span><br><span class="line">    &lt;result property=&quot;email&quot; column=&quot;user_email&quot;/&gt;</span><br><span class="line">    &lt;result property=&quot;password&quot; column=&quot;user_password&quot;/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!--resulté‡Œæœ‰é›†åˆ collection--&gt;</span><br><span class="line">    &lt;collection property=&quot;blogs&quot; ofType=&quot;model.Blog&quot;&gt;</span><br><span class="line">        &lt;id property=&quot;id&quot; column=&quot;blog_id&quot;/&gt;</span><br><span class="line">        &lt;result property=&quot;ownerId&quot; column=&quot;user_id&quot;/&gt;</span><br><span class="line">        &lt;result property=&quot;title&quot; column=&quot;blog_title&quot;/&gt;</span><br><span class="line">        &lt;result property=&quot;content&quot; column=&quot;blog_content&quot;/&gt;</span><br><span class="line">    &lt;/collection&gt;</span><br><span class="line">&lt;/resultMap&gt;</span><br><span class="line"></span><br><span class="line">&lt;select id=&quot;findById&quot; parameterType=&quot;Long&quot; resultMap=&quot;userResult&quot; resultType=&quot;model.User&quot;&gt;</span><br><span class="line">    SELECT</span><br><span class="line">        user.id AS user_id,</span><br><span class="line">        user.name AS user_name,</span><br><span class="line">        user.email AS user_email,</span><br><span class="line">        user.password AS user_password,</span><br><span class="line">        blog.id AS blog_id,</span><br><span class="line">        blog.title AS blog_title,</span><br><span class="line">        blog.content AS blog_content</span><br><span class="line">    FROM user, blog</span><br><span class="line">    WHERE</span><br><span class="line">        user.id = 1</span><br><span class="line">        AND user.id=blog.owner_id;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure><h4 id="7-ä¸¤ä¸ªè¡¨çš„æŸ¥è¯¢å…³è”"><a href="#7-ä¸¤ä¸ªè¡¨çš„æŸ¥è¯¢å…³è”" class="headerlink" title="7.ä¸¤ä¸ªè¡¨çš„æŸ¥è¯¢å…³è”"></a>7.ä¸¤ä¸ªè¡¨çš„æŸ¥è¯¢å…³è”</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">è¿™ä¸ªmapperæ˜¯BlogMapperçš„xmlé…ç½®</span><br><span class="line">è®°å¾—å°†æ”¹xml æ³¨å…¥ å…¨å±€é…ç½®ä¸­</span><br><span class="line">&lt;mapper namespace=&quot;mapper.BlogMapper&quot;&gt;</span><br><span class="line">    &lt;!--è”åˆå¤šè¡¨æŸ¥è¯¢--&gt;</span><br><span class="line">    &lt;!--é¦–å…ˆè¦æœ‰ä¸¤ä¸ªè¡¨çš„mapå…³ç³»--&gt;</span><br><span class="line">    &lt;resultMap id=&quot;blogResult&quot; type=&quot;model.Blog&quot;&gt;</span><br><span class="line">        &lt;result property=&quot;id&quot; column=&quot;blog_id&quot;/&gt;</span><br><span class="line">        &lt;result property=&quot;ownerId&quot; column=&quot;user_id&quot;/&gt;</span><br><span class="line">        &lt;result property=&quot;title&quot; column=&quot;blog_title&quot;/&gt;</span><br><span class="line">        &lt;result property=&quot;content&quot; column=&quot;blog_content&quot;/&gt;</span><br><span class="line"></span><br><span class="line">        &lt;association property=&quot;user&quot;</span><br><span class="line">                     javaType=&quot;model.User&quot;</span><br><span class="line">                     select=&quot;findOwnerOfBlog&quot;</span><br><span class="line">                     column=&quot;user_id&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/resultMap&gt;</span><br><span class="line"></span><br><span class="line">    &lt;resultMap id=&quot;userResult&quot; type=&quot;model.User&quot;&gt;</span><br><span class="line">        &lt;result property=&quot;id&quot; column=&quot;user_id&quot;/&gt;</span><br><span class="line">        &lt;result property=&quot;name&quot; column=&quot;user_name&quot;/&gt;</span><br><span class="line">        &lt;result property=&quot;email&quot; column=&quot;user_email&quot;/&gt;</span><br><span class="line">        &lt;result property=&quot;password&quot; column=&quot;user_password&quot;/&gt;</span><br><span class="line">    &lt;/resultMap&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!--ä¸¤ä¸ªæŸ¥è¯¢--&gt;</span><br><span class="line">    &lt;select id=&quot;findById&quot; parameterType=&quot;Long&quot; resultMap=&quot;blogResult&quot; resultType=&quot;model.Blog&quot;&gt;</span><br><span class="line">        SELECT</span><br><span class="line">        id AS blog_id,</span><br><span class="line">        id AS user_id,</span><br><span class="line">        title AS blog_title,</span><br><span class="line">        content AS blog_content</span><br><span class="line">        FROM</span><br><span class="line">        blog</span><br><span class="line">        WHERE</span><br><span class="line">        id = #&#123;id&#125;;</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line"></span><br><span class="line">    &lt;select id=&quot;findOwnerOfBlog&quot;  parameterType=&quot;int&quot;  resultMap=&quot;userResult&quot; resultType=&quot;model.User&quot;&gt;</span><br><span class="line">        SELECT</span><br><span class="line">        id user_id,</span><br><span class="line">        name user_name,</span><br><span class="line">        email user_email,</span><br><span class="line">        password user_password</span><br><span class="line">        FROM</span><br><span class="line">        user</span><br><span class="line">        WHERE</span><br><span class="line">        id=#&#123;user_id&#125;;</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br><span class="line"></span><br><span class="line">å…¶æµç¨‹æ˜¯ï¼š </span><br><span class="line">1.é¦–å…ˆ clientè°ƒç”¨BlogMapperçš„findByIdæ–¹æ³•</span><br><span class="line">2.sqlæ‰§è¡Œï¼Œä½œå‡ºå›åº”ï¼Œè¿”å›Blogçš„å€¼ï¼ˆæ­¤æ—¶ä¸ç›´æ¥å­˜å‚¨Userå¯¹è±¡çš„å€¼ï¼‰</span><br><span class="line">3.åœ¨Blogçš„mapperæ˜ å°„ä¸­ è°ƒç”¨ select findOwnerOfBlog æ–¹æ³• ä¼ å…¥ user_id æŸ¥è¯¢ è¾“å‡ºUser</span><br></pre></td></tr></table></figure><h4 id="8-å»¶è¿ŸåŠ è½½"><a href="#8-å»¶è¿ŸåŠ è½½" class="headerlink" title="8.å»¶è¿ŸåŠ è½½"></a>8.å»¶è¿ŸåŠ è½½</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">åœ¨ä¸Šè¿°æ¡ˆä¾‹çš„åŸºç¡€ä¸Šï¼Œåœ¨å…¨å±€é…ç½®æ–‡ä»¶ä¸­å¢åŠ å¦‚ä¸‹é…ç½®å³å¯å®ç°ï¼š</span><br><span class="line">&lt;settings&gt;</span><br><span class="line">    &lt;setting name=&quot;lazyLoadingEnabled&quot; value=&quot;true&quot;/&gt;</span><br><span class="line">    &lt;setting name=&quot;aggressiveLazyLoading&quot; value=&quot;false&quot;/&gt;</span><br><span class="line">&lt;/settings&gt;</span><br><span class="line">ä¿®æ”¹åä¼šåœ¨éœ€è¦Userå€¼æ—¶ï¼Œæ‰è¿›è¡Œselect findOwnerOfBlog æ–¹æ³•çš„è§¦å‘</span><br></pre></td></tr></table></figure><h4 id="9-å¤šå¯¹å¤šçš„å®ç°"><a href="#9-å¤šå¯¹å¤šçš„å®ç°" class="headerlink" title="9.å¤šå¯¹å¤šçš„å®ç°"></a>9.å¤šå¯¹å¤šçš„å®ç°</h4><h4 id="10-åˆ†é¡µæŸ¥è¯¢"><a href="#10-åˆ†é¡µæŸ¥è¯¢" class="headerlink" title="10.åˆ†é¡µæŸ¥è¯¢"></a>10.åˆ†é¡µæŸ¥è¯¢</h4><ol><li>limitæ˜¾å¼å®ç°</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=&quot;findByUserId&quot; resultType=&quot;model.Blog&quot;&gt;</span><br><span class="line">    select id,owner_id as ownerId,title,content</span><br><span class="line">    from blog</span><br><span class="line">    where owner_id = #&#123;param1&#125;</span><br><span class="line">    order by id asc</span><br><span class="line">    limit #&#123;param2&#125;, #&#123;param3&#125;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure><ol start="2"><li>rowBounds + pageHelper å®ç°</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">åœ¨æ¥å£ä¸­ï¼š</span><br><span class="line">List&lt;Blog&gt; findByUserIdWithHelper(Long ownerId, RowBounds rowBounds);</span><br><span class="line">åœ¨xmlä¸­ï¼š</span><br><span class="line">&lt;select id=&quot;findByUserIdWithHelper&quot; resultType=&quot;model.Blog&quot;&gt;</span><br><span class="line">    SELECT</span><br><span class="line">    id,</span><br><span class="line">    owner_id AS ownerId,</span><br><span class="line">    title,</span><br><span class="line">    content</span><br><span class="line">    FROM</span><br><span class="line">        blog</span><br><span class="line">    WHERE</span><br><span class="line">        owner_id = #&#123;param1&#125;</span><br><span class="line">    ORDER BY id ASC</span><br><span class="line">&lt;/select&gt;</span><br><span class="line"></span><br><span class="line">æœ€åè¿˜è¦å¯¼åŒ…ï¼Œåœ¨å…¨å±€é…ç½®ä¸­åŠ å…¥æ’ä»¶pagehelperï¼š</span><br><span class="line">&lt;plugins&gt;</span><br><span class="line">    &lt;plugin interceptor=&quot;com.github.pagehelper.PageInterceptor&quot;&gt;</span><br><span class="line">        &lt;property name=&quot;rowBoundsWithCount&quot; value=&quot;true&quot;/&gt;</span><br><span class="line">    &lt;/plugin&gt;</span><br><span class="line">&lt;/plugins&gt;</span><br></pre></td></tr></table></figure><h4 id="11-ä½¿ç”¨æ³¨è§£"><a href="#11-ä½¿ç”¨æ³¨è§£" class="headerlink" title="11.ä½¿ç”¨æ³¨è§£"></a>11.ä½¿ç”¨æ³¨è§£</h4><p>åœ¨mapperæ¥å£å†…ä½¿ç”¨æ³¨è§£sqlè¯­å¥å®ç°ç®€å•çš„æŸ¥è¯¢</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@Select(&quot;select * from blog_db.user&quot;)</span><br><span class="line">List&lt;Blog&gt; findAll();</span><br><span class="line">å…¶ä»–æ›´å¤š....ç”¨æ—¶å†æŸ¥</span><br></pre></td></tr></table></figure><h4 id="12-MyBatisçš„äºŒçº§ç¼“å­˜æœºåˆ¶"><a href="#12-MyBatisçš„äºŒçº§ç¼“å­˜æœºåˆ¶" class="headerlink" title="12.MyBatisçš„äºŒçº§ç¼“å­˜æœºåˆ¶"></a>12.MyBatisçš„äºŒçº§ç¼“å­˜æœºåˆ¶</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">1.ä¸€çº§ç¼“å­˜é»˜è®¤å¼€å¯</span><br><span class="line">    èŒƒå›´ï¼šMapperï¼ˆåŒä¸€ä¸ªmapper ç›¸å½“äºDAOï¼‰</span><br><span class="line">    æ¸…ç©ºï¼šå½“æœ‰ update delete insertæ“ä½œå‘ç”Ÿ</span><br><span class="line"></span><br><span class="line">2.äºŒçº§ç¼“å­˜æ‰‹åŠ¨å¼€å¯</span><br><span class="line">    èŒƒå›´ï¼šSessionï¼ˆåŒä¸€ä¸ªSessionä¼šè¯ï¼‰</span><br><span class="line">    æ¸…ç©ºï¼š</span><br><span class="line">    å¼€å¯ï¼š</span><br><span class="line">    1.åœ¨å…¨å±€é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ï¼š</span><br><span class="line">    &lt;setting name=&quot;cacheEnabled&quot; value=&quot;true&quot;/&gt;   &lt;!--å¼€å¯äºŒçº§ç¼“å­˜--&gt;</span><br><span class="line">    2.å°†Mapperåºåˆ—åŒ–</span><br></pre></td></tr></table></figure><p><a href="https://blog.letiantian.me/mybatis" target="_blank" rel="noopener">ä¼˜ç§€çš„å­¦ä¹ èµ„æº</a></p>]]></content>
      
      
      <categories>
          
          <category> Java web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hello world </tag>
            
            <tag> MyBatis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SpringMVCåŸºæœ¬æ¦‚å¿µå’Œä½¿ç”¨</title>
      <link href="/2019/11/25/SpringMVC%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E5%92%8C%E4%BD%BF%E7%94%A8/"/>
      <url>/2019/11/25/SpringMVC%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E5%92%8C%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="SpringMVCåŸºæœ¬æ¦‚å¿µå’Œä½¿ç”¨"><a href="#SpringMVCåŸºæœ¬æ¦‚å¿µå’Œä½¿ç”¨" class="headerlink" title="SpringMVCåŸºæœ¬æ¦‚å¿µå’Œä½¿ç”¨"></a>SpringMVCåŸºæœ¬æ¦‚å¿µå’Œä½¿ç”¨</h1><ul><li>Spring MVCå±äºSpringFrameWorkçš„åç»­äº§å“ï¼Œå·²ç»èåˆåœ¨Spring Web Flowé‡Œé¢ã€‚Spring æ¡†æ¶æä¾›äº†æ„å»º Web åº”ç”¨ç¨‹åºçš„å…¨åŠŸèƒ½ MVC æ¨¡å—ã€‚</li></ul><h2 id="åŸºæœ¬æ¶æ„æµç¨‹"><a href="#åŸºæœ¬æ¶æ„æµç¨‹" class="headerlink" title="åŸºæœ¬æ¶æ„æµç¨‹"></a>åŸºæœ¬æ¶æ„æµç¨‹</h2><ul><li>æ ¸å¿ƒæ€æƒ³ MVCåˆ†å±‚è®¾è®¡</li></ul><p><img alt data-src="https://pic2.superbed.cn/item/5ddb62008e0e2e3ee94bde32.png" class="lazyload"></p><h2 id="1-å…¥é—¨é…ç½®"><a href="#1-å…¥é—¨é…ç½®" class="headerlink" title="1.å…¥é—¨é…ç½®"></a>1.å…¥é—¨é…ç½®</h2><ol><li>å¯¼åŒ…ï¼š æœ€åŸºæœ¬çš„Springå’ŒSpringMVC 8ä¸ªåŒ…ï¼ŒåŒ…æ‹¬web</li><li>é…ç½®SpringMVC è®¾ç½®</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</span><br><span class="line">       xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot;</span><br><span class="line">       xmlns:context=&quot;http://www.springframework.org/schema/context&quot;</span><br><span class="line">       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">       xsi:schemaLocation=&quot;</span><br><span class="line">        http://www.springframework.org/schema/beans</span><br><span class="line">        http://www.springframework.org/schema/beans/spring-beans.xsd</span><br><span class="line">        http://www.springframework.org/schema/mvc</span><br><span class="line">        http://www.springframework.org/schema/mvc/spring-mvc.xsd</span><br><span class="line">        http://www.springframework.org/schema/context</span><br><span class="line">        http://www.springframework.org/schema/context/spring-context.xsd&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- å¼€å¯æ³¨è§£æ‰«æ --&gt;</span><br><span class="line">    &lt;context:component-scan base-package=&quot;code.controller&quot;/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- è§†å›¾è§£æå™¨å¯¹è±¡ --&gt;</span><br><span class="line">    &lt;bean id=&quot;internalResourceViewResolver&quot; class=&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;&gt;</span><br><span class="line">        &lt;property name=&quot;prefix&quot; value=&quot;/WEB-INF/pages/&quot;/&gt;</span><br><span class="line">        &lt;property name=&quot;suffix&quot; value=&quot;.jsp&quot;/&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- å¼€å¯SpringMVCæ¡†æ¶æ³¨è§£çš„æ”¯æŒ --&gt;</span><br><span class="line">    &lt;mvc:annotation-driven /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure><ol start="3"><li>web é…ç½®</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;web-app xmlns=&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span><br><span class="line">         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">         xsi:schemaLocation=&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span><br><span class="line">         version=&quot;4.0&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;display-name&gt;SpringMVC Project&lt;/display-name&gt;</span><br><span class="line"></span><br><span class="line">    &lt;servlet&gt;</span><br><span class="line">        &lt;!--æ§åˆ¶ä¸­å¿ƒ--&gt;</span><br><span class="line">        &lt;servlet-name&gt;dispatcher&lt;/servlet-name&gt;</span><br><span class="line">        &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!--åˆå§‹åŒ–åŠ è½½SpringMVCé…ç½®--&gt;</span><br><span class="line">        &lt;init-param&gt;</span><br><span class="line">            &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;</span><br><span class="line">            &lt;param-value&gt;classpath:SpringMVC.xml&lt;/param-value&gt;</span><br><span class="line">        &lt;/init-param&gt;</span><br><span class="line">        &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;</span><br><span class="line">    &lt;/servlet&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!--æ˜ å°„ç›‘å¬--&gt;</span><br><span class="line">    &lt;servlet-mapping&gt;</span><br><span class="line">        &lt;servlet-name&gt;dispatcher&lt;/servlet-name&gt;</span><br><span class="line">        &lt;url-pattern&gt;/&lt;/url-pattern&gt;</span><br><span class="line">    &lt;/servlet-mapping&gt;</span><br><span class="line"></span><br><span class="line">&lt;/web-app&gt;</span><br></pre></td></tr></table></figure><p>4.å¤„ç†å‡½æ•°ä¹¦å†™</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">package code.controller;</span><br><span class="line">import org.springframework.stereotype.Controller;</span><br><span class="line">import org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"></span><br><span class="line">@Controller</span><br><span class="line">@RequestMapping(path = &quot;/test&quot;)   //ä¸€çº§è·¯å¾„</span><br><span class="line">public class helloController&#123;</span><br><span class="line"></span><br><span class="line">  // ä¹¦å†™ä¸€ä¸ªæ–¹æ³•å¯¹è¯·æ±‚ä½œå‡ºå›åº”</span><br><span class="line">  @RequestMapping(path = &quot;/hello&quot;)  // äºŒçº§è·¯å¾„</span><br><span class="line">  public String SayHello()&#123;</span><br><span class="line">    System.out.println(&quot;hello SrpingMVC.&quot;);</span><br><span class="line">    return &quot;success&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="2-åŸºæœ¬é…ç½®"><a href="#2-åŸºæœ¬é…ç½®" class="headerlink" title="2.åŸºæœ¬é…ç½®"></a>2.åŸºæœ¬é…ç½®</h3><ol><li>æ¶æ„å›¾ç†è§£<br><img alt data-src="https://pic2.superbed.cn/item/5ddb62008e0e2e3ee94bde34.png" class="lazyload"></li><li>RequestMappingæ³¨è§£<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1.RequestMappingæ³¨è§£Controllerä¸‹å½¢æˆä¸€çº§è·¯å¾„ï¼Œå†ä¹¦å†™åœ¨funcä¸‹å½¢æˆäºŒçº§ç›®å½•</span><br><span class="line">2.pathå±æ€§ = value å±æ€§</span><br><span class="line">3.methodå±æ€§  post get</span><br><span class="line">4.headerså±æ€§  é€‰æ‹©æ¥å—å¿…é¡»æºå¸¦å“ªäº›headersçš„url</span><br><span class="line">5.paramså±æ€§ é€‰æ‹©æ¥å—ç¬¦åˆè§„å®šçš„å‚æ•°çš„url</span><br><span class="line">6.å‚æ•°ç»‘å®š</span><br><span class="line">    1.æ™®é€šæ•°æ®ç±»å‹ï¼Œç›´æ¥é€šè¿‡åŒåæ–¹æ³•å‚æ•°è·å–</span><br><span class="line">    2.beanå¯¹è±¡ç±»å‹ï¼Œé€šè¿‡æ„å»ºjavabean å¹¶é€šè¿‡ä¸å¯¹è±¡å±æ€§ç›¸åŒçš„å±æ€§åè·å–</span><br><span class="line">    3.ç»‘å®šé›†åˆç±»å‹ï¼Œé€šè¿‡ list[] æˆ– map[&apos;&apos;] å¯¹åº”å°è£…</span><br></pre></td></tr></table></figure></li><li>é…ç½®è¿‡æ»¤å™¨è§£å†³ä¸­æ–‡ä¹±ç é—®é¢˜ (web.xml)ä¸­</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--é…ç½®ç›‘å¬å™¨è§£å†³ä¸­æ–‡ä¹±ç é—®é¢˜--&gt;</span><br><span class="line">    &lt;filter&gt;</span><br><span class="line">        &lt;filter-name&gt;characterEncodingFilter&lt;/filter-name&gt;</span><br><span class="line">        &lt;filter-class&gt;org.springframework.web.filter.CharacterEncodingFilter&lt;/filter-class&gt;</span><br><span class="line">        &lt;init-param&gt;</span><br><span class="line">            &lt;param-name&gt;encoding&lt;/param-name&gt;</span><br><span class="line">            &lt;param-value&gt;UTF-8&lt;/param-value&gt;</span><br><span class="line">        &lt;/init-param&gt;</span><br><span class="line">    &lt;/filter&gt;</span><br><span class="line">    &lt;filter-mapping&gt;</span><br><span class="line">        &lt;filter-name&gt;characterEncodingFilter&lt;/filter-name&gt;</span><br><span class="line">        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;</span><br><span class="line">    &lt;/filter-mapping&gt;</span><br></pre></td></tr></table></figure><ol start="4"><li>è‡ªå®šä¹‰ç±»å‹è½¬æ¢</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">1.è‡ªå»ºè½¬æ¢ç±» å®ç° Converter&lt;&gt;æ¥å£</span><br><span class="line">2.Srping.xmlä¸­é…ç½®</span><br><span class="line">&lt;!--é…ç½®è‡ªå®šä¹‰ç±»å‹è½¬æ¢å™¨--&gt;</span><br><span class="line">    &lt;bean id=&quot;conversionService&quot; class=&quot;org.springframework.context.support.ConversionServiceFactoryBean&quot;&gt;</span><br><span class="line">        &lt;property name=&quot;converters&quot;&gt;</span><br><span class="line">            &lt;set&gt;</span><br><span class="line">                &lt;!--åŠ è½½å¯ç”¨çš„ç±»å‹è½¬æ¢å™¨å¯¹è±¡--&gt;</span><br><span class="line">                &lt;bean class=&quot;code.utils.StringToDate&quot;&gt;&lt;/bean&gt;</span><br><span class="line">            &lt;/set&gt;</span><br><span class="line">        &lt;/property&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br><span class="line">    &lt;!-- å¼€å¯SpringMVCæ¡†æ¶æ³¨è§£çš„æ”¯æŒ --&gt;</span><br><span class="line">    &lt;mvc:annotation-driven conversion-service=&quot;conversionService&quot;/&gt;</span><br></pre></td></tr></table></figure><ol start="5"><li><p>è·å– Servlet ,session , reqeust, response</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">åœ¨å‚æ•°ä½ç½®å¼•ç”¨: HttpServletRequest å’Œ HttpServletResponse</span><br><span class="line">@RequestMapping(&quot;/Servlet&quot;)</span><br><span class="line">  public String testServlet(HttpServletRequest request, HttpServletResponse response)&#123;</span><br><span class="line">    System.out.println(request); //request</span><br><span class="line">    System.out.println(request.getSession());   //session</span><br><span class="line">    System.out.println(request.getSession().getServletContext()); //servlet</span><br><span class="line">    System.out.println(response); //response</span><br><span class="line">    return &quot;success&quot;;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></li><li><p>å¼ºåˆ¶ç»‘å®šè¯¥å‚æ•°åçš„ä¼ å…¥å‚æ•° @RequestParam(â€œâ€)</p></li><li><p>restfule ç¼–ç¨‹é£æ ¼ @PathVariable</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">é€šè¿‡ / åç›´æ¥è·Ÿ&#123;å‚æ•°&#125;,å‡å°‘ä½¿ç”¨ ?ä¼ å‚å’Œæ–¹æ³•å</span><br><span class="line">@RequestMapping(&quot;/testPathVariable/&#123;id&#125;&quot;)</span><br><span class="line">  public String testPathVariable(@PathVariable String id)&#123;</span><br><span class="line">    System.out.println(id);</span><br><span class="line">    return &quot;success&quot;;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></li><li><p>æ‹¿åˆ°æ•´ä¸ªpostè¯·æ±‚çš„è¯·æ±‚ä½“: @RequestBody</p></li><li><p>æ‹¿åˆ°è¯·æ±‚çš„Header @RequestHeader</p></li><li><p>æ‹¿åˆ°è¯·æ±‚çš„cookieå€¼ @CookieValue(value=â€â€)</p></li><li><p>å‡½æ•°æ‰§è¡Œå‰çš„æ–¹æ³• @ModelAttribute</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">ModelAttribute ä¼šå…ˆäºå½“å‰ç›®å½•ä¸‹çš„æ–¹æ³•æ‰§è¡Œï¼Œå¯ä»¥åˆ©ç”¨å…¶æ€§è´¨å…ˆè¿›è¡Œå°è£…åˆ¤æ–­åæŠŠå€¼ä¼ ç»™å¤„ç†å‡½æ•°</span><br><span class="line">  @ModelAttribute</span><br><span class="line">  public Account testModelAttribute1(String name,String passwd)&#123;</span><br><span class="line">    Account account = new Account();</span><br><span class="line">    account.setName(name);</span><br><span class="line">    account.setPasswd(passwd);</span><br><span class="line">    account.setUser(new User(&quot;kid&quot;,20));</span><br><span class="line">    return account;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  @RequestMapping(&quot;/testModelAttribute&quot;)</span><br><span class="line">  public String testModelAttribute2(Account account)&#123;</span><br><span class="line">    System.out.println(account);</span><br><span class="line">    return &quot;success&quot;;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></li><li><p>SessionAttributes è®¾ç½®sessionåŸŸçš„å…±æœ‰æ•°æ®</p></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">Modelé»˜è®¤å§æ•°æ®å­˜åˆ°request å¦‚æœè¦è®¾ç½®åˆ°session </span><br><span class="line">éœ€è¦åœ¨classå‰æ·»åŠ @SessionAttributes(value = &#123;&quot;msg&quot;&#125;)æ³¨è§£</span><br><span class="line"></span><br><span class="line">// set</span><br><span class="line">@RequestMapping(&quot;/testSessionAttribute&quot;)</span><br><span class="line">  public String testSessionAttribute(Model model)&#123;</span><br><span class="line">    model.addAttribute(&quot;msg&quot;,&quot;hello world&quot;);  // ä¸ºmodelæ·»åŠ æ•°æ®</span><br><span class="line">    // model  ä¼šæŠŠæ•°æ®å­˜åˆ°requestä¸­</span><br><span class="line">    System.out.println(&quot;testSessionAttribute&quot;);</span><br><span class="line">    return &quot;success&quot;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // get</span><br><span class="line">  @RequestMapping(&quot;/getSessionAttribute&quot;)</span><br><span class="line">  public String getSessionAttribute(ModelMap modelMap)&#123;</span><br><span class="line">    String msg = (String) modelMap.get(&quot;msg&quot;);  //å–å‡ºsessionçš„å€¼</span><br><span class="line">    System.out.println(&quot;getSessionAttribute&quot;);</span><br><span class="line">    System.out.println(msg);</span><br><span class="line">    return &quot;success&quot;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // del</span><br><span class="line">  @RequestMapping(&quot;/delSessionAttribute&quot;)</span><br><span class="line">  public String delSessionAttribute(SessionStatus status)&#123;</span><br><span class="line">    status.setComplete();   // æ¸…ç©ºsession</span><br><span class="line">    System.out.println(&quot;æ¸…ç©ºsession&quot;);</span><br><span class="line">    return &quot;success&quot;;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h3 id="3-è§†å›¾è§£æå™¨"><a href="#3-è§†å›¾è§£æå™¨" class="headerlink" title="3.è§†å›¾è§£æå™¨"></a>3.è§†å›¾è§£æå™¨</h3><h4 id="1-è¿”å›å€¼æ˜¯String-é…ç½®è§†å›¾è§£æå™¨ï¼Œæ­£å¸¸è½¬å‘"><a href="#1-è¿”å›å€¼æ˜¯String-é…ç½®è§†å›¾è§£æå™¨ï¼Œæ­£å¸¸è½¬å‘" class="headerlink" title="1. è¿”å›å€¼æ˜¯String é…ç½®è§†å›¾è§£æå™¨ï¼Œæ­£å¸¸è½¬å‘"></a>1. è¿”å›å€¼æ˜¯String é…ç½®è§†å›¾è§£æå™¨ï¼Œæ­£å¸¸è½¬å‘</h4><h4 id="2-è¿”å›å€¼æ˜¯voidï¼Œä½¿ç”¨HttpServletrequest-response-è½¬å‘æˆ–è€…é‡å®šå‘"><a href="#2-è¿”å›å€¼æ˜¯voidï¼Œä½¿ç”¨HttpServletrequest-response-è½¬å‘æˆ–è€…é‡å®šå‘" class="headerlink" title="2. è¿”å›å€¼æ˜¯voidï¼Œä½¿ç”¨HttpServletrequest / response è½¬å‘æˆ–è€…é‡å®šå‘"></a>2. è¿”å›å€¼æ˜¯voidï¼Œä½¿ç”¨HttpServletrequest / response è½¬å‘æˆ–è€…é‡å®šå‘</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@RequestMapping(&quot;/testVoid&quot;)</span><br><span class="line">  public void testVoid(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123;</span><br><span class="line">    // ç¼–å†™è¯·æ±‚è½¬å‘ï¼š</span><br><span class="line">//    request.getRequestDispatcher(&quot;/WEB-INF/pages/success.jsp&quot;).forward(request,response);</span><br><span class="line">    //é‡å®šå‘</span><br><span class="line">    response.setCharacterEncoding(&quot;UTF-8&quot;);</span><br><span class="line">    response.setContentType(&quot;text/html;charset=UTF-8&quot;);</span><br><span class="line">    response.getWriter().println(&quot;ä½ å¥½ï¼&quot;);</span><br><span class="line">    return;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h4 id="3-è¿”å›å€¼æ˜¯ModelAndView"><a href="#3-è¿”å›å€¼æ˜¯ModelAndView" class="headerlink" title="3. è¿”å›å€¼æ˜¯ModelAndView"></a>3. è¿”å›å€¼æ˜¯ModelAndView</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@RequestMapping(&quot;/testModelAndView&quot;)</span><br><span class="line">  public ModelAndView testModelAndView() &#123;</span><br><span class="line">    ModelAndView mv = new ModelAndView();</span><br><span class="line">    User user = new User();</span><br><span class="line">    user.setUage(12);</span><br><span class="line">    user.setUname(&quot;kid&quot;);</span><br><span class="line">    mv.addObject(&quot;user&quot;,user);  //è®¾ç½®requestå‚æ•°</span><br><span class="line">    mv.setViewName(&quot;success&quot;);    // è®¾ç½®è½¬å‘é¡µé¢</span><br><span class="line">    return mv;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h4 id="4-å¼€æ”¾é™æ€èµ„æºåŠ è½½-SpringMVC-xml"><a href="#4-å¼€æ”¾é™æ€èµ„æºåŠ è½½-SpringMVC-xml" class="headerlink" title="4. å¼€æ”¾é™æ€èµ„æºåŠ è½½ SpringMVC.xml"></a>4. å¼€æ”¾é™æ€èµ„æºåŠ è½½ SpringMVC.xml</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--å‰æ®µæ§åˆ¶å™¨ï¼Œé‚£äº›é™æ€èµ„æºä¸æ§åˆ¶--&gt;</span><br><span class="line">    &lt;mvc:resources mapping=&quot;/js/**&quot; location=&quot;/js/&quot; /&gt;</span><br></pre></td></tr></table></figure><h4 id="5-AJAXçš„å°æ¡ˆä¾‹"><a href="#5-AJAXçš„å°æ¡ˆä¾‹" class="headerlink" title="5. AJAXçš„å°æ¡ˆä¾‹"></a>5. AJAXçš„å°æ¡ˆä¾‹</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">å‰æ®µajaxè¯·æ±‚</span><br><span class="line">&lt;script src=&quot;js/jquery-3.3.1.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">      //é¡µé¢åŠ è½½ï¼Œç»‘å®šå•å‡»äº‹ä»¶</span><br><span class="line">      $(function () &#123;</span><br><span class="line">        $(&quot;#btn&quot;).click(function () &#123;</span><br><span class="line">          // alert(&quot;hello world by js.&quot;);</span><br><span class="line">          // å‘é€ajaxè¯·æ±‚</span><br><span class="line">          $.ajax(&#123;</span><br><span class="line">            url:&quot;user/testAjax&quot;,</span><br><span class="line">            contentType:&quot;application/json;charset=UTF-8&quot;,</span><br><span class="line">            data:&apos;&#123;&quot;uname&quot;:&quot;kid&quot;,&quot;uage&quot;:18&#125;&apos;,</span><br><span class="line">            dataType:&quot;json&quot;,</span><br><span class="line">            type:&quot;post&quot;,</span><br><span class="line">            success:function (data) &#123;</span><br><span class="line">                alert(data.uname);</span><br><span class="line">                alert(data.uage);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;)</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">    </span><br><span class="line">controller æ‰§è¡Œ</span><br><span class="line">// testAjax</span><br><span class="line">@RequestMapping(&quot;/testAjax&quot;)</span><br><span class="line">public @ResponseBody User testAjax(@RequestBody User user)&#123;</span><br><span class="line">System.out.println(&quot;ajax data å·²æ”¶åˆ°...&quot;);</span><br><span class="line">System.out.println(user);</span><br><span class="line">user.setUname(&quot;kid1999&quot;);</span><br><span class="line">return user;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">æ³¨æ„ï¼šajaxæ•°æ®ä¼ è¾“ä½¿ç”¨çš„æ˜¯json springmvcå¯¹jsonä¼ è¾“çš„å°è£…ï¼Œä½¿ç”¨çš„jacksonåŒ…ï¼ˆéœ€è¦æå‰å¯¼å…¥ï¼‰</span><br></pre></td></tr></table></figure><h4 id="6-ä¼ ç»Ÿæ–‡ä»¶ä¸Šä¼ "><a href="#6-ä¼ ç»Ÿæ–‡ä»¶ä¸Šä¼ " class="headerlink" title="6. ä¼ ç»Ÿæ–‡ä»¶ä¸Šä¼ "></a>6. ä¼ ç»Ÿæ–‡ä»¶ä¸Šä¼ </h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">1.å‰ç«¯ è®¾ç½®</span><br><span class="line">&lt;form action=&quot;fileupload&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;</span><br><span class="line">    é€‰æ‹©æ–‡ä»¶ï¼š&lt;input type=&quot;file&quot; name=&quot;upload&quot;&gt;&lt;br&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; value=&quot;upload&quot;&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">2.åç«¯æ¥æ”¶</span><br><span class="line">@RequestMapping(&quot;/fileupload&quot;)</span><br><span class="line">  public String fileupload(HttpServletRequest request) throws Exception &#123;</span><br><span class="line">    System.out.println(&quot;upload success...&quot;);</span><br><span class="line">    // ä½¿ç”¨fileuploadç»„ä»¶å®Œæˆæ–‡ä»¶ä¸Šä¼ </span><br><span class="line">    // ä¸Šä¼ çš„ä½ç½®</span><br><span class="line">    String path = request.getSession().getServletContext().getRealPath(&quot;/upload/&quot;);</span><br><span class="line">    // åˆ¤æ–­è·¯å¾„æ˜¯å¦å­˜åœ¨</span><br><span class="line">    File file = new File(path);</span><br><span class="line">    if(!file.exists())&#123;</span><br><span class="line">      // åˆ›å»ºæ–‡ä»¶å¤¹</span><br><span class="line">      file.mkdirs();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // è§£ærequestå¯¹è±¡ è·å–æ–‡ä»¶ä¸Šä¼ é¡¹</span><br><span class="line">    DiskFileItemFactory factory = new DiskFileItemFactory();</span><br><span class="line">    ServletFileUpload upload = new ServletFileUpload(factory);</span><br><span class="line">    // è§£ærequest</span><br><span class="line">    List&lt;FileItem&gt; items = upload.parseRequest(request);</span><br><span class="line">    // éå†</span><br><span class="line">    for (FileItem item:items) &#123;</span><br><span class="line">      // åˆ¤æ–­ï¼Œå½“å‰itemå¯¹è±¡æ˜¯å¦æ˜¯ä¸Šä¼ æ–‡ä»¶é¡¹</span><br><span class="line">      if(item.isFormField())&#123;</span><br><span class="line">        // æ™®é€šè¡¨å•</span><br><span class="line">      &#125;else &#123;</span><br><span class="line">        String filename = item.getName();</span><br><span class="line">        // æ–‡ä»¶åè®¾ç½® å”¯ä¸€å€¼</span><br><span class="line">        String uuid = UUID.randomUUID().toString().replace(&quot;-&quot;,&quot;&quot;);</span><br><span class="line">        filename = uuid + &quot;_&quot; + filename;</span><br><span class="line">        item.write(new File(path,filename));  // å®Œæˆæ–‡ä»¶ä¸Šä¼ </span><br><span class="line">        item.delete();  //æ¸…ç©ºä¸´æ—¶ç¼“å­˜</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return &quot;success&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  æ³¨æ„ï¼š éœ€è¦ä¾èµ–commons-ioå’Œfileuploadç»„ä»¶</span><br></pre></td></tr></table></figure><h4 id="7-SpringMVCçš„æ–‡ä»¶ä¸Šä¼ "><a href="#7-SpringMVCçš„æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="7. SpringMVCçš„æ–‡ä»¶ä¸Šä¼ "></a>7. SpringMVCçš„æ–‡ä»¶ä¸Šä¼ </h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">1.å‰ç«¯</span><br><span class="line">&lt;form action=&quot;/springmvcUpload&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;</span><br><span class="line">    é€‰æ‹©æ–‡ä»¶ï¼š&lt;input type=&quot;file&quot; name=&quot;upload&quot;&gt;&lt;br&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; value=&quot;upload&quot;&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">2.åç«¯SpringMVCå¤„ç†</span><br><span class="line">// SpringMVCæ–‡ä»¶ä¸Šä¼ </span><br><span class="line">  @RequestMapping(&quot;/springmvcUpload&quot;)</span><br><span class="line">  public String springmvcUpload (HttpServletRequest request,MultipartFile upload) throws IOException &#123;</span><br><span class="line">    System.out.println(&quot;upload success...&quot;);</span><br><span class="line">    // å…ˆç”¨</span><br><span class="line">    String path = request.getSession().getServletContext().getRealPath(&quot;/upload/&quot;);</span><br><span class="line">    File file = new File(path);</span><br><span class="line">    if(!file.exists()) file.mkdirs();</span><br><span class="line">    String uuid = UUID.randomUUID().toString().replace(&quot;-&quot;,&quot;&quot;);</span><br><span class="line">    String filename = upload.getOriginalFilename();</span><br><span class="line">    filename = uuid + &quot;_&quot; + filename;</span><br><span class="line">    upload.transferTo(new File(path,filename));</span><br><span class="line">    return &quot;success&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line"> 3.SpringMVC.xml</span><br><span class="line"> &lt;!--é…ç½®æ–‡ä»¶è§£æå™¨å¯¹è±¡--&gt;</span><br><span class="line">&lt;bean id=&quot;multipartResolver&quot; class=&quot;org.springframework.web.multipart.commons.CommonsMultipartResolver&quot;&gt;</span><br><span class="line">    &lt;property name=&quot;maxUploadSize&quot; value= &quot;10485760&quot;&gt;&lt;/property&gt;</span><br><span class="line">&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">æ³¨æ„ï¼šå‰ç«¯inputçš„name å¯¹åº”åç«¯ MultipartFile çš„å‚æ•°å</span><br></pre></td></tr></table></figure><h4 id="8-è·¨æœåŠ¡å™¨æ–‡ä»¶ä¸Šä¼ -ï¼ˆç•¥ï¼‰"><a href="#8-è·¨æœåŠ¡å™¨æ–‡ä»¶ä¸Šä¼ -ï¼ˆç•¥ï¼‰" class="headerlink" title="8. è·¨æœåŠ¡å™¨æ–‡ä»¶ä¸Šä¼   ï¼ˆç•¥ï¼‰"></a>8. è·¨æœåŠ¡å™¨æ–‡ä»¶ä¸Šä¼   ï¼ˆç•¥ï¼‰</h4><h4 id="9-å¼‚å¸¸å¤„ç†"><a href="#9-å¼‚å¸¸å¤„ç†" class="headerlink" title="9. å¼‚å¸¸å¤„ç†"></a>9. å¼‚å¸¸å¤„ç†</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">    1.ç¼–å†™è‡ªå®šä¹‰å¼‚å¸¸ç±»ï¼Œåšæç¤ºä¿¡æ¯ SysException</span><br><span class="line">public class SysException extends Exception&#123;</span><br><span class="line">  // å­˜å‚¨æç¤ºä¿¡æ¯</span><br><span class="line">  private String message;</span><br><span class="line">  @Override</span><br><span class="line">  public String getMessage() &#123;</span><br><span class="line">    return message;</span><br><span class="line">  &#125;</span><br><span class="line">  public void setMessage(String message) &#123;</span><br><span class="line">    this.message = message;</span><br><span class="line">  &#125;</span><br><span class="line">  public SysException(String message) &#123;</span><br><span class="line">    this.message = message;</span><br><span class="line">  &#125;</span><br><span class="line">  public SysException() &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">    2.ç¼–å†™å¼‚å¸¸å¤„ç†å™¨ å®ç° HandlerExceptionResolver</span><br><span class="line">public class SysExceptionSolver implements HandlerExceptionResolver &#123;</span><br><span class="line">  // å¤„ç†ä¸šåŠ¡é€»è¾‘</span><br><span class="line">  @Override</span><br><span class="line">  public ModelAndView resolveException(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o, Exception e) &#123;</span><br><span class="line">    // è·å–å¼‚å¸¸å¯¹è±¡</span><br><span class="line">    SysException ex = null;</span><br><span class="line">    if(e instanceof SysException) ex = (SysException)e;</span><br><span class="line">    else ex = new SysException(&quot;ç³»ç»Ÿæ­£åœ¨ç»´æŠ¤....&quot;);</span><br><span class="line">    // åˆ›å»ºModelAndViewå¯¹è±¡</span><br><span class="line">    ModelAndView mv = new ModelAndView();</span><br><span class="line">    mv.addObject(&quot;message&quot;,ex.getMessage());</span><br><span class="line">    mv.setViewName(&quot;error&quot;);    //è·³è½¬</span><br><span class="line">    return mv;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">    3.é…ç½®å¼‚å¸¸å¤„ç†å™¨ bean</span><br><span class="line">    &lt;!--é…ç½®å¼‚å¸¸å¤„ç†å™¨--&gt;</span><br><span class="line">&lt;bean id=&quot;sysExceptionSolver&quot; class=&quot;code.Exception.SysExceptionSolver&quot;/&gt;</span><br><span class="line"></span><br><span class="line">æµç¨‹ï¼š ä¸ŠæŠ›é”™è¯¯åˆ°å‰ç«¯æ§åˆ¶å™¨ï¼Œè‡ªå®šä¹‰å¼‚å¸¸å¤„ç†å™¨å¤„ç†å¼‚å¸¸ã€‚</span><br><span class="line">ä½¿ç”¨æ—¶ä¸ŠæŠ›åˆ°è¯¥é”™è¯¯ï¼š</span><br><span class="line"> public String testError() throws SysException&#123; // ä¸ŠæŠ›å¼‚å¸¸</span><br><span class="line">    System.out.println(&quot;å¼‚å¸¸æµ‹è¯•&quot;);</span><br><span class="line">    try &#123;</span><br><span class="line">      int a = 10/0;</span><br><span class="line">    &#125; catch (Exception e) &#123;</span><br><span class="line">      // æ§åˆ¶å°æ‰“å°</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">      // æŠ›å‡ºè‡ªå®šä¹‰å¼‚å¸¸ä¿¡æ¯</span><br><span class="line">      throw new SysException(&quot;æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·å‡ºç°é”™è¯¯ã€‚ã€‚&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    return &quot;success&quot;;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h4 id="10-SpringMVCæ‹¦æˆªå™¨"><a href="#10-SpringMVCæ‹¦æˆªå™¨" class="headerlink" title="10. SpringMVCæ‹¦æˆªå™¨"></a>10. SpringMVCæ‹¦æˆªå™¨</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">1.ç¼–å†™æ‹¦æˆªå™¨ï¼Œå®ç°HandlerIntercepter</span><br><span class="line">public class myIntercepter implements HandlerInterceptor &#123;</span><br><span class="line">  // é¢„å¤„ç†ï¼Œcontroller æ–¹æ³•ä¹‹å‰</span><br><span class="line">  // return true æ”¾è¡Œã€‚ã€‚</span><br><span class="line">  // return false ä¸æ”¾è¡Œ</span><br><span class="line">  @Override</span><br><span class="line">  public boolean preHandle(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o) throws Exception &#123;</span><br><span class="line">    System.out.println(&quot;preHandleæ‹¦æˆªå™¨å·²ç”Ÿæ•ˆã€‚ã€‚ã€‚&quot;);</span><br><span class="line">    return true;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // é¢„å¤„ç†ï¼Œcontroller æ–¹æ³•ä¹‹åï¼Œwebé¡µé¢ä¹‹å‰</span><br><span class="line">  @Override</span><br><span class="line">  public void postHandle(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o, ModelAndView modelAndView) throws Exception &#123;</span><br><span class="line">//    ç›´æ¥åšè¯·æ±‚è½¬å‘</span><br><span class="line">    //    httpServletRequest.getRequestDispatcher(&quot;&quot;).forward(httpServletRequest,httpServletResponse);</span><br><span class="line">  &#125;</span><br><span class="line">  // é¢„å¤„ç†ï¼Œwebé¡µé¢ä¹‹å æœ€åçš„æ–¹æ³•</span><br><span class="line">  @Override</span><br><span class="line">  public void afterCompletion(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o, Exception e) throws Exception &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">2.é…ç½®æ‹¦æˆªå™¨</span><br><span class="line">&lt;!--é…ç½®æ‹¦æˆªå™¨--&gt;</span><br><span class="line">&lt;mvc:interceptors&gt;</span><br><span class="line">    &lt;!--é…ç½®å•ä¸ª--&gt;</span><br><span class="line">    &lt;mvc:interceptor&gt;</span><br><span class="line">        &lt;!--æ‹¦æˆªè·¯å¾„--&gt;</span><br><span class="line">        &lt;mvc:mapping path=&quot;/*&quot;/&gt;</span><br><span class="line">        &lt;!--ä¸æ‹¦æˆª--&gt;</span><br><span class="line">        &lt;!--&lt;mvc:exclude-mapping path=&quot;&quot;/&gt;--&gt;</span><br><span class="line">        &lt;!--é…ç½®bean--&gt;</span><br><span class="line">        &lt;bean class=&quot;code.intercepter.myIntercepter&quot;/&gt;</span><br><span class="line">    &lt;/mvc:interceptor&gt;</span><br><span class="line">&lt;/mvc:interceptors&gt;</span><br></pre></td></tr></table></figure><h3 id="4-SSMæ•´åˆã€‚ã€‚"><a href="#4-SSMæ•´åˆã€‚ã€‚" class="headerlink" title="4.SSMæ•´åˆã€‚ã€‚"></a>4.SSMæ•´åˆã€‚ã€‚</h3>]]></content>
      
      
      <categories>
          
          <category> Java web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hello world </tag>
            
            <tag> SpringMVC </tag>
            
            <tag> WEB </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring åŸºç¡€çŸ¥è¯†ç‚¹</title>
      <link href="/2019/11/25/Spring%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E7%82%B9/"/>
      <url>/2019/11/25/Spring%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E7%82%B9/</url>
      
        <content type="html"><![CDATA[<h1 id="Springæ¡†æ¶"><a href="#Springæ¡†æ¶" class="headerlink" title="Springæ¡†æ¶"></a>Springæ¡†æ¶</h1><ul><li>Springæ¡†æ¶æ˜¯ç”±äºè½¯ä»¶å¼€å‘çš„å¤æ‚æ€§è€Œåˆ›å»ºçš„ã€‚Springä½¿ç”¨çš„æ˜¯åŸºæœ¬çš„JavaBeanæ¥å®Œæˆä»¥å‰åªå¯èƒ½ç”±EJBå®Œæˆçš„äº‹æƒ…ã€‚ç„¶è€Œï¼ŒSpringçš„ç”¨é€”ä¸ä»…ä»…é™äºæœåŠ¡å™¨ç«¯çš„å¼€å‘ã€‚ä»ç®€å•æ€§ã€å¯æµ‹è¯•æ€§å’Œæ¾è€¦åˆæ€§è§’åº¦è€Œè¨€ï¼Œç»å¤§éƒ¨åˆ†Javaåº”ç”¨éƒ½å¯ä»¥ä»Springä¸­å—ç›Šã€‚</li><li>æ§åˆ¶åè½¬</li><li>é¢å‘åˆ‡ç‰‡ç¼–ç¨‹</li></ul><h2 id="IOC-æ§åˆ¶åè½¬"><a href="#IOC-æ§åˆ¶åè½¬" class="headerlink" title="IOC æ§åˆ¶åè½¬"></a>IOC æ§åˆ¶åè½¬</h2><p>å°†new å¯¹è±¡çš„ï¼ˆåˆ›å»ºï¼Œç®¡ç†ï¼Œé”€æ¯..ï¼‰ä»»åŠ¡äº¤ç»™ Springå»ç®¡ç†ï¼Œç¨‹åºå‘˜åªéœ€è¦å»è®¾ç½®beanæˆ–è€…æ³¨è§£ï¼Œç„¶åç”³è¯·ä½¿ç”¨å³å¯</p><h2 id="DI-è¾…åŠ©IOC"><a href="#DI-è¾…åŠ©IOC" class="headerlink" title="DI è¾…åŠ©IOC"></a>DI è¾…åŠ©IOC</h2><p>å¯¹IOCçš„ä¾èµ–è¿›è¡Œæ³¨å…¥</p><h4 id="beançš„ä¸‰ç§åˆ›å»ºæ¨¡å¼ï¼š"><a href="#beançš„ä¸‰ç§åˆ›å»ºæ¨¡å¼ï¼š" class="headerlink" title="beançš„ä¸‰ç§åˆ›å»ºæ¨¡å¼ï¼š"></a>beançš„ä¸‰ç§åˆ›å»ºæ¨¡å¼ï¼š</h4><pre><code>1.ç©ºå‚æ„é€ 2.é™æ€å·¥å‚3.åŠ¨æ€å·¥å‚</code></pre><h2 id="XMLé…ç½®æ¨¡å¼ï¼š"><a href="#XMLé…ç½®æ¨¡å¼ï¼š" class="headerlink" title="XMLé…ç½®æ¨¡å¼ï¼š"></a>XMLé…ç½®æ¨¡å¼ï¼š</h2><h3 id="beanæ ‡ç­¾çš„åŸºæœ¬é…ç½®"><a href="#beanæ ‡ç­¾çš„åŸºæœ¬é…ç½®" class="headerlink" title="beanæ ‡ç­¾çš„åŸºæœ¬é…ç½®"></a>beanæ ‡ç­¾çš„åŸºæœ¬é…ç½®</h3><p>å°†éœ€è¦ç»™springç®¡ç†çš„classè¿›è¡Œé…ç½®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">name: è¯¥å¯¹è±¡çš„åå­—ï¼Œä¾›ç»™åé¢ä½¿ç”¨çš„å®šä½ ï¼ˆä¸å»ºè®®é‡å¤ï¼‰</span><br><span class="line">class: ç»™springç®¡ç†çš„ç±»çš„è·¯å¾„</span><br><span class="line">lazy-init: æ‡’åŠ è½½ï¼Œè°ç”¨è°åŠ è½½</span><br><span class="line">scope:  é»˜è®¤ å•ä¾‹æ¨¡å¼ï¼Œåªè°ƒç”¨ä¸€æ¬¡æ„é€ </span><br><span class="line">        prototype: å¤šä¾‹æ¨¡å¼ï¼Œè°ƒç”¨ä¸€æ¬¡ï¼Œæ–°å»ºä¸€æ¬¡å¯¹è±¡</span><br><span class="line">        request</span><br><span class="line">        session  åœ¨webé¡¹ç›®ä¸­ä½¿ç”¨ï¼Œä¸å¯¹åº”çš„r/sç”Ÿå‘½å‘¨æœŸç›¸åŒ</span><br><span class="line">init-method: åˆå§‹åŒ–åè°ƒç”¨çš„ æ–¹æ³•</span><br><span class="line">destroy-method: é”€æ¯å‰è°ƒç”¨çš„æ–¹æ³•</span><br><span class="line"></span><br><span class="line">eg: &lt;bean name = &quot;&quot; class = &quot;&quot; lazy-init = &quot;&quot; scope = &quot; &quot; ....&gt;</span><br></pre></td></tr></table></figure><h3 id="å±æ€§æ³¨å…¥"><a href="#å±æ€§æ³¨å…¥" class="headerlink" title="å±æ€§æ³¨å…¥"></a>å±æ€§æ³¨å…¥</h3><p>ä¸ºbeanå¯¹è±¡æ³¨å…¥ä¾èµ–çš„å€¼</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1.setæ–¹æ³•æ³¨å…¥ï¼š</span><br><span class="line">    1.åŸºæœ¬ç±»å‹æ³¨å…¥ï¼š &lt;property name = &quot;æ³¨å…¥çš„å­—æ®µå&quot; value = &quot; &quot;/&gt; </span><br><span class="line">    2.å¼•ç”¨ç±»å‹æ³¨å…¥ï¼š &lt;property name = &quot;æ³¨å…¥çš„å­—æ®µå&quot; ref = &quot; &quot;(å·²ç»åˆ›å»ºçš„bean çš„name)/&gt;</span><br><span class="line">2.æ„é€ æ–¹æ³•æ³¨å…¥ï¼š&lt;property name = &quot;æ³¨å…¥çš„å­—æ®µå&quot; value = &quot;å€¼&quot; ref = &quot;&quot; type = &quot;æŒ‡å®šå‚æ•°ç±»å‹&quot;  index = &quot;æŒ‡å®šå‚æ•°ç´¢å¼•&quot; /&gt; </span><br><span class="line">3.å¤æ‚ç±»å‹æ³¨å…¥ï¼š</span><br><span class="line">    &lt;property name = &quot;æ³¨å…¥çš„å­—æ®µå&quot;&gt;</span><br><span class="line">        1.list  &lt;list&gt;&lt;value&gt;&lt;/value&gt;&lt;/list&gt;</span><br><span class="line">        2.map   &lt;map&gt;&lt;entry key = &quot;&quot; value = &quot;&quot;&gt;&lt;/map&gt;</span><br><span class="line">    &lt;/property&gt;</span><br></pre></td></tr></table></figure><h2 id="æ³¨è§£å¼€å‘æ¨¡å¼ï¼š"><a href="#æ³¨è§£å¼€å‘æ¨¡å¼ï¼š" class="headerlink" title="æ³¨è§£å¼€å‘æ¨¡å¼ï¼š"></a>æ³¨è§£å¼€å‘æ¨¡å¼ï¼š</h2><h3 id="beanå¯¹è±¡çš„ç®¡ç†ä¸é…ç½®"><a href="#beanå¯¹è±¡çš„ç®¡ç†ä¸é…ç½®" class="headerlink" title="beanå¯¹è±¡çš„ç®¡ç†ä¸é…ç½®"></a>beanå¯¹è±¡çš„ç®¡ç†ä¸é…ç½®</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">åˆ›å»ºbeanå¯¹è±¡ @Component(&quot;name&quot;)</span><br><span class="line">ä¸ºäº†æ›´åŠ ç»†åŒ–ï¼š  1.@Controller(&quot;name&quot;) webå±‚</span><br><span class="line">               2.@Service(&quot;name&quot;) serviceå±‚</span><br><span class="line">               3.@Repository(&quot;name&quot;) daoå±‚</span><br><span class="line">@scope</span><br><span class="line">@init-method</span><br><span class="line">@destroy-method</span><br></pre></td></tr></table></figure><h3 id="å±æ€§æ³¨å…¥-1"><a href="#å±æ€§æ³¨å…¥-1" class="headerlink" title="å±æ€§æ³¨å…¥"></a>å±æ€§æ³¨å…¥</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ç›´æ¥åœ¨setæ–¹æ³•æˆ–è€…æ„é€ æ–¹æ³•ä¸ŠåŠ æ³¨è§£</span><br><span class="line">@valueï¼ˆ&quot;value&quot;ï¼‰ æ³¨å…¥å€¼ç±»å‹</span><br><span class="line">@Autowiredï¼ˆï¼‰æ³¨å…¥å¼•ç”¨ç±»å‹</span><br><span class="line">@Resource(&quot;name&quot;) æ‰‹å·¥è£…é…beançš„name æ³¨å…¥å¼•ç”¨ç±»å‹</span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨Junitæ•´åˆSpringè¿›è¡Œå•å…ƒæµ‹è¯•"><a href="#ä½¿ç”¨Junitæ•´åˆSpringè¿›è¡Œå•å…ƒæµ‹è¯•" class="headerlink" title="ä½¿ç”¨Junitæ•´åˆSpringè¿›è¡Œå•å…ƒæµ‹è¯•"></a>ä½¿ç”¨Junitæ•´åˆSpringè¿›è¡Œå•å…ƒæµ‹è¯•</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">åœ¨æµ‹è¯•ç±»ä¸­ä½¿ç”¨æ³¨è§£</span><br><span class="line">@RunWith(SprngJUnit4ClassRunner.class) //ä½¿ç”¨junitè¿›è¡Œæµ‹è¯•ï¼Œåˆ›å»ºå®¹å™¨</span><br><span class="line">@ContextConfiguration(&quot;classpath:...xml&quot;) // è¯»å–é…ç½®æ–‡ä»¶</span><br><span class="line">åœ¨éœ€è¦çš„æµ‹è¯•æ–¹æ³•ä¸Š</span><br><span class="line">@Test</span><br></pre></td></tr></table></figure><h3 id="å…¶ä»–å†…å®¹"><a href="#å…¶ä»–å†…å®¹" class="headerlink" title="å…¶ä»–å†…å®¹"></a>å…¶ä»–å†…å®¹</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.å¯¼å…¥å…¶ä»–çš„Springé…ç½®æ–‡ä»¶</span><br><span class="line">&lt;import resource = &quot;...xml&quot;/&gt;</span><br></pre></td></tr></table></figure><h2 id="Spring-AOP-é¢å‘åˆ‡é¢ç¼–ç¨‹"><a href="#Spring-AOP-é¢å‘åˆ‡é¢ç¼–ç¨‹" class="headerlink" title="Spring-AOP é¢å‘åˆ‡é¢ç¼–ç¨‹"></a>Spring-AOP é¢å‘åˆ‡é¢ç¼–ç¨‹</h2><p> å°†çºµå‘é‡å¤çš„ä»£ç ï¼Œæ¨ªå‘æŠ½å–è§£å†³  â€” åŸºäºåŠ¨æ€ä»£ç†<br> ï¼ˆAOPæœ¯è¯­è§£é‡Š <a href="https://blog.csdn.net/yuanye348623610/article/details/8823429ï¼‰" target="_blank" rel="noopener">https://blog.csdn.net/yuanye348623610/article/details/8823429ï¼‰</a></p><p> ä¸¤ç§åŠ¨æ€ä»£ç†<br> 1.æ¥å£ â€” 2.ç»§æ‰¿</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">AOPçš„é…ç½®ï¼š</span><br><span class="line">&lt;aop:config&gt;</span><br><span class="line">&lt;!-- åˆ‡å…¥ç‚¹ --&gt;</span><br><span class="line">&lt;aop:pointcut expression = &quot;åˆ‡å…¥ç‚¹è¡¨è¾¾å¼(è¦å¢å¼ºçš„æ–¹æ³•)&quot;  id=&quot;æ ‡è¯†&quot;/&gt;</span><br><span class="line">&lt;!-- åˆ‡é¢ é€šçŸ¥+åˆ‡å…¥ç‚¹ --&gt;</span><br><span class="line">&lt;aop:aspect ref=&quot;é€šçŸ¥&quot;&gt;</span><br><span class="line">&lt;aop:before method=&quot;æ–¹æ³•å&quot; pointcut-ref = &quot;ä»£ç†å¯¹è±¡&quot;/&gt; æœ€ç»ˆé€šçŸ¥</span><br><span class="line">&lt;aop:after...&gt; å‰ç½®é€šçŸ¥</span><br><span class="line">&lt;aop:after-returning...&gt; æˆåŠŸé€šçŸ¥</span><br><span class="line">&lt;aop:after-throwing..&gt; å¼‚å¸¸é€šçŸ¥</span><br><span class="line">&lt;aop:around...&gt; ç¯ç»•æ´»åŠ¨</span><br><span class="line">&lt;/aop:aspect&gt; </span><br><span class="line"></span><br><span class="line">&lt;/aop:config&gt;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Java web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hello world </tag>
            
            <tag> Spring </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TypeScriptå°è¯•</title>
      <link href="/2019/11/25/TypeScript%E5%B0%9D%E8%AF%95/"/>
      <url>/2019/11/25/TypeScript%E5%B0%9D%E8%AF%95/</url>
      
        <content type="html"><![CDATA[<h2 id="1-å®‰è£…nodejs"><a href="#1-å®‰è£…nodejs" class="headerlink" title="1.å®‰è£…nodejs"></a>1.å®‰è£…nodejs</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">node -v</span><br><span class="line">npm -v</span><br></pre></td></tr></table></figure><h2 id="2-å®‰è£…TypeScriptåŒ…"><a href="#2-å®‰è£…TypeScriptåŒ…" class="headerlink" title="2.å®‰è£…TypeScriptåŒ…"></a>2.å®‰è£…TypeScriptåŒ…</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install typescript -g</span><br><span class="line">tsc --version</span><br></pre></td></tr></table></figure><h2 id="3-ç¼–å†™HelloWorldç¨‹åº"><a href="#3-ç¼–å†™HelloWorldç¨‹åº" class="headerlink" title="3.ç¼–å†™HelloWorldç¨‹åº"></a>3.ç¼–å†™HelloWorldç¨‹åº</h2><ol><li><p>åˆå§‹åŒ–é¡¹ç›®ï¼šè¿›å…¥ä½ çš„ç¼–ç¨‹æ–‡ä»¶å¤¹åï¼Œå¯ä»¥ä½¿ç”¨ <code>npm init -y</code> æ¥åˆå§‹åŒ–é¡¹ç›®ï¼Œç”Ÿæˆpackage.jsonæ–‡ä»¶ã€‚</p></li><li><p>åˆ›å»ºtsconfig.jsonæ–‡ä»¶ï¼Œåœ¨ç»ˆç«¯ä¸­è¾“å…¥ <code>tsc --init</code> ï¼šå®ƒæ˜¯ä¸€ä¸ªTypeScripté¡¹ç›®çš„é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥é€šè¿‡è¯»å–å®ƒæ¥è®¾ç½®TypeScriptç¼–è¯‘å™¨çš„ç¼–è¯‘å‚æ•°ã€‚</p></li><li><p>å®‰è£…@types/node,ä½¿ç”¨ <code>npm install @types/node --dev-save</code>è¿›è¡Œå®‰è£…ã€‚è¿™ä¸ªä¸»è¦æ˜¯è§£å†³æ¨¡å—çš„å£°æ˜æ–‡ä»¶é—®é¢˜ã€‚</p></li><li><p>ç¼–å†™HelloWorld.tsæ–‡ä»¶ï¼Œç„¶åè¿›è¡Œä¿å­˜ï¼Œä»£ç å¦‚ä¸‹ã€‚</p></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var a:string = &quot;HelloWorld&quot;</span><br><span class="line">console.log(a)</span><br></pre></td></tr></table></figure><ol start="5"><li><p>åœ¨Vscodeçš„ä»»åŠ¡èœå•ä¸‹ï¼Œæ‰“å¼€è¿è¡Œç”Ÿæˆä»»åŠ¡ï¼Œç„¶åé€‰æ‹©tscï¼šæ„å»º-tsconfig.jsonï¼Œè¿™æ—¶å€™å°±ä¼šç”Ÿæˆä¸€ä¸ªhelloWorld.jsæ–‡ä»¶</p></li><li><p>åœ¨ç»ˆç«¯ä¸­è¾“å…¥ <code>node helloWorld.js</code> å°±å¯ä»¥çœ‹åˆ°ç»“æœäº†ã€‚</p></li></ol><p><a href="https://jspang.com/" target="_blank" rel="noopener">æ›´å¤šæŠ€æœ¯ä¿¡æ¯ å‚è€ƒæŠ€æœ¯èƒ–Blog</a></p>]]></content>
      
      
      <categories>
          
          <category> TypeScript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hello world </tag>
            
            <tag> TypeScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Goåˆè¯• å…­</title>
      <link href="/2019/11/24/Go%E5%88%9D%E8%AF%95%E5%85%AD/"/>
      <url>/2019/11/24/Go%E5%88%9D%E8%AF%95%E5%85%AD/</url>
      
        <content type="html"><![CDATA[<h1 id="Goè¯­è¨€å…¥é—¨å°è¯•-å…­"><a href="#Goè¯­è¨€å…¥é—¨å°è¯•-å…­" class="headerlink" title="Goè¯­è¨€å…¥é—¨å°è¯•  å…­"></a>Goè¯­è¨€å…¥é—¨å°è¯•  å…­</h1><ul><li>Goï¼ˆåˆç§° Golangï¼‰æ˜¯ Google çš„ Robert Griesemerï¼ŒRob Pike åŠ Ken Thompson å¼€å‘çš„ä¸€ç§é™æ€å¼ºç±»å‹ã€ç¼–è¯‘å‹è¯­è¨€ã€‚Go è¯­è¨€è¯­æ³•ä¸ C ç›¸è¿‘ï¼Œä½†åŠŸèƒ½ä¸Šæœ‰ï¼šå†…å­˜å®‰å…¨ï¼ŒGCï¼ˆåƒåœ¾å›æ”¶ï¼‰ï¼Œç»“æ„å½¢æ€åŠ CSP-style å¹¶å‘è®¡ç®—ã€‚</li></ul><h2 id="1-Goè¯­è¨€çš„åç¨‹æœºåˆ¶"><a href="#1-Goè¯­è¨€çš„åç¨‹æœºåˆ¶" class="headerlink" title="1.Goè¯­è¨€çš„åç¨‹æœºåˆ¶"></a>1.Goè¯­è¨€çš„åç¨‹æœºåˆ¶</h2><ul><li>åç¨‹ç»†åŒ–äºçº¿ç¨‹<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">package ch16</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">&quot;fmt&quot;</span><br><span class="line">&quot;testing&quot;</span><br><span class="line">&quot;time&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func TestGroutine(t *testing.T)  &#123;</span><br><span class="line">for i:=0;i&lt;10;i++&#123;</span><br><span class="line">go func(i int) &#123;//go å¯åŠ¨ä¸€ä¸ªåç¨‹</span><br><span class="line">fmt.Println(i)</span><br><span class="line">&#125;(i)</span><br><span class="line">time.Sleep(time.Millisecond*50)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="2-é€šè¿‡å…±äº«å†…å­˜å®ç°åç¨‹é€šè®¯"><a href="#2-é€šè¿‡å…±äº«å†…å­˜å®ç°åç¨‹é€šè®¯" class="headerlink" title="2. é€šè¿‡å…±äº«å†…å­˜å®ç°åç¨‹é€šè®¯"></a>2. é€šè¿‡å…±äº«å†…å­˜å®ç°åç¨‹é€šè®¯</h2><ul><li>é€šè¿‡åŒäº«èµ„æº ä¸Šé”ï¼Œç­‰å¾…çš„æ–¹å¼ å®ç°åç¨‹çš„æœ‰åºæ‰§è¡Œ<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">package ch17</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">&quot;sync&quot;</span><br><span class="line">&quot;testing&quot;</span><br><span class="line">&quot;time&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">å…±äº«å†…å­˜çš„å¹¶å‘æœºåˆ¶</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">// çº¿ç¨‹ä¸å®‰å…¨çš„</span><br><span class="line">func TestCounterThread(t *testing.T)  &#123;</span><br><span class="line">counter := 0// å­˜åœ¨ç«äº‰</span><br><span class="line">for i:=0;i&lt;5000;i++&#123;</span><br><span class="line">go func() &#123;</span><br><span class="line">counter++</span><br><span class="line">&#125;()</span><br><span class="line">&#125;</span><br><span class="line">time.Sleep(time.Second)</span><br><span class="line">t.Log(&quot;counter = &quot;,counter)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// åŠ é”çº¿ç¨‹å®‰å…¨</span><br><span class="line">func TestCounterThreadSafe(t *testing.T)  &#123;</span><br><span class="line">var mut sync.Mutex</span><br><span class="line">counter := 0// å­˜åœ¨ç«äº‰</span><br><span class="line">for i:=0;i&lt;5000;i++&#123;</span><br><span class="line">go func() &#123;</span><br><span class="line">defer func() &#123;mut.Unlock()&#125;()//è¿›ç¨‹é”™è¯¯æ—¶é‡Šæ”¾èµ„æº</span><br><span class="line">mut.Lock()// åŠ é”</span><br><span class="line">counter++</span><br><span class="line">&#125;()</span><br><span class="line">&#125;</span><br><span class="line">time.Sleep(time.Second)// ç­‰å¾…å†…éƒ¨çº¿ç¨‹æ‰§è¡Œå®Œ</span><br><span class="line">t.Log(&quot;counter = &quot;,counter)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// ç­‰å¾…å­çº¿ç¨‹è¿è¡Œå®Œ  ç±»ä¼¼ join</span><br><span class="line">func TestCounterThreadWaitGroup(t *testing.T)  &#123;</span><br><span class="line">var mut sync.Mutex</span><br><span class="line">var wg sync.WaitGroup</span><br><span class="line">counter := 0// å­˜åœ¨ç«äº‰</span><br><span class="line">for i:=0;i&lt;5000;i++&#123;</span><br><span class="line">wg.Add(1)// å¼€å§‹ç­‰å¾…</span><br><span class="line">go func() &#123;</span><br><span class="line">defer func() &#123;mut.Unlock()&#125;()//è¿›ç¨‹é”™è¯¯æ—¶é‡Šæ”¾èµ„æº</span><br><span class="line">mut.Lock()// åŠ é”</span><br><span class="line">counter++</span><br><span class="line">wg.Done()//ç­‰å¾…ç»“æŸ</span><br><span class="line">&#125;()</span><br><span class="line">&#125;</span><br><span class="line">wg.Wait()//ç­‰å¾…</span><br><span class="line">t.Log(&quot;counter = &quot;,counter)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="3-ä½¿ç”¨channelçš„æ–¹å¼å®ç°åç¨‹çš„é€šè®¯"><a href="#3-ä½¿ç”¨channelçš„æ–¹å¼å®ç°åç¨‹çš„é€šè®¯" class="headerlink" title="3.ä½¿ç”¨channelçš„æ–¹å¼å®ç°åç¨‹çš„é€šè®¯"></a>3.ä½¿ç”¨channelçš„æ–¹å¼å®ç°åç¨‹çš„é€šè®¯</h2><ul><li>channel åˆ†ä¸¤ç§é˜Ÿåˆ—ä¸ç­‰å¾… å’Œ ç‰µæ‰‹ç­‰å¾… ï¼ˆchannelçš„å®¹é‡å†³å®šï¼‰</li><li>æ­¤æ¬¡æ¨¡æ‹Ÿä¸€ä¸ªç”Ÿäº§æ¶ˆè´¹æ¨¡å‹</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">package ch17</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">&quot;fmt&quot;</span><br><span class="line">&quot;testing&quot;</span><br><span class="line">&quot;time&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">//  ä¸²è¡Œ è¿è¡Œä¸¤ä¸ªä»»åŠ¡</span><br><span class="line">func service() string  &#123;</span><br><span class="line">time.Sleep(time.Millisecond *50)</span><br><span class="line">return &quot;Done&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//å¹¶è¡Œè¿è¡Œä¸¤ä¸ªåç¨‹  é€šè¿‡ channel  é€šè®¯</span><br><span class="line">func AsyncService() chan string &#123;</span><br><span class="line">rerch := make(chan string,1)// buffer channel æ¶ˆæ¯é˜Ÿåˆ—</span><br><span class="line">go func() &#123;</span><br><span class="line">ret := service()</span><br><span class="line">fmt.Println(&quot;returned result.&quot;)</span><br><span class="line">rerch &lt;- ret// å¦‚æœæ˜¯æ™®é€šchannel serviceå‘é€æ•°æ®åä¼šç­‰å¾…otheræ‹¿èµ°æ•°æ®</span><br><span class="line">fmt.Println(&quot;service exited.&quot;)</span><br><span class="line">&#125;()</span><br><span class="line">return rerch</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// å…¶ä»–ä»»åŠ¡</span><br><span class="line">func otherTask()  &#123;</span><br><span class="line">fmt.Println(&quot;work on someting else&quot;)</span><br><span class="line">time.Sleep(time.Millisecond *100)</span><br><span class="line">fmt.Println(&quot;Task is Done.&quot;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func TestService(t *testing.T)  &#123;</span><br><span class="line">//fmt.Println(service())</span><br><span class="line">retch := AsyncService()</span><br><span class="line">otherTask()</span><br><span class="line">fmt.Println(&lt;-retch)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-select-è¯­å¥"><a href="#4-select-è¯­å¥" class="headerlink" title="4.select è¯­å¥"></a>4.select è¯­å¥</h2><ul><li><p>select æ˜¯ Go ä¸­çš„ä¸€ä¸ªæ§åˆ¶ç»“æ„ï¼Œç±»ä¼¼äºç”¨äºé€šä¿¡çš„ switch è¯­å¥ã€‚æ¯ä¸ª case å¿…é¡»æ˜¯ä¸€ä¸ªé€šä¿¡æ“ä½œï¼Œè¦ä¹ˆæ˜¯å‘é€è¦ä¹ˆæ˜¯æ¥æ”¶ã€‚</p></li><li><p>select éšæœºæ‰§è¡Œä¸€ä¸ªå¯è¿è¡Œçš„ caseã€‚å¦‚æœæ²¡æœ‰ case å¯è¿è¡Œï¼Œå®ƒå°†é˜»å¡ï¼Œç›´åˆ°æœ‰ case å¯è¿è¡Œã€‚ä¸€ä¸ªé»˜è®¤çš„å­å¥åº”è¯¥æ€»æ˜¯å¯è¿è¡Œçš„ã€‚</p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">package ch18</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">&quot;fmt&quot;</span><br><span class="line">&quot;testing&quot;</span><br><span class="line">&quot;time&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">func service() string  &#123;</span><br><span class="line">time.Sleep(time.Millisecond *500)</span><br><span class="line">return &quot;Done&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func AsyncService() chan string &#123;</span><br><span class="line">rerch := make(chan string,1)// buffer channel æ¶ˆæ¯é˜Ÿåˆ—</span><br><span class="line">go func() &#123;</span><br><span class="line">ret := service()</span><br><span class="line">fmt.Println(&quot;returned result.&quot;)</span><br><span class="line">rerch &lt;- ret// å¦‚æœæ˜¯æ™®é€šchannel serviceå‘é€æ•°æ®åä¼šç­‰å¾…otheræ‹¿èµ°æ•°æ®</span><br><span class="line">fmt.Println(&quot;service exited.&quot;)</span><br><span class="line">&#125;()</span><br><span class="line">return rerch</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">func TestService(t *testing.T)  &#123;</span><br><span class="line">select &#123;</span><br><span class="line">case ret := &lt;-AsyncService():</span><br><span class="line">t.Log(ret)</span><br><span class="line">case &lt;-time.After(time.Millisecond *100):// è¶…æ—¶ç›´æ¥ gg</span><br><span class="line">t.Error(&quot;time out&quot;)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="5-channel-çš„é€€å‡º"><a href="#5-channel-çš„é€€å‡º" class="headerlink" title="5.channel çš„é€€å‡º"></a>5.channel çš„é€€å‡º</h2><ul><li>ç”Ÿäº§è€…ä½¿ç”¨ close å…³é—­åç¨‹</li><li>å½“ åç¨‹ç»“æŸæ—¶ï¼Œä½¿ç”¨ WaitGroup Done é€šçŸ¥æ¶ˆè´¹è€…åç¨‹å…³é—­</li><li>ä¸»è¿›ç¨‹ç­‰å¾…æ‰€æœ‰Doneåç»“æŸ</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">package ch19</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">&quot;fmt&quot;</span><br><span class="line">&quot;sync&quot;</span><br><span class="line">&quot;testing&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// ç”Ÿäº§è€…</span><br><span class="line">func dataProducer(ch chan int,wg *sync.WaitGroup)  &#123;</span><br><span class="line">go func() &#123;</span><br><span class="line">for i:=0;i&lt;10 ;i++  &#123;</span><br><span class="line">ch &lt;- i</span><br><span class="line">&#125;</span><br><span class="line">close(ch)// å…³é—­ chanel</span><br><span class="line">wg.Done()</span><br><span class="line">&#125;()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// æ¶ˆè´¹è€…</span><br><span class="line">func dataReceiver(ch chan int,wg *sync.WaitGroup)&#123;</span><br><span class="line">go func() &#123;</span><br><span class="line">for&#123;</span><br><span class="line">if data,ok := &lt;-ch;ok&#123;// åœ¨channelæ—¶ é€€å‡º</span><br><span class="line">fmt.Println(data)</span><br><span class="line">&#125;else &#123;</span><br><span class="line">break</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">wg.Done()</span><br><span class="line">&#125;()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func TestCloseChannel(t *testing.T)  &#123;</span><br><span class="line">var wg sync.WaitGroup</span><br><span class="line">ch := make(chan int)</span><br><span class="line">wg.Add(1)</span><br><span class="line">dataProducer(ch,&amp;wg)</span><br><span class="line">wg.Add(1)</span><br><span class="line">dataReceiver(ch,&amp;wg)</span><br><span class="line">wg.Wait()//ç­‰å¾…ä¸¤ä¸ªåç¨‹ç»“æŸ</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> GoLang </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Go </tag>
            
            <tag> å¹¶å‘ç¼–ç¨‹ </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Goåˆè¯•äº”</title>
      <link href="/2019/11/24/Go%E5%88%9D%E8%AF%95%E4%BA%94/"/>
      <url>/2019/11/24/Go%E5%88%9D%E8%AF%95%E4%BA%94/</url>
      
        <content type="html"><![CDATA[<hr><p>title: Goåˆè¯• äº”<br>date: 2019-11-24 23:27:26<br>tags: â€œGoâ€<br>categories: â€œGoLangâ€</p><hr><h1 id="Goè¯­è¨€å…¥é—¨å°è¯•-äº”"><a href="#Goè¯­è¨€å…¥é—¨å°è¯•-äº”" class="headerlink" title="Goè¯­è¨€å…¥é—¨å°è¯•  äº”"></a>Goè¯­è¨€å…¥é—¨å°è¯•  äº”</h1><ul><li>Goï¼ˆåˆç§° Golangï¼‰æ˜¯ Google çš„ Robert Griesemerï¼ŒRob Pike åŠ Ken Thompson å¼€å‘çš„ä¸€ç§é™æ€å¼ºç±»å‹ã€ç¼–è¯‘å‹è¯­è¨€ã€‚Go è¯­è¨€è¯­æ³•ä¸ C ç›¸è¿‘ï¼Œä½†åŠŸèƒ½ä¸Šæœ‰ï¼šå†…å­˜å®‰å…¨ï¼ŒGCï¼ˆåƒåœ¾å›æ”¶ï¼‰ï¼Œç»“æ„å½¢æ€åŠ CSP-style å¹¶å‘è®¡ç®—ã€‚</li></ul><h2 id="1-Goè¯­è¨€ä¸­æœ¬åœ°åŒ…çš„æ„å»ºå’Œä½¿ç”¨"><a href="#1-Goè¯­è¨€ä¸­æœ¬åœ°åŒ…çš„æ„å»ºå’Œä½¿ç”¨" class="headerlink" title="1. Goè¯­è¨€ä¸­æœ¬åœ°åŒ…çš„æ„å»ºå’Œä½¿ç”¨"></a>1. Goè¯­è¨€ä¸­æœ¬åœ°åŒ…çš„æ„å»ºå’Œä½¿ç”¨</h2><ul><li><ol><li>ç”Ÿæˆä¸€ä¸ªæ–æ³¢é‚£å¥‘æ•°åˆ—å‡½æ•°çš„åŒ…  ch15/series/â€¦go<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">package series</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">&quot;errors&quot;</span><br><span class="line">&quot;fmt&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">// åˆå§‹åŒ–å‡½æ•°</span><br><span class="line">func init()  &#123;</span><br><span class="line">fmt.Println(&quot;init...&quot;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func GetFib(n int) ([]int,error) &#123;</span><br><span class="line">if n &lt; 2 || n &gt; 100&#123;</span><br><span class="line">return nil,errors.New(&quot;n should be in [2,100]&quot;)</span><br><span class="line">&#125;</span><br><span class="line">res := []int&#123;1,1&#125;</span><br><span class="line">for i:=2;i&lt;n;i++&#123;</span><br><span class="line">res = append(res,res[i-1]+res[i-2])</span><br><span class="line">&#125;</span><br><span class="line">return res,nil</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol></li><li><p>2.ä½¿ç”¨åˆšåˆšå£°æ˜çš„åŒ…  ch15/client/â€¦go</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">package client</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">&quot;ch15/series&quot;       // å¼•å…¥</span><br><span class="line">&quot;testing&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">// è°ƒç”¨ è‡ªå®šä¹‰çš„åŒ…</span><br><span class="line">func TestPackage(t *testing.T)  &#123;</span><br><span class="line">t.Log(series.GetFib(10))// åŒ…å†…æ–¹æ³•å¿…é¡»æ˜¯å¤§å†™å¼€å¤´ ä¸ç„¶æ— æ³•è¯†åˆ«</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æ³¨æ„æœ‰å‡ ç‚¹ï¼š</p></li><li><p>åŒ…è·¯å¾„ï¼ŒåŒ…å†…æ–¹æ³•åå¿…é¡»å¤§å†™å¼€å¤´â€¦</p></li></ul><h2 id="2-ä½¿ç”¨ç½‘ä¸Šçš„åŒ…"><a href="#2-ä½¿ç”¨ç½‘ä¸Šçš„åŒ…" class="headerlink" title="2.ä½¿ç”¨ç½‘ä¸Šçš„åŒ…"></a>2.ä½¿ç”¨ç½‘ä¸Šçš„åŒ…</h2><ul><li>è¿œç¨‹çš„åŒ…ï¼Œå¤§å¤šæ‰˜ç®¡äº github </li><li>ä½¿ç”¨å‘½ä»¤ go get github.com/ä½œè€…/é¡¹ç›®å</li><li>ä¾‹å¦‚ï¼š go get github.com/emirpasic/Gods<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">package remote_package</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">&quot;fmt&quot;</span><br><span class="line">&quot;github.com/emirpasic/Gods/lists/arraylist&quot;</span><br><span class="line">&quot;testing&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">åŒ…ç®¡ç† è½¯ä»¶ï¼š</span><br><span class="line">dep</span><br><span class="line">golide</span><br><span class="line">go module</span><br><span class="line">ã€‚ã€‚ã€‚</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">func TestRemotePackage(t *testing.T)  &#123;</span><br><span class="line">list := arraylist.New()</span><br><span class="line">a := &apos;a&apos;</span><br><span class="line">for i:=0;i&lt;26;i++&#123;</span><br><span class="line">list.Add(string(a))</span><br><span class="line">a++</span><br><span class="line">&#125;</span><br><span class="line">fmt.Println(list)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Goåˆè¯• å››</title>
      <link href="/2019/11/24/Go%E5%88%9D%E8%AF%95%E5%9B%9B/"/>
      <url>/2019/11/24/Go%E5%88%9D%E8%AF%95%E5%9B%9B/</url>
      
        <content type="html"><![CDATA[<hr><h1 id="Goè¯­è¨€å…¥é—¨å°è¯•-å››"><a href="#Goè¯­è¨€å…¥é—¨å°è¯•-å››" class="headerlink" title="Goè¯­è¨€å…¥é—¨å°è¯•  å››"></a>Goè¯­è¨€å…¥é—¨å°è¯•  å››</h1><ul><li>Goï¼ˆåˆç§° Golangï¼‰æ˜¯ Google çš„ Robert Griesemerï¼ŒRob Pike åŠ Ken Thompson å¼€å‘çš„ä¸€ç§é™æ€å¼ºç±»å‹ã€ç¼–è¯‘å‹è¯­è¨€ã€‚Go è¯­è¨€è¯­æ³•ä¸ C ç›¸è¿‘ï¼Œä½†åŠŸèƒ½ä¸Šæœ‰ï¼šå†…å­˜å®‰å…¨ï¼ŒGCï¼ˆåƒåœ¾å›æ”¶ï¼‰ï¼Œç»“æ„å½¢æ€åŠ CSP-style å¹¶å‘è®¡ç®—ã€‚</li></ul><h2 id="1-Goçš„ç»§æ‰¿"><a href="#1-Goçš„ç»§æ‰¿" class="headerlink" title="1. Goçš„ç»§æ‰¿"></a>1. Goçš„ç»§æ‰¿</h2><ul><li>Go çš„ç»§æ‰¿æ˜¯ä¸å®Œæ•´çš„</li><li>çˆ¶ç±»æ— æ³•è®¿é—®å­ç±»çš„æ•°æ®å’Œæ–¹æ³• ï¼Œåªèƒ½å…¨éƒ¨é‡å†™ è·å¾—æ–°çš„æ–¹æ³•<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">package ch12</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">&quot;fmt&quot;</span><br><span class="line">&quot;testing&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">goçš„ç»§æ‰¿ä¸èƒ½å«åšå®Œæ•´çš„ç»§æ‰¿ï¼š</span><br><span class="line">1. çˆ¶ç±»æ— æ³•è®¿é—®å­ç±»çš„æ•°æ®å’Œæ–¹æ³•  æ— å¤šæ€</span><br><span class="line">2. åªèƒ½å…¨éƒ¨é‡å†™ è·å¾—æ–°çš„æ–¹æ³•</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">// pet ç±»</span><br><span class="line">type Pet struct &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func (p *Pet) Speak()&#123;</span><br><span class="line">fmt.Print(&quot;....&quot;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func (p *Pet) SpeakTo(host string)&#123;</span><br><span class="line">p.Speak()</span><br><span class="line">fmt.Println(&quot; &quot;,host)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// dog ç±»  ç»§æ‰¿ pet</span><br><span class="line">/*</span><br><span class="line">type Dog struct &#123;</span><br><span class="line">p *Pet</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func (d *Dog) Speak()&#123;</span><br><span class="line">d.p.Speak()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func (d *Dog) SpeakTo(host string)&#123;</span><br><span class="line">d.p.SpeakTo(host)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// å­ç±»ç»§æ‰¿çˆ¶ç±»çš„ç®€å•å†™æ³•ï¼š</span><br><span class="line">type Dog struct &#123;</span><br><span class="line">Pet</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// test</span><br><span class="line">func TestDog(t *testing.T)  &#123;</span><br><span class="line">dog := new(Dog)</span><br><span class="line">dog.SpeakTo(&quot;kid&quot;)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="2-ç©ºæ¥å£"><a href="#2-ç©ºæ¥å£" class="headerlink" title="2.ç©ºæ¥å£"></a>2.ç©ºæ¥å£</h2><ul><li>Go å…è®¸ç©ºæ¥å£ï¼Œä½†æ˜¯åŒæ—¶å¯å¯ä»¥åˆ¤æ–­æ¥å£çš„type<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">package ch13</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">&quot;fmt&quot;</span><br><span class="line">&quot;testing&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func Testfn(p interface&#123;&#125;)&#123;</span><br><span class="line">switch p.(type) &#123;</span><br><span class="line">case int:</span><br><span class="line">fmt.Println(&quot;int &quot;,p)</span><br><span class="line">case string:</span><br><span class="line">fmt.Println(&quot;string &quot;,p)</span><br><span class="line">default:</span><br><span class="line">fmt.Println(&quot;Unknow type.&quot;)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// ç©ºæ¥å£</span><br><span class="line">func TestEmptyAssertion(t *testing.T)  &#123;</span><br><span class="line">Testfn(10)</span><br><span class="line">Testfn(&quot;10&quot;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="3-é€šè¿‡æ¥å£å®ç°å¤šæ€"><a href="#3-é€šè¿‡æ¥å£å®ç°å¤šæ€" class="headerlink" title="3.é€šè¿‡æ¥å£å®ç°å¤šæ€"></a>3.é€šè¿‡æ¥å£å®ç°å¤šæ€</h2><ul><li>æ ‡å‡†æ­¥éª¤ï¼šå®šä¹‰æ¥å£ï¼Œçˆ¶ç±»ï¼Œå­ç±»ï¼ŒæŠ½è±¡æ–¹æ³•è°ƒç”¨çˆ¶ç±»</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">package ch13</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">&quot;fmt&quot;</span><br><span class="line">&quot;testing&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">type Code string</span><br><span class="line">/*</span><br><span class="line">é€šè¿‡ æ¥å£å®ç° å¤šæ€</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// å®šä¹‰æ¥å£</span><br><span class="line">type Programmer interface &#123;</span><br><span class="line">HelloWrold() Code</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type GOPaogrammer struct &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func (p *GOPaogrammer) HelloWrold() Code&#123;</span><br><span class="line">return &quot;Go&apos;s code&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type JavaProgrammer struct &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func (p *JavaProgrammer) HelloWrold() Code &#123;</span><br><span class="line">return &quot;Java&apos;s code&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// ä¸€ä¸ªæŠ½è±¡æ–¹æ³•</span><br><span class="line">func aProgram(p Programmer)&#123;</span><br><span class="line">fmt.Printf(&quot;%T  %v\n&quot;,p,p.HelloWrold())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">func Test(t *testing.T)&#123;</span><br><span class="line">goProg := &amp;GOPaogrammer&#123;&#125;// æ–°å»ºä¸€ä¸ªå¯¹è±¡è¿”å›çš„å®é™…ä¸Šä¸€ä¸ªæŒ‡é’ˆ</span><br><span class="line">javaProg := new(JavaProgrammer)</span><br><span class="line">aProgram(goProg)</span><br><span class="line">aProgram(javaProg)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-é”™è¯¯å¤„ç†"><a href="#4-é”™è¯¯å¤„ç†" class="headerlink" title="4. é”™è¯¯å¤„ç†"></a>4. é”™è¯¯å¤„ç†</h2><ul><li>æ ¸å¿ƒï¼š åŠæ—©å¤±è´¥ï¼Œæ—©å¤„ç†</li><li>ä½¿ç”¨å¤šè¿”å›å€¼çš„ç‰¹ç‚¹æŠŠé”™è¯¯ä¿¡æ¯å¸¦å‡ºå‡½æ•°<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">package ch14</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">&quot;errors&quot;</span><br><span class="line">&quot;testing&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func GetFib(n int) ([]int,error) &#123;</span><br><span class="line">if n &lt; 2 || n &gt; 100&#123;</span><br><span class="line">return nil,errors.New(&quot;n should be in [2,100]&quot;)</span><br><span class="line">&#125;</span><br><span class="line">res := []int&#123;1,1&#125;</span><br><span class="line">for i:=2;i&lt;n;i++&#123;</span><br><span class="line">res = append(res,res[i-1]+res[i-2])</span><br><span class="line">&#125;</span><br><span class="line">return res,nil</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> æ ¸å¿ƒï¼š åŠæ—©å¤±è´¥</span><br><span class="line">1.Go çš„é”™è¯¯æœºåˆ¶ï¼š errors.Newï¼ˆï¼‰</span><br><span class="line">2.ä½¿ç”¨å¤šè¿”å›å€¼ å¸¦å‡ºé”™è¯¯</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">func TestFunc(t *testing.T)  &#123;</span><br><span class="line">if v,err:=GetFib(-10);err!=nil&#123;</span><br><span class="line">t.Error(err)</span><br><span class="line">&#125;else &#123;</span><br><span class="line">t.Log(v)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="5-é”™è¯¯æ¢å¤"><a href="#5-é”™è¯¯æ¢å¤" class="headerlink" title="5. é”™è¯¯æ¢å¤"></a>5. é”™è¯¯æ¢å¤</h2><ul><li>ä½¿ç”¨recoveræ¢å¤æ˜¯å¾ˆå±é™©çš„ï¼Œå®¹æ˜“é€ æˆåƒµå°¸è¿›ç¨‹</li><li>ä¸­æ–­çš„ä¸‰ç§æ–¹å¼çš„ ä¸åŒç‚¹<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">package ch14</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">&quot;errors&quot;</span><br><span class="line">&quot;fmt&quot;</span><br><span class="line">&quot;testing&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">// recover æ¢å¤é”™è¯¯  å¾ˆå±é™©çš„</span><br><span class="line">func TestPanicVxExit(t *testing.T)  &#123;</span><br><span class="line">defer func() &#123;</span><br><span class="line">if err:= recover();err !=nil&#123;</span><br><span class="line">fmt.Println(&quot;recovered from &quot;,err)</span><br><span class="line">&#125;</span><br><span class="line">&#125;()</span><br><span class="line">fmt.Println(&quot;start&quot;)</span><br><span class="line">panic(errors.New(&quot;someting error!&quot;))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">panicæŠ›å‡ºå¼‚å¸¸é€€å‡º</span><br><span class="line">exit å¼‚å¸¸é€€å‡º</span><br><span class="line">recover æ¢å¤å‡ºé”™å‰çš„çŠ¶æ€</span><br><span class="line"> */</span><br></pre></td></tr></table></figure></li></ul>]]></content>
      
      
      <categories>
          
          <category> GoLang </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Go </tag>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Goåˆè¯• ä¸‰</title>
      <link href="/2019/11/24/Go%E5%88%9D%E8%AF%95%E4%B8%89/"/>
      <url>/2019/11/24/Go%E5%88%9D%E8%AF%95%E4%B8%89/</url>
      
        <content type="html"><![CDATA[<h1 id="Goè¯­è¨€å…¥é—¨å°è¯•-ä¸‰"><a href="#Goè¯­è¨€å…¥é—¨å°è¯•-ä¸‰" class="headerlink" title="Goè¯­è¨€å…¥é—¨å°è¯•  ä¸‰"></a>Goè¯­è¨€å…¥é—¨å°è¯•  ä¸‰</h1><ul><li>Goï¼ˆåˆç§° Golangï¼‰æ˜¯ Google çš„ Robert Griesemerï¼ŒRob Pike åŠ Ken Thompson å¼€å‘çš„ä¸€ç§é™æ€å¼ºç±»å‹ã€ç¼–è¯‘å‹è¯­è¨€ã€‚Go è¯­è¨€è¯­æ³•ä¸ C ç›¸è¿‘ï¼Œä½†åŠŸèƒ½ä¸Šæœ‰ï¼šå†…å­˜å®‰å…¨ï¼ŒGCï¼ˆåƒåœ¾å›æ”¶ï¼‰ï¼Œç»“æ„å½¢æ€åŠ CSP-style å¹¶å‘è®¡ç®—ã€‚</li></ul><h2 id="1-func-æ–¹æ³•"><a href="#1-func-æ–¹æ³•" class="headerlink" title="1.func æ–¹æ³•"></a>1.func æ–¹æ³•</h2><ul><li>æ–¹æ³•æ˜¯goé‡Œé¢çš„ä¸€ç­‰å…¬æ°‘</li><li>æ–¹æ³•å¯ä»¥è¿”å›æ–¹æ³• ç±»ä¼¼åŒ…è£…å™¨</li><li>å¤šè¿”å›</li><li>å¤šå‚æ•°</li><li>defer æœ€åæ‰§è¡Œ ç±»ä¼¼finally</li><li>func éƒ½æ˜¯èµ‹å€¼ä¼ é€’å‚æ•°<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">package ch10</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">&quot;fmt&quot;</span><br><span class="line">&quot;math/rand&quot;</span><br><span class="line">&quot;testing&quot;</span><br><span class="line">&quot;time&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">// ç±»ä¼¼åŒ…è£…å™¨ï¼š è¾“å…¥func è¾“å‡ºfunc</span><br><span class="line">func timeSpent(testFunc func(op int) int) func(op int) int  &#123;</span><br><span class="line">return func(n int) int &#123;</span><br><span class="line">start := time.Now()</span><br><span class="line">ret := testFunc(n)</span><br><span class="line">fmt.Print(&quot;time spent:&quot;,time.Since(start).Seconds())</span><br><span class="line">return ret</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func slowFun(op int) int&#123;</span><br><span class="line">time.Sleep(time.Second*1)</span><br><span class="line">return op</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func TestSlowFun(t *testing.T)&#123;</span><br><span class="line">tsSF := timeSpent(slowFun)</span><br><span class="line">t.Log(tsSF(10))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// å¤šè¿”å›çš„æ–¹æ³•</span><br><span class="line">func returnMultiValues() (int,int)&#123;</span><br><span class="line">return rand.Intn(10),rand.Intn(25)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func TestFn(t *testing.T)  &#123;</span><br><span class="line">a,b := returnMultiValues()</span><br><span class="line">t.Log(a,b)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// å¤šå‚æ•°æ–¹æ³•</span><br><span class="line">func Sum(ops ...int) int&#123;</span><br><span class="line">res:=0</span><br><span class="line">for _,op := range ops&#123;</span><br><span class="line">res += op</span><br><span class="line">&#125;</span><br><span class="line">return res</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func TestVarparam(t *testing.T)&#123;</span><br><span class="line">t.Log(Sum(1,2,3,4,5))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// æœ€åæ‰§è¡Œå‡½æ•° ç±»ä¼¼finally</span><br><span class="line">func Clear()&#123;</span><br><span class="line">fmt.Println(&quot;clear resource.&quot;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func TestDefer(t *testing.T)&#123;</span><br><span class="line">defer Clear()// æœ€åæ‰§è¡Œ</span><br><span class="line">fmt.Println(&quot;start test.&quot;)</span><br><span class="line">panic(&quot;err&quot;) // å¼‚å¸¸é€€å‡º</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="2-ç±»å‹é¢„å®šä¹‰"><a href="#2-ç±»å‹é¢„å®šä¹‰" class="headerlink" title="2. ç±»å‹é¢„å®šä¹‰"></a>2. ç±»å‹é¢„å®šä¹‰</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">package ch11</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">&quot;fmt&quot;</span><br><span class="line">&quot;testing&quot;</span><br><span class="line">&quot;time&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">// ä½¿ç”¨ç±»å‹é¢„å®šä¹‰ ç®€åŒ–</span><br><span class="line">type IntConv func(op int) int</span><br><span class="line"></span><br><span class="line">func timeSpent(testFunc IntConv) IntConv  &#123;</span><br><span class="line">return func(n int) int &#123;</span><br><span class="line">start := time.Now()</span><br><span class="line">ret := testFunc(n)</span><br><span class="line">fmt.Print(&quot;time spent:&quot;,time.Since(start).Seconds())</span><br><span class="line">return ret</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func slowFun(op int) int&#123;</span><br><span class="line">time.Sleep(time.Second*1)</span><br><span class="line">return op</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func TestSlowFun(t *testing.T)&#123;</span><br><span class="line">tsSF := timeSpent(slowFun)</span><br><span class="line">t.Log(tsSF(10))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-ç±»ï¼ˆç»“æ„ä½“ï¼‰"><a href="#3-ç±»ï¼ˆç»“æ„ä½“ï¼‰" class="headerlink" title="3. ç±»ï¼ˆç»“æ„ä½“ï¼‰"></a>3. ç±»ï¼ˆç»“æ„ä½“ï¼‰</h2><ul><li>go çš„ç±» ç±»ä¼¼äº ç»“æ„ä½“ + åŒ…å«è¯¥ç»“æ„ä½“æŒ‡é’ˆçš„func</li><li>2ç§å®šä¹‰ç±»æ–¹æ³•çš„æ–¹å¼<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">package ch11</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">&quot;fmt&quot;</span><br><span class="line">&quot;testing&quot;</span><br><span class="line">&quot;unsafe&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">// å®šä¹‰ç»“æ„ä½“</span><br><span class="line">type Employee struct &#123;</span><br><span class="line">Id string</span><br><span class="line">Name string</span><br><span class="line">Age int</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// å®šä¹‰ç±»æ–¹æ³•</span><br><span class="line"></span><br><span class="line">// 1. ä½¿ç”¨ å¯¹è±¡å¤åˆ¶ä¼ é€’ï¼š å®ä¾‹æˆå‘˜ä¼šè¿›è¡Œå€¼å¤åˆ¶</span><br><span class="line">func (e Employee) String() string  &#123;</span><br><span class="line">fmt.Printf(&quot;address is %x\n&quot;,unsafe.Pointer(&amp;e.Name))// è¾“å‡º nameçš„åœ°å€</span><br><span class="line">return fmt.Sprintf(&quot;Id:%s-name:%s-age:%d&quot;,e.Id,e.Name,e.Age)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 2. ä½¿ç”¨ æŒ‡é’ˆå¤åˆ¶ä¼ é€’ï¼š å®ä¾‹æˆå‘˜ä¸ä¼šè¿›è¡Œå€¼å¤åˆ¶</span><br><span class="line">func (e *Employee) toString() string  &#123;</span><br><span class="line">fmt.Printf(&quot;address is %x\n&quot;,unsafe.Pointer(&amp;e.Name))// è¾“å‡º nameçš„åœ°å€</span><br><span class="line">return fmt.Sprintf(&quot;Id:%s-name:%s-age:%d&quot;,e.Id,e.Name,e.Age)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func TestStruct(t *testing.T)&#123;</span><br><span class="line">e := Employee&#123;&quot;0&quot;,&quot;kid&quot;,20&#125;</span><br><span class="line">t.Log(e.String())</span><br><span class="line">t.Logf(&quot;%T&quot;,e)//ç­‰å¾—åˆ°çš„æ˜¯å¯¹è±¡</span><br><span class="line"></span><br><span class="line">e1 := &amp;Employee&#123;&quot;0&quot;,&quot;kid&quot;,25&#125;</span><br><span class="line">t.Log(e1.toString())</span><br><span class="line">t.Logf(&quot;%T&quot;,e1)//ç­‰å¾—åˆ°çš„æ˜¯å¯¹è±¡</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="4-æ¥å£"><a href="#4-æ¥å£" class="headerlink" title="4.æ¥å£"></a>4.æ¥å£</h2><ul><li>Go æ— ç»§æ‰¿ åªæœ‰æ¥å£</li><li>go æ˜¯ é¸­å­ç±»å‹</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">package ch11</span><br><span class="line"></span><br><span class="line">import &quot;testing&quot;</span><br><span class="line"></span><br><span class="line">type Progarmmer interface &#123;</span><br><span class="line">WriteHelloWorld() string</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type Goparogrammer struct &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func (g *Goparogrammer) WriteHelloWorld() string&#123;</span><br><span class="line">return &quot;fmt.Println(\&quot;Hello world\&quot;)&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// go æ¥å£æ²¡æœ‰ä¾èµ–å…³ç³» æ˜¯é¸­å­ç±»å‹</span><br><span class="line">func TestClient(t *testing.T)&#123;</span><br><span class="line">var p Progarmmer</span><br><span class="line">p = new (Goparogrammer)</span><br><span class="line">t.Log(p.WriteHelloWorld())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> GoLang </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Go </tag>
            
            <tag> é¢å‘å¯¹è±¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Goåˆè¯• äºŒ</title>
      <link href="/2019/11/24/Go%E5%88%9D%E8%AF%95%E4%BA%8C/"/>
      <url>/2019/11/24/Go%E5%88%9D%E8%AF%95%E4%BA%8C/</url>
      
        <content type="html"><![CDATA[<h1 id="Goè¯­è¨€å…¥é—¨å°è¯•-äºŒ"><a href="#Goè¯­è¨€å…¥é—¨å°è¯•-äºŒ" class="headerlink" title="Goè¯­è¨€å…¥é—¨å°è¯•  äºŒ"></a>Goè¯­è¨€å…¥é—¨å°è¯•  äºŒ</h1><ul><li>Goï¼ˆåˆç§° Golangï¼‰æ˜¯ Google çš„ Robert Griesemerï¼ŒRob Pike åŠ Ken Thompson å¼€å‘çš„ä¸€ç§é™æ€å¼ºç±»å‹ã€ç¼–è¯‘å‹è¯­è¨€ã€‚Go è¯­è¨€è¯­æ³•ä¸ C ç›¸è¿‘ï¼Œä½†åŠŸèƒ½ä¸Šæœ‰ï¼šå†…å­˜å®‰å…¨ï¼ŒGCï¼ˆåƒåœ¾å›æ”¶ï¼‰ï¼Œç»“æ„å½¢æ€åŠ CSP-style å¹¶å‘è®¡ç®—ã€‚</li></ul><h2 id="1-Arrayæ•°ç»„"><a href="#1-Arrayæ•°ç»„" class="headerlink" title="1.Arrayæ•°ç»„"></a>1.Arrayæ•°ç»„</h2><ul><li>æ•°ç»„çš„ä¸‰ç§åˆå§‹åŒ–æ–¹å¼</li><li>æ•°ç»„çš„éå†æ–¹å¼</li><li>æ•°ç»„çš„åˆ‡ç‰‡<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">package ch6</span><br><span class="line"></span><br><span class="line">import &quot;testing&quot;</span><br><span class="line"></span><br><span class="line">func TestArrayInit(t *testing.T)&#123;</span><br><span class="line">// é»˜è®¤åˆå§‹åŒ–ä¸º0</span><br><span class="line">var arr [3]int</span><br><span class="line">t.Log(arr[1],arr[2])</span><br><span class="line">// åˆå§‹åŒ–èµ‹å€¼</span><br><span class="line">arr2 := [3]int&#123;1,2,3&#125;</span><br><span class="line">t.Log(arr2)</span><br><span class="line">// åˆå§‹åŒ–è‡ªå®šä¹‰å¤§å°</span><br><span class="line">arr3 :=[...]int&#123;1,2,3&#125;</span><br><span class="line">t.Log(arr3)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// æ•°ç»„çš„éå†</span><br><span class="line">func TestArrayTravel(t *testing.T)  &#123;</span><br><span class="line">arr4:=[...]int&#123;1,2,3,4,5&#125;</span><br><span class="line">// æ™®é€šå†™æ³•</span><br><span class="line">for i:=0;i&lt;len(arr4) ;i++  &#123;</span><br><span class="line">t.Log(arr4[i])</span><br><span class="line">&#125;</span><br><span class="line">// for each</span><br><span class="line">for _,e := range arr4&#123;</span><br><span class="line">t.Log(e)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// æ•°ç»„çš„åˆ‡ç‰‡  [åŒ…å«ï¼Œä¸åŒ…å«]</span><br><span class="line">func TestArraySection(t *testing.T)&#123;</span><br><span class="line">arr5:= [...]int&#123;1,2,3,4&#125;;</span><br><span class="line">arr5_sec := arr5[:3]</span><br><span class="line">t.Log(arr5,arr5_sec)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="2-åˆ‡ç‰‡"><a href="#2-åˆ‡ç‰‡" class="headerlink" title="2.åˆ‡ç‰‡"></a>2.åˆ‡ç‰‡</h2><ul><li>åˆ‡ç‰‡æ˜¯ç§æ•°æ®ç»“æ„ï¼šï¼ˆèµ·ç‚¹ï¼Œå½“å‰é•¿åº¦ï¼Œæ€»å®¹é‡ï¼‰</li><li>åˆ‡ç‰‡çš„å®¹é‡å¢é•¿è§„å¾‹ä¸º 2^n ç±»ä¼¼List</li><li>åˆ‡ç‰‡çš„åˆå§‹åŒ–<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">package ch6</span><br><span class="line"></span><br><span class="line">import &quot;testing&quot;</span><br><span class="line"></span><br><span class="line">// åˆ‡ç‰‡</span><br><span class="line">func TestSlice(t *testing.T)  &#123;</span><br><span class="line">var s0 []int</span><br><span class="line">t.Log(len(s0),cap(s0))</span><br><span class="line">s0 = append(s0, 1)</span><br><span class="line">t.Log(len(s0),cap(s0))// å¯è®¿é—®åºåˆ—çš„é•¿åº¦å’Œå®¹é‡</span><br><span class="line"></span><br><span class="line">s1:=[]int&#123;1,2,3,4&#125;// ç”Ÿæˆä¸€ä¸ªåˆ‡ç‰‡</span><br><span class="line">t.Log(len(s1),cap(s1))</span><br><span class="line"></span><br><span class="line">s2:=make([]int,3,5)// ç”Ÿæˆé•¿åº¦ä¸º3å®¹é‡ä¸º5çš„åˆ‡ç‰‡</span><br><span class="line">t.Log(len(s2),cap(s2))</span><br><span class="line">t.Log(s2[0],s2[1],s2[2])</span><br><span class="line"></span><br><span class="line">// å¾€lenåè¿½åŠ </span><br><span class="line">s2 = append(s2, 1)</span><br><span class="line">t.Log(s2[0],s2[1],s2[2],s2[3])</span><br><span class="line">t.Log(len(s2),cap(s2))</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// åˆ‡ç‰‡å®¹é‡å’Œé•¿åº¦çš„å¢é•¿è§„å¾‹  å®¹é‡æŒ‰2^nå¢é•¿</span><br><span class="line">func TestSliceGrowing(t *testing.T)  &#123;</span><br><span class="line">s:=[]int&#123;&#125;</span><br><span class="line">for i:=0;i&lt;10;i++ &#123;</span><br><span class="line">s = append(s, i)</span><br><span class="line">t.Log(len(s),cap(s))</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// åˆ‡ç‰‡çš„æ•°æ®ç»“æ„</span><br><span class="line">func TestSliceShareMemory(t *testing.T)&#123;</span><br><span class="line">year := []string&#123;&quot;Jan&quot;,&quot;Feb&quot;,&quot;Mar&quot;,&quot;Apr&quot;,&quot;May&quot;,&quot;Jun&quot;,&quot;Jul&quot;,&quot;Aug&quot;,&quot;Sep&quot;,&quot;Oct&quot;,&quot;Nov&quot;,&quot;Dec&quot;&#125;</span><br><span class="line">Q2 := year[3:6]</span><br><span class="line">t.Log(Q2,len(Q2),cap(Q2))// é•¿åº¦ä¸º3 å®¹é‡ä¸º9</span><br><span class="line"></span><br><span class="line">summer:=year[5:8]</span><br><span class="line">summer[0] = &quot;Unknow&quot;// æ•´ä¸ªæ•°ç»„éƒ½ä¼šè¢«å½±å“</span><br><span class="line">t.Log(year)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="3-map-k-vé”®å€¼å¯¹"><a href="#3-map-k-vé”®å€¼å¯¹" class="headerlink" title="3.map k-vé”®å€¼å¯¹"></a>3.map k-vé”®å€¼å¯¹</h2><ul><li>mapçš„åˆå§‹åŒ–</li><li>å¯¹äºä¸å­˜çš„å…ƒç´  è¿”å› çŠ¶æ€</li><li>éå†</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">package ch7</span><br><span class="line"></span><br><span class="line">import &quot;testing&quot;</span><br><span class="line"></span><br><span class="line">// map çš„åˆå§‹åŒ–</span><br><span class="line">func TestInitMap(t *testing.T)  &#123;</span><br><span class="line">m1 := map[int]int&#123;1:1,2:4,3:9&#125;</span><br><span class="line">t.Log(m1[2])</span><br><span class="line">t.Log(&quot;len m1&quot;,len(m1))</span><br><span class="line"></span><br><span class="line">m2 := map[int]int&#123;&#125;</span><br><span class="line">m2[4] = 16</span><br><span class="line">t.Log(&quot;len m2&quot;,len(m2))</span><br><span class="line"></span><br><span class="line">m3:= make(map[int]int,10)// åˆå§‹åŒ–mapå®¹é‡é•¿åº¦</span><br><span class="line">t.Log(&quot;len m3&quot;,len(m3))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// å¯¹æ¯” value = 0 å’Œ å…ƒç´ ä¸å­˜åœ¨</span><br><span class="line">func TestAccessNotExistKey(t *testing.T)&#123;</span><br><span class="line">m1 := map[int]int&#123;&#125;// åˆå§‹åŒ–éƒ½ä¸º0</span><br><span class="line">t.Log(m1[1])</span><br><span class="line">m1[2] = 0</span><br><span class="line">t.Log(m1[2])</span><br><span class="line"></span><br><span class="line">if v,ok := m1[3];ok&#123;//å¦‚æœkeyä¸å­˜åœ¨é™¤äº†è¿”å›value=0ï¼Œè¿˜ä¼šè¿”å›ä¸€ä¸ªçŠ¶æ€ä¸ºfalse</span><br><span class="line">t.Log(&quot;key 3&apos;s value is &quot;,v)</span><br><span class="line">&#125;else &#123;</span><br><span class="line">t.Log(&quot;key 3 is not existing.&quot;)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// éå† map</span><br><span class="line">func TestTravelMap(t *testing.T)  &#123;</span><br><span class="line">m1 := map[int]int&#123;1:1,2:4,3:9&#125;</span><br><span class="line">for k,v := range m1 &#123;</span><br><span class="line">t.Log(k,v)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-map-çš„æ‹“å±•"><a href="#4-map-çš„æ‹“å±•" class="headerlink" title="4.map çš„æ‹“å±•"></a>4.map çš„æ‹“å±•</h2><ul><li>mapå­˜å‚¨func</li><li>mapå®ç°set<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">package ch8</span><br><span class="line"></span><br><span class="line">import &quot;testing&quot;</span><br><span class="line"></span><br><span class="line">// å°†æ–¹æ³•ä½œä¸ºmapçš„value</span><br><span class="line">func TestMapWithFubValue(t *testing.T)  &#123;</span><br><span class="line">m := map[int] func(op int)int &#123;&#125;</span><br><span class="line">m[1] = func(op int) int &#123;return op&#125;</span><br><span class="line">m[2] = func(op int) int &#123;return op*op&#125;</span><br><span class="line">m[3] = func(op int) int &#123;return op*op*op&#125;</span><br><span class="line"></span><br><span class="line">t.Log(m[1](2),m[2](2),m[3](2))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// ä½¿ç”¨map å®ç° set</span><br><span class="line">func TestMapForSet(t *testing.T)&#123;</span><br><span class="line">mySet := map[int]bool&#123;&#125;</span><br><span class="line">mySet[1] = true</span><br><span class="line">n:=1</span><br><span class="line">if mySet[n]&#123;</span><br><span class="line">t.Log(n,&quot; is exist&quot;)</span><br><span class="line">&#125;else&#123;</span><br><span class="line">t.Log(n,&quot;is not exist.&quot;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">mySet[3] = true</span><br><span class="line">t.Log(len(mySet))</span><br><span class="line">delete(mySet,1)</span><br><span class="line">n=1</span><br><span class="line">if mySet[n]&#123;</span><br><span class="line">t.Log(n,&quot; is exist&quot;)</span><br><span class="line">&#125;else&#123;</span><br><span class="line">t.Log(n,&quot;is not exist.&quot;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="5-string"><a href="#5-string" class="headerlink" title="5.string"></a>5.string</h2><ul><li>string é»˜è®¤ utf-8ç¼–ç </li><li>éå†</li><li>stringsçš„å‡½æ•°</li><li>strconvçš„å‡½æ•°<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">package ch9</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">&quot;strconv&quot;</span><br><span class="line">&quot;strings&quot;</span><br><span class="line">&quot;testing&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">// å­—ç¬¦é›† å’Œ å­—ç¬¦ç¼–ç </span><br><span class="line">func TestString(t *testing.T)&#123;</span><br><span class="line">var s string</span><br><span class="line">t.Log(s)</span><br><span class="line">t.Log(len(s))</span><br><span class="line"></span><br><span class="line">s = &quot;\xE4\xB8\xA5&quot;</span><br><span class="line">t.Log(s)</span><br><span class="line">s = &quot;ä¸­&quot;</span><br><span class="line">t.Log(len(s))</span><br><span class="line"></span><br><span class="line">c := []rune(s)</span><br><span class="line">t.Logf(&quot;ä¸­ unicode %x&quot;,c[0])// å­—ç¬¦ç¼–ç </span><br><span class="line">t.Logf(&quot;ä¸­ UTF8 %x&quot;,s)// å­—ç¬¦ç¼–ç çš„å…·ä½“å®ç°</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// å­—ç¬¦ä¸²çš„éå†</span><br><span class="line">func TestStringRange(t *testing.T)&#123;</span><br><span class="line">s:=&quot;ä¸­åäººæ°‘å…±å’Œå›½&quot;</span><br><span class="line">for _,value := range s&#123;</span><br><span class="line">t.Logf(&quot;%[1]c  %[1]x&quot;,value)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// stringså‡½æ•°</span><br><span class="line">func TestStringFn(t *testing.T)  &#123;</span><br><span class="line">s := &quot;A,B,C&quot;</span><br><span class="line">parts := strings.Split(s,&quot;,&quot;)</span><br><span class="line">for _,part := range parts&#123;</span><br><span class="line">t.Logf(part)</span><br><span class="line">&#125;</span><br><span class="line">t.Log(strings.Join(parts,&quot;-&quot;))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// strconv åº“å‡½æ•°</span><br><span class="line">func TestConv(t *testing.T)  &#123;</span><br><span class="line">s := strconv.Itoa(10)</span><br><span class="line">t.Log(&quot;str: &quot; + s)</span><br><span class="line">if i,err :=strconv.Atoi(&quot;25&quot;);err == nil&#123;</span><br><span class="line">t.Log(10 + i)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul>]]></content>
      
      
      <categories>
          
          <category> GoLang </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Go </tag>
            
            <tag> æ•°æ®ç»“æ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Goåˆè¯• ä¸€</title>
      <link href="/2019/11/23/Go%E5%88%9D%E8%AF%95%20%E4%B8%80/"/>
      <url>/2019/11/23/Go%E5%88%9D%E8%AF%95%20%E4%B8%80/</url>
      
        <content type="html"><![CDATA[<h1 id="Goè¯­è¨€å…¥é—¨å°è¯•-ä¸€"><a href="#Goè¯­è¨€å…¥é—¨å°è¯•-ä¸€" class="headerlink" title="Goè¯­è¨€å…¥é—¨å°è¯•  ä¸€"></a>Goè¯­è¨€å…¥é—¨å°è¯•  ä¸€</h1><ul><li>Goï¼ˆåˆç§° Golangï¼‰æ˜¯ Google çš„ Robert Griesemerï¼ŒRob Pike åŠ Ken Thompson å¼€å‘çš„ä¸€ç§é™æ€å¼ºç±»å‹ã€ç¼–è¯‘å‹è¯­è¨€ã€‚Go è¯­è¨€è¯­æ³•ä¸ C ç›¸è¿‘ï¼Œä½†åŠŸèƒ½ä¸Šæœ‰ï¼šå†…å­˜å®‰å…¨ï¼ŒGCï¼ˆåƒåœ¾å›æ”¶ï¼‰ï¼Œç»“æ„å½¢æ€åŠ CSP-style å¹¶å‘è®¡ç®—ã€‚<h2 id="1-æ ‡å‡†å…¥é—¨ç¬¬ä¸€æ­¥ï¼š-HelloWorld"><a href="#1-æ ‡å‡†å…¥é—¨ç¬¬ä¸€æ­¥ï¼š-HelloWorld" class="headerlink" title="1.æ ‡å‡†å…¥é—¨ç¬¬ä¸€æ­¥ï¼š HelloWorld"></a>1.æ ‡å‡†å…¥é—¨ç¬¬ä¸€æ­¥ï¼š HelloWorld</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">&quot;fmt&quot;</span><br><span class="line">&quot;os&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">// 1. package å¿…é¡»æ˜¯ main å¯¹åº” mainæ–¹æ³•</span><br><span class="line">// 2. import å¼•å…¥ä¾èµ–</span><br><span class="line">// 3. main æ–¹æ³•æ²¡æœ‰å‚æ•°ä¹Ÿæ²¡æœ‰é€€å‡ºå€¼ å…¨é å…¶ä»–ä¾èµ–å®Œæˆ</span><br><span class="line"></span><br><span class="line">func main()&#123;</span><br><span class="line">fmt.Print(&quot;hello world.&quot; + os.Args[1]);</span><br><span class="line">os.Exit(0)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-æµ‹è¯•æ–¹æ³•ä¸å‘½åè§„èŒƒï¼š"><a href="#2-æµ‹è¯•æ–¹æ³•ä¸å‘½åè§„èŒƒï¼š" class="headerlink" title="2.æµ‹è¯•æ–¹æ³•ä¸å‘½åè§„èŒƒï¼š"></a>2.æµ‹è¯•æ–¹æ³•ä¸å‘½åè§„èŒƒï¼š</h2></li><li>ä»¥æ–æ³¢é‚£å¥‘æ•°åˆ—ä¸ºä¾‹</li><li>æµ‹è¯•æ–¹æ³•æ–‡ä»¶å¿…é¡»ä»¥ _test.goç»“å°¾ï¼Œpackageä¸å¿…æ˜¯main</li><li>ä½†æ˜¯æ–¹æ³•æµ‹è¯•çš„æ–¹æ³•å¿…é¡»æ˜¯func TestXXX(t *testing.T)çš„å‘½å</li><li>ç”³è¯·å˜é‡æœ‰ä¸‰ç§æ–¹å¼èµ‹å€¼ä¹Ÿæœ‰ä¸‰ç§æ–¹å¼<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">package try_test</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">&quot;testing&quot;</span><br><span class="line">)</span><br><span class="line">// å˜é‡</span><br><span class="line">func TestFibList(t *testing.T) &#123;</span><br><span class="line">// ç›´æ¥å£°æ˜å˜é‡</span><br><span class="line">//var a int = 1</span><br><span class="line">//var b int = 1</span><br><span class="line">// ç”³è¯·å¤šä¸ªå˜é‡</span><br><span class="line">//var(</span><br><span class="line">//a int = 1</span><br><span class="line">//b int = 1</span><br><span class="line">//)</span><br><span class="line">// ç®€å†™ç”³è¯·å˜é‡</span><br><span class="line">a := 1</span><br><span class="line">b := 1</span><br><span class="line">t.Log(a,&quot; &quot;)</span><br><span class="line">t.Log(b,&quot; &quot;)</span><br><span class="line">for i:=0;i&lt;5;i++&#123;</span><br><span class="line">t.Log(b,&quot; &quot;)</span><br><span class="line">tmp := a</span><br><span class="line">a = b</span><br><span class="line">b = tmp + a</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">// å˜é‡èµ‹å€¼</span><br><span class="line">func TestExchange(t *testing.T)  &#123;</span><br><span class="line">a:=1</span><br><span class="line">b:=2</span><br><span class="line"></span><br><span class="line">// æ™®é€šçš„äº¤æ¢å˜é‡</span><br><span class="line">//tmp := a</span><br><span class="line">//a = b</span><br><span class="line">//b = tmp</span><br><span class="line">//t.Log(a,b)</span><br><span class="line"></span><br><span class="line">// å¤šä¸ªå˜é‡èµ‹å€¼</span><br><span class="line">a,b = b,a</span><br><span class="line">t.Log(a,b)</span><br><span class="line">&#125;</span><br><span class="line">// å¸¸é‡</span><br><span class="line">const(</span><br><span class="line">// iota è¿ç»­èµ‹å€¼</span><br><span class="line">Mondy = 1 + iota</span><br><span class="line">Tuesday</span><br><span class="line">Wednesday</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func TestConstantTry(t *testing.T)  &#123;</span><br><span class="line">t.Log(Mondy,Tuesday)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="3-å˜é‡ç±»å‹ï¼š"><a href="#3-å˜é‡ç±»å‹ï¼š" class="headerlink" title="3.å˜é‡ç±»å‹ï¼š"></a>3.å˜é‡ç±»å‹ï¼š</h2><ul><li>ç±»å‹åƒCä½†æ˜¯ä¸æ”¯æŒéšæ€§ç±»å‹è½¬æ¢</li><li>æ”¯æŒæŒ‡é’ˆä½†æ˜¯ä¸æ”¯æŒæŒ‡é’ˆè¿ç®—</li><li>å­—ç¬¦ä¸²ä¸ºç©º == â€œâ€<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">package ch3</span><br><span class="line"></span><br><span class="line">import &quot;testing&quot;</span><br><span class="line"></span><br><span class="line">type MyInt int64        // è‡ªå®šä¹‰ç±»å‹</span><br><span class="line"></span><br><span class="line">// æ•°æ®ç±»å‹ä¸æ”¯æŒéšå½¢è½¬æ¢</span><br><span class="line">func TestImplicit(t *testing.T)&#123;</span><br><span class="line">var a int = 1</span><br><span class="line">var b int64</span><br><span class="line">b = int64(a)</span><br><span class="line">var c MyInt</span><br><span class="line">c = MyInt(b)</span><br><span class="line">t.Log(a,b,c)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// æŒ‡é’ˆå¯ç”¨ ä½†ä¸æ”¯æŒè¿ç®—</span><br><span class="line">func TestPoint(t *testing.T)  &#123;</span><br><span class="line">a := 1</span><br><span class="line">aPtr := &amp;a</span><br><span class="line">//aPtr = aPtr +1</span><br><span class="line">t.Log(a,aPtr)</span><br><span class="line">t.Logf(&quot;%T %T&quot;,a,aPtr)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// String ä¸ºç©ºç”¨â€œâ€è¡¨ç¤º</span><br><span class="line">func TestString(t *testing.T)&#123;</span><br><span class="line">var s string</span><br><span class="line">t.Log(s)</span><br><span class="line">t.Log(len(s))</span><br><span class="line">if s == &quot;&quot;&#123;</span><br><span class="line">t.Log(&quot;s ä¸ºç©º&quot;)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="4-æ•°ç»„"><a href="#4-æ•°ç»„" class="headerlink" title="4.æ•°ç»„"></a>4.æ•°ç»„</h2><ul><li>æ•°ç»„çš„æ¯”è¾ƒåªé™é•¿åº¦ç›¸åŒçš„æ•°ç»„</li><li>itoa è‡ªåŠ å®šä¹‰<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">package ch4</span><br><span class="line"></span><br><span class="line">import &quot;testing&quot;</span><br><span class="line"></span><br><span class="line">// æ•°ç»„çš„æ¯”è¾ƒ</span><br><span class="line">func TestCompareArray(t *testing.T)  &#123;</span><br><span class="line">a:=[...] int&#123;1,2,3&#125;</span><br><span class="line">b:=[...] int&#123;1,1,3&#125;</span><br><span class="line">//c:=[...] int&#123;1,2,3,4&#125;</span><br><span class="line">d:=[...] int&#123;1,2,3&#125;</span><br><span class="line"></span><br><span class="line">t.Log(a==b)</span><br><span class="line">//t.Log(a==c)// é•¿åº¦ä¸åŒç›´æ¥æŠ¥é”™</span><br><span class="line">t.Log(a==d)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// TestBitClear</span><br><span class="line">const (</span><br><span class="line">read = 1 &lt;&lt; iota</span><br><span class="line">write</span><br><span class="line">exec</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func TestBitClear(t *testing.T)&#123;</span><br><span class="line">a := 7  // 0111</span><br><span class="line">a = a &amp;^ read// æ¸…é™¤å¯è¯»æƒé™</span><br><span class="line">t.Log(a&amp;read == read,a&amp;write==write,a&amp;exec==exec)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="5-åˆ†æ”¯åˆ¤æ–­"><a href="#5-åˆ†æ”¯åˆ¤æ–­" class="headerlink" title="5.åˆ†æ”¯åˆ¤æ–­"></a>5.åˆ†æ”¯åˆ¤æ–­</h2><ul><li>if è¯­å¥ä¸ å¤šè¿”å›å†™æ³•</li><li>å¤šæ¡ä»¶çš„ switch</li><li>ä½¿ç”¨switch ä»£æ›¿ å¤æ‚çš„ if<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">package ch5</span><br><span class="line"></span><br><span class="line">import &quot;testing&quot;</span><br><span class="line"></span><br><span class="line">// if è¯­å¥ä¸ å¤šè¿”å›</span><br><span class="line">func TestIfMultiSec(t *testing.T)  &#123;</span><br><span class="line">if a:=1 == 1; a&#123;</span><br><span class="line">t.Log(&quot;1==1&quot;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// å¤šè¿”å›åœ¨ifä¸­åº”ç”¨</span><br><span class="line">//if v,err := someFun(); err==nil&#123;</span><br><span class="line">//t.Log(&quot;success&quot;)</span><br><span class="line">//&#125;else&#123;</span><br><span class="line">//t.Log(&quot;error&quot;)</span><br><span class="line">//&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// å¤šæ¡ä»¶çš„ switch</span><br><span class="line">func TestSwitchMultiCase(t *testing.T)&#123;</span><br><span class="line">for i:=0;i&lt;5 ;i++  &#123;</span><br><span class="line">switch i &#123;</span><br><span class="line">case 0,2:t.Log(&quot;even&quot;)</span><br><span class="line">case 1,3:t.Log(&quot;odd&quot;)</span><br><span class="line">default:t.Log(&quot;it is not 0-3&quot;)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// ä½¿ç”¨switch ä»£æ›¿ å¤æ‚çš„ if</span><br><span class="line">func TestSwitchCaseCondition(t *testing.T)  &#123;</span><br><span class="line">for i:=0;i&lt;5 ;i++  &#123;</span><br><span class="line">switch &#123;</span><br><span class="line">case i%2==0:t.Log(&quot;even&quot;)</span><br><span class="line">case i%2==1:t.Log(&quot;odd&quot;)</span><br><span class="line">default:t.Log(&quot;unknow&quot;)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="6-å¾ªç¯æ¡ä»¶"><a href="#6-å¾ªç¯æ¡ä»¶" class="headerlink" title="6.å¾ªç¯æ¡ä»¶"></a>6.å¾ªç¯æ¡ä»¶</h2><ul><li>è¿™ä¸ªå’Œå…¶ä»–è¯­è¨€éƒ½ä¸€æ ·<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">package ch5</span><br><span class="line"></span><br><span class="line">import &quot;testing&quot;</span><br><span class="line"></span><br><span class="line">func TestLoop(t *testing.T)&#123;</span><br><span class="line">n:=0</span><br><span class="line">for n&lt;5&#123;</span><br><span class="line">t.Log(n)</span><br><span class="line">n++</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul>]]></content>
      
      
      <categories>
          
          <category> GoLang </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Go </tag>
            
            <tag> hello world </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HDFSçš„Shellæ“ä½œ</title>
      <link href="/2019/11/20/HDFS%E7%9A%84Shell%E6%93%8D%E4%BD%9C/"/>
      <url>/2019/11/20/HDFS%E7%9A%84Shell%E6%93%8D%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<h1 id="æŸ¥è¯¢-hdfs-çš„å‘½ä»¤"><a href="#æŸ¥è¯¢-hdfs-çš„å‘½ä»¤" class="headerlink" title="æŸ¥è¯¢  hdfs çš„å‘½ä»¤:"></a>æŸ¥è¯¢  hdfs çš„å‘½ä»¤:</h1><ul><li>hadoop  fs  xxx</li></ul><h2 id="1-è¿½åŠ å†…å®¹åˆ°hdfsä¸­çš„æ–‡ä»¶"><a href="#1-è¿½åŠ å†…å®¹åˆ°hdfsä¸­çš„æ–‡ä»¶" class="headerlink" title="1.è¿½åŠ å†…å®¹åˆ°hdfsä¸­çš„æ–‡ä»¶"></a>1.è¿½åŠ å†…å®¹åˆ°hdfsä¸­çš„æ–‡ä»¶</h2><blockquote><p>hadoop fs -appendToFile æœ¬åœ°æ–‡ä»¶ hdfsä¸­çš„æ–‡ä»¶</p></blockquote><h2 id="2-æŸ¥çœ‹æ–‡ä»¶å†…å®¹"><a href="#2-æŸ¥çœ‹æ–‡ä»¶å†…å®¹" class="headerlink" title="2.æŸ¥çœ‹æ–‡ä»¶å†…å®¹"></a>2.æŸ¥çœ‹æ–‡ä»¶å†…å®¹</h2><blockquote><p>hadoop fs -cat æ–‡ä»¶</p></blockquote><h2 id="3-ä¿®æ”¹æ–‡ä»¶æƒé™"><a href="#3-ä¿®æ”¹æ–‡ä»¶æƒé™" class="headerlink" title="3.ä¿®æ”¹æ–‡ä»¶æƒé™"></a>3.ä¿®æ”¹æ–‡ä»¶æƒé™</h2><blockquote><p>hadoop fs -chmod æƒé™ä¿®æ”¹  å¯¹è±¡æ–‡ä»¶</p></blockquote><h2 id="4-ä¿®æ”¹æ–‡ä»¶çš„æ‰€å±ç”¨æˆ·å’Œç»„"><a href="#4-ä¿®æ”¹æ–‡ä»¶çš„æ‰€å±ç”¨æˆ·å’Œç»„" class="headerlink" title="4.ä¿®æ”¹æ–‡ä»¶çš„æ‰€å±ç”¨æˆ·å’Œç»„"></a>4.ä¿®æ”¹æ–‡ä»¶çš„æ‰€å±ç”¨æˆ·å’Œç»„</h2><blockquote><p>hadoop fs -chown  ç”¨æˆ·å ç»„å æ–‡ä»¶</p></blockquote><h2 id="5-ä¸Šä¼ æœ¬åœ°æ–‡ä»¶åˆ°hdfs"><a href="#5-ä¸Šä¼ æœ¬åœ°æ–‡ä»¶åˆ°hdfs" class="headerlink" title="5.ä¸Šä¼ æœ¬åœ°æ–‡ä»¶åˆ°hdfs"></a>5.ä¸Šä¼ æœ¬åœ°æ–‡ä»¶åˆ°hdfs</h2><blockquote><p>hadoop fs -put æœ¬åœ°æ–‡ä»¶ hdfsè·¯å¾„<br>hadoop fs -copyFromLocal æœ¬åœ°æ–‡ä»¶ hdfsè·¯å¾„</p></blockquote><h2 id="6-ä¸‹è½½hdfsæ–‡ä»¶åˆ°æœ¬åœ°"><a href="#6-ä¸‹è½½hdfsæ–‡ä»¶åˆ°æœ¬åœ°" class="headerlink" title="6.ä¸‹è½½hdfsæ–‡ä»¶åˆ°æœ¬åœ°"></a>6.ä¸‹è½½hdfsæ–‡ä»¶åˆ°æœ¬åœ°</h2><blockquote><p>hadoop fs -get hdfsæ–‡ä»¶ æœ¬åœ°è·¯å¾„<br>hadoop fs -copyToLocal hdfsæ–‡ä»¶ æœ¬åœ°è·¯å¾„</p></blockquote><h2 id="7-åœ¨hdfsä¸­æ‹·è´æ–‡ä»¶"><a href="#7-åœ¨hdfsä¸­æ‹·è´æ–‡ä»¶" class="headerlink" title="7.åœ¨hdfsä¸­æ‹·è´æ–‡ä»¶"></a>7.åœ¨hdfsä¸­æ‹·è´æ–‡ä»¶</h2><blockquote><p>hadoop fs -cp ç›®æ ‡ æ‹·è´è·¯å¾„</p></blockquote><h2 id="8-æŸ¥è¯¢ç£ç›˜ä½¿ç”¨é‡"><a href="#8-æŸ¥è¯¢ç£ç›˜ä½¿ç”¨é‡" class="headerlink" title="8.æŸ¥è¯¢ç£ç›˜ä½¿ç”¨é‡"></a>8.æŸ¥è¯¢ç£ç›˜ä½¿ç”¨é‡</h2><blockquote><p>hadoop fs -df -h  è·¯å¾„</p></blockquote><h2 id="9-ç»Ÿè®¡ç£ç›˜æ–‡ä»¶çš„å¤§å°"><a href="#9-ç»Ÿè®¡ç£ç›˜æ–‡ä»¶çš„å¤§å°" class="headerlink" title="9.ç»Ÿè®¡ç£ç›˜æ–‡ä»¶çš„å¤§å°"></a>9.ç»Ÿè®¡ç£ç›˜æ–‡ä»¶çš„å¤§å°</h2><blockquote><p>hadoop fs -du -s -h ç›®æ ‡ç›®å½•-</p></blockquote><h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><pre><code>hadoop fs -lshadoop fs -mvhadoop fs mkdirhadoop fs rm -r</code></pre>]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hadoop </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HDFSçš„é…ç½®å’Œä¸€äº›æ“ä½œ</title>
      <link href="/2019/11/20/HDFS%E7%9A%84%E9%85%8D%E7%BD%AE%E5%92%8C%E4%B8%80%E4%BA%9B%E6%93%8D%E4%BD%9C/"/>
      <url>/2019/11/20/HDFS%E7%9A%84%E9%85%8D%E7%BD%AE%E5%92%8C%E4%B8%80%E4%BA%9B%E6%93%8D%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<h2 id="1-è¿”å›hadoopé›†ç¾¤çš„ä¿¡æ¯ï¼š"><a href="#1-è¿”å›hadoopé›†ç¾¤çš„ä¿¡æ¯ï¼š" class="headerlink" title="1.è¿”å›hadoopé›†ç¾¤çš„ä¿¡æ¯ï¼š"></a>1.è¿”å›hadoopé›†ç¾¤çš„ä¿¡æ¯ï¼š</h2><p><code>hdfs dfsadmin -report</code></p><h2 id="2-è¿”å›å¯è®¿é—®çš„ç«¯å£ï¼š"><a href="#2-è¿”å›å¯è®¿é—®çš„ç«¯å£ï¼š" class="headerlink" title="2.è¿”å›å¯è®¿é—®çš„ç«¯å£ï¼š"></a>2.è¿”å›å¯è®¿é—®çš„ç«¯å£ï¼š</h2><p><code>netstat -ntlp</code></p><h2 id="3-hadoopçš„ç½‘é¡µè®¿é—®-ï¼š"><a href="#3-hadoopçš„ç½‘é¡µè®¿é—®-ï¼š" class="headerlink" title="3.hadoopçš„ç½‘é¡µè®¿é—® ï¼š"></a>3.hadoopçš„ç½‘é¡µè®¿é—® ï¼š</h2><p> <code>masterip + ï¼šç«¯å£50070</code></p><h2 id="4-å…³é—­èŠ‚ç‚¹ï¼š"><a href="#4-å…³é—­èŠ‚ç‚¹ï¼š" class="headerlink" title="4.å…³é—­èŠ‚ç‚¹ï¼š"></a>4.å…³é—­èŠ‚ç‚¹ï¼š</h2><p><code>hadoop-daemon.sh stop namenode/datanode</code>  </p><h2 id="5-hadoop-etc-hadoop-ä¸‹çš„slavesç®¡ç†ç€datanodeï¼š"><a href="#5-hadoop-etc-hadoop-ä¸‹çš„slavesç®¡ç†ç€datanodeï¼š" class="headerlink" title="5.hadoop/etc/hadoop ä¸‹çš„slavesç®¡ç†ç€datanodeï¼š"></a>5.hadoop/etc/hadoop ä¸‹çš„slavesç®¡ç†ç€datanodeï¼š</h2><p><code>vim slaves</code></p><blockquote><p>å¡«å…¥æ‰€æœ‰ datanodeåå­—ï¼ˆS1ï¼‰</p></blockquote><h2 id="6-åˆ©ç”¨masterç®¡ç†æ‰€æœ‰å­èŠ‚ç‚¹ï¼š"><a href="#6-åˆ©ç”¨masterç®¡ç†æ‰€æœ‰å­èŠ‚ç‚¹ï¼š" class="headerlink" title="6.åˆ©ç”¨masterç®¡ç†æ‰€æœ‰å­èŠ‚ç‚¹ï¼š"></a>6.åˆ©ç”¨masterç®¡ç†æ‰€æœ‰å­èŠ‚ç‚¹ï¼š</h2><blockquote><p><code>start-dfs.sh</code> å¯åŠ¨æ‰€æœ‰èŠ‚ç‚¹</p></blockquote><blockquote><p><code>stop-dfs.sh</code> å…³é—­æ‰€æœ‰èŠ‚ç‚¹</p></blockquote><h2 id="7-å…å¯†ç™»é™†ï¼š"><a href="#7-å…å¯†ç™»é™†ï¼š" class="headerlink" title="7.å…å¯†ç™»é™†ï¼š"></a>7.å…å¯†ç™»é™†ï¼š</h2><blockquote><p>ssh-keygen -t rsa<br>cd /.ssh</p></blockquote><p> ä¸€è·¯å›è½¦ ç”Ÿæˆä¸¤ä¸ªæ–‡ä»¶ ä¸€ä¸ªrootçš„ç§é’¥ ï¼Œä¸€ä¸ªå…¬é’¥</p><blockquote><p>ssh-copy-id S1ï¼ˆå­èŠ‚ç‚¹ï¼‰</p></blockquote><p>å°†å…¬é’¥ç»™å­èŠ‚ç‚¹ï¼Œä»¥åå°±ä¸ç”¨ç»™å¯†ç äº†</p><h2 id="8-hadoop-fs-lsï¼ˆLinuxçš„å‘½ä»¤ï¼‰-ã€‚ã€‚ã€‚ã€‚"><a href="#8-hadoop-fs-lsï¼ˆLinuxçš„å‘½ä»¤ï¼‰-ã€‚ã€‚ã€‚ã€‚" class="headerlink" title="8. hadoop fs  -lsï¼ˆLinuxçš„å‘½ä»¤ï¼‰  ã€‚ã€‚ã€‚ã€‚"></a>8. hadoop fs  -lsï¼ˆLinuxçš„å‘½ä»¤ï¼‰  ã€‚ã€‚ã€‚ã€‚</h2><p>å…¶å®æ˜¯ç±»ä¼¼linux</p><blockquote><p>ä¾‹å¦‚  <code>hadoop fs -put     ...</code><br>å°†ã€‚ã€‚ã€‚ä¸Šä¼ è‡³hdfsç³»ç»Ÿ</p></blockquote><h2 id="9-ä¿®æ”¹æ–‡ä»¶å¤‡ä»½æ•°é‡"><a href="#9-ä¿®æ”¹æ–‡ä»¶å¤‡ä»½æ•°é‡" class="headerlink" title="9.ä¿®æ”¹æ–‡ä»¶å¤‡ä»½æ•°é‡"></a>9.ä¿®æ”¹æ–‡ä»¶å¤‡ä»½æ•°é‡</h2><p>vim hdfs-site.xml<br>æ·»åŠ :</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;name&gt;dfs.replication&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;3&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hadoop </tag>
            
            <tag> ç¯å¢ƒæ­å»º </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hadoopé›†ç¾¤æ­å»ºæ‰‹å†Œ</title>
      <link href="/2019/11/20/Hadoop%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA%E6%89%8B%E5%86%8C/"/>
      <url>/2019/11/20/Hadoop%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA%E6%89%8B%E5%86%8C/</url>
      
        <content type="html"><![CDATA[<h1 id="Hadoopé›†ç¾¤æ­å»ºæ‰‹å†Œ"><a href="#Hadoopé›†ç¾¤æ­å»ºæ‰‹å†Œ" class="headerlink" title="Hadoopé›†ç¾¤æ­å»ºæ‰‹å†Œ"></a>Hadoopé›†ç¾¤æ­å»ºæ‰‹å†Œ</h1><h2 id="1-å‡†å¤‡ææ–™"><a href="#1-å‡†å¤‡ææ–™" class="headerlink" title="1.å‡†å¤‡ææ–™"></a>1.å‡†å¤‡ææ–™</h2><ul><li>centos7 è™šæ‹ŸæœºNå°</li><li>xshell xftp</li><li>hadoop,jdkå®‰è£…åŒ…</li></ul><h2 id="2-å°†Linuxè¿æ¥åˆ°å®¢æˆ·ç«¯ï¼ˆæœ¬æœºï¼‰"><a href="#2-å°†Linuxè¿æ¥åˆ°å®¢æˆ·ç«¯ï¼ˆæœ¬æœºï¼‰" class="headerlink" title="2.å°†Linuxè¿æ¥åˆ°å®¢æˆ·ç«¯ï¼ˆæœ¬æœºï¼‰"></a>2.å°†Linuxè¿æ¥åˆ°å®¢æˆ·ç«¯ï¼ˆæœ¬æœºï¼‰</h2><pre><code>ä¿®æ”¹ç½‘å…³ï¼š æœ¬æœºä¸º192.168.2.1  å…¶ä»–ä¸º101/102/103.ã€‚ã€‚ã€‚åœ¨è™šæ‹Ÿæœºä¸­é€‰æ‹©host-onlyç½‘ç»œvim /etc/sysconfig/network&gt;&gt;&gt;NETWORKING=yes&gt;&gt;&gt;GATWAY=192.168.2.1 (æœ¬æœºip)ä¿®æ”¹ipvim /etc/sysconfig/network-sripts/ifcfg-enp0s3  (linuxç½‘å¡åå­—)&gt;&gt;&gt;TYPE=Ethernet&gt;&gt;&gt;IPADDR=192.168.20  (ç»™linuxåˆ†é…çš„ip)&gt;&gt;&gt;NETMASK=255.255.255.0ä¿®æ”¹ä¸»æœºå ï¼›hostnamectl set-hostname  ....é‡å¯ç½‘ç»œï¼šservice network restartæµ‹è¯•æ˜¯å¦ä¿®æ”¹æˆåŠŸï¼šï¼ˆæ³¨æ„å…³æ‰é˜²ç«å¢™)ifconfigping å®¢æˆ·ç«¯ip</code></pre><h2 id="3-å®‰è£…å¥½ä¸€å°linuxï¼š"><a href="#3-å®‰è£…å¥½ä¸€å°linuxï¼š" class="headerlink" title="3.å®‰è£…å¥½ä¸€å°linuxï¼š"></a>3.å®‰è£…å¥½ä¸€å°linuxï¼š</h2><pre><code>è£…å¥½xshell åˆ©ç”¨sshè®¿é—®linuxè£…å¥½xftp  å°†æœ¬åœ°ä¸‹è½½çš„ Hadoop jdk ä¸Šä¼  linuxå®‰è£… jdkï¼šrpm -ivh ã€‚ã€‚ã€‚rpm   ï¼ˆé»˜è®¤å®‰è£…åœ¨/usr/javaï¼‰ç”¨ javaå‘½ä»¤æ£€æŸ¥å®‰è£… Hadoopï¼štar -xvf ã€‚ã€‚ã€‚tar.gzmvæ”¹å</code></pre><p>è®¾ç½®ç¯å¢ƒå˜é‡</p><blockquote><p>vim /etc/profile</p></blockquote><pre><code>export HADOOP_HOME=/usr/local/hadoopexport PATH=$HADOOP_HOME/bin:$HADOOP_HOME/sbin:$PATH</code></pre><p>è®©è®¾ç½®ç”Ÿæ•ˆ</p><pre><code>source /etc/profile</code></pre><p>è®¾ç½®Hadoopçš„JAVA_HOME</p><pre><code>cd /usr/local/hadoopvim etc/hadoop/hadoop-env.shexport JAVA_HOME=/usr/java/default</code></pre><h2 id="4-ç½‘ç»œè”é€š"><a href="#4-ç½‘ç»œè”é€š" class="headerlink" title="4.ç½‘ç»œè”é€š"></a>4.ç½‘ç»œè”é€š</h2><pre><code>å…¨éƒ¨å…³æ‰é˜²ç«å¢™systemctl stop firewalldsystemctl disable firewalldæŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€firewall-cmd --stateåœæ­¢firewallsystemctl stop firewalld.serviceç¦æ­¢firewallå¼€æœºå¯åŠ¨systemctl disable firewalld.service äº’ç›¸pingæµ‹è¯•æ˜¯å¦è”é€šåˆ†åˆ«è¿›è¡Œ ä¿®æ”¹ip/ ä¿®æ”¹ä¸»æœºå / é‡å¯ç½‘ç»œ çš„æ“ä½œ</code></pre><h2 id="5-é…ç½®-usr-local-hadoop-etc-hadoop"><a href="#5-é…ç½®-usr-local-hadoop-etc-hadoop" class="headerlink" title="5.é…ç½®/usr/local/hadoop/etc/hadoop"></a>5.é…ç½®/usr/local/hadoop/etc/hadoop</h2><p>ä¸­å¿ƒèŠ‚ç‚¹é…ç½®ï¼š</p><blockquote><p>vim core-site.xml</p></blockquote><pre><code>&lt;!-- æŒ‡å®šHADOOPæ‰€ä½¿ç”¨çš„æ–‡ä»¶ç³»ç»Ÿschemaï¼ˆURIï¼‰ï¼ŒHDFSçš„è€å¤§ï¼ˆNameNodeï¼‰çš„åœ°å€ --&gt;&lt;property&gt;    &lt;name&gt;fs.defaultFS&lt;/name&gt;    &lt;value&gt;hdfs://master:9000&lt;/value&gt;&lt;/property&gt;&lt;!-- æŒ‡å®šhadoopè¿è¡Œæ—¶äº§ç”Ÿæ–‡ä»¶çš„å­˜å‚¨ç›®å½• --&gt;&lt;property&gt;      &lt;name&gt;hadoop.tmp.dir&lt;/name&gt;    &lt;value&gt;/usr/local/hadoop/tmp&lt;/value&gt;&lt;/property&gt;</code></pre><p> ä¿®æ”¹å¤‡ä»½æ•°é‡</p><blockquote><p>vim hdfs-site.xml</p></blockquote><pre><code>&lt;!-- æŒ‡å®šHDFSå‰¯æœ¬çš„æ•°é‡ --&gt;&lt;property&gt;    &lt;name&gt;dfs.replication&lt;/name&gt;    &lt;value&gt;1&lt;/value&gt;&lt;/property&gt; &lt;!-- æŒ‡Second namenodeçš„å¯åŠ¨ä½ç½® --&gt;&lt;property&gt;    &lt;name&gt;dfs.namenode.secondary.http-address&lt;/name&gt;    &lt;value&gt;master:50090&lt;/value&gt;&lt;/property&gt;</code></pre><p>ä¿®æ”¹è®¡ç®—æ¡†æ¶    </p><blockquote><p>vim mapred-site.xml</p></blockquote><pre><code>&lt;!-- æŒ‡å®šmrè¿è¡Œåœ¨yarnä¸Š --&gt;&lt;property&gt;    &lt;name&gt;mapreduce.framework.name&lt;/name&gt;    &lt;value&gt;yarn&lt;/value&gt;&lt;/property&gt;</code></pre><p>ä¿®æ”¹èµ„æºè°ƒç”¨æ¡†æ¶</p><blockquote><p>vim yarn-site.xml</p></blockquote><pre><code>&lt;!-- æŒ‡å®šYARNçš„è€å¤§ï¼ˆResourceManagerï¼‰çš„åœ°å€ --&gt;&lt;property&gt;        &lt;name&gt;yarn.resourcemanager.hostname&lt;/name&gt;        &lt;value&gt;master&lt;/value&gt;&lt;/property&gt;    &lt;!-- reducerè·å–æ•°æ®çš„æ–¹å¼ --&gt;&lt;property&gt;        &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt;        &lt;value&gt;mapreduce_shuffle&lt;/value&gt; &lt;/property&gt;</code></pre><h4 id="å¦‚æœæ˜¯å®Œå…¨åˆ†å¸ƒå¼-å°†ä¸Šé¢çš„åšå¥½çš„æ‹·è´-ä¿®æ”¹ip-hostnameå³å¯ã€‚å¦‚æœæ˜¯ä¼ªåˆ†å¸ƒå¼-å°±è¿™æ ·è¿è¡Œå°±å¥½äº†"><a href="#å¦‚æœæ˜¯å®Œå…¨åˆ†å¸ƒå¼-å°†ä¸Šé¢çš„åšå¥½çš„æ‹·è´-ä¿®æ”¹ip-hostnameå³å¯ã€‚å¦‚æœæ˜¯ä¼ªåˆ†å¸ƒå¼-å°±è¿™æ ·è¿è¡Œå°±å¥½äº†" class="headerlink" title="å¦‚æœæ˜¯å®Œå…¨åˆ†å¸ƒå¼,å°†ä¸Šé¢çš„åšå¥½çš„æ‹·è´,ä¿®æ”¹ip hostnameå³å¯ã€‚å¦‚æœæ˜¯ä¼ªåˆ†å¸ƒå¼,å°±è¿™æ ·è¿è¡Œå°±å¥½äº†"></a>å¦‚æœæ˜¯å®Œå…¨åˆ†å¸ƒå¼,å°†ä¸Šé¢çš„åšå¥½çš„æ‹·è´,ä¿®æ”¹ip hostnameå³å¯ã€‚å¦‚æœæ˜¯ä¼ªåˆ†å¸ƒå¼,å°±è¿™æ ·è¿è¡Œå°±å¥½äº†</h4><h2 id="6-å¯åŠ¨hdfs"><a href="#6-å¯åŠ¨hdfs" class="headerlink" title="6.å¯åŠ¨hdfs"></a>6.å¯åŠ¨hdfs</h2><pre><code>é¦–å…ˆæ ¼å¼åŒ–hdfs   hdfs namenode -formatå°†ipä¸åå­—å¯¹åº”vim /etc/hosts    192.168.2.20  master    ....    ....    ....masterå¯åŠ¨ namenodeï¼š    hadoop-daemon.sh start namenodejps  æ£€æŸ¥namenodeæ˜¯å¦å¯åŠ¨vim slavesæ·»åŠ å­èŠ‚ç‚¹ä¿¡æ¯    master    s1    ....slaveå¯åŠ¨ datanodeï¼š    hadoop-daemon.sh start datanodejpsæ£€æŸ¥</code></pre><h2 id="é”™è¯¯æŒ‡å—"><a href="#é”™è¯¯æŒ‡å—" class="headerlink" title="é”™è¯¯æŒ‡å—"></a>é”™è¯¯æŒ‡å—</h2><pre><code>1.å¦‚æœå‡ºç°javahomeé—®é¢˜          &gt;&gt;&gt; é…ç½®javahomeè·¯å¾„ vim hadoop-env.sh             /usr/java/default2.å‡ºç° -bash  hadoop  ã€‚ã€‚ã€‚not found é—®é¢˜    &gt;&gt;&gt; é…ç½® vim /etc/profileå¢åŠ :    export HADOOP_HOME=/usr/local/hadoop    export PATH=$HADOOP_HOME/bin:$HADOOP_HOME/sbin:$PATH3.ä¿®æ”¹å®Œé…ç½®ä¿¡æ¯ä»¥åè®°å¾— source  /ã€‚ã€‚ã€‚4.å¤šæ¬¡æ ¼å¼åŒ–hdfsä¼šå¯¼è‡´ namenodeä¸datanodeçš„idä¸åˆ  &gt;&gt; masterå¯åŠ¨ä¸äº†datanode è¿›å…¥hadoopçš„logs ä¸‹æŸ¥çœ‹æ—¥å¿—   &gt;&gt;  ä¿®æ”¹Versionçš„ natanode å’Œ namenode çš„clusterIDä¸€è‡´</code></pre>]]></content>
      
      
      <categories>
          
          <category> å¤§æ•°æ® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hadoop </tag>
            
            <tag> ç¯å¢ƒæ­å»º </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019è“æ¡¥æ¯æ ¡èµ›æ€»ç»“</title>
      <link href="/2019/11/17/2019%E8%93%9D%E6%A1%A5%E6%9D%AF%E6%A0%A1%E8%B5%9B/"/>
      <url>/2019/11/17/2019%E8%93%9D%E6%A1%A5%E6%9D%AF%E6%A0%A1%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<h2 id="2019è“æ¡¥æ¯æ ¡èµ›æ€»ç»“"><a href="#2019è“æ¡¥æ¯æ ¡èµ›æ€»ç»“" class="headerlink" title="2019è“æ¡¥æ¯æ ¡èµ›æ€»ç»“"></a>2019è“æ¡¥æ¯æ ¡èµ›æ€»ç»“</h2><h4 id="1-2-è®¡ç®—å™¨è®¡ç®—å†…å­˜-æ‰‹åŠ¨å¿½ç•¥"><a href="#1-2-è®¡ç®—å™¨è®¡ç®—å†…å­˜-æ‰‹åŠ¨å¿½ç•¥" class="headerlink" title="1 - 2 è®¡ç®—å™¨è®¡ç®—å†…å­˜(æ‰‹åŠ¨å¿½ç•¥)"></a>1 - 2 è®¡ç®—å™¨è®¡ç®—å†…å­˜(æ‰‹åŠ¨å¿½ç•¥)</h4><h4 id="3-ç»Ÿè®¡1-2019ä¸­å¸¦â€™9â€™çš„æ•°å­—æœ‰å¤šå°‘ä¸ª"><a href="#3-ç»Ÿè®¡1-2019ä¸­å¸¦â€™9â€™çš„æ•°å­—æœ‰å¤šå°‘ä¸ª" class="headerlink" title="3.ç»Ÿè®¡1-2019ä¸­å¸¦â€™9â€™çš„æ•°å­—æœ‰å¤šå°‘ä¸ª"></a>3.ç»Ÿè®¡1-2019ä¸­å¸¦â€™9â€™çš„æ•°å­—æœ‰å¤šå°‘ä¸ª</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">public class C &#123;</span><br><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">int res = 0;</span><br><span class="line">for(int i=1;i&lt;=2019;i++)&#123;</span><br><span class="line">if(func(String.valueOf(i))) res++;</span><br><span class="line">&#125;</span><br><span class="line">System.out.println(res);</span><br><span class="line">&#125;</span><br><span class="line">public static boolean func(String n) &#123;</span><br><span class="line">for(char c:n.toCharArray())&#123;</span><br><span class="line">if(c == &apos;9&apos;) return true;</span><br><span class="line">&#125;</span><br><span class="line">return false;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æ€è·¯å¾ˆç®€å•,è¦ä¹ˆç”¨å­—ç¬¦ä¸²è¦ä¹ˆç”¨å–æ¨¡åˆ¤æ–­æ˜¯ä¸æ˜¯å«æœ‰â€™9â€™</li></ul><h4 id="4-ç»Ÿè®¡8-8çš„å›¾é‡Œæœ‰å¤šå°‘ç§èµ°å¯¹è§’çº¿çš„æ–¹å¼"><a href="#4-ç»Ÿè®¡8-8çš„å›¾é‡Œæœ‰å¤šå°‘ç§èµ°å¯¹è§’çº¿çš„æ–¹å¼" class="headerlink" title="4.ç»Ÿè®¡8*8çš„å›¾é‡Œæœ‰å¤šå°‘ç§èµ°å¯¹è§’çº¿çš„æ–¹å¼"></a>4.ç»Ÿè®¡8*8çš„å›¾é‡Œæœ‰å¤šå°‘ç§èµ°å¯¹è§’çº¿çš„æ–¹å¼</h4><p>è¿™ä¸ªé¢˜æœ‰ç‚¹ä¸œè¥¿æ˜¯åœ¨ç»™äº†å¾ˆå¤šé™åˆ¶ï¼Œå…¶å®æœ€åå‘ç°éƒ½æ˜¯æ²¡å•¥ç”¨çš„ï¼ŒåŠ ä¸åŠ ä¹Ÿæ˜¯é‚£ä¹ˆå¤š (åªèƒ½å¾€å³æˆ–è€…å¾€ä¸‹èµ°) ç›´æ¥dfså³å¯ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">public class D &#123;</span><br><span class="line">static int res = 0;</span><br><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">dfs(0,0,0);</span><br><span class="line">System.out.println(res);</span><br><span class="line">&#125;</span><br><span class="line">public static void dfs(int i,int j,int count)&#123;</span><br><span class="line">if(i&lt;0||i&gt;=8||j&lt;0||j&gt;=8||count&gt;14) return;</span><br><span class="line">if(i==7&amp;&amp;j==7&amp;&amp;count==14)&#123;</span><br><span class="line">res++;</span><br><span class="line">return;</span><br><span class="line">&#125;</span><br><span class="line">dfs(i+1,j,count+1);</span><br><span class="line">dfs(i,j+1,count+1);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="5-å’Œç¬¬ä¸‰é¢˜æœ‰ç‚¹ç±»ä¼¼-åªä¸è¿‡æ˜¯æ±‚1-nç›´æ¥æœ‰å¤šå°‘-ç”±ä¸åŒæ•°å­—ç»„æˆçš„æ•°å­—"><a href="#5-å’Œç¬¬ä¸‰é¢˜æœ‰ç‚¹ç±»ä¼¼-åªä¸è¿‡æ˜¯æ±‚1-nç›´æ¥æœ‰å¤šå°‘-ç”±ä¸åŒæ•°å­—ç»„æˆçš„æ•°å­—" class="headerlink" title="5.å’Œç¬¬ä¸‰é¢˜æœ‰ç‚¹ç±»ä¼¼,åªä¸è¿‡æ˜¯æ±‚1-nç›´æ¥æœ‰å¤šå°‘(ç”±ä¸åŒæ•°å­—ç»„æˆçš„æ•°å­—)"></a>5.å’Œç¬¬ä¸‰é¢˜æœ‰ç‚¹ç±»ä¼¼,åªä¸è¿‡æ˜¯æ±‚1-nç›´æ¥æœ‰å¤šå°‘(ç”±ä¸åŒæ•°å­—ç»„æˆçš„æ•°å­—)</h4><ul><li>å¤šåŠ ä¸€ä¸ªvisæ•°ç»„åˆ¤æ–­è¯¥æ•°,æ˜¯å¦åœ¨è¿™ä¸ªæ•°å­—é‡Œå‡ºç°è¿‡ å¤æ‚åº¦åº”è¯¥æ˜¯(æ•°å­—çš„ä½æ•°*n)<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">public class E &#123;</span><br><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">Scanner sc = new Scanner(System.in);</span><br><span class="line">int n = sc.nextInt();</span><br><span class="line">int res = n;</span><br><span class="line">for(int i=1;i&lt;=n;i++)&#123;</span><br><span class="line">if(func(i)) res--;</span><br><span class="line">&#125;</span><br><span class="line">System.out.println(res);</span><br><span class="line">&#125;</span><br><span class="line">public static boolean func(int num)&#123;</span><br><span class="line">boolean[] vis = new boolean[11];//è¿™é‡Œæœ‰ç‚¹è´¹ç©ºé—´</span><br><span class="line">while(num != 0)&#123;</span><br><span class="line">int n = num%10;</span><br><span class="line">if(vis[n]) return true;</span><br><span class="line">else vis[n] = true;</span><br><span class="line">num /= 10;</span><br><span class="line">&#125;</span><br><span class="line">return false;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h4 id="6-æ±‚æœ€é•¿ä¸Šå‡å­åºåˆ—çš„é•¿åº¦"><a href="#6-æ±‚æœ€é•¿ä¸Šå‡å­åºåˆ—çš„é•¿åº¦" class="headerlink" title="6.æ±‚æœ€é•¿ä¸Šå‡å­åºåˆ—çš„é•¿åº¦"></a>6.æ±‚æœ€é•¿ä¸Šå‡å­åºåˆ—çš„é•¿åº¦</h4><ul><li>ç›´æ¥éå† (nçš„æ—¶é—´å¤æ‚åº¦) ç»Ÿè®¡æœ€é•¿çš„åºåˆ—é•¿åº¦<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">public class F &#123;</span><br><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">Scanner sc = new Scanner(System.in);</span><br><span class="line">int n = sc.nextInt();</span><br><span class="line">int[] nums = new int[n+1];</span><br><span class="line">for(int i=0;i&lt;n;i++)&#123;</span><br><span class="line">nums[i] = sc.nextInt();</span><br><span class="line">&#125;</span><br><span class="line">int max = 1;</span><br><span class="line">int len = 1;</span><br><span class="line">int num = nums[0];</span><br><span class="line">for(int i=1;i&lt;n;i++)&#123;</span><br><span class="line">if(num&lt;nums[i]) len++;</span><br><span class="line">else len = 1;</span><br><span class="line">num = nums[i];</span><br><span class="line">if(len &gt; max ) max = len;</span><br><span class="line">&#125;</span><br><span class="line">System.out.println(max);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h4 id="7-æœ¬æ¥æ˜¯ä¸€é“é€åˆ†é¢˜-æ±‚é€†åºå¯¹"><a href="#7-æœ¬æ¥æ˜¯ä¸€é“é€åˆ†é¢˜-æ±‚é€†åºå¯¹" class="headerlink" title="7.æœ¬æ¥æ˜¯ä¸€é“é€åˆ†é¢˜,æ±‚é€†åºå¯¹"></a>7.æœ¬æ¥æ˜¯ä¸€é“é€åˆ†é¢˜,æ±‚é€†åºå¯¹</h4><ul><li>å†™è¿‡çš„é¢˜ï¼Œç»“æœæ´»ç”Ÿç”Ÿä¼šè¢«è‡ªå·±ç©æˆäº†ä¸¢åˆ†é¢˜ï¼Œæ€è·¯å¾ˆç®€å•ç›´æ¥ä¸¤å±‚foræš´åŠ›ä¹Ÿèƒ½è¿‡ï¼Œä½†æ˜¯ä½¿ç”¨å½’å¹¶æ’åºç†è®ºä¸Šæ˜¯èƒ½è¿‡10wçš„æµ‹è¯•é›†çš„ã€‚å…³é”®ä¸€æ­¥æ²¡å†™å‡ºæ¥ï¼Œéš¾å—ï¼Œä¸æƒ³è¯´è¯â€¦..<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">public class G &#123;</span><br><span class="line">static int res = 0;</span><br><span class="line">static int[] nums;</span><br><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">Scanner sc = new Scanner(System.in);</span><br><span class="line">int n = sc.nextInt();</span><br><span class="line">nums = new int[n+1];</span><br><span class="line">for(int i=0;i&lt;n;i++)&#123;</span><br><span class="line">nums[i] = sc.nextInt();</span><br><span class="line">&#125;</span><br><span class="line">merge_sort(nums,0,n-1);</span><br><span class="line">System.out.println(res);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public static void merge_sort(int[] nums,int l,int r)&#123;</span><br><span class="line">if(l&gt;=r) return;</span><br><span class="line">int mid = l+r&gt;&gt;1;</span><br><span class="line">merge_sort(nums,l,mid);</span><br><span class="line">merge_sort(nums,mid+1,r);</span><br><span class="line">int[] tmp = new int[r-l+1];</span><br><span class="line">int k=0,left=l,right=mid+1;</span><br><span class="line">while(left&lt;=mid &amp;&amp; right&lt;=r)&#123;</span><br><span class="line">if(nums[left]&lt;=nums[right]) tmp[k++] = nums[left++];</span><br><span class="line">else &#123;</span><br><span class="line">tmp[k++] = nums[right++];</span><br><span class="line">res+=mid-left+1;            // æ ¸å¿ƒ: é€†åºå¯¹ åº”è¯¥æ˜¯åé¢çš„æ•°å»å‰é¢çš„è·¯ç¨‹ä¹‹å’Œ</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">while(left&lt;=mid)&#123;</span><br><span class="line">tmp[k++] = nums[left++];</span><br><span class="line">&#125;</span><br><span class="line">while(right&lt;=r) tmp[k++] = nums[right++];</span><br><span class="line">for(int n:tmp) nums[l++] = n;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h4 id="8-æ±‚1-nä¹‹é—´å–nä¸ªæ•°ä¸”æ»¡è¶³å¥‡æ•°ä½å¤§äºå‰ä¸€é¡¹-å¶æ•°ä½å°äºå‰ä¸€é¡¹"><a href="#8-æ±‚1-nä¹‹é—´å–nä¸ªæ•°ä¸”æ»¡è¶³å¥‡æ•°ä½å¤§äºå‰ä¸€é¡¹-å¶æ•°ä½å°äºå‰ä¸€é¡¹" class="headerlink" title="8.æ±‚1-nä¹‹é—´å–nä¸ªæ•°ä¸”æ»¡è¶³å¥‡æ•°ä½å¤§äºå‰ä¸€é¡¹,å¶æ•°ä½å°äºå‰ä¸€é¡¹"></a>8.æ±‚1-nä¹‹é—´å–nä¸ªæ•°ä¸”æ»¡è¶³å¥‡æ•°ä½å¤§äºå‰ä¸€é¡¹,å¶æ•°ä½å°äºå‰ä¸€é¡¹</h4><ul><li>ç›¸å½“æ ‡å‡†çš„æœç´¢,ä½†æ˜¯å¥½åƒæ‹¿ä¸äº†å¤šå°‘åˆ†</li><li>æ€è·¯: ç¬¬ä¸€ä¸ªæ•°éšä¾¿å–,åé¢çš„æŒ‰å¥‡å¶ä½åˆ†ç­–ç•¥æœç´¢<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">public class H &#123;</span><br><span class="line">static int res = 0;</span><br><span class="line">static int n,m;</span><br><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">Scanner sc = new Scanner(System.in);</span><br><span class="line">m = sc.nextInt();</span><br><span class="line">n = sc.nextInt();</span><br><span class="line">for(int i=1;i&lt;=n;i++)&#123;</span><br><span class="line">dfs(2,i);</span><br><span class="line">&#125;</span><br><span class="line">System.out.println(res);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public static void dfs(int index,int pre)&#123;</span><br><span class="line">if(index == m+1)&#123;</span><br><span class="line">res++;</span><br><span class="line">return;</span><br><span class="line">&#125;</span><br><span class="line">if(index % 2 == 0)&#123;</span><br><span class="line">for(int i=1;i&lt;pre;i++)&#123;</span><br><span class="line">dfs(index+1,i);</span><br><span class="line">&#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">for(int i=pre+1;i&lt;=n;i++)&#123;</span><br><span class="line">dfs(index+1,i);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h4 id="9-åŠ ä¸Šæ­¥é•¿-æ±‚æœ€çŸ­è·¯å¾„"><a href="#9-åŠ ä¸Šæ­¥é•¿-æ±‚æœ€çŸ­è·¯å¾„" class="headerlink" title="9.åŠ ä¸Šæ­¥é•¿,æ±‚æœ€çŸ­è·¯å¾„"></a>9.åŠ ä¸Šæ­¥é•¿,æ±‚æœ€çŸ­è·¯å¾„</h4><ul><li>ä¹Ÿæ˜¯dfsæœç´¢æœ€çŸ­è·¯å¾„,ä¸è¿‡æ˜¯æœç´¢çš„è·¯çº¿æœ‰æ‰€é™åˆ¶,å¿…é¡»æ˜¯æ»¡è¶³è·¯å¾„ä¹‹é•¿å°äºæ­¥é•¿(ä½¿ç”¨dpæ•°ç»„ä¿å­˜è¯¥ç‚¹çš„æœ€çŸ­è·¯å¾„,ç”¨ç©ºé—´æ¢æ—¶é—´)<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">public class I &#123;</span><br><span class="line">static boolean[][] vis;</span><br><span class="line">static int[][] dp;</span><br><span class="line">static int n,m;</span><br><span class="line">static double size; </span><br><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">Scanner sc = new Scanner(System.in);</span><br><span class="line">n = sc.nextInt();</span><br><span class="line">m = sc.nextInt();</span><br><span class="line">size = sc.nextDouble();</span><br><span class="line">vis = new boolean[n+1][m+1];</span><br><span class="line">dp = new int[n+1][m+1];</span><br><span class="line">System.out.println(dfs(1,1));</span><br><span class="line">&#125;</span><br><span class="line">public static int dfs(int i,int j)&#123;</span><br><span class="line">if(i==n&amp;&amp;j==m) return 0;</span><br><span class="line">if(dp[i][j] != 0) return dp[i][j];</span><br><span class="line">int min = Integer.MAX_VALUE;</span><br><span class="line">for(int x=0;x&lt;=n-i;x++)&#123;        // æœç´¢ç­–ç•¥</span><br><span class="line">for(int y=0;y&lt;=m-j;y++)&#123;</span><br><span class="line">if(Math.sqrt((x*x) + (y*y)) &gt; size) break;</span><br><span class="line">if(!vis[i+x][j+y]) &#123;</span><br><span class="line">vis[i+x][j+y] = true;</span><br><span class="line">min = Math.min(min, dfs(i+x,j+y));</span><br><span class="line">vis[i+x][j+y] = false;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">dp[i][j] = min+1;       // ä¿å­˜æœ€çŸ­è·¯å¾„</span><br><span class="line">return min + 1;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p>ä½†æ˜¯å¥½åƒè¿˜æ˜¯è¿‡ä¸äº†1000*1000çš„çŸ©é˜µ</p><h4 id="10-æŒ‰åŸé¡ºåºè¾“å‡ºå‰nå¤§çš„æ•°å­—"><a href="#10-æŒ‰åŸé¡ºåºè¾“å‡ºå‰nå¤§çš„æ•°å­—" class="headerlink" title="10.æŒ‰åŸé¡ºåºè¾“å‡ºå‰nå¤§çš„æ•°å­—"></a>10.æŒ‰åŸé¡ºåºè¾“å‡ºå‰nå¤§çš„æ•°å­—</h4><ul><li>å‰nå¤§å¯ä»¥ç›´æ¥sortæˆ–è€…ç”¨ä¼˜å…ˆé˜Ÿåˆ—</li><li>åé¢æŒ‰é¡ºåºè¾“å‡º,å¯ä»¥ç”¨mapè®°å½•å‰nå¤§çš„æ•°æ®,å†å›åŸæ•°ç»„ä¸­æŒ‰ä½ç½®è¾“å‡º</li><li>ä½¿ç”¨mapå¯ä»¥ç”¨keyè®°å½•æ•°å­—,valueè®°å½•å‡ºç°æ¬¡æ•°,å¤„ç†å…·æœ‰é‡å¤æ•°æ®çš„æƒ…å†µ<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">public class J &#123;</span><br><span class="line">public static void main(String[] args)&#123;</span><br><span class="line">Scanner sc = new Scanner(System.in);</span><br><span class="line">int n = sc.nextInt();</span><br><span class="line">int m = sc.nextInt();</span><br><span class="line">int[] nums = new int[n+1];</span><br><span class="line">PriorityQueue&lt;Integer&gt; q = new PriorityQueue&lt;&gt;(m);</span><br><span class="line">for(int i=0;i&lt;n;i++)&#123;</span><br><span class="line">int num = sc.nextInt();</span><br><span class="line">nums[i] = num;</span><br><span class="line">if(q.size() &lt;m) q.add(num);</span><br><span class="line">else if(q.peek() &lt; num)&#123;</span><br><span class="line">q.poll();</span><br><span class="line">q.add(num);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">Map&lt;Integer,Integer&gt; map = new HashMap&lt;&gt;();</span><br><span class="line">for(int i=0;i&lt;m;i++)&#123;</span><br><span class="line">int key = q.poll();</span><br><span class="line">if(map.containsKey(key))&#123;</span><br><span class="line">map.put(key,map.get(key)+1);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">map.put(key,1);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">for(int i=0;i&lt;n;i++)&#123;</span><br><span class="line">if(map.containsKey(nums[i]))&#123;</span><br><span class="line">System.out.print(nums[i] + &quot; &quot;);</span><br><span class="line">if(map.get(nums[i]) == 1) map.remove(nums[i]);</span><br><span class="line">else map.put(nums[i], map.get(nums[i])-1);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>O(nlogn)çš„å¤æ‚åº¦,åº”è¯¥èƒ½è¿‡,åªæ˜¯æœ€åå¤ªç€æ€¥,å¿˜äº†åŠ ä¸Šåˆ¤æ–­,valueä¸º0æ—¶åˆ é™¤è¯¥å…ƒç´ â€¦.</li></ul><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“:"></a>æ€»ç»“:</h2><p> DFSç”¨çš„å¾ˆå¤šï¼Œä½†æ˜¯å‰ªææ²¡å†™å¥½ï¼Œåªèƒ½æ‹¿éƒ¨åˆ†åˆ†ã€‚<br> å¤±è¯¯å¤ªå¤šï¼Œä¼šçš„æ²¡å†™å‡ºæ¥ï¼Œåè€Œæµªè´¹å¤§æŠŠæ—¶é—´ã€‚å¸Œæœ›èƒ½è¿‡æ ¡èµ›ï¼Œç»™ä¸ªè¡¥æ•‘çš„æœºä¼šã€‚ã€‚ã€‚ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
            <tag> DFS </tag>
            
            <tag> æ’åºç®—æ³• </tag>
            
            <tag> æ¨¡æ‹Ÿ </tag>
            
            <tag> ç«èµ› </tag>
            
            <tag> æ•°æ®ç»“æ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ’åºæ¨¡æ¿</title>
      <link href="/2019/11/16/%E6%8E%92%E5%BA%8F%E6%A8%A1%E6%9D%BF/"/>
      <url>/2019/11/16/%E6%8E%92%E5%BA%8F%E6%A8%A1%E6%9D%BF/</url>
      
        <content type="html"><![CDATA[<h2 id="å¿«é€Ÿæ’åº"><a href="#å¿«é€Ÿæ’åº" class="headerlink" title="å¿«é€Ÿæ’åº"></a>å¿«é€Ÿæ’åº</h2><ul><li>åˆ©ç”¨åˆ†æ²»ï¼Œé€‰æ‹©ä¸€ä¸ªæ ‡å…µä½¿å·¦å³åŒºé—´åˆ†åˆ«æ»¡è¶³&lt;=å’Œ&gt;=æ ‡å…µï¼Œé€’å½’å­åŒºé—´ç›´åˆ°åŒºé—´é•¿åº¦ä¸º1</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">public static void quick_sort(int[] nums, int l, int r) &#123;</span><br><span class="line">if(l&gt;=r) return;</span><br><span class="line">int m = nums[l+r&gt;&gt;1],left = l-1,right = r+1;  //æ³¨æ„æ­¤å¤„çš„æ ‡å…µå–å€¼ å¿…é¡»ä¸ä¸‹é¢é€’å½’çš„æ ‡å…µç›¸å l - right</span><br><span class="line">while (left&lt;right)&#123;</span><br><span class="line">do left++; while (nums[left] &lt; m);</span><br><span class="line">do right--; while (nums[right] &gt; m);</span><br><span class="line">if(left&lt;right) &#123;</span><br><span class="line">int tmp = nums[left];</span><br><span class="line">nums[left] = nums[right];</span><br><span class="line">nums[right] = tmp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">quick_sort(nums,l,right);</span><br><span class="line">quick_sort(nums,right+1, r);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŒç»­ä¼˜åŒ–ï¼š1.ç±»ä¼¼è·å…°æ——é—®é¢˜ï¼Œå½“æ‰€æ±‚å€¼ä¸æ ‡å…µç›¸åŒæ—¶ ä¸å‚ä¸ä¸‹ä¸€æ¬¡é€’å½’<br>  2.éšæœºæ ‡å…µ è¡¨ç°ä¼šæ¯”å›ºå®šæ ‡å…µçš„æ•ˆæœå¥½</p><h2 id="å½’å¹¶æ’åº"><a href="#å½’å¹¶æ’åº" class="headerlink" title="å½’å¹¶æ’åº"></a>å½’å¹¶æ’åº</h2><ul><li>ä¹Ÿæ˜¯åˆ†æ²»ï¼Œå…ˆé€’å½’ï¼Œå†åˆå¹¶ã€‚æ¯æ¬¡é€’å½’äºŒåˆ†ç›´åˆ°åŒºé—´é•¿åº¦ä¸º1ï¼Œç„¶åå’Œå¹¶è¿”å›æœ‰åºæ•°ç»„</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">public static void merge_sort(int[] nums,int l,int r)&#123;</span><br><span class="line">    if(l&gt;=r) return;</span><br><span class="line">    int mid = l+r&gt;&gt;1;</span><br><span class="line">    merge_sort(nums,l,mid);</span><br><span class="line">    merge_sort(nums,mid+1,r);</span><br><span class="line">    int[] tmp = new int[r-l+1];</span><br><span class="line">    int k=0,left=l,right=mid+1;</span><br><span class="line">    while(left&lt;=mid &amp;&amp; right&lt;=r)&#123;</span><br><span class="line">        if(nums[left]&lt;nums[right]) tmp[k++] = nums[left++];</span><br><span class="line">        else tmp[k++] = nums[right++];</span><br><span class="line">    &#125;</span><br><span class="line">    while(left&lt;=mid) tmp[k++] = nums[left++];</span><br><span class="line">    while(right&lt;=r) tmp[k++] = nums[right++];</span><br><span class="line">    for(int n:tmp) nums[l++] = n;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å¿«æ’é‡åœ¨åˆ‡åˆ†åŒºé—´ï¼Œå½’å¹¶é‡åœ¨åˆå¹¶åŒºé—´"><a href="#å¿«æ’é‡åœ¨åˆ‡åˆ†åŒºé—´ï¼Œå½’å¹¶é‡åœ¨åˆå¹¶åŒºé—´" class="headerlink" title="å¿«æ’é‡åœ¨åˆ‡åˆ†åŒºé—´ï¼Œå½’å¹¶é‡åœ¨åˆå¹¶åŒºé—´"></a>å¿«æ’é‡åœ¨åˆ‡åˆ†åŒºé—´ï¼Œå½’å¹¶é‡åœ¨åˆå¹¶åŒºé—´</h4><h2 id="javaä¸­çš„å¤åˆæ’åº"><a href="#javaä¸­çš„å¤åˆæ’åº" class="headerlink" title="javaä¸­çš„å¤åˆæ’åº"></a>javaä¸­çš„å¤åˆæ’åº</h2><ul><li>å¯¹æ–°å»ºçš„ç»“æ„ä½“ä½¿ç”¨ç»§æ‰¿ Comparableæ¥å£ å®ä¹ æ’åºå¯¹æ¯”</li><li>å¯¹äºæ™®é€šçš„å¯¹æ¯”ï¼Œä½¿ç”¨ new Comparatorç±»</li><li>å¯¹äºå¤åˆå¯¹æ¯” ä½¿ç”¨å¤šå±‚if-elseåµŒå¥—</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">import java.util.ArrayList;</span><br><span class="line">import java.util.Comparator;</span><br><span class="line">import java.util.List;</span><br><span class="line">// å¯¹ç»“æ„ä½“æ’åº</span><br><span class="line">class Node implements Comparable&lt;Node&gt;&#123;</span><br><span class="line">int x;</span><br><span class="line">int y;</span><br><span class="line">public Node(int x, int y) &#123;</span><br><span class="line">this.x = x;</span><br><span class="line">this.y = y;</span><br><span class="line">&#125;</span><br><span class="line">// å…ˆæŒ‰ x æ’åº å†æŒ‰ yæ’åº</span><br><span class="line">@Override</span><br><span class="line">public int compareTo(Node other) &#123;</span><br><span class="line">if(other.x &gt; this.x) return 1;</span><br><span class="line">else if(other.x &lt; this.x) return -1;</span><br><span class="line">else &#123;</span><br><span class="line">return other.y - this.y;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public class NodeSort &#123;</span><br><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">List&lt;Node&gt; list = new ArrayList&lt;&gt;();</span><br><span class="line">list.sort(new Comparator&lt;Node&gt;() &#123;</span><br><span class="line">@Override</span><br><span class="line">public int compare(Node o1, Node o2) &#123;</span><br><span class="line">return o1.x-o2.x;</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="javaä¸­çš„ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆå †æ’åºï¼‰"><a href="#javaä¸­çš„ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆå †æ’åºï¼‰" class="headerlink" title="javaä¸­çš„ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆå †æ’åºï¼‰"></a>javaä¸­çš„ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆå †æ’åºï¼‰</h2><ul><li>å †æ’åºé»˜è®¤ç»´æŠ¤nå¤§å°çš„æœ€å€¼ï¼ˆé»˜è®¤æœ€å¤§å€¼ å°é¡¶å †ï¼‰</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">import java.util.Comparator;</span><br><span class="line">import java.util.PriorityQueue;</span><br><span class="line"></span><br><span class="line">public class heapSort &#123;</span><br><span class="line">  public static void main(String[] args) &#123;</span><br><span class="line">    int[] arr = &#123;1,5,3,2,7,6,4,9,8&#125;;</span><br><span class="line">    int k = 3;      // é˜Ÿçš„size</span><br><span class="line">    PriorityQueue&lt;Integer&gt; q1 = new PriorityQueue&lt;&gt;(k);   // ç»´æŠ¤å°é¡¶å †</span><br><span class="line">    PriorityQueue&lt;Integer&gt; q = new PriorityQueue&lt;&gt;(k, new Comparator&lt;Integer&gt;() &#123;   // ç»´æŠ¤å¤§é¡¶å †</span><br><span class="line">      @Override</span><br><span class="line">      public int compare(Integer o1, Integer o2) &#123;</span><br><span class="line">        return o2-o1;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    for (int i = 0; i &lt;9 ; i++) &#123;</span><br><span class="line">      if(q.size() &lt; k) q.add(arr[i]);</span><br><span class="line">      else if(arr[i] &lt; q.peek())&#123;</span><br><span class="line">        q.poll();</span><br><span class="line">        q.add(arr[i]);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    for (int i = 0; i &lt;k ; i++) &#123;</span><br><span class="line">      System.out.println(q.poll());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
            <tag> æ’åºç®—æ³• </tag>
            
            <tag> æ•°æ®ç»“æ„ </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
